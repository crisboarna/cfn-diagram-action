"use strict";var e=require("os"),t=require("fs"),n=require("path"),r=require("http"),i=require("https"),o=require("net"),s=require("tls"),a=require("events"),l=require("assert"),c=require("util"),u=require("string_decoder"),d=require("child_process"),h=require("timers"),p=require("constants"),f=require("stream"),m=require("url"),g=require("tty"),_=require("crypto"),w=require("buffer"),v=require("zlib"),b=require("module"),y=require("dns"),S=require("readline"),x=require("inspector");function k(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var E=k(e),C=k(t),T=k(n),P=k(r),O=k(i),A=k(o),I=k(s),M=k(a),F=k(l),N=k(c),R=k(u),j=k(d),D=k(h),L=k(p),B=k(f),H=k(m),q=k(g),U=k(_),W=k(w),$=k(v),z=k(b),V=k(y),G=k(S),K=k(x);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function J(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))}var Y="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function X(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Q={},Z={},ee={};Object.defineProperty(ee,"__esModule",{value:!0}),ee.toCommandProperties=ee.toCommandValue=void 0,ee.toCommandValue=function(e){return null==e?"":"string"==typeof e||e instanceof String?e:JSON.stringify(e)},ee.toCommandProperties=function(e){return Object.keys(e).length?{title:e.title,file:e.file,line:e.startLine,endLine:e.endLine,col:e.startColumn,endColumn:e.endColumn}:{}};var te=Y&&Y.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),ne=Y&&Y.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),re=Y&&Y.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&te(t,e,n);return ne(t,e),t};Object.defineProperty(Z,"__esModule",{value:!0}),Z.issue=Z.issueCommand=void 0;const ie=re(E.default),oe=ee;function se(e,t,n){const r=new ae(e,t,n);process.stdout.write(r.toString()+ie.EOL)}Z.issueCommand=se,Z.issue=function(e,t=""){se(e,{},t)};class ae{constructor(e,t,n){e||(e="missing.command"),this.command=e,this.properties=t,this.message=n}toString(){let e="::"+this.command;if(this.properties&&Object.keys(this.properties).length>0){e+=" ";let n=!0;for(const r in this.properties)if(this.properties.hasOwnProperty(r)){const i=this.properties[r];i&&(n?n=!1:e+=",",e+=`${r}=${t=i,oe.toCommandValue(t).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}`)}}var t;return e+=`::${function(e){return oe.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}(this.message)}`,e}}var le={},ce=Y&&Y.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),ue=Y&&Y.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),de=Y&&Y.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&ce(t,e,n);return ue(t,e),t};Object.defineProperty(le,"__esModule",{value:!0}),le.issueCommand=void 0;const he=de(C.default),pe=de(E.default),fe=ee;le.issueCommand=function(e,t){const n=process.env[`GITHUB_${e}`];if(!n)throw new Error(`Unable to find environment variable for file command ${e}`);if(!he.existsSync(n))throw new Error(`Missing file at path: ${n}`);he.appendFileSync(n,`${fe.toCommandValue(t)}${pe.EOL}`,{encoding:"utf8"})};var me={},ge={},_e={};function we(e){if(!e.hostname)return!1;let t,n=process.env.no_proxy||process.env.NO_PROXY||"";if(!n)return!1;e.port?t=Number(e.port):"http:"===e.protocol?t=80:"https:"===e.protocol&&(t=443);let r=[e.hostname.toUpperCase()];"number"==typeof t&&r.push(`${r[0]}:${t}`);for(let e of n.split(",").map((e=>e.trim().toUpperCase())).filter((e=>e)))if(r.some((t=>t===e)))return!0;return!1}Object.defineProperty(_e,"__esModule",{value:!0}),_e.getProxyUrl=function(e){let t,n,r="https:"===e.protocol;return we(e)||(n=r?process.env.https_proxy||process.env.HTTPS_PROXY:process.env.http_proxy||process.env.HTTP_PROXY,n&&(t=new URL(n))),t},_e.checkBypass=we;var ve,be,ye={exports:{}},Se={};function xe(){return be?ye.exports:(be=1,ye.exports=function(){if(ve)return Se;ve=1;var e,t=I.default,n=P.default,r=O.default,i=M.default,o=N.default;function s(e){var t=this;t.options=e||{},t.proxyOptions=t.options.proxy||{},t.maxSockets=t.options.maxSockets||n.Agent.defaultMaxSockets,t.requests=[],t.sockets=[],t.on("free",(function(e,n,r,i){for(var o=l(n,r,i),s=0,a=t.requests.length;s<a;++s){var c=t.requests[s];if(c.host===o.host&&c.port===o.port)return t.requests.splice(s,1),void c.request.onSocket(e)}e.destroy(),t.removeSocket(e)}))}function a(e,n){var r=this;s.prototype.createSocket.call(r,e,(function(i){var o=e.request.getHeader("host"),s=c({},r.options,{socket:i,servername:o?o.replace(/:.*$/,""):e.host}),a=t.connect(0,s);r.sockets[r.sockets.indexOf(i)]=a,n(a)}))}function l(e,t,n){return"string"==typeof e?{host:e,port:t,localAddress:n}:e}function c(e){for(var t=1,n=arguments.length;t<n;++t){var r=arguments[t];if("object"==typeof r)for(var i=Object.keys(r),o=0,s=i.length;o<s;++o){var a=i[o];void 0!==r[a]&&(e[a]=r[a])}}return e}return Se.httpOverHttp=function(e){var t=new s(e);return t.request=n.request,t},Se.httpsOverHttp=function(e){var t=new s(e);return t.request=n.request,t.createSocket=a,t.defaultPort=443,t},Se.httpOverHttps=function(e){var t=new s(e);return t.request=r.request,t},Se.httpsOverHttps=function(e){var t=new s(e);return t.request=r.request,t.createSocket=a,t.defaultPort=443,t},o.inherits(s,i.EventEmitter),s.prototype.addRequest=function(e,t,n,r){var i=this,o=c({request:e},i.options,l(t,n,r));i.sockets.length>=this.maxSockets?i.requests.push(o):i.createSocket(o,(function(t){function n(){i.emit("free",t,o)}function r(e){i.removeSocket(t),t.removeListener("free",n),t.removeListener("close",r),t.removeListener("agentRemove",r)}t.on("free",n),t.on("close",r),t.on("agentRemove",r),e.onSocket(t)}))},s.prototype.createSocket=function(t,n){var r=this,i={};r.sockets.push(i);var o=c({},r.proxyOptions,{method:"CONNECT",path:t.host+":"+t.port,agent:!1,headers:{host:t.host+":"+t.port}});t.localAddress&&(o.localAddress=t.localAddress),o.proxyAuth&&(o.headers=o.headers||{},o.headers["Proxy-Authorization"]="Basic "+new Buffer(o.proxyAuth).toString("base64")),e("making CONNECT request");var s=r.request(o);function a(o,a,l){var c;return s.removeAllListeners(),a.removeAllListeners(),200!==o.statusCode?(e("tunneling socket could not be established, statusCode=%d",o.statusCode),a.destroy(),(c=new Error("tunneling socket could not be established, statusCode="+o.statusCode)).code="ECONNRESET",t.request.emit("error",c),void r.removeSocket(i)):l.length>0?(e("got illegal response body from proxy"),a.destroy(),(c=new Error("got illegal response body from proxy")).code="ECONNRESET",t.request.emit("error",c),void r.removeSocket(i)):(e("tunneling connection has established"),r.sockets[r.sockets.indexOf(i)]=a,n(a))}s.useChunkedEncodingByDefault=!1,s.once("response",(function(e){e.upgrade=!0})),s.once("upgrade",(function(e,t,n){process.nextTick((function(){a(e,t,n)}))})),s.once("connect",a),s.once("error",(function(n){s.removeAllListeners(),e("tunneling socket could not be established, cause=%s\n",n.message,n.stack);var o=new Error("tunneling socket could not be established, cause="+n.message);o.code="ECONNRESET",t.request.emit("error",o),r.removeSocket(i)})),s.end()},s.prototype.removeSocket=function(e){var t=this.sockets.indexOf(e);if(-1!==t){this.sockets.splice(t,1);var n=this.requests.shift();n&&this.createSocket(n,(function(e){n.request.onSocket(e)}))}},e=process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments);"string"==typeof e[0]?e[0]="TUNNEL: "+e[0]:e.unshift("TUNNEL:"),console.error.apply(console,e)}:function(){},Se.debug=e,Se}())}!function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=P.default,n=O.default,r=_e;let i;var o,s,a;!function(e){e[e.OK=200]="OK",e[e.MultipleChoices=300]="MultipleChoices",e[e.MovedPermanently=301]="MovedPermanently",e[e.ResourceMoved=302]="ResourceMoved",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.SwitchProxy=306]="SwitchProxy",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout"}(o=e.HttpCodes||(e.HttpCodes={})),function(e){e.Accept="accept",e.ContentType="content-type"}(s=e.Headers||(e.Headers={})),function(e){e.ApplicationJson="application/json"}(a=e.MediaTypes||(e.MediaTypes={})),e.getProxyUrl=function(e){let t=r.getProxyUrl(new URL(e));return t?t.href:""};const l=[o.MovedPermanently,o.ResourceMoved,o.SeeOther,o.TemporaryRedirect,o.PermanentRedirect],c=[o.BadGateway,o.ServiceUnavailable,o.GatewayTimeout],u=["OPTIONS","GET","DELETE","HEAD"];class d extends Error{constructor(e,t){super(e),this.name="HttpClientError",this.statusCode=t,Object.setPrototypeOf(this,d.prototype)}}e.HttpClientError=d;class h{constructor(e){this.message=e}readBody(){return new Promise((async(e,t)=>{let n=Buffer.alloc(0);this.message.on("data",(e=>{n=Buffer.concat([n,e])})),this.message.on("end",(()=>{e(n.toString())}))}))}}e.HttpClientResponse=h,e.isHttps=function(e){return"https:"===new URL(e).protocol};class p{constructor(e,t,n){this._ignoreSslError=!1,this._allowRedirects=!0,this._allowRedirectDowngrade=!1,this._maxRedirects=50,this._allowRetries=!1,this._maxRetries=1,this._keepAlive=!1,this._disposed=!1,this.userAgent=e,this.handlers=t||[],this.requestOptions=n,n&&(null!=n.ignoreSslError&&(this._ignoreSslError=n.ignoreSslError),this._socketTimeout=n.socketTimeout,null!=n.allowRedirects&&(this._allowRedirects=n.allowRedirects),null!=n.allowRedirectDowngrade&&(this._allowRedirectDowngrade=n.allowRedirectDowngrade),null!=n.maxRedirects&&(this._maxRedirects=Math.max(n.maxRedirects,0)),null!=n.keepAlive&&(this._keepAlive=n.keepAlive),null!=n.allowRetries&&(this._allowRetries=n.allowRetries),null!=n.maxRetries&&(this._maxRetries=n.maxRetries))}options(e,t){return this.request("OPTIONS",e,null,t||{})}get(e,t){return this.request("GET",e,null,t||{})}del(e,t){return this.request("DELETE",e,null,t||{})}post(e,t,n){return this.request("POST",e,t,n||{})}patch(e,t,n){return this.request("PATCH",e,t,n||{})}put(e,t,n){return this.request("PUT",e,t,n||{})}head(e,t){return this.request("HEAD",e,null,t||{})}sendStream(e,t,n,r){return this.request(e,t,n,r)}async getJson(e,t={}){t[s.Accept]=this._getExistingOrDefaultHeader(t,s.Accept,a.ApplicationJson);let n=await this.get(e,t);return this._processResponse(n,this.requestOptions)}async postJson(e,t,n={}){let r=JSON.stringify(t,null,2);n[s.Accept]=this._getExistingOrDefaultHeader(n,s.Accept,a.ApplicationJson),n[s.ContentType]=this._getExistingOrDefaultHeader(n,s.ContentType,a.ApplicationJson);let i=await this.post(e,r,n);return this._processResponse(i,this.requestOptions)}async putJson(e,t,n={}){let r=JSON.stringify(t,null,2);n[s.Accept]=this._getExistingOrDefaultHeader(n,s.Accept,a.ApplicationJson),n[s.ContentType]=this._getExistingOrDefaultHeader(n,s.ContentType,a.ApplicationJson);let i=await this.put(e,r,n);return this._processResponse(i,this.requestOptions)}async patchJson(e,t,n={}){let r=JSON.stringify(t,null,2);n[s.Accept]=this._getExistingOrDefaultHeader(n,s.Accept,a.ApplicationJson),n[s.ContentType]=this._getExistingOrDefaultHeader(n,s.ContentType,a.ApplicationJson);let i=await this.patch(e,r,n);return this._processResponse(i,this.requestOptions)}async request(e,t,n,r){if(this._disposed)throw new Error("Client has already been disposed.");let i,s=new URL(t),a=this._prepareRequest(e,s,r),d=this._allowRetries&&-1!=u.indexOf(e)?this._maxRetries+1:1,h=0;for(;h<d;){if(i=await this.requestRaw(a,n),i&&i.message&&i.message.statusCode===o.Unauthorized){let e;for(let t=0;t<this.handlers.length;t++)if(this.handlers[t].canHandleAuthentication(i)){e=this.handlers[t];break}return e?e.handleAuthentication(this,a,n):i}let t=this._maxRedirects;for(;-1!=l.indexOf(i.message.statusCode)&&this._allowRedirects&&t>0;){const o=i.message.headers.location;if(!o)break;let l=new URL(o);if("https:"==s.protocol&&s.protocol!=l.protocol&&!this._allowRedirectDowngrade)throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.");if(await i.readBody(),l.hostname!==s.hostname)for(let e in r)"authorization"===e.toLowerCase()&&delete r[e];a=this._prepareRequest(e,l,r),i=await this.requestRaw(a,n),t--}if(-1==c.indexOf(i.message.statusCode))return i;h+=1,h<d&&(await i.readBody(),await this._performExponentialBackoff(h))}return i}dispose(){this._agent&&this._agent.destroy(),this._disposed=!0}requestRaw(e,t){return new Promise(((n,r)=>{this.requestRawWithCallback(e,t,(function(e,t){e&&r(e),n(t)}))}))}requestRawWithCallback(e,t,n){let r;"string"==typeof t&&(e.options.headers["Content-Length"]=Buffer.byteLength(t,"utf8"));let i=!1,o=(e,t)=>{i||(i=!0,n(e,t))},s=e.httpModule.request(e.options,(e=>{let t=new h(e);o(null,t)}));s.on("socket",(e=>{r=e})),s.setTimeout(this._socketTimeout||18e4,(()=>{r&&r.end(),o(new Error("Request timeout: "+e.options.path),null)})),s.on("error",(function(e){o(e,null)})),t&&"string"==typeof t&&s.write(t,"utf8"),t&&"string"!=typeof t?(t.on("close",(function(){s.end()})),t.pipe(s)):s.end()}getAgent(e){let t=new URL(e);return this._getAgent(t)}_prepareRequest(e,r,i){const o={};o.parsedUrl=r;const s="https:"===o.parsedUrl.protocol;o.httpModule=s?n:t;const a=s?443:80;return o.options={},o.options.host=o.parsedUrl.hostname,o.options.port=o.parsedUrl.port?parseInt(o.parsedUrl.port):a,o.options.path=(o.parsedUrl.pathname||"")+(o.parsedUrl.search||""),o.options.method=e,o.options.headers=this._mergeHeaders(i),null!=this.userAgent&&(o.options.headers["user-agent"]=this.userAgent),o.options.agent=this._getAgent(o.parsedUrl),this.handlers&&this.handlers.forEach((e=>{e.prepareRequest(o.options)})),o}_mergeHeaders(e){const t=e=>Object.keys(e).reduce(((t,n)=>(t[n.toLowerCase()]=e[n],t)),{});return this.requestOptions&&this.requestOptions.headers?Object.assign({},t(this.requestOptions.headers),t(e)):t(e||{})}_getExistingOrDefaultHeader(e,t,n){let r;var i;return this.requestOptions&&this.requestOptions.headers&&(r=(i=this.requestOptions.headers,Object.keys(i).reduce(((e,t)=>(e[t.toLowerCase()]=i[t],e)),{}))[t]),e[t]||r||n}_getAgent(e){let o,s=r.getProxyUrl(e),a=s&&s.hostname;if(this._keepAlive&&a&&(o=this._proxyAgent),this._keepAlive&&!a&&(o=this._agent),o)return o;const l="https:"===e.protocol;let c=100;if(this.requestOptions&&(c=this.requestOptions.maxSockets||t.globalAgent.maxSockets),a){i||(i=xe());const e={maxSockets:c,keepAlive:this._keepAlive,proxy:{...(s.username||s.password)&&{proxyAuth:`${s.username}:${s.password}`},host:s.hostname,port:s.port}};let t;const n="https:"===s.protocol;t=l?n?i.httpsOverHttps:i.httpsOverHttp:n?i.httpOverHttps:i.httpOverHttp,o=t(e),this._proxyAgent=o}if(this._keepAlive&&!o){const e={keepAlive:this._keepAlive,maxSockets:c};o=l?new n.Agent(e):new t.Agent(e),this._agent=o}return o||(o=l?n.globalAgent:t.globalAgent),l&&this._ignoreSslError&&(o.options=Object.assign(o.options||{},{rejectUnauthorized:!1})),o}_performExponentialBackoff(e){e=Math.min(10,e);const t=5*Math.pow(2,e);return new Promise((e=>setTimeout((()=>e()),t)))}static dateTimeDeserializer(e,t){if("string"==typeof t){let e=new Date(t);if(!isNaN(e.valueOf()))return e}return t}async _processResponse(e,t){return new Promise((async(n,r)=>{const i=e.message.statusCode,s={statusCode:i,result:null,headers:{}};let a,l;i==o.NotFound&&n(s);try{l=await e.readBody(),l&&l.length>0&&(a=t&&t.deserializeDates?JSON.parse(l,p.dateTimeDeserializer):JSON.parse(l),s.result=a),s.headers=e.message.headers}catch(e){}if(i>299){let e;e=a&&a.message?a.message:l&&l.length>0?l:"Failed request: ("+i+")";let t=new d(e,i);t.result=s.result,r(t)}else n(s)}))}}e.HttpClient=p}(ge);var ke,Ee={};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.BasicCredentialHandler=class{constructor(e,t){this.username=e,this.password=t}prepareRequest(e){e.headers.Authorization="Basic "+Buffer.from(this.username+":"+this.password).toString("base64")}canHandleAuthentication(e){return!1}handleAuthentication(e,t,n){return null}};Ee.BearerCredentialHandler=class{constructor(e){this.token=e}prepareRequest(e){e.headers.Authorization="Bearer "+this.token}canHandleAuthentication(e){return!1}handleAuthentication(e,t,n){return null}};function Ce(){if(ke)return me;ke=1;var e=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(me,"__esModule",{value:!0}),me.OidcClient=void 0;const t=ge,n=Ee,r=Ie();class i{static createHttpClient(e=!0,r=10){const o={allowRetries:e,maxRetries:r};return new t.HttpClient("actions/oidc-client",[new n.BearerCredentialHandler(i.getRequestToken())],o)}static getRequestToken(){const e=process.env.ACTIONS_ID_TOKEN_REQUEST_TOKEN;if(!e)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable");return e}static getIDTokenUrl(){const e=process.env.ACTIONS_ID_TOKEN_REQUEST_URL;if(!e)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable");return e}static getCall(t){var n;return e(this,void 0,void 0,(function*(){const e=i.createHttpClient(),r=yield e.getJson(t).catch((e=>{throw new Error(`Failed to get ID Token. \n \n\t        Error Code : ${e.statusCode}\n \n\t        Error Message: ${e.result.message}`)})),o=null===(n=r.result)||void 0===n?void 0:n.value;if(!o)throw new Error("Response json body do not have ID Token field");return o}))}static getIDToken(t){return e(this,void 0,void 0,(function*(){try{let e=i.getIDTokenUrl();if(t){e=`${e}&audience=${encodeURIComponent(t)}`}r.debug(`ID token url is ${e}`);const n=yield i.getCall(e);return r.setSecret(n),n}catch(e){throw new Error(`Error message: ${e.message}`)}}))}}return me.OidcClient=i,me}Ee.PersonalAccessTokenCredentialHandler=class{constructor(e){this.token=e}prepareRequest(e){e.headers.Authorization="Basic "+Buffer.from("PAT:"+this.token).toString("base64")}canHandleAuthentication(e){return!1}handleAuthentication(e,t,n){return null}};var Te,Pe,Oe={};function Ae(){return Te||(Te=1,function(e){var t=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.summary=e.markdownSummary=e.SUMMARY_DOCS_URL=e.SUMMARY_ENV_VAR=void 0;const n=E.default,r=C.default,{access:i,appendFile:o,writeFile:s}=r.promises;e.SUMMARY_ENV_VAR="GITHUB_STEP_SUMMARY",e.SUMMARY_DOCS_URL="https://docs.github.com/actions/using-workflows/workflow-commands-for-github-actions#adding-a-job-summary";const a=new class{constructor(){this._buffer=""}filePath(){return t(this,void 0,void 0,(function*(){if(this._filePath)return this._filePath;const t=process.env[e.SUMMARY_ENV_VAR];if(!t)throw new Error(`Unable to find environment variable for $${e.SUMMARY_ENV_VAR}. Check if your runtime environment supports job summaries.`);try{yield i(t,r.constants.R_OK|r.constants.W_OK)}catch(e){throw new Error(`Unable to access summary file: '${t}'. Check if the file has correct read/write permissions.`)}return this._filePath=t,this._filePath}))}wrap(e,t,n={}){const r=Object.entries(n).map((([e,t])=>` ${e}="${t}"`)).join("");return t?`<${e}${r}>${t}</${e}>`:`<${e}${r}>`}write(e){return t(this,void 0,void 0,(function*(){const t=!!(null==e?void 0:e.overwrite),n=yield this.filePath(),r=t?s:o;return yield r(n,this._buffer,{encoding:"utf8"}),this.emptyBuffer()}))}clear(){return t(this,void 0,void 0,(function*(){return this.emptyBuffer().write({overwrite:!0})}))}stringify(){return this._buffer}isEmptyBuffer(){return 0===this._buffer.length}emptyBuffer(){return this._buffer="",this}addRaw(e,t=!1){return this._buffer+=e,t?this.addEOL():this}addEOL(){return this.addRaw(n.EOL)}addCodeBlock(e,t){const n=Object.assign({},t&&{lang:t}),r=this.wrap("pre",this.wrap("code",e),n);return this.addRaw(r).addEOL()}addList(e,t=!1){const n=t?"ol":"ul",r=e.map((e=>this.wrap("li",e))).join(""),i=this.wrap(n,r);return this.addRaw(i).addEOL()}addTable(e){const t=e.map((e=>{const t=e.map((e=>{if("string"==typeof e)return this.wrap("td",e);const{header:t,data:n,colspan:r,rowspan:i}=e,o=t?"th":"td",s=Object.assign(Object.assign({},r&&{colspan:r}),i&&{rowspan:i});return this.wrap(o,n,s)})).join("");return this.wrap("tr",t)})).join(""),n=this.wrap("table",t);return this.addRaw(n).addEOL()}addDetails(e,t){const n=this.wrap("details",this.wrap("summary",e)+t);return this.addRaw(n).addEOL()}addImage(e,t,n){const{width:r,height:i}=n||{},o=Object.assign(Object.assign({},r&&{width:r}),i&&{height:i}),s=this.wrap("img",null,Object.assign({src:e,alt:t},o));return this.addRaw(s).addEOL()}addHeading(e,t){const n=`h${t}`,r=["h1","h2","h3","h4","h5","h6"].includes(n)?n:"h1",i=this.wrap(r,e);return this.addRaw(i).addEOL()}addSeparator(){const e=this.wrap("hr",null);return this.addRaw(e).addEOL()}addBreak(){const e=this.wrap("br",null);return this.addRaw(e).addEOL()}addQuote(e,t){const n=Object.assign({},t&&{cite:t}),r=this.wrap("blockquote",e,n);return this.addRaw(r).addEOL()}addLink(e,t){const n=this.wrap("a",e,{href:t});return this.addRaw(n).addEOL()}};e.markdownSummary=a,e.summary=a}(Oe)),Oe}function Ie(){return Pe||(Pe=1,function(e){var t=Y&&Y.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=Y&&Y.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=Y&&Y.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var i in e)"default"!==i&&Object.hasOwnProperty.call(e,i)&&t(r,e,i);return n(r,e),r},i=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.getIDToken=e.getState=e.saveState=e.group=e.endGroup=e.startGroup=e.info=e.notice=e.warning=e.error=e.debug=e.isDebug=e.setFailed=e.setCommandEcho=e.setOutput=e.getBooleanInput=e.getMultilineInput=e.getInput=e.addPath=e.setSecret=e.exportVariable=e.ExitCode=void 0;const o=Z,s=le,a=ee,l=r(E.default),c=r(T.default),u=Ce();var d;function h(e,t){const n=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!n)throw new Error(`Input required and not supplied: ${e}`);return t&&!1===t.trimWhitespace?n:n.trim()}function p(e,t={}){o.issueCommand("error",a.toCommandProperties(t),e instanceof Error?e.toString():e)}function f(e){o.issue("group",e)}function m(){o.issue("endgroup")}!function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure"}(d=e.ExitCode||(e.ExitCode={})),e.exportVariable=function(e,t){const n=a.toCommandValue(t);if(process.env[e]=n,process.env.GITHUB_ENV||""){const t="_GitHubActionsFileCommandDelimeter_",r=`${e}<<${t}${l.EOL}${n}${l.EOL}${t}`;s.issueCommand("ENV",r)}else o.issueCommand("set-env",{name:e},n)},e.setSecret=function(e){o.issueCommand("add-mask",{},e)},e.addPath=function(e){process.env.GITHUB_PATH||""?s.issueCommand("PATH",e):o.issueCommand("add-path",{},e),process.env.PATH=`${e}${c.delimiter}${process.env.PATH}`},e.getInput=h,e.getMultilineInput=function(e,t){return h(e,t).split("\n").filter((e=>""!==e))},e.getBooleanInput=function(e,t){const n=h(e,t);if(["true","True","TRUE"].includes(n))return!0;if(["false","False","FALSE"].includes(n))return!1;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${e}\nSupport boolean input list: \`true | True | TRUE | false | False | FALSE\``)},e.setOutput=function(e,t){process.stdout.write(l.EOL),o.issueCommand("set-output",{name:e},t)},e.setCommandEcho=function(e){o.issue("echo",e?"on":"off")},e.setFailed=function(e){process.exitCode=d.Failure,p(e)},e.isDebug=function(){return"1"===process.env.RUNNER_DEBUG},e.debug=function(e){o.issueCommand("debug",{},e)},e.error=p,e.warning=function(e,t={}){o.issueCommand("warning",a.toCommandProperties(t),e instanceof Error?e.toString():e)},e.notice=function(e,t={}){o.issueCommand("notice",a.toCommandProperties(t),e instanceof Error?e.toString():e)},e.info=function(e){process.stdout.write(e+l.EOL)},e.startGroup=f,e.endGroup=m,e.group=function(e,t){return i(this,void 0,void 0,(function*(){let n;f(e);try{n=yield t()}finally{m()}return n}))},e.saveState=function(e,t){o.issueCommand("save-state",{name:e},t)},e.getState=function(e){return process.env[`STATE_${e}`]||""},e.getIDToken=function(e){return i(this,void 0,void 0,(function*(){return yield u.OidcClient.getIDToken(e)}))};var g=Ae();Object.defineProperty(e,"summary",{enumerable:!0,get:function(){return g.summary}});var _=Ae();Object.defineProperty(e,"markdownSummary",{enumerable:!0,get:function(){return _.markdownSummary}})}(Q)),Q}var Me=Ie(),Fe={},Ne={},Re={},je={};!function(e){var t,n=Y&&Y.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),r=Y&&Y.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=Y&&Y.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t},o=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.getCmdPath=e.tryGetExecutablePath=e.isRooted=e.isDirectory=e.exists=e.IS_WINDOWS=e.unlink=e.symlink=e.stat=e.rmdir=e.rename=e.readlink=e.readdir=e.mkdir=e.lstat=e.copyFile=e.chmod=void 0;const s=i(C.default),a=i(T.default);function l(e){return(1&e.mode)>0||(8&e.mode)>0&&e.gid===process.getgid()||(64&e.mode)>0&&e.uid===process.getuid()}t=s.promises,e.chmod=t.chmod,e.copyFile=t.copyFile,e.lstat=t.lstat,e.mkdir=t.mkdir,e.readdir=t.readdir,e.readlink=t.readlink,e.rename=t.rename,e.rmdir=t.rmdir,e.stat=t.stat,e.symlink=t.symlink,e.unlink=t.unlink,e.IS_WINDOWS="win32"===process.platform,e.exists=function(t){return o(this,void 0,void 0,(function*(){try{yield e.stat(t)}catch(e){if("ENOENT"===e.code)return!1;throw e}return!0}))},e.isDirectory=function(t,n=!1){return o(this,void 0,void 0,(function*(){return(n?yield e.stat(t):yield e.lstat(t)).isDirectory()}))},e.isRooted=function(t){if(!(t=function(t){if(t=t||"",e.IS_WINDOWS)return(t=t.replace(/\//g,"\\")).replace(/\\\\+/g,"\\");return t.replace(/\/\/+/g,"/")}(t)))throw new Error('isRooted() parameter "p" cannot be empty');return e.IS_WINDOWS?t.startsWith("\\")||/^[A-Z]:/i.test(t):t.startsWith("/")},e.tryGetExecutablePath=function(t,n){return o(this,void 0,void 0,(function*(){let r;try{r=yield e.stat(t)}catch(e){"ENOENT"!==e.code&&console.log(`Unexpected error attempting to determine if executable file exists '${t}': ${e}`)}if(r&&r.isFile())if(e.IS_WINDOWS){const e=a.extname(t).toUpperCase();if(n.some((t=>t.toUpperCase()===e)))return t}else if(l(r))return t;const i=t;for(const o of n){t=i+o,r=void 0;try{r=yield e.stat(t)}catch(e){"ENOENT"!==e.code&&console.log(`Unexpected error attempting to determine if executable file exists '${t}': ${e}`)}if(r&&r.isFile()){if(e.IS_WINDOWS){try{const n=a.dirname(t),r=a.basename(t).toUpperCase();for(const i of yield e.readdir(n))if(r===i.toUpperCase()){t=a.join(n,i);break}}catch(e){console.log(`Unexpected error attempting to determine the actual case of the file '${t}': ${e}`)}return t}if(l(r))return t}}return""}))},e.getCmdPath=function(){var e;return null!==(e=process.env.COMSPEC)&&void 0!==e?e:"cmd.exe"}}(je);var De=Y&&Y.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),Le=Y&&Y.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Be=Y&&Y.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&De(t,e,n);return Le(t,e),t},He=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(Re,"__esModule",{value:!0}),Re.findInPath=Re.which=Re.mkdirP=Re.rmRF=Re.mv=Re.cp=void 0;const qe=F.default,Ue=Be(j.default),We=Be(T.default),$e=N.default,ze=Be(je),Ve=$e.promisify(Ue.exec),Ge=$e.promisify(Ue.execFile);function Ke(e){return He(this,void 0,void 0,(function*(){if(ze.IS_WINDOWS){if(/[*"<>|]/.test(e))throw new Error('File path must not contain `*`, `"`, `<`, `>` or `|` on Windows');try{const t=ze.getCmdPath();(yield ze.isDirectory(e,!0))?yield Ve(`${t} /s /c "rd /s /q "%inputPath%""`,{env:{inputPath:e}}):yield Ve(`${t} /s /c "del /f /a "%inputPath%""`,{env:{inputPath:e}})}catch(e){if("ENOENT"!==e.code)throw e}try{yield ze.unlink(e)}catch(e){if("ENOENT"!==e.code)throw e}}else{let t=!1;try{t=yield ze.isDirectory(e)}catch(e){if("ENOENT"!==e.code)throw e;return}t?yield Ge("rm",["-rf",`${e}`]):yield ze.unlink(e)}}))}function Je(e){return He(this,void 0,void 0,(function*(){qe.ok(e,"a path argument must be provided"),yield ze.mkdir(e,{recursive:!0})}))}function Ye(e){return He(this,void 0,void 0,(function*(){if(!e)throw new Error("parameter 'tool' is required");const t=[];if(ze.IS_WINDOWS&&process.env.PATHEXT)for(const e of process.env.PATHEXT.split(We.delimiter))e&&t.push(e);if(ze.isRooted(e)){const n=yield ze.tryGetExecutablePath(e,t);return n?[n]:[]}if(e.includes(We.sep))return[];const n=[];if(process.env.PATH)for(const e of process.env.PATH.split(We.delimiter))e&&n.push(e);const r=[];for(const i of n){const n=yield ze.tryGetExecutablePath(We.join(i,e),t);n&&r.push(n)}return r}))}function Xe(e,t,n,r){return He(this,void 0,void 0,(function*(){if(n>=255)return;n++,yield Je(t);const i=yield ze.readdir(e);for(const o of i){const i=`${e}/${o}`,s=`${t}/${o}`;(yield ze.lstat(i)).isDirectory()?yield Xe(i,s,n,r):yield Qe(i,s,r)}yield ze.chmod(t,(yield ze.stat(e)).mode)}))}function Qe(e,t,n){return He(this,void 0,void 0,(function*(){if((yield ze.lstat(e)).isSymbolicLink()){try{yield ze.lstat(t),yield ze.unlink(t)}catch(e){"EPERM"===e.code&&(yield ze.chmod(t,"0666"),yield ze.unlink(t))}const n=yield ze.readlink(e);yield ze.symlink(n,t,ze.IS_WINDOWS?"junction":null)}else(yield ze.exists(t))&&!n||(yield ze.copyFile(e,t))}))}Re.cp=function(e,t,n={}){return He(this,void 0,void 0,(function*(){const{force:r,recursive:i,copySourceDirectory:o}=function(e){const t=null==e.force||e.force,n=Boolean(e.recursive),r=null==e.copySourceDirectory||Boolean(e.copySourceDirectory);return{force:t,recursive:n,copySourceDirectory:r}}(n),s=(yield ze.exists(t))?yield ze.stat(t):null;if(s&&s.isFile()&&!r)return;const a=s&&s.isDirectory()&&o?We.join(t,We.basename(e)):t;if(!(yield ze.exists(e)))throw new Error(`no such file or directory: ${e}`);if((yield ze.stat(e)).isDirectory()){if(!i)throw new Error(`Failed to copy. ${e} is a directory, but tried to copy without recursive flag.`);yield Xe(e,a,0,r)}else{if(""===We.relative(e,a))throw new Error(`'${a}' and '${e}' are the same file`);yield Qe(e,a,r)}}))},Re.mv=function(e,t,n={}){return He(this,void 0,void 0,(function*(){if(yield ze.exists(t)){let r=!0;if((yield ze.isDirectory(t))&&(t=We.join(t,We.basename(e)),r=yield ze.exists(t)),r){if(null!=n.force&&!n.force)throw new Error("Destination already exists");yield Ke(t)}}yield Je(We.dirname(t)),yield ze.rename(e,t)}))},Re.rmRF=Ke,Re.mkdirP=Je,Re.which=function e(t,n){return He(this,void 0,void 0,(function*(){if(!t)throw new Error("parameter 'tool' is required");if(n){const n=yield e(t,!1);if(!n)throw ze.IS_WINDOWS?new Error(`Unable to locate executable file: ${t}. Please verify either the file path exists or the file can be found within a directory specified by the PATH environment variable. Also verify the file has a valid extension for an executable file.`):new Error(`Unable to locate executable file: ${t}. Please verify either the file path exists or the file can be found within a directory specified by the PATH environment variable. Also check the file mode to verify the file is executable.`);return n}const r=yield Ye(t);return r&&r.length>0?r[0]:""}))},Re.findInPath=Ye;var Ze=Y&&Y.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),et=Y&&Y.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),tt=Y&&Y.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&Ze(t,e,n);return et(t,e),t},nt=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.argStringToArray=Ne.ToolRunner=void 0;const rt=tt(E.default),it=tt(M.default),ot=tt(j.default),st=tt(T.default),at=tt(Re),lt=tt(je),ct=D.default,ut="win32"===process.platform;class dt extends it.EventEmitter{constructor(e,t,n){if(super(),!e)throw new Error("Parameter 'toolPath' cannot be null or empty.");this.toolPath=e,this.args=t||[],this.options=n||{}}_debug(e){this.options.listeners&&this.options.listeners.debug&&this.options.listeners.debug(e)}_getCommandString(e,t){const n=this._getSpawnFileName(),r=this._getSpawnArgs(e);let i=t?"":"[command]";if(ut)if(this._isCmdFile()){i+=n;for(const e of r)i+=` ${e}`}else if(e.windowsVerbatimArguments){i+=`"${n}"`;for(const e of r)i+=` ${e}`}else{i+=this._windowsQuoteCmdArg(n);for(const e of r)i+=` ${this._windowsQuoteCmdArg(e)}`}else{i+=n;for(const e of r)i+=` ${e}`}return i}_processLineBuffer(e,t,n){try{let r=t+e.toString(),i=r.indexOf(rt.EOL);for(;i>-1;){n(r.substring(0,i)),r=r.substring(i+rt.EOL.length),i=r.indexOf(rt.EOL)}return r}catch(e){return this._debug(`error processing line. Failed with error ${e}`),""}}_getSpawnFileName(){return ut&&this._isCmdFile()?process.env.COMSPEC||"cmd.exe":this.toolPath}_getSpawnArgs(e){if(ut&&this._isCmdFile()){let t=`/D /S /C "${this._windowsQuoteCmdArg(this.toolPath)}`;for(const n of this.args)t+=" ",t+=e.windowsVerbatimArguments?n:this._windowsQuoteCmdArg(n);return t+='"',[t]}return this.args}_endsWith(e,t){return e.endsWith(t)}_isCmdFile(){const e=this.toolPath.toUpperCase();return this._endsWith(e,".CMD")||this._endsWith(e,".BAT")}_windowsQuoteCmdArg(e){if(!this._isCmdFile())return this._uvQuoteCmdArg(e);if(!e)return'""';const t=[" ","\t","&","(",")","[","]","{","}","^","=",";","!","'","+",",","`","~","|","<",">",'"'];let n=!1;for(const r of e)if(t.some((e=>e===r))){n=!0;break}if(!n)return e;let r='"',i=!0;for(let t=e.length;t>0;t--)r+=e[t-1],i&&"\\"===e[t-1]?r+="\\":'"'===e[t-1]?(i=!0,r+='"'):i=!1;return r+='"',r.split("").reverse().join("")}_uvQuoteCmdArg(e){if(!e)return'""';if(!e.includes(" ")&&!e.includes("\t")&&!e.includes('"'))return e;if(!e.includes('"')&&!e.includes("\\"))return`"${e}"`;let t='"',n=!0;for(let r=e.length;r>0;r--)t+=e[r-1],n&&"\\"===e[r-1]?t+="\\":'"'===e[r-1]?(n=!0,t+="\\"):n=!1;return t+='"',t.split("").reverse().join("")}_cloneExecOptions(e){const t={cwd:(e=e||{}).cwd||process.cwd(),env:e.env||process.env,silent:e.silent||!1,windowsVerbatimArguments:e.windowsVerbatimArguments||!1,failOnStdErr:e.failOnStdErr||!1,ignoreReturnCode:e.ignoreReturnCode||!1,delay:e.delay||1e4};return t.outStream=e.outStream||process.stdout,t.errStream=e.errStream||process.stderr,t}_getSpawnOptions(e,t){e=e||{};const n={};return n.cwd=e.cwd,n.env=e.env,n.windowsVerbatimArguments=e.windowsVerbatimArguments||this._isCmdFile(),e.windowsVerbatimArguments&&(n.argv0=`"${t}"`),n}exec(){return nt(this,void 0,void 0,(function*(){return!lt.isRooted(this.toolPath)&&(this.toolPath.includes("/")||ut&&this.toolPath.includes("\\"))&&(this.toolPath=st.resolve(process.cwd(),this.options.cwd||process.cwd(),this.toolPath)),this.toolPath=yield at.which(this.toolPath,!0),new Promise(((e,t)=>nt(this,void 0,void 0,(function*(){this._debug(`exec tool: ${this.toolPath}`),this._debug("arguments:");for(const e of this.args)this._debug(`   ${e}`);const n=this._cloneExecOptions(this.options);!n.silent&&n.outStream&&n.outStream.write(this._getCommandString(n)+rt.EOL);const r=new ht(n,this.toolPath);if(r.on("debug",(e=>{this._debug(e)})),this.options.cwd&&!(yield lt.exists(this.options.cwd)))return t(new Error(`The cwd: ${this.options.cwd} does not exist!`));const i=this._getSpawnFileName(),o=ot.spawn(i,this._getSpawnArgs(n),this._getSpawnOptions(this.options,i));let s="";o.stdout&&o.stdout.on("data",(e=>{this.options.listeners&&this.options.listeners.stdout&&this.options.listeners.stdout(e),!n.silent&&n.outStream&&n.outStream.write(e),s=this._processLineBuffer(e,s,(e=>{this.options.listeners&&this.options.listeners.stdline&&this.options.listeners.stdline(e)}))}));let a="";if(o.stderr&&o.stderr.on("data",(e=>{if(r.processStderr=!0,this.options.listeners&&this.options.listeners.stderr&&this.options.listeners.stderr(e),!n.silent&&n.errStream&&n.outStream){(n.failOnStdErr?n.errStream:n.outStream).write(e)}a=this._processLineBuffer(e,a,(e=>{this.options.listeners&&this.options.listeners.errline&&this.options.listeners.errline(e)}))})),o.on("error",(e=>{r.processError=e.message,r.processExited=!0,r.processClosed=!0,r.CheckComplete()})),o.on("exit",(e=>{r.processExitCode=e,r.processExited=!0,this._debug(`Exit code ${e} received from tool '${this.toolPath}'`),r.CheckComplete()})),o.on("close",(e=>{r.processExitCode=e,r.processExited=!0,r.processClosed=!0,this._debug(`STDIO streams have closed for tool '${this.toolPath}'`),r.CheckComplete()})),r.on("done",((n,r)=>{s.length>0&&this.emit("stdline",s),a.length>0&&this.emit("errline",a),o.removeAllListeners(),n?t(n):e(r)})),this.options.input){if(!o.stdin)throw new Error("child process missing stdin");o.stdin.end(this.options.input)}}))))}))}}Ne.ToolRunner=dt,Ne.argStringToArray=function(e){const t=[];let n=!1,r=!1,i="";function o(e){r&&'"'!==e&&(i+="\\"),i+=e,r=!1}for(let s=0;s<e.length;s++){const a=e.charAt(s);'"'!==a?"\\"===a&&r?o(a):"\\"===a&&n?r=!0:" "!==a||n?o(a):i.length>0&&(t.push(i),i=""):r?o(a):n=!n}return i.length>0&&t.push(i.trim()),t};class ht extends it.EventEmitter{constructor(e,t){if(super(),this.processClosed=!1,this.processError="",this.processExitCode=0,this.processExited=!1,this.processStderr=!1,this.delay=1e4,this.done=!1,this.timeout=null,!t)throw new Error("toolPath must not be empty");this.options=e,this.toolPath=t,e.delay&&(this.delay=e.delay)}CheckComplete(){this.done||(this.processClosed?this._setResult():this.processExited&&(this.timeout=ct.setTimeout(ht.HandleTimeout,this.delay,this)))}_debug(e){this.emit("debug",e)}_setResult(){let e;this.processExited&&(this.processError?e=new Error(`There was an error when attempting to execute the process '${this.toolPath}'. This may indicate the process failed to start. Error: ${this.processError}`):0===this.processExitCode||this.options.ignoreReturnCode?this.processStderr&&this.options.failOnStdErr&&(e=new Error(`The process '${this.toolPath}' failed because one or more lines were written to the STDERR stream`)):e=new Error(`The process '${this.toolPath}' failed with exit code ${this.processExitCode}`)),this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.done=!0,this.emit("done",e,this.processExitCode)}static HandleTimeout(e){if(!e.done){if(!e.processClosed&&e.processExited){const t=`The STDIO streams did not close within ${e.delay/1e3} seconds of the exit event from process '${e.toolPath}'. This may indicate a child process inherited the STDIO streams and has not yet exited.`;e._debug(t)}e._setResult()}}}var pt=Y&&Y.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),ft=Y&&Y.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),mt=Y&&Y.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&pt(t,e,n);return ft(t,e),t},gt=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.getExecOutput=bt=Fe.exec=void 0;const _t=R.default,wt=mt(Ne);function vt(e,t,n){return gt(this,void 0,void 0,(function*(){const r=wt.argStringToArray(e);if(0===r.length)throw new Error("Parameter 'commandLine' cannot be null or empty.");const i=r[0];t=r.slice(1).concat(t||[]);return new wt.ToolRunner(i,t,n).exec()}))}var bt=Fe.exec=vt;Fe.getExecOutput=function(e,t,n){var r,i;return gt(this,void 0,void 0,(function*(){let o="",s="";const a=new _t.StringDecoder("utf8"),l=new _t.StringDecoder("utf8"),c=null===(r=null==n?void 0:n.listeners)||void 0===r?void 0:r.stdout,u=null===(i=null==n?void 0:n.listeners)||void 0===i?void 0:i.stderr,d=Object.assign(Object.assign({},null==n?void 0:n.listeners),{stdout:e=>{o+=a.write(e),c&&c(e)},stderr:e=>{s+=l.write(e),u&&u(e)}}),h=yield vt(e,t,Object.assign(Object.assign({},n),{listeners:d}));return o+=a.end(),s+=l.end(),{exitCode:h,stdout:o,stderr:s}}))};var yt={exports:{}},St={},xt={};function kt(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Et={},Ct={exports:{}},Tt={},Pt=L.default,Ot=process.cwd,At=null,It=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return At||(At=Ot.call(process)),At};try{process.cwd()}catch(e){}if("function"==typeof process.chdir){var Mt=process.chdir;process.chdir=function(e){At=null,Mt.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Mt)}var Ft=function(e){Pt.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&function(e){e.lchmod=function(t,n,r){e.open(t,Pt.O_WRONLY|Pt.O_SYMLINK,n,(function(t,i){t?r&&r(t):e.fchmod(i,n,(function(t){e.close(i,(function(e){r&&r(t||e)}))}))}))},e.lchmodSync=function(t,n){var r,i=e.openSync(t,Pt.O_WRONLY|Pt.O_SYMLINK,n),o=!0;try{r=e.fchmodSync(i,n),o=!1}finally{if(o)try{e.closeSync(i)}catch(e){}else e.closeSync(i)}return r}}(e);e.lutimes||function(e){Pt.hasOwnProperty("O_SYMLINK")&&e.futimes?(e.lutimes=function(t,n,r,i){e.open(t,Pt.O_SYMLINK,(function(t,o){t?i&&i(t):e.futimes(o,n,r,(function(t){e.close(o,(function(e){i&&i(t||e)}))}))}))},e.lutimesSync=function(t,n,r){var i,o=e.openSync(t,Pt.O_SYMLINK),s=!0;try{i=e.futimesSync(o,n,r),s=!1}finally{if(s)try{e.closeSync(o)}catch(e){}else e.closeSync(o)}return i}):e.futimes&&(e.lutimes=function(e,t,n,r){r&&process.nextTick(r)},e.lutimesSync=function(){})}(e);e.chown=r(e.chown),e.fchown=r(e.fchown),e.lchown=r(e.lchown),e.chmod=t(e.chmod),e.fchmod=t(e.fchmod),e.lchmod=t(e.lchmod),e.chownSync=i(e.chownSync),e.fchownSync=i(e.fchownSync),e.lchownSync=i(e.lchownSync),e.chmodSync=n(e.chmodSync),e.fchmodSync=n(e.fchmodSync),e.lchmodSync=n(e.lchmodSync),e.stat=o(e.stat),e.fstat=o(e.fstat),e.lstat=o(e.lstat),e.statSync=s(e.statSync),e.fstatSync=s(e.fstatSync),e.lstatSync=s(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(e,t,n){n&&process.nextTick(n)},e.lchmodSync=function(){});e.chown&&!e.lchown&&(e.lchown=function(e,t,n,r){r&&process.nextTick(r)},e.lchownSync=function(){});"win32"===It&&(e.rename="function"!=typeof e.rename?e.rename:function(t){function n(n,r,i){var o=Date.now(),s=0;t(n,r,(function a(l){if(l&&("EACCES"===l.code||"EPERM"===l.code)&&Date.now()-o<6e4)return setTimeout((function(){e.stat(r,(function(e,o){e&&"ENOENT"===e.code?t(n,r,a):i(l)}))}),s),void(s<100&&(s+=10));i&&i(l)}))}return Object.setPrototypeOf&&Object.setPrototypeOf(n,t),n}(e.rename));function t(t){return t?function(n,r,i){return t.call(e,n,r,(function(e){a(e)&&(e=null),i&&i.apply(this,arguments)}))}:t}function n(t){return t?function(n,r){try{return t.call(e,n,r)}catch(e){if(!a(e))throw e}}:t}function r(t){return t?function(n,r,i,o){return t.call(e,n,r,i,(function(e){a(e)&&(e=null),o&&o.apply(this,arguments)}))}:t}function i(t){return t?function(n,r,i){try{return t.call(e,n,r,i)}catch(e){if(!a(e))throw e}}:t}function o(t){return t?function(n,r,i){function o(e,t){t&&(t.uid<0&&(t.uid+=4294967296),t.gid<0&&(t.gid+=4294967296)),i&&i.apply(this,arguments)}return"function"==typeof r&&(i=r,r=null),r?t.call(e,n,r,o):t.call(e,n,o)}:t}function s(t){return t?function(n,r){var i=r?t.call(e,n,r):t.call(e,n);return i&&(i.uid<0&&(i.uid+=4294967296),i.gid<0&&(i.gid+=4294967296)),i}:t}function a(e){return!e||("ENOSYS"===e.code||!(process.getuid&&0===process.getuid()||"EINVAL"!==e.code&&"EPERM"!==e.code))}e.read="function"!=typeof e.read?e.read:function(t){function n(n,r,i,o,s,a){var l;if(a&&"function"==typeof a){var c=0;l=function(u,d,h){if(u&&"EAGAIN"===u.code&&c<10)return c++,t.call(e,n,r,i,o,s,l);a.apply(this,arguments)}}return t.call(e,n,r,i,o,s,l)}return Object.setPrototypeOf&&Object.setPrototypeOf(n,t),n}(e.read),e.readSync="function"!=typeof e.readSync?e.readSync:(l=e.readSync,function(t,n,r,i,o){for(var s=0;;)try{return l.call(e,t,n,r,i,o)}catch(e){if("EAGAIN"===e.code&&s<10){s++;continue}throw e}});var l};var Nt=B.default.Stream,Rt=function(e){return{ReadStream:function t(n,r){if(!(this instanceof t))return new t(n,r);Nt.call(this);var i=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536,r=r||{};for(var o=Object.keys(r),s=0,a=o.length;s<a;s++){var l=o[s];this[l]=r[l]}this.encoding&&this.setEncoding(this.encoding);if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(null!==this.fd)return void process.nextTick((function(){i._read()}));e.open(this.path,this.flags,this.mode,(function(e,t){if(e)return i.emit("error",e),void(i.readable=!1);i.fd=t,i.emit("open",t),i._read()}))},WriteStream:function t(n,r){if(!(this instanceof t))return new t(n,r);Nt.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,r=r||{};for(var i=Object.keys(r),o=0,s=i.length;o<s;o++){var a=i[o];this[a]=r[a]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],null===this.fd&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}};var jt=function(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Object)var t={__proto__:Dt(e)};else t=Object.create(null);return Object.getOwnPropertyNames(e).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})),t},Dt=Object.getPrototypeOf||function(e){return e.__proto__};var Lt,Bt,Ht=C.default,qt=Ft,Ut=Rt,Wt=jt,$t=N.default;function zt(e,t){Object.defineProperty(e,Lt,{get:function(){return t}})}"function"==typeof Symbol&&"function"==typeof Symbol.for?(Lt=Symbol.for("graceful-fs.queue"),Bt=Symbol.for("graceful-fs.previous")):(Lt="___graceful-fs.queue",Bt="___graceful-fs.previous");var Vt=function(){};if($t.debuglog?Vt=$t.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(Vt=function(){var e=$t.format.apply($t,arguments);e="GFS4: "+e.split(/\n/).join("\nGFS4: "),console.error(e)}),!Ht[Lt]){var Gt=Y[Lt]||[];zt(Ht,Gt),Ht.close=function(e){function t(t,n){return e.call(Ht,t,(function(e){e||Qt(),"function"==typeof n&&n.apply(this,arguments)}))}return Object.defineProperty(t,Bt,{value:e}),t}(Ht.close),Ht.closeSync=function(e){function t(t){e.apply(Ht,arguments),Qt()}return Object.defineProperty(t,Bt,{value:e}),t}(Ht.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",(function(){Vt(Ht[Lt]),F.default.equal(Ht[Lt].length,0)}))}Y[Lt]||zt(Y,Ht[Lt]);var Kt,Jt=Yt(Wt(Ht));function Yt(e){qt(e),e.gracefulify=Yt,e.createReadStream=function(t,n){return new e.ReadStream(t,n)},e.createWriteStream=function(t,n){return new e.WriteStream(t,n)};var t=e.readFile;e.readFile=function(e,n,r){"function"==typeof n&&(r=n,n=null);return function e(n,r,i,o){return t(n,r,(function(t){!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?"function"==typeof i&&i.apply(this,arguments):Xt([e,[n,r,i],t,o||Date.now(),Date.now()])}))}(e,n,r)};var n=e.writeFile;e.writeFile=function(e,t,r,i){"function"==typeof r&&(i=r,r=null);return function e(t,r,i,o,s){return n(t,r,i,(function(n){!n||"EMFILE"!==n.code&&"ENFILE"!==n.code?"function"==typeof o&&o.apply(this,arguments):Xt([e,[t,r,i,o],n,s||Date.now(),Date.now()])}))}(e,t,r,i)};var r=e.appendFile;r&&(e.appendFile=function(e,t,n,i){"function"==typeof n&&(i=n,n=null);return function e(t,n,i,o,s){return r(t,n,i,(function(r){!r||"EMFILE"!==r.code&&"ENFILE"!==r.code?"function"==typeof o&&o.apply(this,arguments):Xt([e,[t,n,i,o],r,s||Date.now(),Date.now()])}))}(e,t,n,i)});var i=e.copyFile;i&&(e.copyFile=function(e,t,n,r){"function"==typeof n&&(r=n,n=0);return function e(t,n,r,o,s){return i(t,n,r,(function(i){!i||"EMFILE"!==i.code&&"ENFILE"!==i.code?"function"==typeof o&&o.apply(this,arguments):Xt([e,[t,n,r,o],i,s||Date.now(),Date.now()])}))}(e,t,n,r)});var o=e.readdir;e.readdir=function(e,t,n){"function"==typeof t&&(n=t,t=null);var r=s.test(process.version)?function(e,t,n,r){return o(e,i(e,t,n,r))}:function(e,t,n,r){return o(e,t,i(e,t,n,r))};return r(e,t,n);function i(e,t,n,i){return function(o,s){!o||"EMFILE"!==o.code&&"ENFILE"!==o.code?(s&&s.sort&&s.sort(),"function"==typeof n&&n.call(this,o,s)):Xt([r,[e,t,n],o,i||Date.now(),Date.now()])}}};var s=/^v[0-5]\./;if("v0.8"===process.version.substr(0,4)){var a=Ut(e);h=a.ReadStream,p=a.WriteStream}var l=e.ReadStream;l&&(h.prototype=Object.create(l.prototype),h.prototype.open=function(){var e=this;m(e.path,e.flags,e.mode,(function(t,n){t?(e.autoClose&&e.destroy(),e.emit("error",t)):(e.fd=n,e.emit("open",n),e.read())}))});var c=e.WriteStream;c&&(p.prototype=Object.create(c.prototype),p.prototype.open=function(){var e=this;m(e.path,e.flags,e.mode,(function(t,n){t?(e.destroy(),e.emit("error",t)):(e.fd=n,e.emit("open",n))}))}),Object.defineProperty(e,"ReadStream",{get:function(){return h},set:function(e){h=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return p},set:function(e){p=e},enumerable:!0,configurable:!0});var u=h;Object.defineProperty(e,"FileReadStream",{get:function(){return u},set:function(e){u=e},enumerable:!0,configurable:!0});var d=p;function h(e,t){return this instanceof h?(l.apply(this,arguments),this):h.apply(Object.create(h.prototype),arguments)}function p(e,t){return this instanceof p?(c.apply(this,arguments),this):p.apply(Object.create(p.prototype),arguments)}Object.defineProperty(e,"FileWriteStream",{get:function(){return d},set:function(e){d=e},enumerable:!0,configurable:!0});var f=e.open;function m(e,t,n,r){return"function"==typeof n&&(r=n,n=null),function e(t,n,r,i,o){return f(t,n,r,(function(s,a){!s||"EMFILE"!==s.code&&"ENFILE"!==s.code?"function"==typeof i&&i.apply(this,arguments):Xt([e,[t,n,r,i],s,o||Date.now(),Date.now()])}))}(e,t,n,r)}return e.open=m,e}function Xt(e){Vt("ENQUEUE",e[0].name,e[1]),Ht[Lt].push(e),Zt()}function Qt(){for(var e=Date.now(),t=0;t<Ht[Lt].length;++t)Ht[Lt][t].length>2&&(Ht[Lt][t][3]=e,Ht[Lt][t][4]=e);Zt()}function Zt(){if(clearTimeout(Kt),Kt=void 0,0!==Ht[Lt].length){var e=Ht[Lt].shift(),t=e[0],n=e[1],r=e[2],i=e[3],o=e[4];if(void 0===i)Vt("RETRY",t.name,n),t.apply(null,n);else if(Date.now()-i>=6e4){Vt("TIMEOUT",t.name,n);var s=n.pop();"function"==typeof s&&s.call(null,r)}else{var a=Date.now()-o,l=Math.max(o-i,1);a>=Math.min(1.2*l,100)?(Vt("RETRY",t.name,n),t.apply(null,n.concat([i]))):Ht[Lt].push(e)}void 0===Kt&&(Kt=setTimeout(Zt,0))}}process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!Ht.__patched&&(Jt=Yt(Ht),Ht.__patched=!0);var en={exports:{}},tn={};function nn(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var rn=nn;nn.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts},nn.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null},nn.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(void 0===n){if(!this._cachedTimeouts)return!1;this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),n=this._timeouts.shift()}var r=this,i=setTimeout((function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout((function(){r._operationTimeoutCb(r._attempts)}),r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)}),n);return this._options.unref&&i.unref(),!0},nn.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){n._operationTimeoutCb()}),n._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},nn.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},nn.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},nn.prototype.start=nn.prototype.try,nn.prototype.errors=function(){return this._errors},nn.prototype.attempts=function(){return this._attempts},nn.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,n=0,r=0;r<this._errors.length;r++){var i=this._errors[r],o=i.message,s=(e[o]||0)+1;e[o]=s,s>=n&&(t=i,n=s)}return t},function(e){var t=rn;e.operation=function(n){var r=e.timeouts(n);return new t(r,{forever:n&&n.forever,unref:n&&n.unref,maxRetryTime:n&&n.maxRetryTime})},e.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in e)t[n]=e[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var r=[],i=0;i<t.retries;i++)r.push(this.createTimeout(i,t));return e&&e.forever&&!r.length&&r.push(this.createTimeout(i,t)),r.sort((function(e,t){return e-t})),r},e.createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1,r=Math.round(n*t.minTimeout*Math.pow(t.factor,e));return r=Math.min(r,t.maxTimeout)},e.wrap=function(t,n,r){if(n instanceof Array&&(r=n,n=null),!r)for(var i in r=[],t)"function"==typeof t[i]&&r.push(i);for(var o=0;o<r.length;o++){var s=r[o],a=t[s];t[s]=function(r){var i=e.operation(n),o=Array.prototype.slice.call(arguments,1),s=o.pop();o.push((function(e){i.retry(e)||(e&&(arguments[0]=i.mainError()),s.apply(this,arguments))})),i.attempt((function(){r.apply(t,o)}))}.bind(t,a),t[s].options=n}}}(tn),en.exports=tn;var on,sn={exports:{}},an={exports:{}};var ln=Y.process;const cn=function(e){return e&&"object"==typeof e&&"function"==typeof e.removeListener&&"function"==typeof e.emit&&"function"==typeof e.reallyExit&&"function"==typeof e.listeners&&"function"==typeof e.kill&&"number"==typeof e.pid&&"function"==typeof e.on};if(cn(ln)){var un,dn=F.default,hn=(on||(on=1,(kn=an).exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"],"win32"!==process.platform&&kn.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),"linux"===process.platform&&kn.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")),an.exports),pn=/^win/i.test(ln.platform),fn=M.default;"function"!=typeof fn&&(fn=fn.EventEmitter),ln.__signal_exit_emitter__?un=ln.__signal_exit_emitter__:((un=ln.__signal_exit_emitter__=new fn).count=0,un.emitted={}),un.infinite||(un.setMaxListeners(1/0),un.infinite=!0),sn.exports=function(e,t){if(!cn(Y.process))return function(){};dn.equal(typeof e,"function","a callback must be provided for exit handler"),!1===wn&&vn();var n="exit";t&&t.alwaysLast&&(n="afterexit");return un.on(n,e),function(){un.removeListener(n,e),0===un.listeners("exit").length&&0===un.listeners("afterexit").length&&mn()}};var mn=function(){wn&&cn(Y.process)&&(wn=!1,hn.forEach((function(e){try{ln.removeListener(e,_n[e])}catch(e){}})),ln.emit=Sn,ln.reallyExit=bn,un.count-=1)};sn.exports.unload=mn;var gn=function(e,t,n){un.emitted[e]||(un.emitted[e]=!0,un.emit(e,t,n))},_n={};hn.forEach((function(e){_n[e]=function(){cn(Y.process)&&(ln.listeners(e).length===un.count&&(mn(),gn("exit",null,e),gn("afterexit",null,e),pn&&"SIGHUP"===e&&(e="SIGINT"),ln.kill(ln.pid,e)))}})),sn.exports.signals=function(){return hn};var wn=!1,vn=function(){!wn&&cn(Y.process)&&(wn=!0,un.count+=1,hn=hn.filter((function(e){try{return ln.on(e,_n[e]),!0}catch(e){return!1}})),ln.emit=xn,ln.reallyExit=yn)};sn.exports.load=vn;var bn=ln.reallyExit,yn=function(e){cn(Y.process)&&(ln.exitCode=e||0,gn("exit",ln.exitCode,null),gn("afterexit",ln.exitCode,null),bn.call(ln,ln.exitCode))},Sn=ln.emit,xn=function(e,t){if("exit"===e&&cn(Y.process)){void 0!==t&&(ln.exitCode=t);var n=Sn.apply(this,arguments);return gn("exit",ln.exitCode,null),gn("afterexit",ln.exitCode,null),n}return Sn.apply(this,arguments)}}else sn.exports=function(){return function(){}};var kn,En={};const Cn=Symbol();En.probe=function(e,t,n){const r=t[Cn];if(r)return t.stat(e,((e,t)=>{if(e)return n(e);n(null,t.mtime,r)}));const i=new Date(1e3*Math.ceil(Date.now()/1e3)+5);t.utimes(e,i,i,(r=>{if(r)return n(r);t.stat(e,((e,r)=>{if(e)return n(e);const i=r.mtime.getTime()%1e3==0?"s":"ms";Object.defineProperty(t,Cn,{value:i}),n(null,r.mtime,i)}))}))},En.getMtime=function(e){let t=Date.now();return"s"===e&&(t=1e3*Math.ceil(t/1e3)),new Date(t)};const Tn=T.default,Pn=Jt,On=en.exports,An=sn.exports,In=En,Mn={};function Fn(e,t){return t.lockfilePath||`${e}.lock`}function Nn(e,t,n){if(!t.realpath)return n(null,Tn.resolve(e));t.fs.realpath(e,n)}function Rn(e,t,n){const r=Fn(e,t);t.fs.mkdir(r,(i=>i?"EEXIST"!==i.code?n(i):t.stale<=0?n(Object.assign(new Error("Lock file is already being held"),{code:"ELOCKED",file:e})):void t.fs.stat(r,((r,i)=>r?"ENOENT"===r.code?Rn(e,{...t,stale:0},n):n(r):jn(i,t)?void Dn(e,t,(r=>{if(r)return n(r);Rn(e,{...t,stale:0},n)})):n(Object.assign(new Error("Lock file is already being held"),{code:"ELOCKED",file:e})))):In.probe(r,t.fs,((e,i,o)=>{if(e)return t.fs.rmdir(r,(()=>{})),n(e);n(null,i,o)}))))}function jn(e,t){return e.mtime.getTime()<Date.now()-t.stale}function Dn(e,t,n){t.fs.rmdir(Fn(e,t),(e=>{if(e&&"ENOENT"!==e.code)return n(e);n()}))}function Ln(e,t){const n=Mn[e];n.updateTimeout||(n.updateDelay=n.updateDelay||t.update,n.updateTimeout=setTimeout((()=>{n.updateTimeout=null,t.fs.stat(n.lockfilePath,((r,i)=>{const o=n.lastUpdate+t.stale<Date.now();if(r)return"ENOENT"===r.code||o?Bn(e,n,Object.assign(r,{code:"ECOMPROMISED"})):(n.updateDelay=1e3,Ln(e,t));if(!(n.mtime.getTime()===i.mtime.getTime()))return Bn(e,n,Object.assign(new Error("Unable to update lock within the stale threshold"),{code:"ECOMPROMISED"}));const s=In.getMtime(n.mtimePrecision);t.fs.utimes(n.lockfilePath,s,s,(r=>{const i=n.lastUpdate+t.stale<Date.now();if(!n.released){if(r)return"ENOENT"===r.code||i?Bn(e,n,Object.assign(r,{code:"ECOMPROMISED"})):(n.updateDelay=1e3,Ln(e,t));n.mtime=s,n.lastUpdate=Date.now(),n.updateDelay=null,Ln(e,t)}}))}))}),n.updateDelay),n.updateTimeout.unref&&n.updateTimeout.unref())}function Bn(e,t,n){t.released=!0,t.updateTimeout&&clearTimeout(t.updateTimeout),Mn[e]===t&&delete Mn[e],t.options.onCompromised(n)}function Hn(e,t,n){Nn(e,t={fs:Pn,realpath:!0,...t},((e,r)=>{if(e)return n(e);const i=Mn[r];if(!i)return n(Object.assign(new Error("Lock is not acquired/owned by you"),{code:"ENOTACQUIRED"}));i.updateTimeout&&clearTimeout(i.updateTimeout),i.released=!0,delete Mn[r],Dn(r,t,n)}))}An((()=>{for(const e in Mn){const t=Mn[e].options;try{t.fs.rmdirSync(Fn(e,t))}catch(e){}}})),Tt.lock=function(e,t,n){(t={stale:1e4,update:null,realpath:!0,retries:0,fs:Pn,onCompromised:e=>{throw e},...t}).retries=t.retries||0,t.retries="number"==typeof t.retries?{retries:t.retries}:t.retries,t.stale=Math.max(t.stale||0,2e3),t.update=null==t.update?t.stale/2:t.update||0,t.update=Math.max(Math.min(t.update,t.stale/2),1e3),Nn(e,t,((e,r)=>{if(e)return n(e);const i=On.operation(t.retries);i.attempt((()=>{Rn(r,t,((e,o,s)=>{if(i.retry(e))return;if(e)return n(i.mainError());const a=Mn[r]={lockfilePath:Fn(r,t),mtime:o,mtimePrecision:s,options:t,lastUpdate:Date.now()};Ln(r,t),n(null,(e=>{if(a.released)return e&&e(Object.assign(new Error("Lock is already released"),{code:"ERELEASED"}));Hn(r,{...t,realpath:!1},e)}))}))}))}))},Tt.unlock=Hn,Tt.check=function(e,t,n){(t={stale:1e4,realpath:!0,fs:Pn,...t}).stale=Math.max(t.stale||0,2e3),Nn(e,t,((e,r)=>{if(e)return n(e);t.fs.stat(Fn(r,t),((e,r)=>e?"ENOENT"===e.code?n(null,!1):n(e):n(null,!jn(r,t))))}))},Tt.getLocks=function(){return Mn};const qn=Jt;var Un={toPromise:function(e){return(...t)=>new Promise(((n,r)=>{t.push(((e,t)=>{e?r(e):n(t)})),e(...t)}))},toSync:function(e){return(...t)=>{let n,r;if(t.push(((e,t)=>{n=e,r=t})),e(...t),n)throw n;return r}},toSyncOptions:function(e){if((e={...e}).fs=function(e){const t={...e};return["mkdir","realpath","stat","rmdir","utimes"].forEach((n=>{t[n]=(...t)=>{const r=t.pop();let i;try{i=e[`${n}Sync`](...t)}catch(e){return r(e)}r(null,i)}})),t}(e.fs||qn),"number"==typeof e.retries&&e.retries>0||e.retries&&"number"==typeof e.retries.retries&&e.retries.retries>0)throw Object.assign(new Error("Cannot use retries with the sync api"),{code:"ESYNC"});return e}};const Wn=Tt,{toPromise:$n,toSync:zn,toSyncOptions:Vn}=Un;async function Gn(e,t){const n=await $n(Wn.lock)(e,t);return $n(n)}Ct.exports=Gn,Ct.exports.lock=Gn,Ct.exports.unlock=function(e,t){return $n(Wn.unlock)(e,t)},Ct.exports.lockSync=function(e,t){const n=zn(Wn.lock)(e,Vn(t));return zn(n)},Ct.exports.unlockSync=function(e,t){return zn(Wn.unlock)(e,Vn(t))},Ct.exports.check=function(e,t){return $n(Wn.check)(e,t)},Ct.exports.checkSync=function(e,t){return zn(Wn.check)(e,Vn(t))};var Kn={};Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.getUbuntuVersion=async function(){void 0===Zn&&(Zn=await async function(){if("linux"!==Xn.platform())return"";let e=await Yn.default.promises.readFile("/etc/upstream-release/lsb-release","utf8").catch((e=>""));e||(e=await Yn.default.promises.readFile("/etc/os-release","utf8").catch((e=>"")));return e?tr(e):""}());return Zn},Kn.getUbuntuVersionSync=function(){void 0===Zn&&(Zn=function(){if("linux"!==Xn.platform())return"";try{let e;return e=Yn.default.existsSync("/etc/upstream-release/lsb-release")?Yn.default.readFileSync("/etc/upstream-release/lsb-release","utf8"):Yn.default.readFileSync("/etc/os-release","utf8"),e?tr(e):""}catch(e){return""}}());return Zn},Kn.parseOSReleaseText=er;var Jn,Yn=(Jn=C.default)&&Jn.__esModule?Jn:{default:Jn},Xn=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=Qn(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(E.default);function Qn(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(Qn=function(e){return e?n:t})(e)}let Zn;function er(e){const t=new Map;for(const n of e.split("\n")){const e=n.split("="),r=e.shift();let i=e.join("=").trim();i.startsWith('"')&&i.endsWith('"')&&(i=i.substring(1,i.length-1)),r&&t.set(r.toLowerCase(),i)}return t}function tr(e){var t,n;const r=er(e);return r.get("distrib_id")&&"ubuntu"===(null===(t=r.get("distrib_id"))||void 0===t?void 0:t.toLowerCase())?r.get("distrib_release")||"":r.get("name")&&"ubuntu"===(null===(n=r.get("name"))||void 0===n?void 0:n.toLowerCase())&&r.get("version_id")||""}var nr={},rr={},ir=H.default.parse,or={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443},sr=String.prototype.endsWith||function(e){return e.length<=this.length&&-1!==this.indexOf(e,this.length-e.length)};function ar(e){return process.env[e.toLowerCase()]||process.env[e.toUpperCase()]||""}rr.getProxyForUrl=function(e){var t="string"==typeof e?ir(e):e||{},n=t.protocol,r=t.host,i=t.port;if("string"!=typeof r||!r||"string"!=typeof n)return"";if(n=n.split(":",1)[0],!function(e,t){var n=(ar("npm_config_no_proxy")||ar("no_proxy")).toLowerCase();if(!n)return!0;if("*"===n)return!1;return n.split(/[,\s]/).every((function(n){if(!n)return!0;var r=n.match(/^(.+):(\d+)$/),i=r?r[1]:n,o=r?parseInt(r[2]):0;return!(!o||o===t)||(/^[.*]/.test(i)?("*"===i.charAt(0)&&(i=i.slice(1)),!sr.call(e,i)):e!==i)}))}(r=r.replace(/:\d*$/,""),i=parseInt(i)||or[n]||0))return"";var o=ar("npm_config_"+n+"_proxy")||ar(n+"_proxy")||ar("npm_config_proxy")||ar("all_proxy");return o&&-1===o.indexOf("://")&&(o=n+"://"+o),o};var lr,cr,ur,dr,hr,pr={},fr={exports:{}},mr={exports:{}};function gr(){if(cr)return lr;cr=1;var e=1e3,t=60*e,n=60*t,r=24*n,i=7*r,o=365.25*r;function s(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}return lr=function(a,l){l=l||{};var c=typeof a;if("string"===c&&a.length>0)return function(s){if((s=String(s)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(!a)return;var l=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return l*o;case"weeks":case"week":case"w":return l*i;case"days":case"day":case"d":return l*r;case"hours":case"hour":case"hrs":case"hr":case"h":return l*n;case"minutes":case"minute":case"mins":case"min":case"m":return l*t;case"seconds":case"second":case"secs":case"sec":case"s":return l*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}(a);if("number"===c&&isFinite(a))return l.long?function(i){var o=Math.abs(i);if(o>=r)return s(i,o,r,"day");if(o>=n)return s(i,o,n,"hour");if(o>=t)return s(i,o,t,"minute");if(o>=e)return s(i,o,e,"second");return i+" ms"}(a):function(i){var o=Math.abs(i);if(o>=r)return Math.round(i/r)+"d";if(o>=n)return Math.round(i/n)+"h";if(o>=t)return Math.round(i/t)+"m";if(o>=e)return Math.round(i/e)+"s";return i+"ms"}(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))},lr}function _r(){if(dr)return ur;return dr=1,ur=function(e){function t(e){let r,i,o,s=null;function a(...e){if(!a.enabled)return;const n=a,i=Number(new Date),o=i-(r||i);n.diff=o,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";s++;const o=t.formatters[i];if("function"==typeof o){const t=e[s];r=o.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=gr(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t},ur}var wr,vr,br,yr,Sr,xr={exports:{}};function kr(){if(yr)return br;yr=1;const e=E.default,t=q.default,n=vr?wr:(vr=1,wr=(e,t=process.argv)=>{const n=e.startsWith("-")?"":1===e.length?"-":"--",r=t.indexOf(n+e),i=t.indexOf("--");return-1!==r&&(-1===i||r<i)}),{env:r}=process;let i;function o(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function s(t,o){if(0===i)return 0;if(n("color=16m")||n("color=full")||n("color=truecolor"))return 3;if(n("color=256"))return 2;if(t&&!o&&void 0===i)return 0;const s=i||0;if("dumb"===r.TERM)return s;if("win32"===process.platform){const t=e.release().split(".");return Number(t[0])>=10&&Number(t[2])>=10586?Number(t[2])>=14931?3:2:1}if("CI"in r)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some((e=>e in r))||"codeship"===r.CI_NAME?1:s;if("TEAMCITY_VERSION"in r)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(r.TEAMCITY_VERSION)?1:0;if("truecolor"===r.COLORTERM)return 3;if("TERM_PROGRAM"in r){const e=parseInt((r.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(r.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(r.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(r.TERM)||"COLORTERM"in r?1:s}return n("no-color")||n("no-colors")||n("color=false")||n("color=never")?i=0:(n("color")||n("colors")||n("color=true")||n("color=always"))&&(i=1),"FORCE_COLOR"in r&&(i="true"===r.FORCE_COLOR?1:"false"===r.FORCE_COLOR?0:0===r.FORCE_COLOR.length?1:Math.min(parseInt(r.FORCE_COLOR,10),3)),br={supportsColor:function(e){return o(s(e,e&&e.isTTY))},stdout:o(s(!0,t.isatty(1))),stderr:o(s(!0,t.isatty(2)))},br}function Er(){return Sr||(Sr=1,function(e,t){const n=q.default,r=N.default;t.init=function(e){e.inspectOpts={};const n=Object.keys(t.inspectOpts);for(let r=0;r<n.length;r++)e.inspectOpts[n[r]]=t.inspectOpts[n[r]]},t.log=function(...e){return process.stderr.write(r.format(...e)+"\n")},t.formatArgs=function(n){const{namespace:r,useColors:i}=this;if(i){const t=this.color,i="[3"+(t<8?t:"8;5;"+t),o=`  ${i};1m${r} [0m`;n[0]=o+n[0].split("\n").join("\n"+o),n.push(i+"m+"+e.exports.humanize(this.diff)+"[0m")}else n[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+r+" "+n[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.destroy=r.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=kr();e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const n=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[n]=r,e}),{}),e.exports=_r()(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,r.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,r.inspect(e,this.inspectOpts)}}(xr,xr.exports)),xr.exports}!function(e){"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=(hr||(hr=1,function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=_r()(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}(mr,mr.exports)),mr.exports):e.exports=Er()}(fr);var Cr,Tr,Pr,Or,Ar,Ir={exports:{}},Mr={exports:{}};function Fr(){if(Tr)return Cr;Tr=1;var e=1e3,t=60*e,n=60*t,r=24*n,i=7*r,o=365.25*r;function s(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}return Cr=function(a,l){l=l||{};var c=typeof a;if("string"===c&&a.length>0)return function(s){if((s=String(s)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(!a)return;var l=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return l*o;case"weeks":case"week":case"w":return l*i;case"days":case"day":case"d":return l*r;case"hours":case"hour":case"hrs":case"hr":case"h":return l*n;case"minutes":case"minute":case"mins":case"min":case"m":return l*t;case"seconds":case"second":case"secs":case"sec":case"s":return l*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}(a);if("number"===c&&isFinite(a))return l.long?function(i){var o=Math.abs(i);if(o>=r)return s(i,o,r,"day");if(o>=n)return s(i,o,n,"hour");if(o>=t)return s(i,o,t,"minute");if(o>=e)return s(i,o,e,"second");return i+" ms"}(a):function(i){var o=Math.abs(i);if(o>=r)return Math.round(i/r)+"d";if(o>=n)return Math.round(i/n)+"h";if(o>=t)return Math.round(i/t)+"m";if(o>=e)return Math.round(i/e)+"s";return i+"ms"}(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))}}function Nr(){if(Or)return Pr;return Or=1,Pr=function(e){function t(e){let r,i,o,s=null;function a(...e){if(!a.enabled)return;const n=a,i=Number(new Date),o=i-(r||i);n.diff=o,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";s++;const o=t.formatters[i];if("function"==typeof o){const t=e[s];r=o.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=Fr(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t},Pr}var Rr,jr={exports:{}};function Dr(){return Rr||(Rr=1,function(e,t){const n=q.default,r=N.default;t.init=function(e){e.inspectOpts={};const n=Object.keys(t.inspectOpts);for(let r=0;r<n.length;r++)e.inspectOpts[n[r]]=t.inspectOpts[n[r]]},t.log=function(...e){return process.stderr.write(r.format(...e)+"\n")},t.formatArgs=function(n){const{namespace:r,useColors:i}=this;if(i){const t=this.color,i="[3"+(t<8?t:"8;5;"+t),o=`  ${i};1m${r} [0m`;n[0]=o+n[0].split("\n").join("\n"+o),n.push(i+"m+"+e.exports.humanize(this.diff)+"[0m")}else n[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+r+" "+n[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.destroy=r.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=kr();e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const n=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[n]=r,e}),{}),e.exports=Nr()(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,r.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,r.inspect(e,this.inspectOpts)}}(jr,jr.exports)),jr.exports}!function(e){"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=(Ar||(Ar=1,function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=Nr()(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}(Mr,Mr.exports)),Mr.exports):e.exports=Dr()}(Ir);var Lr,Br,Hr,qr={};function Ur(){if(Hr)return Br;Hr=1;var e=Y&&Y.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};const t=M.default,n=e(Ir.exports),r=e((Lr||(Lr=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.default=function(e){return function(t,n){return new Promise(((r,i)=>{e.call(this,t,n,((e,t)=>{e?i(e):r(t)}))}))}}),qr)),i=n.default("agent-base");function o(){const{stack:e}=new Error;return"string"==typeof e&&e.split("\n").some((e=>-1!==e.indexOf("(https.js:")||-1!==e.indexOf("node:https:")))}function s(e,t){return new s.Agent(e,t)}return function(e){class n extends t.EventEmitter{constructor(e,t){super();let n=t;"function"==typeof e?this.callback=e:e&&(n=e),this.timeout=null,n&&"number"==typeof n.timeout&&(this.timeout=n.timeout),this.maxFreeSockets=1,this.maxSockets=1,this.maxTotalSockets=1/0,this.sockets={},this.freeSockets={},this.requests={},this.options={}}get defaultPort(){return"number"==typeof this.explicitDefaultPort?this.explicitDefaultPort:o()?443:80}set defaultPort(e){this.explicitDefaultPort=e}get protocol(){return"string"==typeof this.explicitProtocol?this.explicitProtocol:o()?"https:":"http:"}set protocol(e){this.explicitProtocol=e}callback(e,t,n){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(e,t){const n=Object.assign({},t);"boolean"!=typeof n.secureEndpoint&&(n.secureEndpoint=o()),null==n.host&&(n.host="localhost"),null==n.port&&(n.port=n.secureEndpoint?443:80),null==n.protocol&&(n.protocol=n.secureEndpoint?"https:":"http:"),n.host&&n.path&&delete n.path,delete n.agent,delete n.hostname,delete n._defaultAgent,delete n.defaultPort,delete n.createConnection,e._last=!0,e.shouldKeepAlive=!1;let s=!1,a=null;const l=n.timeout||this.timeout,c=t=>{e._hadError||(e.emit("error",t),e._hadError=!0)},u=()=>{a=null,s=!0;const e=new Error(`A "socket" was not created for HTTP request before ${l}ms`);e.code="ETIMEOUT",c(e)},d=e=>{s||(null!==a&&(clearTimeout(a),a=null),c(e))},h=t=>{if(s)return;if(null!=a&&(clearTimeout(a),a=null),r=t,Boolean(r)&&"function"==typeof r.addRequest)return i("Callback returned another Agent instance %o",t.constructor.name),void t.addRequest(e,n);var r;if(t)return t.once("free",(()=>{this.freeSocket(t,n)})),void e.onSocket(t);const o=new Error(`no Duplex stream was returned to agent-base for \`${e.method} ${e.path}\``);c(o)};if("function"==typeof this.callback){this.promisifiedCallback||(this.callback.length>=3?(i("Converting legacy callback function to promise"),this.promisifiedCallback=r.default(this.callback)):this.promisifiedCallback=this.callback),"number"==typeof l&&l>0&&(a=setTimeout(u,l)),"port"in n&&"number"!=typeof n.port&&(n.port=Number(n.port));try{i("Resolving socket for %o request: %o",n.protocol,`${e.method} ${e.path}`),Promise.resolve(this.promisifiedCallback(e,n)).then(h,d)}catch(e){Promise.reject(e).catch(d)}}else c(new Error("`callback` is not defined"))}freeSocket(e,t){i("Freeing socket %o %o",e.constructor.name,t),e.destroy()}destroy(){i("Destroying agent %o",this.constructor.name)}}e.Agent=n,e.prototype=e.Agent.prototype}(s||(s={})),Br=s}var Wr={},$r=Y&&Y.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Wr,"__esModule",{value:!0});const zr=$r(fr.exports).default("https-proxy-agent:parse-proxy-response");Wr.default=function(e){return new Promise(((t,n)=>{let r=0;const i=[];function o(){const n=e.read();n?function(e){i.push(e),r+=e.length;const n=Buffer.concat(i,r);if(-1===n.indexOf("\r\n\r\n"))return zr("have not received end of HTTP headers yet..."),void o();const s=n.toString("ascii",0,n.indexOf("\r\n")),a=+s.split(" ")[1];zr("got proxy server response: %o",s),t({statusCode:a,buffered:n})}(n):e.once("readable",o)}function s(e){zr("onclose had error %o",e)}function a(){zr("onend")}function l(t){e.removeListener("end",a),e.removeListener("error",l),e.removeListener("close",s),e.removeListener("readable",o),zr("onerror %o",t),n(t)}e.on("error",l),e.on("close",s),e.on("end",a),o()}))};var Vr=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},Gr=Y&&Y.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(pr,"__esModule",{value:!0});const Kr=Gr(A.default),Jr=Gr(I.default),Yr=Gr(H.default),Xr=Gr(F.default),Qr=Gr(fr.exports),Zr=Ur(),ei=Gr(Wr),ti=Qr.default("https-proxy-agent:agent");class ni extends Zr.Agent{constructor(e){let t;if(t="string"==typeof e?Yr.default.parse(e):e,!t)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");ti("creating new HttpsProxyAgent instance: %o",t),super(t);const n=Object.assign({},t);var r;this.secureProxy=t.secureProxy||"string"==typeof(r=n.protocol)&&/^https:?$/i.test(r),n.host=n.hostname||n.host,"string"==typeof n.port&&(n.port=parseInt(n.port,10)),!n.port&&n.host&&(n.port=this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in n)&&(n.ALPNProtocols=["http 1.1"]),n.host&&n.path&&(delete n.path,delete n.pathname),this.proxy=n}callback(e,t){return Vr(this,void 0,void 0,(function*(){const{proxy:n,secureProxy:r}=this;let i;r?(ti("Creating `tls.Socket`: %o",n),i=Jr.default.connect(n)):(ti("Creating `net.Socket`: %o",n),i=Kr.default.connect(n));const o=Object.assign({},n.headers);let s=`CONNECT ${`${t.host}:${t.port}`} HTTP/1.1\r\n`;n.auth&&(o["Proxy-Authorization"]=`Basic ${Buffer.from(n.auth).toString("base64")}`);let{host:a,port:l,secureEndpoint:c}=t;(function(e,t){return Boolean(!t&&80===e||t&&443===e)})(l,c)||(a+=`:${l}`),o.Host=a,o.Connection="close";for(const e of Object.keys(o))s+=`${e}: ${o[e]}\r\n`;const u=ei.default(i);i.write(`${s}\r\n`);const{statusCode:d,buffered:h}=yield u;if(200===d){if(e.once("socket",ri),t.secureEndpoint){const e=t.servername||t.host;if(!e)throw new Error('Could not determine "servername"');return ti("Upgrading socket connection to TLS"),Jr.default.connect(Object.assign(Object.assign({},function(e,...t){const n={};let r;for(r in e)t.includes(r)||(n[r]=e[r]);return n}(t,"host","hostname","path","port")),{socket:i,servername:e}))}return i}i.destroy();const p=new Kr.default.Socket;return p.readable=!0,e.once("socket",(e=>{ti("replaying proxy buffer for failed request"),Xr.default(e.listenerCount("data")>0),e.push(h),e.push(null)})),p}))}}function ri(e){e.resume()}pr.default=ni;const ii=(Y&&Y.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(pr);function oi(e){return new ii.default(e)}!function(e){e.HttpsProxyAgent=ii.default,e.prototype=ii.default.prototype}(oi||(oi={}));var si=oi;Object.defineProperty(nr,"__esModule",{value:!0}),nr.createSocket=async function(e,t){return new Promise(((n,r)=>{const i=ci.default.createConnection({host:e,port:t});i.on("connect",(()=>n(i))),i.on("error",(e=>r(e)))}))},nr.fetchData=function(e,t){return new Promise(((n,r)=>{mi(e,(async i=>{if(200!==i.statusCode){const n=t?await t(e,i):new Error(`fetch failed: server returned code ${i.statusCode}. URL: ${e.url}`);return void r(n)}let o="";i.on("data",(e=>o+=e)),i.on("error",(e=>r(e))),i.on("end",(()=>n(o)))}),r)}))},nr.httpRequest=mi;var ai=pi(P.default),li=pi(O.default),ci=pi(A.default),ui=rr,di=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=hi(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(H.default);function hi(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(hi=function(e){return e?n:t})(e)}function pi(e){return e&&e.__esModule?e:{default:e}}const fi=si;function mi(e,t,n){const r=di.parse(e.url);let i={...r};i.method=e.method||"GET",i.headers=e.headers;const o=(0,ui.getProxyForUrl)(e.url);if(o)if(e.url.startsWith("http:")){const e=di.parse(o);i={path:r.href,host:e.hostname,port:e.port}}else{const e=di.parse(o);e.secureProxy="https:"===e.protocol,i.agent=new fi(e),i.rejectUnauthorized=!1}const s=r=>{const i=r.statusCode||0;i>=300&&i<400&&r.headers.location?mi({...e,url:r.headers.location},t,n):t(r)},a="https:"===i.protocol?li.default.request(i,s):ai.default.request(i,s);if(a.on("error",n),void 0!==e.timeout){const t=()=>{n(new Error(`Request to ${e.url} timed out after ${e.timeout}ms`)),a.abort()};if(e.timeout<=0)return void t();a.setTimeout(e.timeout,t)}a.end(e.data)}var gi={},_i={name:"playwright-core",version:"1.21.1",description:"A high-level API to automate web browsers",repository:"github:Microsoft/playwright",homepage:"https://playwright.dev",engines:{node:">=12"},author:{name:"Microsoft Corporation"},license:"Apache-2.0",exports:{".":{import:"./index.mjs",require:"./index.js"},"./cli":"./cli.js","./package.json":"./package.json","./lib/grid/gridServer":"./lib/grid/gridServer.js","./lib/grid/gridClient":"./lib/grid/gridClient.js","./lib/grid/dockerGridFactory":"./lib/grid/dockerGridFactory.js","./lib/outofprocess":"./lib/outofprocess.js","./lib/utils":"./lib/utils/index.js","./lib/utils/comparators":"./lib/utils/comparators.js","./lib/utils/eventsHelper":"./lib/utils/eventsHelper.js","./lib/utils/fileUtils":"./lib/utils/fileUtils.js","./lib/utils/httpServer":"./lib/utils/httpServer.js","./lib/utils/hostPlatform":"./lib/utils/hostPlatform.js","./lib/utils/manualPromise":"./lib/utils/manualPromise.js","./lib/utils/multimap":"./lib/utils/multimap.js","./lib/utils/processLauncher":"./lib/utils/processLauncher.js","./lib/utils/spawnAsync":"./lib/utils/spawnAsync.js","./lib/utils/stackTrace":"./lib/utils/stackTrace.js","./lib/utils/timeoutRunner":"./lib/utils/timeoutRunner.js","./lib/remote/playwrightServer":"./lib/remote/playwrightServer.js","./lib/remote/playwrightClient":"./lib/remote/playwrightClient.js","./lib/server":"./lib/server/index.js"},types:"types/types.d.ts",bin:{playwright:"./cli.js"},dependencies:{commander:"8.3.0",colors:"1.4.0",debug:"4.3.3","extract-zip":"2.0.1","https-proxy-agent":"5.0.0","jpeg-js":"0.4.3",mime:"3.0.0",pixelmatch:"5.2.1",pngjs:"6.0.0",progress:"2.0.3","proper-lockfile":"4.1.2","proxy-from-env":"1.1.0",rimraf:"3.0.2","socks-proxy-agent":"6.1.1","stack-utils":"2.0.5",ws:"8.4.2",yauzl:"2.10.0",yazl:"2.5.1"}};Object.defineProperty(gi,"__esModule",{value:!0}),gi.getClientLanguage=ki,gi.getPlaywrightVersion=Ei,gi.getUserAgent=function(){if(xi)return xi;try{xi=function(){let e="unknown",t="unknown";if("win32"===process.platform){const n=bi.default.release().split(".");e="windows",t=`${n[0]}.${n[1]}`}else if("darwin"===process.platform){const n=(0,wi.execSync)("sw_vers -productVersion",{stdio:["ignore","pipe","ignore"]}).toString().trim().split(".");e="macOS",t=`${n[0]}.${n[1]}`}else if("linux"===process.platform)try{const n=vi.default.readFileSync("/etc/os-release","utf8"),r=(0,yi.parseOSReleaseText)(n);e=r.get("id")||"unknown",t=r.get("version_id")||"unknown"}catch(t){e="linux"}const{langName:n,langVersion:r}=ki();return`Playwright/${Ei()} (${bi.default.arch()}; ${e} ${t}) ${n}/${r}`}()}catch(e){xi="Playwright/unknown"}return xi};var wi=j.default,vi=Si(C.default),bi=Si(E.default),yi=Kn;function Si(e){return e&&e.__esModule?e:{default:e}}let xi;function ki(){let e="unknown",t="unknown";if(process.env.PW_LANG_NAME){if(["node","python","java","csharp"].includes(process.env.PW_LANG_NAME)){var n;e=process.env.PW_LANG_NAME,t=null!==(n=process.env.PW_LANG_NAME_VERSION)&&void 0!==n?n:"unknown"}}else e="node",t=process.version.substring(1).split(".").slice(0,2).join(".");return{langName:e,langVersion:t}}function Ei(e=!1){const t=_i;return e?t.version.split(".").slice(0,2).join("."):t.version}var Ci={};Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.arrayToObject=function(e){if(!e)return;const t={};for(const{name:n,value:r}of e)t[n]=r;return t},Ci.assert=function(e,t){if(!e)throw new Error(t||"Assertion error")},Ci.calculateSha1=function(e){const t=Ti.createHash("sha1");return t.update(e),t.digest("hex")},Ci.constructURLBasedOnBaseURL=function(e,t){try{return new Pi.URL(t,e).toString()}catch(e){return t}},Ci.createGuid=function(){return Ti.randomBytes(16).toString("hex")},Ci.debugAssert=function(e,t){if(Fi()&&!e)throw new Error(t)},Ci.debugMode=function(){return"console"===Ii?"console":"0"===Ii||"false"===Ii?"":Ii?"inspector":""},Ci.experimentalFeaturesEnabled=function(){return Fi()||!!process.env.PLAYWRIGHT_EXPERIMENTAL_FEATURES},Ci.getAsBooleanFromENV=function(e){const t=Ni(e);return!!t&&"false"!==t&&"0"!==t},Ci.getFromENV=Ni,Ci.headersArrayToObject=function(e,t){const n={};for(const{name:r,value:i}of e)n[t?r.toLowerCase():r]=i;return n},Ci.headersObjectToArray=function(e,t,n){n||(n=t);const r=[];for(const i in e){const o=e[i];if(t){const e="set-cookie"===i.toLowerCase()?n:t;for(const t of o.split(e))r.push({name:i,value:t.trim()})}else r.push({name:i,value:o})}return r},Ci.isError=function(e){return e instanceof Error||e&&e.__proto__&&"Error"===e.__proto__.name},Ci.isFilePayload=function(e){return"object"==typeof e&&e.name&&e.mimeType&&e.buffer},Ci.isObject=function(e){return"object"==typeof e&&null!==e},Ci.isRegExp=function(e){return e instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(e)},Ci.isString=function(e){return"string"==typeof e||e instanceof String},Ci.isUnderTest=Fi,Ci.makeWaitForNextTask=function(){if(process.versions.electron)return e=>setTimeout(e,0);if(parseInt(process.versions.node,10)>=11)return setImmediate;let e=!1;const t=[],n=()=>{const r=t.shift();r?(setImmediate(n),r()):e=!1};return r=>{t.push(r),e||(e=!0,setImmediate(n))}},Ci.monotonicTime=function(){const[e,t]=process.hrtime();return 1e3*e+(t/1e3|0)/1e3},Ci.objectToArray=function(e){if(!e)return;const t=[];for(const[n,r]of Object.entries(e))t.push({name:n,value:String(r)});return t},Ci.setUnderTest=function(){Mi=!0},Ci.streamToString=function(e){return new Promise(((t,n)=>{const r=[];e.on("data",(e=>r.push(Buffer.from(e)))),e.on("error",n),e.on("end",(()=>t(Buffer.concat(r).toString("utf8"))))}))},Ci.wrapInASCIIBox=function(e,t=0){const n=e.split("\n"),r=Math.max(...n.map((e=>e.length)));return[""+"".repeat(r+2*t)+"",...n.map((e=>""+" ".repeat(t)+e+" ".repeat(r-e.length+t)+"")),""+"".repeat(r+2*t)+""].join("\n")};var Ti=Ai(U.default),Pi=Ai(H.default);function Oi(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(Oi=function(e){return e?n:t})(e)}function Ai(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=Oi(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}const Ii=Ni("PWDEBUG")||"";let Mi=!1;function Fi(){return Mi}function Ni(e){let t=process.env[e];return t=void 0===t?process.env[`npm_config_${e.toLowerCase()}`]:t,t=void 0===t?process.env[`npm_package_config_${e.toLowerCase()}`]:t,t}var Ri={},ji={},Di=T.default,Li="win32"===process.platform,Bi=C.default,Hi=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function qi(e){return"function"==typeof e?e:function(){var e;if(Hi){var t=new Error;e=function(e){e&&(t.message=e.message,n(e=t))}}else e=n;return e;function n(e){if(e){if(process.throwDeprecation)throw e;if(!process.noDeprecation){var t="fs: missing callback "+(e.stack||e.message);process.traceDeprecation?console.trace(t):console.error(t)}}}}()}if(Di.normalize,Li)var Ui=/(.*?)(?:[\/\\]+|$)/g;else Ui=/(.*?)(?:[\/]+|$)/g;if(Li)var Wi=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else Wi=/^[\/]*/;ji.realpathSync=function(e,t){if(e=Di.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return t[e];var n,r,i,o,s=e,a={},l={};function c(){var t=Wi.exec(e);n=t[0].length,r=t[0],i=t[0],o="",Li&&!l[i]&&(Bi.lstatSync(i),l[i]=!0)}for(c();n<e.length;){Ui.lastIndex=n;var u=Ui.exec(e);if(o=r,r+=u[0],i=o+u[1],n=Ui.lastIndex,!(l[i]||t&&t[i]===i)){var d;if(t&&Object.prototype.hasOwnProperty.call(t,i))d=t[i];else{var h=Bi.lstatSync(i);if(!h.isSymbolicLink()){l[i]=!0,t&&(t[i]=i);continue}var p=null;if(!Li){var f=h.dev.toString(32)+":"+h.ino.toString(32);a.hasOwnProperty(f)&&(p=a[f])}null===p&&(Bi.statSync(i),p=Bi.readlinkSync(i)),d=Di.resolve(o,p),t&&(t[i]=d),Li||(a[f]=p)}e=Di.resolve(d,e.slice(n)),c()}}return t&&(t[s]=e),e},ji.realpath=function(e,t,n){if("function"!=typeof n&&(n=qi(t),t=null),e=Di.resolve(e),t&&Object.prototype.hasOwnProperty.call(t,e))return process.nextTick(n.bind(null,null,t[e]));var r,i,o,s,a=e,l={},c={};function u(){var t=Wi.exec(e);r=t[0].length,i=t[0],o=t[0],s="",Li&&!c[o]?Bi.lstat(o,(function(e){if(e)return n(e);c[o]=!0,d()})):process.nextTick(d)}function d(){if(r>=e.length)return t&&(t[a]=e),n(null,e);Ui.lastIndex=r;var l=Ui.exec(e);return s=i,i+=l[0],o=s+l[1],r=Ui.lastIndex,c[o]||t&&t[o]===o?process.nextTick(d):t&&Object.prototype.hasOwnProperty.call(t,o)?f(t[o]):Bi.lstat(o,h)}function h(e,r){if(e)return n(e);if(!r.isSymbolicLink())return c[o]=!0,t&&(t[o]=o),process.nextTick(d);if(!Li){var i=r.dev.toString(32)+":"+r.ino.toString(32);if(l.hasOwnProperty(i))return p(null,l[i],o)}Bi.stat(o,(function(e){if(e)return n(e);Bi.readlink(o,(function(e,t){Li||(l[i]=t),p(e,t)}))}))}function p(e,r,i){if(e)return n(e);var o=Di.resolve(s,r);t&&(t[i]=o),f(o)}function f(t){e=Di.resolve(t,e.slice(r)),u()}u()};var $i=eo;eo.realpath=eo,eo.sync=to,eo.realpathSync=to,eo.monkeypatch=function(){Gi.realpath=eo,Gi.realpathSync=to},eo.unmonkeypatch=function(){Gi.realpath=Ki,Gi.realpathSync=Ji};var zi,Vi,Gi=C.default,Ki=Gi.realpath,Ji=Gi.realpathSync,Yi=process.version,Xi=/^v[0-5]\./.test(Yi),Qi=ji;function Zi(e){return e&&"realpath"===e.syscall&&("ELOOP"===e.code||"ENOMEM"===e.code||"ENAMETOOLONG"===e.code)}function eo(e,t,n){if(Xi)return Ki(e,t,n);"function"==typeof t&&(n=t,t=null),Ki(e,t,(function(r,i){Zi(r)?Qi.realpath(e,t,n):n(r,i)}))}function to(e,t){if(Xi)return Ji(e,t);try{return Ji(e,t)}catch(n){if(Zi(n))return Qi.realpathSync(e,t);throw n}}function no(){if(Vi)return zi;Vi=1,zi=function(t,n){for(var r=[],i=0;i<t.length;i++){var o=n(t[i],i);e(o)?r.push.apply(r,o):r.push(o)}return r};var e=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};return zi}var ro,io,oo,so,ao=lo;function lo(e,t,n){e instanceof RegExp&&(e=co(e,n)),t instanceof RegExp&&(t=co(t,n));var r=uo(e,t,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+e.length,r[1]),post:n.slice(r[1]+t.length)}}function co(e,t){var n=t.match(e);return n?n[0]:null}function uo(e,t,n){var r,i,o,s,a,l=n.indexOf(e),c=n.indexOf(t,l+1),u=l;if(l>=0&&c>0){if(e===t)return[l,c];for(r=[],o=n.length;u>=0&&!a;)u==l?(r.push(u),l=n.indexOf(e,u+1)):1==r.length?a=[r.pop(),c]:((i=r.pop())<o&&(o=i,s=c),c=n.indexOf(t,u+1)),u=l<c&&l>=0?l:c;r.length&&(a=[o,s])}return a}function ho(){if(io)return ro;io=1;var e=no(),t=ao;ro=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return f(function(e){return e.split("\\\\").join(n).split("\\{").join(r).split("\\}").join(i).split("\\,").join(o).split("\\.").join(s)}(e),!0).map(l)};var n="\0SLASH"+Math.random()+"\0",r="\0OPEN"+Math.random()+"\0",i="\0CLOSE"+Math.random()+"\0",o="\0COMMA"+Math.random()+"\0",s="\0PERIOD"+Math.random()+"\0";function a(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function l(e){return e.split(n).join("\\").split(r).join("{").split(i).join("}").split(o).join(",").split(s).join(".")}function c(e){if(!e)return[""];var n=[],r=t("{","}",e);if(!r)return e.split(",");var i=r.pre,o=r.body,s=r.post,a=i.split(",");a[a.length-1]+="{"+o+"}";var l=c(s);return s.length&&(a[a.length-1]+=l.shift(),a.push.apply(a,l)),n.push.apply(n,a),n}function u(e){return"{"+e+"}"}function d(e){return/^-?0\d/.test(e)}function h(e,t){return e<=t}function p(e,t){return e>=t}function f(n,r){var o=[],s=t("{","}",n);if(!s||/\$$/.test(s.pre))return[n];var l,m=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(s.body),g=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(s.body),_=m||g,w=s.body.indexOf(",")>=0;if(!_&&!w)return s.post.match(/,.*\}/)?f(n=s.pre+"{"+s.body+i+s.post):[n];if(_)l=s.body.split(/\.\./);else if(1===(l=c(s.body)).length&&1===(l=f(l[0],!1).map(u)).length)return(y=s.post.length?f(s.post,!1):[""]).map((function(e){return s.pre+l[0]+e}));var v,b=s.pre,y=s.post.length?f(s.post,!1):[""];if(_){var S=a(l[0]),x=a(l[1]),k=Math.max(l[0].length,l[1].length),E=3==l.length?Math.abs(a(l[2])):1,C=h;x<S&&(E*=-1,C=p);var T=l.some(d);v=[];for(var P=S;C(P,x);P+=E){var O;if(g)"\\"===(O=String.fromCharCode(P))&&(O="");else if(O=String(P),T){var A=k-O.length;if(A>0){var I=new Array(A+1).join("0");O=P<0?"-"+I+O.slice(1):I+O}}v.push(O)}}else v=e(l,(function(e){return f(e,!1)}));for(var M=0;M<v.length;M++)for(var F=0;F<y.length;F++){var N=b+v[M]+y[F];(!r||_||N)&&o.push(N)}return o}return ro}function po(){if(so)return oo;so=1,oo=c,c.Minimatch=u;var e=function(){try{return require("path")}catch(e){}}()||{sep:"/"};c.sep=e.sep;var t=c.GLOBSTAR=u.GLOBSTAR={},n=ho(),r={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},i="[^/]",o="[^/]*?",s="().*{}+?[]^$\\!".split("").reduce((function(e,t){return e[t]=!0,e}),{});var a=/\/+/;function l(e,t){t=t||{};var n={};return Object.keys(e).forEach((function(t){n[t]=e[t]})),Object.keys(t).forEach((function(e){n[e]=t[e]})),n}function c(e,t,n){return h(t),n||(n={}),!(!n.nocomment&&"#"===t.charAt(0))&&new u(t,n).match(e)}function u(t,n){if(!(this instanceof u))return new u(t,n);h(t),n||(n={}),t=t.trim(),n.allowWindowsEscape||"/"===e.sep||(t=t.split(e.sep).join("/")),this.options=n,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!n.partial,this.make()}function d(e,t){return t||(t=this instanceof u?this.options:{}),e=void 0===e?this.pattern:e,h(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:n(e)}c.filter=function(e,t){return t=t||{},function(n,r,i){return c(n,e,t)}},c.defaults=function(e){if(!e||"object"!=typeof e||!Object.keys(e).length)return c;var t=c,n=function(n,r,i){return t(n,r,l(e,i))};return(n.Minimatch=function(n,r){return new t.Minimatch(n,l(e,r))}).defaults=function(n){return t.defaults(l(e,n)).Minimatch},n.filter=function(n,r){return t.filter(n,l(e,r))},n.defaults=function(n){return t.defaults(l(e,n))},n.makeRe=function(n,r){return t.makeRe(n,l(e,r))},n.braceExpand=function(n,r){return t.braceExpand(n,l(e,r))},n.match=function(n,r,i){return t.match(n,r,l(e,i))},n},u.defaults=function(e){return c.defaults(e).Minimatch},u.prototype.debug=function(){},u.prototype.make=function(){var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&(this.debug=function(){console.error.apply(console,arguments)});this.debug(this.pattern,n),n=this.globParts=n.map((function(e){return e.split(a)})),this.debug(this.pattern,n),n=n.map((function(e,t,n){return e.map(this.parse,this)}),this),this.debug(this.pattern,n),n=n.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,n),this.set=n},u.prototype.parseNegate=function(){var e=this.pattern,t=!1,n=this.options,r=0;if(n.nonegate)return;for(var i=0,o=e.length;i<o&&"!"===e.charAt(i);i++)t=!t,r++;r&&(this.pattern=e.substr(r));this.negate=t},c.braceExpand=function(e,t){return d(e,t)},u.prototype.braceExpand=d;var h=function(e){if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")};u.prototype.parse=function(e,n){h(e);var a=this.options;if("**"===e){if(!a.noglobstar)return t;e="*"}if(""===e)return"";var l,c="",u=!!a.nocase,d=!1,f=[],m=[],g=!1,_=-1,w=-1,v="."===e.charAt(0)?"":a.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",b=this;function y(){if(l){switch(l){case"*":c+=o,u=!0;break;case"?":c+=i,u=!0;break;default:c+="\\"+l}b.debug("clearStateChar %j %j",l,c),l=!1}}for(var S,x=0,k=e.length;x<k&&(S=e.charAt(x));x++)if(this.debug("%s\t%s %s %j",e,x,c,S),d&&s[S])c+="\\"+S,d=!1;else switch(S){case"/":return!1;case"\\":y(),d=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,x,c,S),g){this.debug("  in class"),"!"===S&&x===w+1&&(S="^"),c+=S;continue}b.debug("call clearStateChar %j",l),y(),l=S,a.noext&&y();continue;case"(":if(g){c+="(";continue}if(!l){c+="\\(";continue}f.push({type:l,start:x-1,reStart:c.length,open:r[l].open,close:r[l].close}),c+="!"===l?"(?:(?!(?:":"(?:",this.debug("plType %j %j",l,c),l=!1;continue;case")":if(g||!f.length){c+="\\)";continue}y(),u=!0;var E=f.pop();c+=E.close,"!"===E.type&&m.push(E),E.reEnd=c.length;continue;case"|":if(g||!f.length||d){c+="\\|",d=!1;continue}y(),c+="|";continue;case"[":if(y(),g){c+="\\"+S;continue}g=!0,w=x,_=c.length,c+=S;continue;case"]":if(x===w+1||!g){c+="\\"+S,d=!1;continue}var C=e.substring(w+1,x);try{RegExp("["+C+"]")}catch(e){var T=this.parse(C,p);c=c.substr(0,_)+"\\["+T[0]+"\\]",u=u||T[1],g=!1;continue}u=!0,g=!1,c+=S;continue;default:y(),d?d=!1:!s[S]||"^"===S&&g||(c+="\\"),c+=S}g&&(C=e.substr(w+1),T=this.parse(C,p),c=c.substr(0,_)+"\\["+T[0],u=u||T[1]);for(E=f.pop();E;E=f.pop()){var P=c.slice(E.reStart+E.open.length);this.debug("setting tail",c,E),P=P.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,n){return n||(n="\\"),t+t+n+"|"})),this.debug("tail=%j\n   %s",P,P,E,c);var O="*"===E.type?o:"?"===E.type?i:"\\"+E.type;u=!0,c=c.slice(0,E.reStart)+O+"\\("+P}y(),d&&(c+="\\\\");var A=!1;switch(c.charAt(0)){case"[":case".":case"(":A=!0}for(var I=m.length-1;I>-1;I--){var M=m[I],F=c.slice(0,M.reStart),N=c.slice(M.reStart,M.reEnd-8),R=c.slice(M.reEnd-8,M.reEnd),j=c.slice(M.reEnd);R+=j;var D=F.split("(").length-1,L=j;for(x=0;x<D;x++)L=L.replace(/\)[+*?]?/,"");var B="";""===(j=L)&&n!==p&&(B="$"),c=F+N+j+B+R}""!==c&&u&&(c="(?=.)"+c);A&&(c=v+c);if(n===p)return[c,u];if(!u)return function(e){return e.replace(/\\(.)/g,"$1")}(e);var H=a.nocase?"i":"";try{var q=new RegExp("^"+c+"$",H)}catch(e){return new RegExp("$.")}return q._glob=e,q._src=c,q};var p={};return c.makeRe=function(e,t){return new u(e,t||{}).makeRe()},u.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var n=this.options,r=n.noglobstar?o:n.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",i=n.nocase?"i":"",s=e.map((function(e){return e.map((function(e){return e===t?r:"string"==typeof e?function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(e):e._src})).join("\\/")})).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,i)}catch(e){this.regexp=!1}return this.regexp},c.match=function(e,t,n){var r=new u(t,n=n||{});return e=e.filter((function(e){return r.match(e)})),r.options.nonull&&!e.length&&e.push(t),e},u.prototype.match=function(t,n){if(void 0===n&&(n=this.partial),this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return""===t;if("/"===t&&n)return!0;var r=this.options;"/"!==e.sep&&(t=t.split(e.sep).join("/")),t=t.split(a),this.debug(this.pattern,"split",t);var i,o,s=this.set;for(this.debug(this.pattern,"set",s),o=t.length-1;o>=0&&!(i=t[o]);o--);for(o=0;o<s.length;o++){var l=s[o],c=t;if(r.matchBase&&1===l.length&&(c=[i]),this.matchOne(c,l,n))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate},u.prototype.matchOne=function(e,n,r){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:n}),this.debug("matchOne",e.length,n.length);for(var o=0,s=0,a=e.length,l=n.length;o<a&&s<l;o++,s++){this.debug("matchOne loop");var c,u=n[s],d=e[o];if(this.debug(n,u,d),!1===u)return!1;if(u===t){this.debug("GLOBSTAR",[n,u,d]);var h=o,p=s+1;if(p===l){for(this.debug("** at the end");o<a;o++)if("."===e[o]||".."===e[o]||!i.dot&&"."===e[o].charAt(0))return!1;return!0}for(;h<a;){var f=e[h];if(this.debug("\nglobstar while",e,h,n,p,f),this.matchOne(e.slice(h),n.slice(p),r))return this.debug("globstar found match!",h,a,f),!0;if("."===f||".."===f||!i.dot&&"."===f.charAt(0)){this.debug("dot detected!",e,h,n,p);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!r||(this.debug("\n>>> no match, partial?",e,h,n,p),h!==a))}if("string"==typeof u?(c=d===u,this.debug("string match",u,d,c)):(c=d.match(u),this.debug("pattern match",u,d,c)),!c)return!1}if(o===a&&s===l)return!0;if(o===a)return r;if(s===l)return o===a-1&&""===e[o];throw new Error("wtf?")},oo}lo.range=uo;var fo,mo={exports:{}},go={exports:{}};!function(e){try{var t=require("util");if("function"!=typeof t.inherits)throw"";e.exports=t.inherits}catch(t){e.exports=(fo||(fo=1,"function"==typeof Object.create?go.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:go.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),go.exports)}}(mo);var _o={exports:{}};function wo(e){return"/"===e.charAt(0)}function vo(e){var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(e),n=t[1]||"",r=Boolean(n&&":"!==n.charAt(1));return Boolean(t[2]||r)}_o.exports="win32"===process.platform?vo:wo,_o.exports.posix=wo,_o.exports.win32=vo;var bo,yo,So,xo={};function ko(){if(bo)return xo;function e(e,t){return Object.prototype.hasOwnProperty.call(e,t)}bo=1,xo.setopts=function(r,s,c){c||(c={});if(c.matchBase&&-1===s.indexOf("/")){if(c.noglobstar)throw new Error("base matching requires globstar");s="**/"+s}r.silent=!!c.silent,r.pattern=s,r.strict=!1!==c.strict,r.realpath=!!c.realpath,r.realpathCache=c.realpathCache||Object.create(null),r.follow=!!c.follow,r.dot=!!c.dot,r.mark=!!c.mark,r.nodir=!!c.nodir,r.nodir&&(r.mark=!0);r.sync=!!c.sync,r.nounique=!!c.nounique,r.nonull=!!c.nonull,r.nosort=!!c.nosort,r.nocase=!!c.nocase,r.stat=!!c.stat,r.noprocess=!!c.noprocess,r.absolute=!!c.absolute,r.fs=c.fs||t,r.maxLength=c.maxLength||1/0,r.cache=c.cache||Object.create(null),r.statCache=c.statCache||Object.create(null),r.symlinks=c.symlinks||Object.create(null),function(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]);e.ignore.length&&(e.ignore=e.ignore.map(a))}(r,c),r.changedCwd=!1;var u=process.cwd();e(c,"cwd")?(r.cwd=n.resolve(c.cwd),r.changedCwd=r.cwd!==u):r.cwd=u;r.root=c.root||n.resolve(r.cwd,"/"),r.root=n.resolve(r.root),"win32"===process.platform&&(r.root=r.root.replace(/\\/g,"/"));r.cwdAbs=i(r.cwd)?r.cwd:l(r,r.cwd),"win32"===process.platform&&(r.cwdAbs=r.cwdAbs.replace(/\\/g,"/"));r.nomount=!!c.nomount,c.nonegate=!0,c.nocomment=!0,r.minimatch=new o(s,c),r.options=r.minimatch.options},xo.ownProp=e,xo.makeAbs=l,xo.finish=function(e){for(var t=e.nounique,n=t?[]:Object.create(null),r=0,i=e.matches.length;r<i;r++){var o=e.matches[r];if(o&&0!==Object.keys(o).length){var a=Object.keys(o);t?n.push.apply(n,a):a.forEach((function(e){n[e]=!0}))}else if(e.nonull){var u=e.minimatch.globSet[r];t?n.push(u):n[u]=!0}}t||(n=Object.keys(n));e.nosort||(n=n.sort(s));if(e.mark){for(r=0;r<n.length;r++)n[r]=e._mark(n[r]);e.nodir&&(n=n.filter((function(t){var n=!/\/$/.test(t),r=e.cache[t]||e.cache[l(e,t)];return n&&r&&(n="DIR"!==r&&!Array.isArray(r)),n})))}e.ignore.length&&(n=n.filter((function(t){return!c(e,t)})));e.found=n},xo.mark=function(e,t){var n=l(e,t),r=e.cache[n],i=t;if(r){var o="DIR"===r||Array.isArray(r),s="/"===t.slice(-1);if(o&&!s?i+="/":!o&&s&&(i=i.slice(0,-1)),i!==t){var a=l(e,i);e.statCache[a]=e.statCache[n],e.cache[a]=e.cache[n]}}return i},xo.isIgnored=c,xo.childrenIgnored=function(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return!(!e.gmatcher||!e.gmatcher.match(t))}))};var t=C.default,n=T.default,r=po(),i=_o.exports,o=r.Minimatch;function s(e,t){return e.localeCompare(t,"en")}function a(e){var t=null;if("/**"===e.slice(-3)){var n=e.replace(/(\/\*\*)+$/,"");t=new o(n,{dot:!0})}return{matcher:new o(e,{dot:!0}),gmatcher:t}}function l(e,t){var r=t;return r="/"===t.charAt(0)?n.join(e.root,t):i(t)||""===t?t:e.changedCwd?n.resolve(e.cwd,t):n.resolve(t),"win32"===process.platform&&(r=r.replace(/\\/g,"/")),r}function c(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return e.matcher.match(t)||!(!e.gmatcher||!e.gmatcher.match(t))}))}return xo}var Eo=function e(t,n){if(t&&n)return e(t)(n);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){r[e]=t[e]})),r;function r(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];var r=t.apply(this,e),i=e[e.length-1];return"function"==typeof r&&r!==i&&Object.keys(i).forEach((function(e){r[e]=i[e]})),r}};var Co={exports:{}},To=Eo;function Po(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function Oo(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},n=e.name||"Function wrapped with `once`";return t.onceError=n+" shouldn't be called more than once",t.called=!1,t}Co.exports=To(Po),Co.exports.strict=To(Oo),Po.proto=Po((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return Po(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Oo(this)},configurable:!0})}));var Ao,Io,Mo=Eo,Fo=Object.create(null),No=Co.exports,Ro=Mo((function(e,t){return Fo[e]?(Fo[e].push(t),null):(Fo[e]=[t],function(e){return No((function t(){var n=Fo[e],r=n.length,i=jo(arguments);try{for(var o=0;o<r;o++)n[o].apply(null,i)}finally{n.length>r?(n.splice(0,r),process.nextTick((function(){t.apply(null,i)}))):delete Fo[e]}}))}(e))}));function jo(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r]=e[r];return n}function Do(){if(Io)return Ao;Io=1,Ao=m;var e=$i,t=po();t.Minimatch;var n=mo.exports,r=M.default.EventEmitter,i=T.default,o=F.default,s=_o.exports,a=function(){if(So)return yo;So=1,yo=u,u.GlobSync=d;var e=$i,t=po();t.Minimatch,Do().Glob;var n=T.default,r=F.default,i=_o.exports,o=ko(),s=o.setopts,a=o.ownProp,l=o.childrenIgnored,c=o.isIgnored;function u(e,t){if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new d(e,t).found}function d(e,t){if(!e)throw new Error("must provide pattern");if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof d))return new d(e,t);if(s(this,e,t),this.noprocess)return this;var n=this.minimatch.set.length;this.matches=new Array(n);for(var r=0;r<n;r++)this._process(this.minimatch.set[r],r,!1);this._finish()}return d.prototype._finish=function(){if(r(this instanceof d),this.realpath){var t=this;this.matches.forEach((function(n,r){var i=t.matches[r]=Object.create(null);for(var o in n)try{o=t._makeAbs(o),i[e.realpathSync(o,t.realpathCache)]=!0}catch(e){if("stat"!==e.syscall)throw e;i[t._makeAbs(o)]=!0}}))}o.finish(this)},d.prototype._process=function(e,n,o){r(this instanceof d);for(var s,a=0;"string"==typeof e[a];)a++;switch(a){case e.length:return void this._processSimple(e.join("/"),n);case 0:s=null;break;default:s=e.slice(0,a).join("/")}var c,u=e.slice(a);null===s?c=".":i(s)||i(e.join("/"))?(s&&i(s)||(s="/"+s),c=s):c=s;var h=this._makeAbs(c);l(this,c)||(u[0]===t.GLOBSTAR?this._processGlobStar(s,c,h,u,n,o):this._processReaddir(s,c,h,u,n,o))},d.prototype._processReaddir=function(e,t,r,i,o,s){var a=this._readdir(r,s);if(a){for(var l=i[0],c=!!this.minimatch.negate,u=l._glob,d=this.dot||"."===u.charAt(0),h=[],p=0;p<a.length;p++)("."!==(g=a[p]).charAt(0)||d)&&(c&&!e?!g.match(l):g.match(l))&&h.push(g);var f=h.length;if(0!==f)if(1!==i.length||this.mark||this.stat)for(i.shift(),p=0;p<f;p++){var m;g=h[p],m=e?[e,g]:[g],this._process(m.concat(i),o,s)}else{this.matches[o]||(this.matches[o]=Object.create(null));for(p=0;p<f;p++){var g=h[p];e&&(g="/"!==e.slice(-1)?e+"/"+g:e+g),"/"!==g.charAt(0)||this.nomount||(g=n.join(this.root,g)),this._emitMatch(o,g)}}}},d.prototype._emitMatch=function(e,t){if(!c(this,t)){var n=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=n),!this.matches[e][t]){if(this.nodir){var r=this.cache[n];if("DIR"===r||Array.isArray(r))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},d.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,n;try{n=this.fs.lstatSync(e)}catch(e){if("ENOENT"===e.code)return null}var r=n&&n.isSymbolicLink();return this.symlinks[e]=r,r||!n||n.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},d.prototype._readdir=function(e,t){if(t&&!a(this.symlinks,e))return this._readdirInGlobStar(e);if(a(this.cache,e)){var n=this.cache[e];if(!n||"FILE"===n)return null;if(Array.isArray(n))return n}try{return this._readdirEntries(e,this.fs.readdirSync(e))}catch(t){return this._readdirError(e,t),null}},d.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var n=0;n<t.length;n++){var r=t[n];r="/"===e?e+r:e+"/"+r,this.cache[r]=!0}return this.cache[e]=t,t},d.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(e);if(this.cache[n]="FILE",n===this.cwdAbs){var r=new Error(t.code+" invalid cwd "+this.cwd);throw r.path=this.cwd,r.code=t.code,r}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},d.prototype._processGlobStar=function(e,t,n,r,i,o){var s=this._readdir(n,o);if(s){var a=r.slice(1),l=e?[e]:[],c=l.concat(a);this._process(c,i,!1);var u=s.length;if(!this.symlinks[n]||!o)for(var d=0;d<u;d++)if("."!==s[d].charAt(0)||this.dot){var h=l.concat(s[d],a);this._process(h,i,!0);var p=l.concat(s[d],r);this._process(p,i,!0)}}},d.prototype._processSimple=function(e,t){var r=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),r){if(e&&i(e)&&!this.nomount){var o=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=n.join(this.root,e):(e=n.resolve(this.root,e),o&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}},d.prototype._stat=function(e){var t=this._makeAbs(e),n="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&a(this.cache,t)){var r=this.cache[t];if(Array.isArray(r)&&(r="DIR"),!n||"DIR"===r)return r;if(n&&"FILE"===r)return!1}var i=this.statCache[t];if(!i){var o;try{o=this.fs.lstatSync(t)}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return this.statCache[t]=!1,!1}if(o&&o.isSymbolicLink())try{i=this.fs.statSync(t)}catch(e){i=o}else i=o}return this.statCache[t]=i,r=!0,i&&(r=i.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||r,(!n||"FILE"!==r)&&r},d.prototype._mark=function(e){return o.mark(this,e)},d.prototype._makeAbs=function(e){return o.makeAbs(this,e)},yo}(),l=ko(),c=l.setopts,u=l.ownProp,d=Ro,h=l.childrenIgnored,p=l.isIgnored,f=Co.exports;function m(e,t,n){if("function"==typeof t&&(n=t,t={}),t||(t={}),t.sync){if(n)throw new TypeError("callback provided to sync glob");return a(e,t)}return new _(e,t,n)}m.sync=a;var g=m.GlobSync=a.GlobSync;function _(e,t,n){if("function"==typeof t&&(n=t,t=null),t&&t.sync){if(n)throw new TypeError("callback provided to sync glob");return new g(e,t)}if(!(this instanceof _))return new _(e,t,n);c(this,e,t),this._didRealPath=!1;var r=this.minimatch.set.length;this.matches=new Array(r),"function"==typeof n&&(n=f(n),this.on("error",n),this.on("end",(function(e){n(null,e)})));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===r)return s();for(var o=0;o<r;o++)this._process(this.minimatch.set[o],o,!1,s);function s(){--i._processing,i._processing<=0&&i._finish()}}return m.glob=m,m.hasMagic=function(e,t){var n=function(e,t){if(null===t||"object"!=typeof t)return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}({},t);n.noprocess=!0;var r=new _(e,n).minimatch.set;if(!e)return!1;if(r.length>1)return!0;for(var i=0;i<r[0].length;i++)if("string"!=typeof r[0][i])return!0;return!1},m.Glob=_,n(_,r),_.prototype._finish=function(){if(o(this instanceof _),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();l.finish(this),this.emit("end",this.found)}},_.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var t=this,n=0;n<this.matches.length;n++)this._realpathSet(n,r)}function r(){0==--e&&t._finish()}},_.prototype._realpathSet=function(t,n){var r=this.matches[t];if(!r)return n();var i=Object.keys(r),o=this,s=i.length;if(0===s)return n();var a=this.matches[t]=Object.create(null);i.forEach((function(r,i){r=o._makeAbs(r),e.realpath(r,o.realpathCache,(function(e,i){e?"stat"===e.syscall?a[r]=!0:o.emit("error",e):a[i]=!0,0==--s&&(o.matches[t]=a,n())}))}))},_.prototype._mark=function(e){return l.mark(this,e)},_.prototype._makeAbs=function(e){return l.makeAbs(this,e)},_.prototype.abort=function(){this.aborted=!0,this.emit("abort")},_.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},_.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var n=e[t];this._emitMatch(n[0],n[1])}}if(this._processQueue.length){var r=this._processQueue.slice(0);this._processQueue.length=0;for(t=0;t<r.length;t++){var i=r[t];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},_.prototype._process=function(e,n,r,i){if(o(this instanceof _),o("function"==typeof i),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([e,n,r,i]);else{for(var a,l=0;"string"==typeof e[l];)l++;switch(l){case e.length:return void this._processSimple(e.join("/"),n,i);case 0:a=null;break;default:a=e.slice(0,l).join("/")}var c,u=e.slice(l);null===a?c=".":s(a)||s(e.join("/"))?(a&&s(a)||(a="/"+a),c=a):c=a;var d=this._makeAbs(c);if(h(this,c))return i();u[0]===t.GLOBSTAR?this._processGlobStar(a,c,d,u,n,r,i):this._processReaddir(a,c,d,u,n,r,i)}},_.prototype._processReaddir=function(e,t,n,r,i,o,s){var a=this;this._readdir(n,o,(function(l,c){return a._processReaddir2(e,t,n,r,i,o,c,s)}))},_.prototype._processReaddir2=function(e,t,n,r,o,s,a,l){if(!a)return l();for(var c=r[0],u=!!this.minimatch.negate,d=c._glob,h=this.dot||"."===d.charAt(0),p=[],f=0;f<a.length;f++){if("."!==(g=a[f]).charAt(0)||h)(u&&!e?!g.match(c):g.match(c))&&p.push(g)}var m=p.length;if(0===m)return l();if(1===r.length&&!this.mark&&!this.stat){this.matches[o]||(this.matches[o]=Object.create(null));for(f=0;f<m;f++){var g=p[f];e&&(g="/"!==e?e+"/"+g:e+g),"/"!==g.charAt(0)||this.nomount||(g=i.join(this.root,g)),this._emitMatch(o,g)}return l()}r.shift();for(f=0;f<m;f++){g=p[f];e&&(g="/"!==e?e+"/"+g:e+g),this._process([g].concat(r),o,s,l)}l()},_.prototype._emitMatch=function(e,t){if(!this.aborted&&!p(this,t))if(this.paused)this._emitQueue.push([e,t]);else{var n=s(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=n),!this.matches[e][t]){if(this.nodir){var r=this.cache[n];if("DIR"===r||Array.isArray(r))return}this.matches[e][t]=!0;var i=this.statCache[n];i&&this.emit("stat",t,i),this.emit("match",t)}}},_.prototype._readdirInGlobStar=function(e,t){if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var n=this,r=d("lstat\0"+e,(function(r,i){if(r&&"ENOENT"===r.code)return t();var o=i&&i.isSymbolicLink();n.symlinks[e]=o,o||!i||i.isDirectory()?n._readdir(e,!1,t):(n.cache[e]="FILE",t())}));r&&n.fs.lstat(e,r)}},_.prototype._readdir=function(e,t,n){if(!this.aborted&&(n=d("readdir\0"+e+"\0"+t,n))){if(t&&!u(this.symlinks,e))return this._readdirInGlobStar(e,n);if(u(this.cache,e)){var r=this.cache[e];if(!r||"FILE"===r)return n();if(Array.isArray(r))return n(null,r)}this.fs.readdir(e,function(e,t,n){return function(r,i){r?e._readdirError(t,r,n):e._readdirEntries(t,i,n)}}(this,e,n))}},_.prototype._readdirEntries=function(e,t,n){if(!this.aborted){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var i=t[r];i="/"===e?e+i:e+"/"+i,this.cache[i]=!0}return this.cache[e]=t,n(null,t)}},_.prototype._readdirError=function(e,t,n){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var i=new Error(t.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=t.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return n()}},_.prototype._processGlobStar=function(e,t,n,r,i,o,s){var a=this;this._readdir(n,o,(function(l,c){a._processGlobStar2(e,t,n,r,i,o,c,s)}))},_.prototype._processGlobStar2=function(e,t,n,r,i,o,s,a){if(!s)return a();var l=r.slice(1),c=e?[e]:[],u=c.concat(l);this._process(u,i,!1,a);var d=this.symlinks[n],h=s.length;if(d&&o)return a();for(var p=0;p<h;p++){if("."!==s[p].charAt(0)||this.dot){var f=c.concat(s[p],l);this._process(f,i,!0,a);var m=c.concat(s[p],r);this._process(m,i,!0,a)}}a()},_.prototype._processSimple=function(e,t,n){var r=this;this._stat(e,(function(i,o){r._processSimple2(e,t,i,o,n)}))},_.prototype._processSimple2=function(e,t,n,r,o){if(this.matches[t]||(this.matches[t]=Object.create(null)),!r)return o();if(e&&s(e)&&!this.nomount){var a=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=i.join(this.root,e):(e=i.resolve(this.root,e),a&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),o()},_.prototype._stat=function(e,t){var n=this._makeAbs(e),r="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&u(this.cache,n)){var i=this.cache[n];if(Array.isArray(i)&&(i="DIR"),!r||"DIR"===i)return t(null,i);if(r&&"FILE"===i)return t()}var o=this.statCache[n];if(void 0!==o){if(!1===o)return t(null,o);var s=o.isDirectory()?"DIR":"FILE";return r&&"FILE"===s?t():t(null,s,o)}var a=this,l=d("stat\0"+n,(function(r,i){if(i&&i.isSymbolicLink())return a.fs.stat(n,(function(r,o){r?a._stat2(e,n,null,i,t):a._stat2(e,n,r,o,t)}));a._stat2(e,n,r,i,t)}));l&&a.fs.lstat(n,l)},_.prototype._stat2=function(e,t,n,r,i){if(n&&("ENOENT"===n.code||"ENOTDIR"===n.code))return this.statCache[t]=!1,i();var o="/"===e.slice(-1);if(this.statCache[t]=r,"/"===t.slice(-1)&&r&&!r.isDirectory())return i(null,!1,r);var s=!0;return r&&(s=r.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||s,o&&"FILE"===s?i():i(null,s,r)},Ao}const Lo=F.default,Bo=T.default,Ho=C.default;let qo;try{qo=Do()}catch(e){}const Uo={nosort:!0,silent:!0};let Wo=0;const $o="win32"===process.platform,zo=e=>{if(["unlink","chmod","stat","lstat","rmdir","readdir"].forEach((t=>{e[t]=e[t]||Ho[t],e[t+="Sync"]=e[t]||Ho[t]})),e.maxBusyTries=e.maxBusyTries||3,e.emfileWait=e.emfileWait||1e3,!1===e.glob&&(e.disableGlob=!0),!0!==e.disableGlob&&void 0===qo)throw Error("glob dependency not found, set `options.disableGlob = true` if intentional");e.disableGlob=e.disableGlob||!1,e.glob=e.glob||Uo},Vo=(e,t,n)=>{"function"==typeof t&&(n=t,t={}),Lo(e,"rimraf: missing path"),Lo.equal(typeof e,"string","rimraf: path should be a string"),Lo.equal(typeof n,"function","rimraf: callback function required"),Lo(t,"rimraf: invalid options argument provided"),Lo.equal(typeof t,"object","rimraf: options should be object"),zo(t);let r=0,i=null,o=0;const s=(e,s)=>e?n(e):(o=s.length,0===o?n():void s.forEach((e=>{const s=a=>{if(a){if(("EBUSY"===a.code||"ENOTEMPTY"===a.code||"EPERM"===a.code)&&r<t.maxBusyTries)return r++,setTimeout((()=>Go(e,t,s)),100*r);if("EMFILE"===a.code&&Wo<t.emfileWait)return setTimeout((()=>Go(e,t,s)),Wo++);"ENOENT"===a.code&&(a=null)}Wo=0,(e=>{i=i||e,0==--o&&n(i)})(a)};Go(e,t,s)})));if(t.disableGlob||!qo.hasMagic(e))return s(null,[e]);t.lstat(e,((n,r)=>{if(!n)return s(null,[e]);qo(e,t.glob,s)}))},Go=(e,t,n)=>{Lo(e),Lo(t),Lo("function"==typeof n),t.lstat(e,((r,i)=>r&&"ENOENT"===r.code?n(null):(r&&"EPERM"===r.code&&$o&&Ko(e,t,r,n),i&&i.isDirectory()?Yo(e,t,r,n):void t.unlink(e,(r=>{if(r){if("ENOENT"===r.code)return n(null);if("EPERM"===r.code)return $o?Ko(e,t,r,n):Yo(e,t,r,n);if("EISDIR"===r.code)return Yo(e,t,r,n)}return n(r)})))))},Ko=(e,t,n,r)=>{Lo(e),Lo(t),Lo("function"==typeof r),t.chmod(e,438,(i=>{i?r("ENOENT"===i.code?null:n):t.stat(e,((i,o)=>{i?r("ENOENT"===i.code?null:n):o.isDirectory()?Yo(e,t,n,r):t.unlink(e,r)}))}))},Jo=(e,t,n)=>{Lo(e),Lo(t);try{t.chmodSync(e,438)}catch(e){if("ENOENT"===e.code)return;throw n}let r;try{r=t.statSync(e)}catch(e){if("ENOENT"===e.code)return;throw n}r.isDirectory()?Zo(e,t,n):t.unlinkSync(e)},Yo=(e,t,n,r)=>{Lo(e),Lo(t),Lo("function"==typeof r),t.rmdir(e,(i=>{!i||"ENOTEMPTY"!==i.code&&"EEXIST"!==i.code&&"EPERM"!==i.code?i&&"ENOTDIR"===i.code?r(n):r(i):Xo(e,t,r)}))},Xo=(e,t,n)=>{Lo(e),Lo(t),Lo("function"==typeof n),t.readdir(e,((r,i)=>{if(r)return n(r);let o,s=i.length;if(0===s)return t.rmdir(e,n);i.forEach((r=>{Vo(Bo.join(e,r),t,(r=>{if(!o)return r?n(o=r):void(0==--s&&t.rmdir(e,n))}))}))}))},Qo=(e,t)=>{let n;if(zo(t=t||{}),Lo(e,"rimraf: missing path"),Lo.equal(typeof e,"string","rimraf: path should be a string"),Lo(t,"rimraf: missing options"),Lo.equal(typeof t,"object","rimraf: options should be object"),t.disableGlob||!qo.hasMagic(e))n=[e];else try{t.lstatSync(e),n=[e]}catch(r){n=qo.sync(e,t.glob)}if(n.length)for(let e=0;e<n.length;e++){const r=n[e];let i;try{i=t.lstatSync(r)}catch(e){if("ENOENT"===e.code)return;"EPERM"===e.code&&$o&&Jo(r,t,e)}try{i&&i.isDirectory()?Zo(r,t,null):t.unlinkSync(r)}catch(e){if("ENOENT"===e.code)return;if("EPERM"===e.code)return $o?Jo(r,t,e):Zo(r,t,e);if("EISDIR"!==e.code)throw e;Zo(r,t,e)}}},Zo=(e,t,n)=>{Lo(e),Lo(t);try{t.rmdirSync(e)}catch(r){if("ENOENT"===r.code)return;if("ENOTDIR"===r.code)throw n;"ENOTEMPTY"!==r.code&&"EEXIST"!==r.code&&"EPERM"!==r.code||es(e,t)}},es=(e,t)=>{Lo(e),Lo(t),t.readdirSync(e).forEach((n=>Qo(Bo.join(e,n),t)));const n=$o?100:1;let r=0;for(;;){let i=!0;try{const o=t.rmdirSync(e,t);return i=!1,o}finally{if(++r<n&&i)continue}}};var ts=Vo;Vo.sync=Qo,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.canAccessFile=function(e){if(!e)return!1;try{return ns.default.accessSync(e),!0}catch(e){return!1}},Ri.existsAsync=void 0,Ri.mkdirIfNeeded=async function(e){await ns.default.promises.mkdir(rs.default.dirname(e),{recursive:!0}).catch((()=>{}))},Ri.removeFolders=async function(e){return await Promise.all(e.map((e=>new Promise((t=>{(0,is.default)(e,{maxBusyTries:10},(e=>{t(null!=e?e:void 0)}))})))))};var ns=os(C.default),rs=os(T.default),is=os(ts);function os(e){return e&&e.__esModule?e:{default:e}}Ri.existsAsync=e=>new Promise((t=>ns.default.stat(e,(e=>t(!e)))));var ss={};Object.defineProperty(ss,"__esModule",{value:!0}),ss.hostPlatform=void 0;var as=function(e){return e&&e.__esModule?e:{default:e}}(E.default),ls=Kn;const cs=(()=>{const e=as.default.platform();if("darwin"===e){const e=as.default.release().split(".").map((e=>parseInt(e,10)));let t="";if(e[0]<18)t="mac10.13";else if(18===e[0])t="mac10.14";else if(19===e[0])t="mac10.15";else{const n=12;t="mac"+Math.min(e[0]-9,n),as.default.cpus().some((e=>e.model.includes("Apple")))&&(t+="-arm64")}return t}if("linux"===e){const e="arm64"===as.default.arch()?"-arm64":"",t=(0,ls.getUbuntuVersionSync)();return t?parseInt(t,10)<=19?"ubuntu18.04"+e:"ubuntu20.04"+e:"generic-linux"+e}return"win32"===e?"win64":"<unknown>"})();ss.hostPlatform=cs;var us={};Object.defineProperty(us,"__esModule",{value:!0}),us.spawnAsync=function(e,t,n={}){const r=(0,ds.spawn)(e,t,Object.assign({windowsHide:!0},n));return new Promise((e=>{let t="",n="";r.stdout&&r.stdout.on("data",(e=>t+=e)),r.stderr&&r.stderr.on("data",(e=>n+=e)),r.on("close",(r=>e({stdout:t,stderr:n,code:r}))),r.on("error",(r=>e({stdout:t,stderr:n,code:0,error:r})))}))};var ds=j.default;var hs={},ps={};Object.defineProperty(ps,"__esModule",{value:!0}),ps.deps=void 0;const fs={"ubuntu18.04":{tools:["xvfb","fonts-noto-color-emoji","ttf-unifont","libfontconfig","libfreetype6","xfonts-cyrillic","xfonts-scalable","fonts-liberation","fonts-ipafont-gothic","fonts-wqy-zenhei","fonts-tlwg-loma-otf","ttf-ubuntu-font-family"],chromium:["fonts-liberation","libasound2","libatk-bridge2.0-0","libatk1.0-0","libatspi2.0-0","libcairo2","libcups2","libdbus-1-3","libdrm2","libegl1","libgbm1","libglib2.0-0","libgtk-3-0","libnspr4","libnss3","libpango-1.0-0","libx11-6","libx11-xcb1","libxcb1","libxcomposite1","libxdamage1","libxext6","libxfixes3","libxrandr2","libxshmfence1"],firefox:["ffmpeg","libatk1.0-0","libcairo-gobject2","libcairo2","libdbus-1-3","libdbus-glib-1-2","libfontconfig1","libfreetype6","libgdk-pixbuf2.0-0","libglib2.0-0","libgtk-3-0","libpango-1.0-0","libpangocairo-1.0-0","libpangoft2-1.0-0","libx11-6","libx11-xcb1","libxcb-shm0","libxcb1","libxcomposite1","libxcursor1","libxdamage1","libxext6","libxfixes3","libxi6","libxrender1","libxt6","libxtst6"],webkit:["gstreamer1.0-libav","gstreamer1.0-plugins-bad","gstreamer1.0-plugins-base","gstreamer1.0-plugins-good","libatk-bridge2.0-0","libatk1.0-0","libbrotli1","libcairo2","libegl1","libenchant1c2a","libepoxy0","libevdev2","libfontconfig1","libfreetype6","libgdk-pixbuf2.0-0","libgl1","libgles2","libglib2.0-0","libgstreamer-gl1.0-0","libgstreamer1.0-0","libgtk-3-0","libharfbuzz-icu0","libharfbuzz0b","libhyphen0","libicu60","libjpeg-turbo8","libnotify4","libopenjp2-7","libopus0","libpango-1.0-0","libpng16-16","libsecret-1-0","libvpx5","libwayland-client0","libwayland-egl1","libwayland-server0","libwebp6","libwebpdemux2","libwoff1","libx11-6","libxcomposite1","libxdamage1","libxkbcommon0","libxml2","libxslt1.1"],lib2package:{"libasound.so.2":"libasound2","libatk-1.0.so.0":"libatk1.0-0","libatk-bridge-2.0.so.0":"libatk-bridge2.0-0","libatspi.so.0":"libatspi2.0-0","libbrotlidec.so.1":"libbrotli1","libcairo-gobject.so.2":"libcairo-gobject2","libcairo.so.2":"libcairo2","libcups.so.2":"libcups2","libdbus-1.so.3":"libdbus-1-3","libdbus-glib-1.so.2":"libdbus-glib-1-2","libdrm.so.2":"libdrm2","libEGL.so.1":"libegl1","libenchant.so.1":"libenchant1c2a","libepoxy.so.0":"libepoxy0","libevent-2.1.so.6":"libevent-2.1-6","libevdev.so.2":"libevdev2","libfontconfig.so.1":"libfontconfig1","libfreetype.so.6":"libfreetype6","libgbm.so.1":"libgbm1","libgdk_pixbuf-2.0.so.0":"libgdk-pixbuf2.0-0","libgdk-3.so.0":"libgtk-3-0","libgdk-x11-2.0.so.0":"libgtk2.0-0","libgio-2.0.so.0":"libglib2.0-0","libGL.so.1":"libgl1","libGLESv2.so.2":"libgles2","libglib-2.0.so.0":"libglib2.0-0","libgmodule-2.0.so.0":"libglib2.0-0","libgobject-2.0.so.0":"libglib2.0-0","libgstapp-1.0.so.0":"gstreamer1.0-plugins-base","libgstaudio-1.0.so.0":"gstreamer1.0-plugins-base","libgstbase-1.0.so.0":"libgstreamer1.0-0","libgstcodecparsers-1.0.so.0":"gstreamer1.0-plugins-bad","libgstfft-1.0.so.0":"gstreamer1.0-plugins-base","libgstgl-1.0.so.0":"libgstreamer-gl1.0-0","libgstpbutils-1.0.so.0":"gstreamer1.0-plugins-base","libgstreamer-1.0.so.0":"libgstreamer1.0-0","libgsttag-1.0.so.0":"gstreamer1.0-plugins-base","libgstvideo-1.0.so.0":"gstreamer1.0-plugins-base","libgthread-2.0.so.0":"libglib2.0-0","libgtk-3.so.0":"libgtk-3-0","libgtk-x11-2.0.so.0":"libgtk2.0-0","libharfbuzz-icu.so.0":"libharfbuzz-icu0","libharfbuzz.so.0":"libharfbuzz0b","libhyphen.so.0":"libhyphen0","libicudata.so.60":"libicu60","libicui18n.so.60":"libicu60","libicuuc.so.60":"libicu60","libjpeg.so.8":"libjpeg-turbo8","libnotify.so.4":"libnotify4","libnspr4.so":"libnspr4","libnss3.so":"libnss3","libnssutil3.so":"libnss3","libopenjp2.so.7":"libopenjp2-7","libopus.so.0":"libopus0","libpango-1.0.so.0":"libpango-1.0-0","libpangocairo-1.0.so.0":"libpangocairo-1.0-0","libpangoft2-1.0.so.0":"libpangoft2-1.0-0","libpng16.so.16":"libpng16-16","libsecret-1.so.0":"libsecret-1-0","libsmime3.so":"libnss3","libvpx.so.5":"libvpx5","libwayland-client.so.0":"libwayland-client0","libwayland-egl.so.1":"libwayland-egl1","libwayland-server.so.0":"libwayland-server0","libwebp.so.6":"libwebp6","libwebpdemux.so.2":"libwebpdemux2","libwoff2dec.so.1.0.2":"libwoff1","libX11-xcb.so.1":"libx11-xcb1","libX11.so.6":"libx11-6","libxcb-dri3.so.0":"libxcb-dri3-0","libxcb-shm.so.0":"libxcb-shm0","libxcb.so.1":"libxcb1","libXcomposite.so.1":"libxcomposite1","libXcursor.so.1":"libxcursor1","libXdamage.so.1":"libxdamage1","libXext.so.6":"libxext6","libXfixes.so.3":"libxfixes3","libXi.so.6":"libxi6","libxkbcommon.so.0":"libxkbcommon0","libxml2.so.2":"libxml2","libXrandr.so.2":"libxrandr2","libXrender.so.1":"libxrender1","libxslt.so.1":"libxslt1.1","libXt.so.6":"libxt6","libXtst.so.6":"libxtst6"}},"ubuntu20.04":{tools:["xvfb","fonts-noto-color-emoji","ttf-unifont","libfontconfig","libfreetype6","xfonts-cyrillic","xfonts-scalable","fonts-liberation","fonts-ipafont-gothic","fonts-wqy-zenhei","fonts-tlwg-loma-otf","ttf-ubuntu-font-family"],chromium:["fonts-liberation","libasound2","libatk-bridge2.0-0","libatk1.0-0","libatspi2.0-0","libcairo2","libcups2","libdbus-1-3","libdrm2","libegl1","libgbm1","libglib2.0-0","libgtk-3-0","libnspr4","libnss3","libpango-1.0-0","libx11-6","libx11-xcb1","libxcb1","libxcomposite1","libxdamage1","libxext6","libxfixes3","libxrandr2","libxshmfence1"],firefox:["ffmpeg","libatk1.0-0","libcairo-gobject2","libcairo2","libdbus-1-3","libdbus-glib-1-2","libfontconfig1","libfreetype6","libgdk-pixbuf2.0-0","libglib2.0-0","libgtk-3-0","libpango-1.0-0","libpangocairo-1.0-0","libpangoft2-1.0-0","libx11-6","libx11-xcb1","libxcb-shm0","libxcb1","libxcomposite1","libxcursor1","libxdamage1","libxext6","libxfixes3","libxi6","libxrender1","libxt6","libxtst6"],webkit:["gstreamer1.0-libav","gstreamer1.0-plugins-bad","gstreamer1.0-plugins-base","gstreamer1.0-plugins-good","libatk-bridge2.0-0","libatk1.0-0","libcairo2","libegl1","libenchant1c2a","libepoxy0","libevdev2","libfontconfig1","libfreetype6","libgdk-pixbuf2.0-0","libgl1","libgles2","libglib2.0-0","libgstreamer-gl1.0-0","libgstreamer1.0-0","libgtk-3-0","libharfbuzz-icu0","libharfbuzz0b","libhyphen0","libicu66","libjpeg-turbo8","libnotify4","libopengl0","libopenjp2-7","libopus0","libpango-1.0-0","libpng16-16","libsecret-1-0","libsoup2.4-1","libvpx6","libwayland-client0","libwayland-egl1","libwayland-server0","libwebp6","libwebpdemux2","libwoff1","libx11-6","libxcomposite1","libxdamage1","libxkbcommon0","libxml2","libxslt1.1"],lib2package:{"libasound.so.2":"libasound2","libatk-1.0.so.0":"libatk1.0-0","libatk-bridge-2.0.so.0":"libatk-bridge2.0-0","libatspi.so.0":"libatspi2.0-0","libcairo-gobject.so.2":"libcairo-gobject2","libcairo.so.2":"libcairo2","libcups.so.2":"libcups2","libdbus-1.so.3":"libdbus-1-3","libdbus-glib-1.so.2":"libdbus-glib-1-2","libdrm.so.2":"libdrm2","libEGL.so.1":"libegl1","libenchant.so.1":"libenchant1c2a","libevdev.so.2":"libevdev2","libepoxy.so.0":"libepoxy0","libfontconfig.so.1":"libfontconfig1","libfreetype.so.6":"libfreetype6","libgbm.so.1":"libgbm1","libgdk_pixbuf-2.0.so.0":"libgdk-pixbuf2.0-0","libgdk-3.so.0":"libgtk-3-0","libgdk-x11-2.0.so.0":"libgtk2.0-0","libgio-2.0.so.0":"libglib2.0-0","libGL.so.1":"libgl1","libGLESv2.so.2":"libgles2","libglib-2.0.so.0":"libglib2.0-0","libgmodule-2.0.so.0":"libglib2.0-0","libgobject-2.0.so.0":"libglib2.0-0","libgstapp-1.0.so.0":"gstreamer1.0-plugins-base","libgstaudio-1.0.so.0":"gstreamer1.0-plugins-base","libgstbase-1.0.so.0":"libgstreamer1.0-0","libgstcodecparsers-1.0.so.0":"gstreamer1.0-plugins-bad","libgstfft-1.0.so.0":"gstreamer1.0-plugins-base","libgstgl-1.0.so.0":"libgstreamer-gl1.0-0","libgstpbutils-1.0.so.0":"gstreamer1.0-plugins-base","libgstreamer-1.0.so.0":"libgstreamer1.0-0","libgsttag-1.0.so.0":"gstreamer1.0-plugins-base","libgstvideo-1.0.so.0":"gstreamer1.0-plugins-base","libgthread-2.0.so.0":"libglib2.0-0","libgtk-3.so.0":"libgtk-3-0","libgtk-x11-2.0.so.0":"libgtk2.0-0","libharfbuzz-icu.so.0":"libharfbuzz-icu0","libharfbuzz.so.0":"libharfbuzz0b","libhyphen.so.0":"libhyphen0","libicui18n.so.66":"libicu66","libicuuc.so.66":"libicu66","libjpeg.so.8":"libjpeg-turbo8","libnotify.so.4":"libnotify4","libnspr4.so":"libnspr4","libnss3.so":"libnss3","libnssutil3.so":"libnss3","libOpenGL.so.0":"libopengl0","libopenjp2.so.7":"libopenjp2-7","libopus.so.0":"libopus0","libpango-1.0.so.0":"libpango-1.0-0","libpangocairo-1.0.so.0":"libpangocairo-1.0-0","libpangoft2-1.0.so.0":"libpangoft2-1.0-0","libpng16.so.16":"libpng16-16","libsecret-1.so.0":"libsecret-1-0","libsmime3.so":"libnss3","libsoup-2.4.so.1":"libsoup2.4-1","libvpx.so.6":"libvpx6","libwayland-client.so.0":"libwayland-client0","libwayland-egl.so.1":"libwayland-egl1","libwayland-server.so.0":"libwayland-server0","libwebp.so.6":"libwebp6","libwebpdemux.so.2":"libwebpdemux2","libwoff2dec.so.1.0.2":"libwoff1","libX11-xcb.so.1":"libx11-xcb1","libX11.so.6":"libx11-6","libxcb-dri3.so.0":"libxcb-dri3-0","libxcb-shm.so.0":"libxcb-shm0","libxcb.so.1":"libxcb1","libXcomposite.so.1":"libxcomposite1","libXcursor.so.1":"libxcursor1","libXdamage.so.1":"libxdamage1","libXext.so.6":"libxext6","libXfixes.so.3":"libxfixes3","libXi.so.6":"libxi6","libxkbcommon.so.0":"libxkbcommon0","libxml2.so.2":"libxml2","libXrandr.so.2":"libxrandr2","libXrender.so.1":"libxrender1","libxslt.so.1":"libxslt1.1","libXt.so.6":"libxt6","libXtst.so.6":"libxtst6","libxshmfence.so.1":"libxshmfence1"}},"ubuntu21.04":{tools:["xvfb","fonts-noto-color-emoji","ttf-unifont","libfontconfig","libfreetype6","xfonts-cyrillic","xfonts-scalable","fonts-liberation","fonts-ipafont-gothic","fonts-wqy-zenhei","fonts-tlwg-loma-otf","ttf-ubuntu-font-family"],chromium:["libasound2","libatk-bridge2.0-0","libatk1.0-0","libatspi2.0-0","libcairo2","libcups2","libdbus-1-3","libdrm2","libgbm1","libglib2.0-0","libnspr4","libnss3","libpango-1.0-0","libx11-6","libxcb1","libxcomposite1","libxdamage1","libxext6","libxfixes3","libxkbcommon0","libxrandr2","libxshmfence1"],firefox:["ffmpeg","libatk1.0-0","libcairo-gobject2","libcairo2","libdbus-1-3","libdbus-glib-1-2","libfontconfig1","libfreetype6","libgdk-pixbuf-2.0-0","libglib2.0-0","libgtk-3-0","libgtk2.0-0","libharfbuzz0b","libpango-1.0-0","libpangocairo-1.0-0","libpangoft2-1.0-0","libx11-6","libx11-xcb1","libxcb-shm0","libxcb1","libxcomposite1","libxcursor1","libxdamage1","libxext6","libxfixes3","libxi6","libxrender1","libxt6"],webkit:["gstreamer1.0-libav","gstreamer1.0-plugins-bad","gstreamer1.0-plugins-base","gstreamer1.0-plugins-good","libatk-bridge2.0-0","libatk1.0-0","libcairo2","libegl1","libepoxy0","libevdev2","libfontconfig1","libfreetype6","libgdk-pixbuf-2.0-0","libgl1","libgles2","libglib2.0-0","libgstreamer-gl1.0-0","libgstreamer-plugins-bad1.0-0","libgstreamer-plugins-base1.0-0","libgstreamer1.0-0","libgtk-3-0","libharfbuzz-icu0","libharfbuzz0b","libhyphen0","libjavascriptcoregtk-4.0-18","libjpeg-turbo8","liblcms2-2","libnotify4","libopenjp2-7","libopus0","libpango-1.0-0","libpng16-16","libsecret-1-0","libsoup2.4-1","libvpx6","libwayland-client0","libwayland-egl1","libwayland-server0","libwebkit2gtk-4.0-37","libwebp6","libwebpdemux2","libwoff1","libwpe-1.0-1","libwpebackend-fdo-1.0-1","libwpewebkit-1.0-3","libx11-6","libxcomposite1","libxdamage1","libxkbcommon0","libxml2","libxslt1.1"],lib2package:{"libasound.so.2":"libasound2","libatk-1.0.so.0":"libatk1.0-0","libatk-bridge-2.0.so.0":"libatk-bridge2.0-0","libatspi.so.0":"libatspi2.0-0","libcairo-gobject.so.2":"libcairo-gobject2","libcairo.so.2":"libcairo2","libcups.so.2":"libcups2","libdbus-1.so.3":"libdbus-1-3","libdbus-glib-1.so.2":"libdbus-glib-1-2","libdrm.so.2":"libdrm2","libEGL.so.1":"libegl1","libepoxy.so.0":"libepoxy0","libfontconfig.so.1":"libfontconfig1","libfreetype.so.6":"libfreetype6","libgbm.so.1":"libgbm1","libgdk_pixbuf-2.0.so.0":"libgdk-pixbuf-2.0-0","libgdk-3.so.0":"libgtk-3-0","libgdk-x11-2.0.so.0":"libgtk2.0-0","libgio-2.0.so.0":"libglib2.0-0","libGL.so.1":"libgl1","libGLESv2.so.2":"libgles2","libglib-2.0.so.0":"libglib2.0-0","libgmodule-2.0.so.0":"libglib2.0-0","libgobject-2.0.so.0":"libglib2.0-0","libgstapp-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstaudio-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstbase-1.0.so.0":"libgstreamer1.0-0","libgstcodecparsers-1.0.so.0":"libgstreamer-plugins-bad1.0-0","libgstfft-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstgl-1.0.so.0":"libgstreamer-gl1.0-0","libgstpbutils-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstreamer-1.0.so.0":"libgstreamer1.0-0","libgsttag-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstvideo-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgthread-2.0.so.0":"libglib2.0-0","libgtk-3.so.0":"libgtk-3-0","libgtk-x11-2.0.so.0":"libgtk2.0-0","libharfbuzz-icu.so.0":"libharfbuzz-icu0","libharfbuzz.so.0":"libharfbuzz0b","libhyphen.so.0":"libhyphen0","libjavascriptcoregtk-4.0.so.18":"libjavascriptcoregtk-4.0-18","libjpeg.so.8":"libjpeg-turbo8","liblcms2.so.2":"liblcms2-2","libnotify.so.4":"libnotify4","libnspr4.so":"libnspr4","libnss3.so":"libnss3","libnssutil3.so":"libnss3","libopenjp2.so.7":"libopenjp2-7","libopus.so.0":"libopus0","libpango-1.0.so.0":"libpango-1.0-0","libpangocairo-1.0.so.0":"libpangocairo-1.0-0","libpangoft2-1.0.so.0":"libpangoft2-1.0-0","libpng16.so.16":"libpng16-16","libsecret-1.so.0":"libsecret-1-0","libsmime3.so":"libnss3","libsoup-2.4.so.1":"libsoup2.4-1","libvpx.so.6":"libvpx6","libwayland-client.so.0":"libwayland-client0","libwayland-egl.so.1":"libwayland-egl1","libwayland-server.so.0":"libwayland-server0","libwebkit2gtk-4.0.so.37":"libwebkit2gtk-4.0-37","libwebp.so.6":"libwebp6","libwebpdemux.so.2":"libwebpdemux2","libwoff2dec.so.1.0.2":"libwoff1","libwpe-1.0.so.1":"libwpe-1.0-1","libWPEBackend-fdo-1.0.so.1":"libwpebackend-fdo-1.0-1","libWPEWebKit-1.0.so.3":"libwpewebkit-1.0-3","libX11-xcb.so.1":"libx11-xcb1","libX11.so.6":"libx11-6","libxcb-shm.so.0":"libxcb-shm0","libxcb.so.1":"libxcb1","libXcomposite.so.1":"libxcomposite1","libXcursor.so.1":"libxcursor1","libXdamage.so.1":"libxdamage1","libXext.so.6":"libxext6","libXfixes.so.3":"libxfixes3","libXi.so.6":"libxi6","libxkbcommon.so.0":"libxkbcommon0","libxml2.so.2":"libxml2","libXrandr.so.2":"libxrandr2","libXrender.so.1":"libxrender1","libxshmfence.so.1":"libxshmfence1","libxslt.so.1":"libxslt1.1","libXt.so.6":"libxt6"}}};var ms;function gs(){if(ms)return hs;ms=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.installDependenciesLinux=async function(e,t){const n=[];for(const t of e){const e=l.deps[s.hostPlatform];if(!e)return void console.warn("Cannot install dependencies for this linux distribution!");n.push(...e[t])}const i=Array.from(new Set(n));t||console.log("Installing Ubuntu dependencies...");const o=[];o.push("apt-get update"),o.push(["apt-get","install","-y","--no-install-recommends",...i].join(" "));const{command:a,args:c,elevatedPermissions:u}=await v(o);if(t)return void console.log(`${a} ${w(c).join(" ")}`);u&&console.log("Switching to root user to install dependencies...");const d=r.default.spawn(a,c,{stdio:"inherit"});await new Promise(((e,t)=>{d.on("exit",(n=>0===n?e():t(new Error(`Installation process exited with code: ${n}`)))),d.on("error",t)}))},hs.installDependenciesWindows=async function(e,n){if(e.has("chromium")){const e="powershell.exe",r=["-ExecutionPolicy","Bypass","-File",t.default.join(p,"install_media_pack.ps1")];if(n)return void console.log(`${e} ${w(r).join(" ")}`);const{code:i}=await(0,o.spawnAsync)(e,r,{cwd:p,stdio:"inherit"});if(0!==i)throw new Error("Failed to install windows dependencies!")}},hs.transformCommandsForRoot=v,hs.validateDependenciesLinux=async function(r,u,d){var h;const p=u,f=[];for(const e of p)f.push(...await g(e));const w=await Promise.all(f.map((e=>async function(e,n){const r=t.default.dirname(e);let i=n.join(":");process.env.LD_LIBRARY_PATH&&(i=`${process.env.LD_LIBRARY_PATH}:${i}`);const{stdout:s,code:a}=await(0,o.spawnAsync)("ldd",[e],{cwd:r,env:{...process.env,LD_LIBRARY_PATH:i}});if(0!==a)return[];return s.split("\n").map((e=>e.trim())).filter((e=>e.endsWith("not found")&&e.includes("=>"))).map((e=>e.split("=>")[0].trim()))}(e,p)))),v=new Set;for(const e of w)for(const t of e)v.add(t);for(const e of await async function(e){if(!e.length)return[];const{stdout:t,code:n,error:r}=await(0,o.spawnAsync)("/sbin/ldconfig",["-p"],{});if(0!==n||r)return[];const i=e=>t.toLowerCase().includes(e.toLowerCase());return e.filter((e=>!i(e)))}(d))v.add(e);if(!v.size)return;const b=new Set(v),y=new Set,S={...(null===(h=l.deps[s.hostPlatform])||void 0===h?void 0:h.lib2package)||{},..._};for(const e of v){const t=S[e];t&&(y.add(t),v.delete(e))}const x=0!==process.getuid()&&"win32"!==n.platform()?"sudo ":"",k=await async function(){return await e.default.promises.readFile(m,"utf8").then((e=>JSON.parse(e))).catch((e=>null))}(),E=["Host system is missing dependencies to run browsers."];if(k&&!k.driverVersion.startsWith((0,c.getPlaywrightVersion)(!0)+".")){const e=(0,c.getPlaywrightVersion)(),t=k.dockerImageName.replace(k.driverVersion,e);E.push("This is most likely due to docker image version not matching Playwright version:",`- Playwright: ${e}`,`-     Docker: ${k.driverVersion}`,"","Either:",`- (recommended) use docker image "${t}"`,"- (alternative 1) run the following command inside docker to install missing dependencies:","",`    ${x}${(0,a.buildPlaywrightCLICommand)(r,"install-deps")}`,"","- (alternative 2) use Aptitude inside docker:","",`    ${x}apt-get install ${[...y].join("\\\n        ")}`,"","<3 Playwright Team")}else y.size&&!v.size?E.push("Please install them with the following command:","",`    ${x}${(0,a.buildPlaywrightCLICommand)(r,"install-deps")}`,"","Alternatively, use Aptitude:",`    ${x}apt-get install ${[...y].join("\\\n        ")}`,"","<3 Playwright Team"):E.push("Missing libraries:",...[...b].map((e=>"    "+e)));throw new Error("\n"+i.wrapInASCIIBox(E.join("\n"),1))},hs.validateDependenciesWindows=async function(e){const r=e,i=[];for(const e of r)i.push(...await g(e));const s=await Promise.all(i.map((e=>async function(e){const n=t.default.join(__dirname,"..","..","..","bin","PrintDeps.exe"),r=t.default.dirname(e),{stdout:i,code:s}=await(0,o.spawnAsync)(n,[e],{cwd:r,env:{...process.env,LD_LIBRARY_PATH:process.env.LD_LIBRARY_PATH?`${process.env.LD_LIBRARY_PATH}:${r}`:r}});if(0!==s)return[];return i.split("\n").map((e=>e.trim())).filter((e=>e.endsWith("not found")&&e.includes("=>"))).map((e=>e.split("=>")[0].trim().toLowerCase()))}(e)))),a=new Set;for(const e of s)for(const t of e)a.add(t);if(!a.size)return;let l=!1,c=!1;for(const e of a)e.startsWith("api-ms-win-crt")||"vcruntime140.dll"===e||"vcruntime140_1.dll"===e||"msvcp140.dll"===e?l=!0:"mf.dll"!==e&&"mfplat.dll"!==e&&"msmpeg2vdec.dll"!==e&&"evr.dll"!==e&&"avrt.dll"!==e||(c=!0);const u=[];l&&u.push("Some of the Universal C Runtime files cannot be found on the system. You can fix","that by installing Microsoft Visual C++ Redistributable for Visual Studio from:","https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads","");c&&u.push("Some of the Media Foundation files cannot be found on the system. If you are","on Windows Server try fixing this by running the following command in PowerShell","as Administrator:","","    Install-WindowsFeature Server-Media-Foundation","","For Windows N editions visit:","https://support.microsoft.com/en-us/help/3145500/media-feature-pack-list-for-windows-n-editions","");u.push("Full list of missing libraries:",`    ${[...a].join("\n    ")}`,"");const d=`Host system is missing dependencies!\n\n${u.join("\n")}`;if(function(){if("win32"!==n.platform()||"x64"!==n.arch())return!1;const[e,t]=n.release().split(".").map((e=>parseInt(e,10)));return e>6||6===e&&t>1}())throw new Error(d);console.warn("WARNING: running on unsupported windows version!"),console.warn(d)},hs.writeDockerVersion=async function(n){await e.default.promises.mkdir(t.default.dirname(m),{recursive:!0}),await e.default.promises.writeFile(m,JSON.stringify({driverVersion:f.version,dockerImageName:n.replace("%version%",f.version)},null,2),"utf8"),await e.default.promises.chmod(m,511)};var e=h(C.default),t=h(T.default),n=d(E.default),r=h(j.default),i=d(Ci),o=us,s=ss,a=Tl(),l=ps,c=gi;function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function d(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}function h(e){return e&&e.__esModule?e:{default:e}}const p=t.default.join(__dirname,"..","..","..","bin"),f=_i,m="/ms-playwright/.docker-info";async function g(r){if(!e.default.existsSync(r))return[];const i=(await e.default.promises.readdir(r)).map((e=>t.default.resolve(r,e))),o=await Promise.all(i.map((t=>e.default.promises.stat(t)))),s=i.filter(((e,t)=>o[t].isFile()));return(await Promise.all(s.map((async r=>(function(e){switch(n.platform()){case"linux":return e.endsWith(".so")||e.includes(".so.");case"win32":return e.endsWith(".dll");default:return!1}}(t.default.basename(r).toLowerCase())||!!await(t=>e.default.promises.access(t,e.default.constants.X_OK).then((()=>!0)).catch((e=>!1)))(r))&&r)))).filter(Boolean)}const _={"libx264.so":"gstreamer1.0-libav"};function w(e){return e.map((e=>e.includes(" ")?`"${e}"`:e))}async function v(e){if(0===process.getuid())return{command:"sh",args:["-c",`${e.join("&& ")}`],elevatedPermissions:!1};return 0===(await(0,o.spawnAsync)("which",["sudo"])).code?{command:"sudo",args:["--","sh","-c",`${e.join("&& ")}`],elevatedPermissions:!0}:{command:"su",args:["root","-c",`${e.join("&& ")}`],elevatedPermissions:!0}}return hs}ps.deps=fs,fs["ubuntu20.04-arm64"]={tools:[...fs["ubuntu20.04"].tools],chromium:[...fs["ubuntu20.04"].chromium],firefox:[...fs["ubuntu20.04"].firefox],webkit:[...fs["ubuntu20.04"].webkit,"libevent-2.1-7"],lib2package:{...fs["ubuntu20.04"].lib2package,"libevent-2.1.so.7":"libevent-2.1.so.7"}};var _s={},ws={exports:{}},vs=Co.exports,bs=function(){},ys=function(e,t,n){if("function"==typeof t)return ys(e,null,t);t||(t={}),n=vs(n||bs);var r=e._writableState,i=e._readableState,o=t.readable||!1!==t.readable&&e.readable,s=t.writable||!1!==t.writable&&e.writable,a=!1,l=function(){e.writable||c()},c=function(){s=!1,o||n.call(e)},u=function(){o=!1,s||n.call(e)},d=function(t){n.call(e,t?new Error("exited with error code: "+t):null)},h=function(t){n.call(e,t)},p=function(){process.nextTick(f)},f=function(){if(!a)return(!o||i&&i.ended&&!i.destroyed)&&(!s||r&&r.ended&&!r.destroyed)?void 0:n.call(e,new Error("premature close"))},m=function(){e.req.on("finish",c)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(e)?s&&!r&&(e.on("end",l),e.on("close",l)):(e.on("complete",c),e.on("abort",p),e.req?m():e.on("request",m)),function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length}(e)&&e.on("exit",d),e.on("end",u),e.on("finish",c),!1!==t.error&&e.on("error",h),e.on("close",p),function(){a=!0,e.removeListener("complete",c),e.removeListener("abort",p),e.removeListener("request",m),e.req&&e.req.removeListener("finish",c),e.removeListener("end",l),e.removeListener("close",l),e.removeListener("finish",c),e.removeListener("exit",d),e.removeListener("end",u),e.removeListener("error",h),e.removeListener("close",p)}},Ss=ys,xs=Co.exports,ks=Ss,Es=C.default,Cs=function(){},Ts=/^v?\.0/.test(process.version),Ps=function(e){return"function"==typeof e},Os=function(e,t,n,r){r=xs(r);var i=!1;e.on("close",(function(){i=!0})),ks(e,{readable:t,writable:n},(function(e){if(e)return r(e);i=!0,r()}));var o=!1;return function(t){if(!i&&!o)return o=!0,function(e){return!!Ts&&!!Es&&(e instanceof(Es.ReadStream||Cs)||e instanceof(Es.WriteStream||Cs))&&Ps(e.close)}(e)?e.close(Cs):function(e){return e.setHeader&&Ps(e.abort)}(e)?e.abort():Ps(e.destroy)?e.destroy():void r(t||new Error("stream was destroyed"))}},As=function(e){e()},Is=function(e,t){return e.pipe(t)},Ms=function(){var e,t=Array.prototype.slice.call(arguments),n=Ps(t[t.length-1]||Cs)&&t.pop()||Cs;if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new Error("pump requires two streams per minimum");var r=t.map((function(i,o){var s=o<t.length-1;return Os(i,s,o>0,(function(t){e||(e=t),t&&r.forEach(As),s||(r.forEach(As),n(e))}))}));return t.reduce(Is)};const{PassThrough:Fs}=B.default;const{constants:Ns}=W.default,Rs=Ms,js=e=>{e={...e};const{array:t}=e;let{encoding:n}=e;const r="buffer"===n;let i=!1;t?i=!(n||r):n=n||"utf8",r&&(n=null);const o=new Fs({objectMode:i});n&&o.setEncoding(n);let s=0;const a=[];return o.on("data",(e=>{a.push(e),i?s=a.length:s+=e.length})),o.getBufferedValue=()=>t?a:r?Buffer.concat(a,s):a.join(""),o.getBufferedLength=()=>s,o};class Ds extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}}async function Ls(e,t){if(!e)return Promise.reject(new Error("Expected a stream"));t={maxBuffer:1/0,...t};const{maxBuffer:n}=t;let r;return await new Promise(((i,o)=>{const s=e=>{e&&r.getBufferedLength()<=Ns.MAX_LENGTH&&(e.bufferedData=r.getBufferedValue()),o(e)};r=Rs(e,js(t),(e=>{e?s(e):i()})),r.on("data",(()=>{r.getBufferedLength()>n&&s(new Ds)}))})),r.getBufferedValue()}ws.exports=Ls,ws.exports.default=Ls,ws.exports.buffer=(e,t)=>Ls(e,{...t,encoding:"buffer"}),ws.exports.array=(e,t)=>Ls(e,{...t,array:!0}),ws.exports.MaxBufferError=Ds;var Bs={},Hs={},qs=Us;function Us(){this.pending=0,this.max=1/0,this.listeners=[],this.waiting=[],this.error=null}function Ws(e){e.pending+=1;var t=!1;return function(r){if(t)throw new Error("callback called twice");if(t=!0,e.error=e.error||r,e.pending-=1,e.waiting.length>0&&e.pending<e.max)$s(e,e.waiting.shift());else if(0===e.pending){var i=e.listeners;e.listeners=[],i.forEach(n)}};function n(t){t(e.error)}}function $s(e,t){t(Ws(e))}Us.prototype.go=function(e){this.pending<this.max?$s(this,e):this.waiting.push(e)},Us.prototype.wait=function(e){0===this.pending?e(this.error):this.listeners.push(e)},Us.prototype.hold=function(){return Ws(this)};var zs=C.default,Vs=N.default,Gs=B.default,Ks=Gs.Readable,Js=Gs.Writable,Ys=Gs.PassThrough,Xs=qs,Qs=M.default.EventEmitter;function Zs(e,t){t=t||{},Qs.call(this),this.fd=e,this.pend=new Xs,this.pend.max=1,this.refCount=0,this.autoClose=!!t.autoClose}function ea(e,t){t=t||{},Ks.call(this,t),this.context=e,this.context.ref(),this.start=t.start||0,this.endOffset=t.end,this.pos=this.start,this.destroyed=!1}function ta(e,t){t=t||{},Js.call(this,t),this.context=e,this.context.ref(),this.start=t.start||0,this.endOffset=null==t.end?1/0:+t.end,this.bytesWritten=0,this.pos=this.start,this.destroyed=!1,this.on("finish",this.destroy.bind(this))}function na(e,t){Qs.call(this),t=t||{},this.refCount=0,this.buffer=e,this.maxChunkSize=t.maxChunkSize||Number.MAX_SAFE_INTEGER}Hs.createFromBuffer=function(e,t){return new na(e,t)},Hs.createFromFd=function(e,t){return new Zs(e,t)},Hs.BufferSlicer=na,Hs.FdSlicer=Zs,Vs.inherits(Zs,Qs),Zs.prototype.read=function(e,t,n,r,i){var o=this;o.pend.go((function(s){zs.read(o.fd,e,t,n,r,(function(e,t,n){s(),i(e,t,n)}))}))},Zs.prototype.write=function(e,t,n,r,i){var o=this;o.pend.go((function(s){zs.write(o.fd,e,t,n,r,(function(e,t,n){s(),i(e,t,n)}))}))},Zs.prototype.createReadStream=function(e){return new ea(this,e)},Zs.prototype.createWriteStream=function(e){return new ta(this,e)},Zs.prototype.ref=function(){this.refCount+=1},Zs.prototype.unref=function(){var e=this;if(e.refCount-=1,!(e.refCount>0)){if(e.refCount<0)throw new Error("invalid unref");e.autoClose&&zs.close(e.fd,(function(t){t?e.emit("error",t):e.emit("close")}))}},Vs.inherits(ea,Ks),ea.prototype._read=function(e){var t=this;if(!t.destroyed){var n=Math.min(t._readableState.highWaterMark,e);if(null!=t.endOffset&&(n=Math.min(n,t.endOffset-t.pos)),n<=0)return t.destroyed=!0,t.push(null),void t.context.unref();t.context.pend.go((function(e){if(t.destroyed)return e();var r=new Buffer(n);zs.read(t.context.fd,r,0,n,t.pos,(function(n,i){n?t.destroy(n):0===i?(t.destroyed=!0,t.push(null),t.context.unref()):(t.pos+=i,t.push(r.slice(0,i))),e()}))}))}},ea.prototype.destroy=function(e){this.destroyed||(e=e||new Error("stream destroyed"),this.destroyed=!0,this.emit("error",e),this.context.unref())},Vs.inherits(ta,Js),ta.prototype._write=function(e,t,n){var r=this;if(!r.destroyed){if(r.pos+e.length>r.endOffset){var i=new Error("maximum file length exceeded");return i.code="ETOOBIG",r.destroy(),void n(i)}r.context.pend.go((function(t){if(r.destroyed)return t();zs.write(r.context.fd,e,0,e.length,r.pos,(function(e,i){e?(r.destroy(),t(),n(e)):(r.bytesWritten+=i,r.pos+=i,r.emit("progress"),t(),n())}))}))}},ta.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.context.unref())},Vs.inherits(na,Qs),na.prototype.read=function(e,t,n,r,i){var o=r+n,s=o-this.buffer.length,a=s>0?s:n;this.buffer.copy(e,t,r,o),setImmediate((function(){i(null,a)}))},na.prototype.write=function(e,t,n,r,i){e.copy(this.buffer,r,t,t+n),setImmediate((function(){i(null,n,e)}))},na.prototype.createReadStream=function(e){var t=new Ys(e=e||{});t.destroyed=!1,t.start=e.start||0,t.endOffset=e.end,t.pos=t.endOffset||this.buffer.length;for(var n=this.buffer.slice(t.start,t.pos),r=0;;){var i=r+this.maxChunkSize;if(i>=n.length){r<n.length&&t.write(n.slice(r,n.length));break}t.write(n.slice(r,i)),r=i}return t.end(),t.destroy=function(){t.destroyed=!0},t},na.prototype.createWriteStream=function(e){var t=this,n=new Js(e=e||{});return n.start=e.start||0,n.endOffset=null==e.end?this.buffer.length:+e.end,n.bytesWritten=0,n.pos=n.start,n.destroyed=!1,n._write=function(e,r,i){if(!n.destroyed){var o=n.pos+e.length;if(o>n.endOffset){var s=new Error("maximum file length exceeded");return s.code="ETOOBIG",n.destroyed=!0,void i(s)}e.copy(t.buffer,n.pos,0,e.length),n.bytesWritten+=e.length,n.pos=o,n.emit("progress"),i()}},n.destroy=function(){n.destroyed=!0},n},na.prototype.ref=function(){this.refCount+=1},na.prototype.unref=function(){if(this.refCount-=1,this.refCount<0)throw new Error("invalid unref")};var ra=W.default.Buffer,ia=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];function oa(e){if(ra.isBuffer(e))return e;var t="function"==typeof ra.alloc&&"function"==typeof ra.from;if("number"==typeof e)return t?ra.alloc(e):new ra(e);if("string"==typeof e)return t?ra.from(e):new ra(e);throw new Error("input must be buffer, number, or string, received "+typeof e)}function sa(e){var t=oa(4);return t.writeInt32BE(e,0),t}function aa(e,t){e=oa(e),ra.isBuffer(t)&&(t=t.readUInt32BE(0));for(var n=-1^~~t,r=0;r<e.length;r++)n=ia[255&(n^e[r])]^n>>>8;return-1^n}function la(){return sa(aa.apply(null,arguments))}"undefined"!=typeof Int32Array&&(ia=new Int32Array(ia)),la.signed=function(){return aa.apply(null,arguments)},la.unsigned=function(){return aa.apply(null,arguments)>>>0};var ca=la,ua=C.default,da=$.default,ha=Hs,pa=ca,fa=N.default,ma=M.default.EventEmitter,ga=B.default.Transform,_a=B.default.PassThrough,wa=B.default.Writable;function va(e,t,n){"function"==typeof t&&(n=t,t=null),null==t&&(t={}),null==t.autoClose&&(t.autoClose=!1),null==t.lazyEntries&&(t.lazyEntries=!1),null==t.decodeStrings&&(t.decodeStrings=!0),null==t.validateEntrySizes&&(t.validateEntrySizes=!0),null==t.strictFileNames&&(t.strictFileNames=!1),null==n&&(n=Na),ua.fstat(e,(function(r,i){if(r)return n(r);ba(ha.createFromFd(e,{autoClose:!0}),i.size,t,n)}))}function ba(e,t,n,r){"function"==typeof n&&(r=n,n=null),null==n&&(n={}),null==n.autoClose&&(n.autoClose=!0),null==n.lazyEntries&&(n.lazyEntries=!1),null==n.decodeStrings&&(n.decodeStrings=!0);var i=!!n.decodeStrings;if(null==n.validateEntrySizes&&(n.validateEntrySizes=!0),null==n.strictFileNames&&(n.strictFileNames=!1),null==r&&(r=Na),"number"!=typeof t)throw new Error("expected totalSize parameter to be a number");if(t>Number.MAX_SAFE_INTEGER)throw new Error("zip file too large. only file sizes up to 2^52 are supported due to JavaScript's Number type being an IEEE 754 double.");e.ref();var o=Math.min(65557,t),s=Ia(o),a=t-s.length;Ta(e,s,0,o,a,(function(l){if(l)return r(l);for(var c=o-22;c>=0;c-=1)if(101010256===s.readUInt32LE(c)){var u=s.slice(c),d=u.readUInt16LE(4);if(0!==d)return r(new Error("multi-disk zip files are not supported: found disk number: "+d));var h=u.readUInt16LE(10),p=u.readUInt32LE(16),f=u.readUInt16LE(20),m=u.length-22;if(f!==m)return r(new Error("invalid comment length. expected: "+m+". found: "+f));var g=i?Ma(u,22,u.length,!1):u.slice(22);if(65535!==h&&4294967295!==p)return r(null,new ya(e,p,t,h,g,n.autoClose,n.lazyEntries,i,n.validateEntrySizes,n.strictFileNames));var _=Ia(20),w=a+c-_.length;return void Ta(e,_,0,_.length,w,(function(o){if(o)return r(o);if(117853008!==_.readUInt32LE(0))return r(new Error("invalid zip64 end of central directory locator signature"));var s=Fa(_,8),a=Ia(56);Ta(e,a,0,a.length,s,(function(o){return o?r(o):101075792!==a.readUInt32LE(0)?r(new Error("invalid zip64 end of central directory record signature")):(h=Fa(a,32),p=Fa(a,48),r(null,new ya(e,p,t,h,g,n.autoClose,n.lazyEntries,i,n.validateEntrySizes,n.strictFileNames)))}))}))}r(new Error("end of central directory record signature not found"))}))}function ya(e,t,n,r,i,o,s,a,l,c){var u=this;ma.call(u),u.reader=e,u.reader.on("error",(function(e){xa(u,e)})),u.reader.once("close",(function(){u.emit("close")})),u.readEntryCursor=t,u.fileSize=n,u.entryCount=r,u.comment=i,u.entriesRead=0,u.autoClose=!!o,u.lazyEntries=!!s,u.decodeStrings=!!a,u.validateEntrySizes=!!l,u.strictFileNames=!!c,u.isOpen=!0,u.emittedError=!1,u.lazyEntries||u._readEntry()}function Sa(e,t){e.autoClose&&e.close(),xa(e,t)}function xa(e,t){e.emittedError||(e.emittedError=!0,e.emit("error",t))}function ka(){}function Ea(e,t){return new Date(1980+(e>>9&127),(e>>5&15)-1,31&e,t>>11&31,t>>5&63,2*(31&t),0)}function Ca(e){return-1!==e.indexOf("\\")?"invalid characters in fileName: "+e:/^[a-zA-Z]:/.test(e)||/^\//.test(e)?"absolute path: "+e:-1!==e.split("/").indexOf("..")?"invalid relative path: "+e:null}function Ta(e,t,n,r,i,o){if(0===r)return setImmediate((function(){o(null,Ia(0))}));e.read(t,n,r,i,(function(e,t){return e?o(e):t<r?o(new Error("unexpected EOF")):void o()}))}function Pa(e){ga.call(this),this.actualByteCount=0,this.expectedByteCount=e}function Oa(){ma.call(this),this.refCount=0}function Aa(e){_a.call(this),this.context=e,this.context.ref(),this.unreffedYet=!1}Bs.open=function(e,t,n){"function"==typeof t&&(n=t,t=null);null==t&&(t={});null==t.autoClose&&(t.autoClose=!0);null==t.lazyEntries&&(t.lazyEntries=!1);null==t.decodeStrings&&(t.decodeStrings=!0);null==t.validateEntrySizes&&(t.validateEntrySizes=!0);null==t.strictFileNames&&(t.strictFileNames=!1);null==n&&(n=Na);ua.open(e,"r",(function(e,r){if(e)return n(e);va(r,t,(function(e,t){e&&ua.close(r,Na),n(e,t)}))}))},Bs.fromFd=va,Bs.fromBuffer=function(e,t,n){"function"==typeof t&&(n=t,t=null);null==t&&(t={});t.autoClose=!1,null==t.lazyEntries&&(t.lazyEntries=!1);null==t.decodeStrings&&(t.decodeStrings=!0);null==t.validateEntrySizes&&(t.validateEntrySizes=!0);null==t.strictFileNames&&(t.strictFileNames=!1);ba(ha.createFromBuffer(e,{maxChunkSize:65536}),e.length,t,n)},Bs.fromRandomAccessReader=ba,Bs.dosDateTimeToDate=Ea,Bs.validateFileName=Ca,Bs.ZipFile=ya,Bs.Entry=ka,Bs.RandomAccessReader=Oa,fa.inherits(ya,ma),ya.prototype.close=function(){this.isOpen&&(this.isOpen=!1,this.reader.unref())},ya.prototype.readEntry=function(){if(!this.lazyEntries)throw new Error("readEntry() called without lazyEntries:true");this._readEntry()},ya.prototype._readEntry=function(){var e=this;if(e.entryCount!==e.entriesRead){if(!e.emittedError){var t=Ia(46);Ta(e.reader,t,0,t.length,e.readEntryCursor,(function(n){if(n)return Sa(e,n);if(!e.emittedError){var r=new ka,i=t.readUInt32LE(0);if(33639248!==i)return Sa(e,new Error("invalid central directory file header signature: 0x"+i.toString(16)));if(r.versionMadeBy=t.readUInt16LE(4),r.versionNeededToExtract=t.readUInt16LE(6),r.generalPurposeBitFlag=t.readUInt16LE(8),r.compressionMethod=t.readUInt16LE(10),r.lastModFileTime=t.readUInt16LE(12),r.lastModFileDate=t.readUInt16LE(14),r.crc32=t.readUInt32LE(16),r.compressedSize=t.readUInt32LE(20),r.uncompressedSize=t.readUInt32LE(24),r.fileNameLength=t.readUInt16LE(28),r.extraFieldLength=t.readUInt16LE(30),r.fileCommentLength=t.readUInt16LE(32),r.internalFileAttributes=t.readUInt16LE(36),r.externalFileAttributes=t.readUInt32LE(38),r.relativeOffsetOfLocalHeader=t.readUInt32LE(42),64&r.generalPurposeBitFlag)return Sa(e,new Error("strong encryption is not supported"));e.readEntryCursor+=46,t=Ia(r.fileNameLength+r.extraFieldLength+r.fileCommentLength),Ta(e.reader,t,0,t.length,e.readEntryCursor,(function(n){if(n)return Sa(e,n);if(!e.emittedError){var i=0!=(2048&r.generalPurposeBitFlag);r.fileName=e.decodeStrings?Ma(t,0,r.fileNameLength,i):t.slice(0,r.fileNameLength);var o=r.fileNameLength+r.extraFieldLength,s=t.slice(r.fileNameLength,o);r.extraFields=[];for(var a=0;a<s.length-3;){var l=s.readUInt16LE(a+0),c=s.readUInt16LE(a+2),u=a+4,d=u+c;if(d>s.length)return Sa(e,new Error("extra field length exceeds extra field buffer size"));var h=Ia(c);s.copy(h,0,u,d),r.extraFields.push({id:l,data:h}),a=d}if(r.fileComment=e.decodeStrings?Ma(t,o,o+r.fileCommentLength,i):t.slice(o,o+r.fileCommentLength),r.comment=r.fileComment,e.readEntryCursor+=t.length,e.entriesRead+=1,4294967295===r.uncompressedSize||4294967295===r.compressedSize||4294967295===r.relativeOffsetOfLocalHeader){var p=null;for(a=0;a<r.extraFields.length;a++){if(1===(m=r.extraFields[a]).id){p=m.data;break}}if(null==p)return Sa(e,new Error("expected zip64 extended information extra field"));var f=0;if(4294967295===r.uncompressedSize){if(f+8>p.length)return Sa(e,new Error("zip64 extended information extra field does not include uncompressed size"));r.uncompressedSize=Fa(p,f),f+=8}if(4294967295===r.compressedSize){if(f+8>p.length)return Sa(e,new Error("zip64 extended information extra field does not include compressed size"));r.compressedSize=Fa(p,f),f+=8}if(4294967295===r.relativeOffsetOfLocalHeader){if(f+8>p.length)return Sa(e,new Error("zip64 extended information extra field does not include relative header offset"));r.relativeOffsetOfLocalHeader=Fa(p,f),f+=8}}if(e.decodeStrings)for(a=0;a<r.extraFields.length;a++){var m;if(28789===(m=r.extraFields[a]).id){if(m.data.length<6)continue;if(1!==m.data.readUInt8(0))continue;var g=m.data.readUInt32LE(1);if(pa.unsigned(t.slice(0,r.fileNameLength))!==g)continue;r.fileName=Ma(m.data,5,m.data.length,!0);break}}if(e.validateEntrySizes&&0===r.compressionMethod){var _=r.uncompressedSize;if(r.isEncrypted()&&(_+=12),r.compressedSize!==_){var w="compressed/uncompressed size mismatch for stored file: "+r.compressedSize+" != "+r.uncompressedSize;return Sa(e,new Error(w))}}if(e.decodeStrings){e.strictFileNames||(r.fileName=r.fileName.replace(/\\/g,"/"));var v=Ca(r.fileName,e.validateFileNameOptions);if(null!=v)return Sa(e,new Error(v))}e.emit("entry",r),e.lazyEntries||e._readEntry()}}))}}))}}else setImmediate((function(){e.autoClose&&e.close(),e.emittedError||e.emit("end")}))},ya.prototype.openReadStream=function(e,t,n){var r=this,i=0,o=e.compressedSize;if(null==n)n=t,t={};else{if(null!=t.decrypt){if(!e.isEncrypted())throw new Error("options.decrypt can only be specified for encrypted entries");if(!1!==t.decrypt)throw new Error("invalid options.decrypt value: "+t.decrypt);if(e.isCompressed()&&!1!==t.decompress)throw new Error("entry is encrypted and compressed, and options.decompress !== false")}if(null!=t.decompress){if(!e.isCompressed())throw new Error("options.decompress can only be specified for compressed entries");if(!1!==t.decompress&&!0!==t.decompress)throw new Error("invalid options.decompress value: "+t.decompress)}if(null!=t.start||null!=t.end){if(e.isCompressed()&&!1!==t.decompress)throw new Error("start/end range not allowed for compressed entry without options.decompress === false");if(e.isEncrypted()&&!1!==t.decrypt)throw new Error("start/end range not allowed for encrypted entry without options.decrypt === false")}if(null!=t.start){if((i=t.start)<0)throw new Error("options.start < 0");if(i>e.compressedSize)throw new Error("options.start > entry.compressedSize")}if(null!=t.end){if((o=t.end)<0)throw new Error("options.end < 0");if(o>e.compressedSize)throw new Error("options.end > entry.compressedSize");if(o<i)throw new Error("options.end < options.start")}}if(!r.isOpen)return n(new Error("closed"));if(e.isEncrypted()&&!1!==t.decrypt)return n(new Error("entry is encrypted, and options.decrypt !== false"));r.reader.ref();var s=Ia(30);Ta(r.reader,s,0,s.length,e.relativeOffsetOfLocalHeader,(function(a){try{if(a)return n(a);var l=s.readUInt32LE(0);if(67324752!==l)return n(new Error("invalid local file header signature: 0x"+l.toString(16)));var c,u=s.readUInt16LE(26),d=s.readUInt16LE(28),h=e.relativeOffsetOfLocalHeader+s.length+u+d;if(0===e.compressionMethod)c=!1;else{if(8!==e.compressionMethod)return n(new Error("unsupported compression method: "+e.compressionMethod));c=null==t.decompress||t.decompress}var p=h,f=p+e.compressedSize;if(0!==e.compressedSize&&f>r.fileSize)return n(new Error("file data overflows file bounds: "+p+" + "+e.compressedSize+" > "+r.fileSize));var m=r.reader.createReadStream({start:p+i,end:p+o}),g=m;if(c){var _=!1,w=da.createInflateRaw();m.on("error",(function(e){setImmediate((function(){_||w.emit("error",e)}))})),m.pipe(w),r.validateEntrySizes?(g=new Pa(e.uncompressedSize),w.on("error",(function(e){setImmediate((function(){_||g.emit("error",e)}))})),w.pipe(g)):g=w,g.destroy=function(){_=!0,w!==g&&w.unpipe(g),m.unpipe(w),m.destroy()}}n(null,g)}finally{r.reader.unref()}}))},ka.prototype.getLastModDate=function(){return Ea(this.lastModFileDate,this.lastModFileTime)},ka.prototype.isEncrypted=function(){return 0!=(1&this.generalPurposeBitFlag)},ka.prototype.isCompressed=function(){return 8===this.compressionMethod},fa.inherits(Pa,ga),Pa.prototype._transform=function(e,t,n){if(this.actualByteCount+=e.length,this.actualByteCount>this.expectedByteCount){var r="too many bytes in the stream. expected "+this.expectedByteCount+". got at least "+this.actualByteCount;return n(new Error(r))}n(null,e)},Pa.prototype._flush=function(e){if(this.actualByteCount<this.expectedByteCount){var t="not enough bytes in the stream. expected "+this.expectedByteCount+". got only "+this.actualByteCount;return e(new Error(t))}e()},fa.inherits(Oa,ma),Oa.prototype.ref=function(){this.refCount+=1},Oa.prototype.unref=function(){var e=this;if(e.refCount-=1,!(e.refCount>0)){if(e.refCount<0)throw new Error("invalid unref");e.close((function(t){if(t)return e.emit("error",t);e.emit("close")}))}},Oa.prototype.createReadStream=function(e){var t=e.start,n=e.end;if(t===n){var r=new _a;return setImmediate((function(){r.end()})),r}var i=this._readStreamForRange(t,n),o=!1,s=new Aa(this);i.on("error",(function(e){setImmediate((function(){o||s.emit("error",e)}))})),s.destroy=function(){i.unpipe(s),s.unref(),i.destroy()};var a=new Pa(n-t);return s.on("error",(function(e){setImmediate((function(){o||a.emit("error",e)}))})),a.destroy=function(){o=!0,s.unpipe(a),s.destroy()},i.pipe(s).pipe(a)},Oa.prototype._readStreamForRange=function(e,t){throw new Error("not implemented")},Oa.prototype.read=function(e,t,n,r,i){var o=this.createReadStream({start:r,end:r+n}),s=new wa,a=0;s._write=function(n,r,i){n.copy(e,t+a,0,n.length),a+=n.length,i()},s.on("finish",i),o.on("error",(function(e){i(e)})),o.pipe(s)},Oa.prototype.close=function(e){setImmediate(e)},fa.inherits(Aa,_a),Aa.prototype._flush=function(e){this.unref(),e()},Aa.prototype.unref=function(e){this.unreffedYet||(this.unreffedYet=!0,this.context.unref())};var Ia;function Ma(e,t,n,r){if(r)return e.toString("utf8",t,n);for(var i="",o=t;o<n;o++)i+="\0 !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"[e[o]];return i}function Fa(e,t){var n=e.readUInt32LE(t);return 4294967296*e.readUInt32LE(t+4)+n}function Na(e){if(e)throw e}Ia="function"==typeof Buffer.allocUnsafe?function(e){return Buffer.allocUnsafe(e)}:function(e){return new Buffer(e)};const Ra=Ir.exports("extract-zip"),{createWriteStream:ja,promises:Da}=C.default,La=ws.exports,Ba=T.default,{promisify:Ha}=N.default,qa=B.default,Ua=Ha(Bs.open),Wa=Ha(qa.pipeline);class $a{constructor(e,t){this.zipPath=e,this.opts=t}async extract(){return Ra("opening",this.zipPath,"with opts",this.opts),this.zipfile=await Ua(this.zipPath,{lazyEntries:!0}),this.canceled=!1,new Promise(((e,t)=>{this.zipfile.on("error",(e=>{this.canceled=!0,t(e)})),this.zipfile.readEntry(),this.zipfile.on("close",(()=>{this.canceled||(Ra("zip extraction complete"),e())})),this.zipfile.on("entry",(async e=>{if(this.canceled)return void Ra("skipping entry",e.fileName,{cancelled:this.canceled});if(Ra("zipfile entry",e.fileName),e.fileName.startsWith("__MACOSX/"))return void this.zipfile.readEntry();const n=Ba.dirname(Ba.join(this.opts.dir,e.fileName));try{await Da.mkdir(n,{recursive:!0});const t=await Da.realpath(n);if(Ba.relative(this.opts.dir,t).split(Ba.sep).includes(".."))throw new Error(`Out of bound path "${t}" found while processing file ${e.fileName}`);await this.extractEntry(e),Ra("finished processing",e.fileName),this.zipfile.readEntry()}catch(e){this.canceled=!0,this.zipfile.close(),t(e)}}))}))}async extractEntry(e){if(this.canceled)return void Ra("skipping entry extraction",e.fileName,{cancelled:this.canceled});this.opts.onEntry&&this.opts.onEntry(e,this.zipfile);const t=Ba.join(this.opts.dir,e.fileName),n=e.externalFileAttributes>>16&65535,r=40960==(61440&n);let i=16384==(61440&n);!i&&e.fileName.endsWith("/")&&(i=!0);const o=e.versionMadeBy>>8;i||(i=0===o&&16===e.externalFileAttributes),Ra("extracting entry",{filename:e.fileName,isDir:i,isSymlink:r});const s=511&this.getExtractedMode(n,i),a=i?t:Ba.dirname(t),l={recursive:!0};if(i&&(l.mode=s),Ra("mkdir",{dir:a,...l}),await Da.mkdir(a,l),i)return;Ra("opening read stream",t);const c=await Ha(this.zipfile.openReadStream.bind(this.zipfile))(e);if(r){const e=await La(c);Ra("creating symlink",e,t),await Da.symlink(e,t)}else await Wa(c,ja(t,{mode:s}))}getExtractedMode(e,t){let n=e;return 0===n&&(t?(this.opts.defaultDirMode&&(n=parseInt(this.opts.defaultDirMode,10)),n||(n=493)):(this.opts.defaultFileMode&&(n=parseInt(this.opts.defaultFileMode,10)),n||(n=420))),n}}var za,Va,Ga,Ka={},Ja={exports:{}},Ya={exports:{}};function Xa(){if(Va)return za;return Va=1,za=function(e){function t(e){let r,i,o,s=null;function a(...e){if(!a.enabled)return;const n=a,i=Number(new Date),o=i-(r||i);n.diff=o,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";s++;const o=t.formatters[i];if("function"==typeof o){const t=e[s];r=o.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=gr(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t},za}var Qa,Za={exports:{}};function el(){return Qa||(Qa=1,function(e,t){const n=q.default,r=N.default;t.init=function(e){e.inspectOpts={};const n=Object.keys(t.inspectOpts);for(let r=0;r<n.length;r++)e.inspectOpts[n[r]]=t.inspectOpts[n[r]]},t.log=function(...e){return process.stderr.write(r.format(...e)+"\n")},t.formatArgs=function(n){const{namespace:r,useColors:i}=this;if(i){const t=this.color,i="[3"+(t<8?t:"8;5;"+t),o=`  ${i};1m${r} [0m`;n[0]=o+n[0].split("\n").join("\n"+o),n.push(i+"m+"+e.exports.humanize(this.diff)+"[0m")}else n[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+r+" "+n[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.destroy=r.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=kr();e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const n=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[n]=r,e}),{}),e.exports=Xa()(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,r.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,r.inspect(e,this.inspectOpts)}}(Za,Za.exports)),Za.exports}!function(e){"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=(Ga||(Ga=1,function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=Xa()(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}(Ya,Ya.exports)),Ya.exports):e.exports=el()}(Ja),Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.debugLogger=Ka.RecentLogsCollector=void 0;var tl=rl(Ja.exports),nl=rl(C.default);function rl(e){return e&&e.__esModule?e:{default:e}}const il={api:45,protocol:34,install:34,download:34,browser:0,proxy:92,error:160,"channel:command":33,"channel:response":202,"channel:event":207};const ol=new class{constructor(){if(this._debuggers=new Map,process.env.DEBUG_FILE){const e=new RegExp(["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:[a-zA-Z\\d]*(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|"),"g"),t=nl.default.createWriteStream(process.env.DEBUG_FILE);tl.default.log=n=>{t.write(n.replace(e,"")),t.write("\n")}}}log(e,t){let n=this._debuggers.get(e);n||(n=(0,tl.default)(`pw:${e}`),this._debuggers.set(e,n),n.color=il[e]),n(t)}isEnabled(e){return tl.default.enabled(`pw:${e}`)}};Ka.debugLogger=ol;Ka.RecentLogsCollector=class{constructor(){this._logs=[]}log(e){this._logs.push(e),300===this._logs.length&&this._logs.splice(0,150)}recentLogs(){return this._logs.length>150?this._logs.slice(-150):this._logs}};var sl={},al={exports:{}},ll={exports:{}};
/*!
 * node-progress
 * Copyright(c) 2011 TJ Holowaychuk <tj@vision-media.ca>
 * MIT Licensed
 */
!function(e,t){function n(e,t){if(this.stream=t.stream||process.stderr,"number"==typeof t){var n=t;(t={}).total=n}else{if(t=t||{},"string"!=typeof e)throw new Error("format required");if("number"!=typeof t.total)throw new Error("total required")}this.fmt=e,this.curr=t.curr||0,this.total=t.total,this.width=t.width||this.total,this.clear=t.clear,this.chars={complete:t.complete||"=",incomplete:t.incomplete||"-",head:t.head||t.complete||"="},this.renderThrottle=0!==t.renderThrottle?t.renderThrottle||16:0,this.lastRender=-1/0,this.callback=t.callback||function(){},this.tokens={},this.lastDraw=""}ll.exports=n,n.prototype.tick=function(e,t){if(0!==e&&(e=e||1),"object"==typeof e&&(t=e,e=1),t&&(this.tokens=t),0==this.curr&&(this.start=new Date),this.curr+=e,this.render(),this.curr>=this.total)return this.render(void 0,!0),this.complete=!0,this.terminate(),void this.callback(this)},n.prototype.render=function(e,t){if(t=void 0!==t&&t,e&&(this.tokens=e),this.stream.isTTY){var n=Date.now(),r=n-this.lastRender;if(t||!(r<this.renderThrottle)){this.lastRender=n;var i=this.curr/this.total;i=Math.min(Math.max(i,0),1);var o,s,a,l=Math.floor(100*i),c=new Date-this.start,u=100==l?0:c*(this.total/this.curr-1),d=this.curr/(c/1e3),h=this.fmt.replace(":current",this.curr).replace(":total",this.total).replace(":elapsed",isNaN(c)?"0.0":(c/1e3).toFixed(1)).replace(":eta",isNaN(u)||!isFinite(u)?"0.0":(u/1e3).toFixed(1)).replace(":percent",l.toFixed(0)+"%").replace(":rate",Math.round(d)),p=Math.max(0,this.stream.columns-h.replace(":bar","").length);p&&"win32"===process.platform&&(p-=1);var f=Math.min(this.width,p);if(a=Math.round(f*i),s=Array(Math.max(0,a+1)).join(this.chars.complete),o=Array(Math.max(0,f-a+1)).join(this.chars.incomplete),a>0&&(s=s.slice(0,-1)+this.chars.head),h=h.replace(":bar",s+o),this.tokens)for(var m in this.tokens)h=h.replace(":"+m,this.tokens[m]);this.lastDraw!==h&&(this.stream.cursorTo(0),this.stream.write(h),this.stream.clearLine(1),this.lastDraw=h)}}},n.prototype.update=function(e,t){var n=Math.floor(e*this.total)-this.curr;this.tick(n,t)},n.prototype.interrupt=function(e){this.stream.clearLine(),this.stream.cursorTo(0),this.stream.write(e),this.stream.write("\n"),this.stream.write(this.lastDraw)},n.prototype.terminate=function(){this.clear?this.stream.clearLine&&(this.stream.clearLine(),this.stream.cursorTo(0)):this.stream.write("\n")}}(),al.exports=ll.exports,Object.defineProperty(sl,"__esModule",{value:!0}),sl.download=async function(e,t,n={}){const{progressBarName:r="file",retryCount:i=3,log:o=(()=>{}),userAgent:s}=n;for(let n=1;n<=i;++n){o(`downloading ${r} - attempt #${n}`);const{error:a}=await pl(e,t,{progressCallback:fl(r),log:o,userAgent:s});if(!a){o(`SUCCESS downloading ${r}`);break}const l=(null==a?void 0:a.message)||"";if(o(`attempt #${n} - ERROR: ${l}`),!(n<i&&(l.includes("ECONNRESET")||l.includes("ETIMEDOUT"))))throw a;{const e=200*Math.random()+250*Math.pow(1.5,n);o(`sleeping ${e}ms before retry...`),await new Promise((t=>setTimeout(t,e)))}}};var cl=hl(C.default),ul=hl(al.exports),dl=nr;function hl(e){return e&&e.__esModule?e:{default:e}}function pl(e,t,n={}){const{progressCallback:r,log:i=(()=>{})}=n;i("running download:"),i(`-- from url: ${e}`),i(`-- to location: ${t}`);let o=({error:e})=>{},s=0,a=0;const l=new Promise((e=>{o=e}));return(0,dl.httpRequest)({url:e,headers:n.userAgent?{"User-Agent":n.userAgent}:void 0},(n=>{if(i(`-- response status code: ${n.statusCode}`),200!==n.statusCode){const t=new Error(`Download failed: server returned code ${n.statusCode}. URL: ${e}`);return n.resume(),void o({error:t})}const s=cl.default.createWriteStream(t);s.on("finish",(()=>o({error:null}))),s.on("error",(e=>o({error:e}))),n.pipe(s),a=parseInt(n.headers["content-length"]||"0",10),i(`-- total bytes: ${a}`),r&&n.on("data",c)}),(e=>o({error:e}))),l;function c(e){s+=e.length,r(s,a)}}function fl(e){let t,n=0;return(r,i)=>{if(!process.stderr.isTTY)return;t||(t=new ul.default(`Downloading ${e} - ${function(e){const t=e/1024/1024;return Math.round(10*t)/10+" Mb"}(i)} [:bar] :percent :etas `,{complete:"=",incomplete:" ",width:20,total:i}));const o=r-n;n=r,t.tick(o)}}Object.defineProperty(_s,"__esModule",{value:!0}),_s.downloadBrowserWithProgressBar=async function(e,t,n,r,i){const o=`Playwright build of ${e}`;if(await(0,bl.existsAsync)(t))return yl.debugLogger.log("install",`browser ${e} is already downloaded.`),!1;const s=r,a=wl.default.join(_l.default.tmpdir(),i);try{await(0,Sl.download)(s,a,{progressBarName:o,log:yl.debugLogger.log.bind(yl.debugLogger,"install"),userAgent:(0,vl.getUserAgent)()}),yl.debugLogger.log("install","extracting archive"),yl.debugLogger.log("install",`-- zip: ${a}`),yl.debugLogger.log("install",`-- location: ${t}`),await(0,ml.default)(a,{dir:t}),yl.debugLogger.log("install",`fixing permissions at ${n}`),await gl.default.promises.chmod(n,493)}catch(e){throw yl.debugLogger.log("install",`FAILED installation ${o} with error: ${e}`),process.exitCode=1,e}finally{await(0,bl.existsAsync)(a)&&await gl.default.promises.unlink(a)}return kl(`${o} downloaded to ${t}`),!0},_s.logPolitely=kl;var ml=xl((async function(e,t){if(Ra("creating target directory",t.dir),!Ba.isAbsolute(t.dir))throw new Error("Target directory is expected to be absolute");return await Da.mkdir(t.dir,{recursive:!0}),t.dir=await Da.realpath(t.dir),new $a(e,t).extract()})),gl=xl(C.default),_l=xl(E.default),wl=xl(T.default),vl=gi,bl=Ri,yl=Ka,Sl=sl;function xl(e){return e&&e.__esModule?e:{default:e}}function kl(e){const t=process.env.npm_config_loglevel;["silent","error","warn"].indexOf(t||"")>-1||console.log(e)}var El,Cl={comment:"Do not edit this file, use utils/roll_browser.js",browsers:[{name:"chromium",revision:"1000",installByDefault:!0},{name:"chromium-with-symbols",revision:"1000",installByDefault:!1},{name:"firefox",revision:"1322",installByDefault:!0},{name:"firefox-beta",revision:"1321",installByDefault:!1},{name:"webkit",revision:"1630",installByDefault:!0,revisionOverrides:{"mac10.14":"1446","mac10.15":"1616"}},{name:"ffmpeg",revision:"1007",installByDefault:!0}]};function Tl(){return El||(El=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Registry=void 0,e.buildPlaywrightCLICommand=A,e.findChromiumChannel=function(e){let t=null;for(const n of["chromium","chrome","msedge"])try{M.findExecutable(n).executablePathOrDie(e),t="chromium"===n?void 0:n;break}catch(e){}if(null===t){const t=["No chromium-based browser found on the system.","Please run the following command to download one:","",`    ${A(e,"install chromium")}`,"","<3 Playwright Team"].join("\n");throw new Error("\n"+(0,c.wrapInASCIIBox)(t,1))}return t},e.installBrowsersForNpmInstall=I,e.installDefaultBrowsersForNpmInstall=async function(){return I(M.defaultExecutables().map((e=>e.name)))},e.registryDirectory=e.registry=void 0,Object.defineProperty(e,"writeDockerVersion",{enumerable:!0,get:function(){return p.writeDockerVersion}});var t=_(E.default),n=m(T.default),r=_(N.default),i=_(C.default),o=m(Ct.exports),s=Kn,a=nr,l=gi,c=Ci,u=Ri,d=ss,h=us,p=gs(),f=_s;function m(e){return e&&e.__esModule?e:{default:e}}function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(g=function(e){return e?n:t})(e)}function _(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=g(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}const w=n.default.join(__dirname,"..","..",".."),v=n.default.join(__dirname,"..","..","..","bin"),b={chromium:{linux:["chrome-linux","chrome"],mac:["chrome-mac","Chromium.app","Contents","MacOS","Chromium"],win:["chrome-win","chrome.exe"]},firefox:{linux:["firefox","firefox"],mac:["firefox","Nightly.app","Contents","MacOS","firefox"],win:["firefox","firefox.exe"]},webkit:{linux:["pw_run.sh"],mac:["pw_run.sh"],win:["Playwright.exe"]},ffmpeg:{linux:["ffmpeg-linux"],mac:["ffmpeg-mac"],win:["ffmpeg-win64.exe"]}},y={chromium:{"<unknown>":void 0,"generic-linux":"builds/chromium/%s/chromium-linux.zip","generic-linux-arm64":"builds/chromium/%s/chromium-linux-arm64.zip","ubuntu18.04":"builds/chromium/%s/chromium-linux.zip","ubuntu20.04":"builds/chromium/%s/chromium-linux.zip","ubuntu18.04-arm64":"builds/chromium/%s/chromium-linux-arm64.zip","ubuntu20.04-arm64":"builds/chromium/%s/chromium-linux-arm64.zip","mac10.13":"builds/chromium/%s/chromium-mac.zip","mac10.14":"builds/chromium/%s/chromium-mac.zip","mac10.15":"builds/chromium/%s/chromium-mac.zip",mac11:"builds/chromium/%s/chromium-mac.zip","mac11-arm64":"builds/chromium/%s/chromium-mac-arm64.zip",mac12:"builds/chromium/%s/chromium-mac.zip","mac12-arm64":"builds/chromium/%s/chromium-mac-arm64.zip",win64:"builds/chromium/%s/chromium-win64.zip"},"chromium-with-symbols":{"<unknown>":void 0,"generic-linux":"builds/chromium/%s/chromium-with-symbols-linux.zip","generic-linux-arm64":"builds/chromium/%s/chromium-with-symbols-linux-arm64.zip","ubuntu18.04":"builds/chromium/%s/chromium-with-symbols-linux.zip","ubuntu20.04":"builds/chromium/%s/chromium-with-symbols-linux.zip","ubuntu18.04-arm64":"builds/chromium/%s/chromium-with-symbols-linux-arm64.zip","ubuntu20.04-arm64":"builds/chromium/%s/chromium-with-symbols-linux-arm64.zip","mac10.13":"builds/chromium/%s/chromium-with-symbols-mac.zip","mac10.14":"builds/chromium/%s/chromium-with-symbols-mac.zip","mac10.15":"builds/chromium/%s/chromium-with-symbols-mac.zip",mac11:"builds/chromium/%s/chromium-with-symbols-mac.zip","mac11-arm64":"builds/chromium/%s/chromium-with-symbols-mac-arm64.zip",mac12:"builds/chromium/%s/chromium-with-symbols-mac.zip","mac12-arm64":"builds/chromium/%s/chromium-with-symbols-mac-arm64.zip",win64:"builds/chromium/%s/chromium-with-symbols-win64.zip"},firefox:{"<unknown>":void 0,"generic-linux":"builds/firefox/%s/firefox-ubuntu-20.04.zip","generic-linux-arm64":"builds/firefox/%s/firefox-ubuntu-20.04-arm64.zip","ubuntu18.04":"builds/firefox/%s/firefox-ubuntu-18.04.zip","ubuntu20.04":"builds/firefox/%s/firefox-ubuntu-20.04.zip","ubuntu18.04-arm64":void 0,"ubuntu20.04-arm64":"builds/firefox/%s/firefox-ubuntu-20.04-arm64.zip","mac10.13":"builds/firefox/%s/firefox-mac-11.zip","mac10.14":"builds/firefox/%s/firefox-mac-11.zip","mac10.15":"builds/firefox/%s/firefox-mac-11.zip",mac11:"builds/firefox/%s/firefox-mac-11.zip","mac11-arm64":"builds/firefox/%s/firefox-mac-11-arm64.zip",mac12:"builds/firefox/%s/firefox-mac-11.zip","mac12-arm64":"builds/firefox/%s/firefox-mac-11-arm64.zip",win64:"builds/firefox/%s/firefox-win64.zip"},"firefox-beta":{"<unknown>":void 0,"generic-linux":"builds/firefox-beta/%s/firefox-beta-ubuntu-20.04.zip","generic-linux-arm64":void 0,"ubuntu18.04":"builds/firefox-beta/%s/firefox-beta-ubuntu-18.04.zip","ubuntu20.04":"builds/firefox-beta/%s/firefox-beta-ubuntu-20.04.zip","ubuntu18.04-arm64":void 0,"ubuntu20.04-arm64":void 0,"mac10.13":"builds/firefox-beta/%s/firefox-beta-mac-11.zip","mac10.14":"builds/firefox-beta/%s/firefox-beta-mac-11.zip","mac10.15":"builds/firefox-beta/%s/firefox-beta-mac-11.zip",mac11:"builds/firefox-beta/%s/firefox-beta-mac-11.zip","mac11-arm64":"builds/firefox-beta/%s/firefox-beta-mac-11-arm64.zip",mac12:"builds/firefox-beta/%s/firefox-beta-mac-11.zip","mac12-arm64":"builds/firefox-beta/%s/firefox-beta-mac-11-arm64.zip",win64:"builds/firefox-beta/%s/firefox-beta-win64.zip"},webkit:{"<unknown>":void 0,"generic-linux":"builds/webkit/%s/webkit-ubuntu-20.04.zip","generic-linux-arm64":"builds/webkit/%s/webkit-ubuntu-20.04-arm64.zip","ubuntu18.04":"builds/webkit/%s/webkit-ubuntu-18.04.zip","ubuntu20.04":"builds/webkit/%s/webkit-ubuntu-20.04.zip","ubuntu18.04-arm64":void 0,"ubuntu20.04-arm64":"builds/webkit/%s/webkit-ubuntu-20.04-arm64.zip","mac10.13":void 0,"mac10.14":"builds/deprecated-webkit-mac-10.14/%s/deprecated-webkit-mac-10.14.zip","mac10.15":"builds/webkit/%s/webkit-mac-10.15.zip",mac11:"builds/webkit/%s/webkit-mac-11.zip","mac11-arm64":"builds/webkit/%s/webkit-mac-11-arm64.zip",mac12:"builds/webkit/%s/webkit-mac-12.zip","mac12-arm64":"builds/webkit/%s/webkit-mac-12-arm64.zip",win64:"builds/webkit/%s/webkit-win64.zip"},ffmpeg:{"<unknown>":void 0,"generic-linux":"builds/ffmpeg/%s/ffmpeg-linux.zip","generic-linux-arm64":"builds/ffmpeg/%s/ffmpeg-linux-arm64.zip","ubuntu18.04":"builds/ffmpeg/%s/ffmpeg-linux.zip","ubuntu20.04":"builds/ffmpeg/%s/ffmpeg-linux.zip","ubuntu18.04-arm64":"builds/ffmpeg/%s/ffmpeg-linux-arm64.zip","ubuntu20.04-arm64":"builds/ffmpeg/%s/ffmpeg-linux-arm64.zip","mac10.13":"builds/ffmpeg/%s/ffmpeg-mac.zip","mac10.14":"builds/ffmpeg/%s/ffmpeg-mac.zip","mac10.15":"builds/ffmpeg/%s/ffmpeg-mac.zip",mac11:"builds/ffmpeg/%s/ffmpeg-mac.zip","mac11-arm64":"builds/ffmpeg/%s/ffmpeg-mac-arm64.zip",mac12:"builds/ffmpeg/%s/ffmpeg-mac.zip","mac12-arm64":"builds/ffmpeg/%s/ffmpeg-mac-arm64.zip",win64:"builds/ffmpeg/%s/ffmpeg-win64.zip"}},S=(()=>{let e;const r=(0,c.getFromENV)("PLAYWRIGHT_BROWSERS_PATH");if("0"===r)e=n.default.join(__dirname,"..","..","..",".local-browsers");else if(r)e=r;else{let r;if("linux"===process.platform)r=process.env.XDG_CACHE_HOME||n.default.join(t.homedir(),".cache");else if("darwin"===process.platform)r=n.default.join(t.homedir(),"Library","Caches");else{if("win32"!==process.platform)throw new Error("Unsupported platform: "+process.platform);r=process.env.LOCALAPPDATA||n.default.join(t.homedir(),"AppData","Local")}e=n.default.join(r,"ms-playwright")}return n.default.isAbsolute(e)||(e=n.default.resolve((0,c.getFromENV)("INIT_CWD")||process.cwd(),e)),e})();function x(e){return e.browsers.map((e=>{const t=e.name,r=(e.revisionOverrides||{})[d.hostPlatform],i=r||e.revision,o=r?`${t}_${d.hostPlatform}_special`:`${t}`;return{name:t,revision:i,installByDefault:!!e.installByDefault,dir:n.default.join(S,o.replace(/-/g,"_")+"-"+i)}}))}e.registryDirectory=S;const k=["chromium","firefox","webkit","ffmpeg","firefox-beta","chromium-with-symbols"];class P{constructor(e){this._executables=void 0;const t=x(e),r=(e,t)=>{let r;return d.hostPlatform.startsWith("ubuntu")||d.hostPlatform.startsWith("generic-linux")?r=b[t].linux:d.hostPlatform.startsWith("mac")?r=b[t].mac:d.hostPlatform.startsWith("win")&&(r=b[t].win),r?n.default.join(e,...r):void 0},i=(e,t,n,r)=>{if(!t)throw new Error(`${e} is not supported on ${d.hostPlatform}`);const i=A(r,"install"+(n?"":" "+e));if(!(0,u.canAccessFile)(t)){const e=["Looks like Playwright Test or Playwright was just installed or updated.",`Please run the following command to download new browser${n?"s":""}:`,"",`    ${i}`,"","<3 Playwright Team"].join("\n");throw new Error(`Executable doesn't exist at ${t}\n${(0,c.wrapInASCIIBox)(e,1)}`)}return t};this._executables=[];const o=t.find((e=>"chromium"===e.name)),s=r(o.dir,"chromium");this._executables.push({type:"browser",name:"chromium",browserName:"chromium",directory:o.dir,executablePath:()=>s,executablePathOrDie:e=>i("chromium",s,o.installByDefault,e),installType:o.installByDefault?"download-by-default":"download-on-demand",validateHostRequirements:e=>this._validateHostRequirements(e,"chromium",o.dir,["chrome-linux"],[],["chrome-win"]),_install:()=>this._downloadExecutable(o,s,y.chromium[d.hostPlatform],"PLAYWRIGHT_CHROMIUM_DOWNLOAD_HOST"),_dependencyGroup:"chromium",_isHermeticInstallation:!0});const a=t.find((e=>"chromium-with-symbols"===e.name)),l=r(a.dir,"chromium");this._executables.push({type:"tool",name:"chromium-with-symbols",browserName:"chromium",directory:a.dir,executablePath:()=>l,executablePathOrDie:e=>i("chromium-with-symbols",l,a.installByDefault,e),installType:a.installByDefault?"download-by-default":"download-on-demand",validateHostRequirements:e=>this._validateHostRequirements(e,"chromium",a.dir,["chrome-linux"],[],["chrome-win"]),_install:()=>this._downloadExecutable(a,l,y["chromium-with-symbols"][d.hostPlatform],"PLAYWRIGHT_CHROMIUM_DOWNLOAD_HOST"),_dependencyGroup:"chromium",_isHermeticInstallation:!0}),this._executables.push(this._createChromiumChannel("chrome",{linux:"/opt/google/chrome/chrome",darwin:"/Applications/Google Chrome.app/Contents/MacOS/Google Chrome",win32:"\\Google\\Chrome\\Application\\chrome.exe"},(()=>this._installChromiumChannel("chrome",{linux:"reinstall_chrome_stable_linux.sh",darwin:"reinstall_chrome_stable_mac.sh",win32:"reinstall_chrome_stable_win.ps1"})))),this._executables.push(this._createChromiumChannel("chrome-beta",{linux:"/opt/google/chrome-beta/chrome",darwin:"/Applications/Google Chrome Beta.app/Contents/MacOS/Google Chrome Beta",win32:"\\Google\\Chrome Beta\\Application\\chrome.exe"},(()=>this._installChromiumChannel("chrome-beta",{linux:"reinstall_chrome_beta_linux.sh",darwin:"reinstall_chrome_beta_mac.sh",win32:"reinstall_chrome_beta_win.ps1"})))),this._executables.push(this._createChromiumChannel("chrome-dev",{linux:"/opt/google/chrome-unstable/chrome",darwin:"/Applications/Google Chrome Dev.app/Contents/MacOS/Google Chrome Dev",win32:"\\Google\\Chrome Dev\\Application\\chrome.exe"})),this._executables.push(this._createChromiumChannel("chrome-canary",{linux:"",darwin:"/Applications/Google Chrome Canary.app/Contents/MacOS/Google Chrome Canary",win32:"\\Google\\Chrome SxS\\Application\\chrome.exe"})),this._executables.push(this._createChromiumChannel("msedge",{linux:"/opt/microsoft/msedge/msedge",darwin:"/Applications/Microsoft Edge.app/Contents/MacOS/Microsoft Edge",win32:"\\Microsoft\\Edge\\Application\\msedge.exe"},(()=>this._installMSEdgeChannel("msedge",{linux:"reinstall_msedge_stable_linux.sh",darwin:"reinstall_msedge_stable_mac.sh",win32:"reinstall_msedge_stable_win.ps1"})))),this._executables.push(this._createChromiumChannel("msedge-beta",{linux:"/opt/microsoft/msedge-beta/msedge",darwin:"/Applications/Microsoft Edge Beta.app/Contents/MacOS/Microsoft Edge Beta",win32:"\\Microsoft\\Edge Beta\\Application\\msedge.exe"},(()=>this._installMSEdgeChannel("msedge-beta",{darwin:"reinstall_msedge_beta_mac.sh",linux:"reinstall_msedge_beta_linux.sh",win32:"reinstall_msedge_beta_win.ps1"})))),this._executables.push(this._createChromiumChannel("msedge-dev",{linux:"/opt/microsoft/msedge-dev/msedge",darwin:"/Applications/Microsoft Edge Dev.app/Contents/MacOS/Microsoft Edge Dev",win32:"\\Microsoft\\Edge Dev\\Application\\msedge.exe"},(()=>this._installMSEdgeChannel("msedge-dev",{darwin:"reinstall_msedge_dev_mac.sh",linux:"reinstall_msedge_dev_linux.sh",win32:"reinstall_msedge_dev_win.ps1"})))),this._executables.push(this._createChromiumChannel("msedge-canary",{linux:"",darwin:"/Applications/Microsoft Edge Canary.app/Contents/MacOS/Microsoft Edge Canary",win32:"\\Microsoft\\Edge SxS\\Application\\msedge.exe"}));const h=t.find((e=>"firefox"===e.name)),p=r(h.dir,"firefox");this._executables.push({type:"browser",name:"firefox",browserName:"firefox",directory:h.dir,executablePath:()=>p,executablePathOrDie:e=>i("firefox",p,h.installByDefault,e),installType:h.installByDefault?"download-by-default":"download-on-demand",validateHostRequirements:e=>this._validateHostRequirements(e,"firefox",h.dir,["firefox"],[],["firefox"]),_install:()=>this._downloadExecutable(h,p,y.firefox[d.hostPlatform],"PLAYWRIGHT_FIREFOX_DOWNLOAD_HOST"),_dependencyGroup:"firefox",_isHermeticInstallation:!0});const f=t.find((e=>"firefox-beta"===e.name)),m=r(f.dir,"firefox");this._executables.push({type:"tool",name:"firefox-beta",browserName:"firefox",directory:f.dir,executablePath:()=>m,executablePathOrDie:e=>i("firefox-beta",m,f.installByDefault,e),installType:f.installByDefault?"download-by-default":"download-on-demand",validateHostRequirements:e=>this._validateHostRequirements(e,"firefox",f.dir,["firefox"],[],["firefox"]),_install:()=>this._downloadExecutable(f,m,y["firefox-beta"][d.hostPlatform],"PLAYWRIGHT_FIREFOX_DOWNLOAD_HOST"),_dependencyGroup:"firefox",_isHermeticInstallation:!0});const g=t.find((e=>"webkit"===e.name)),_=r(g.dir,"webkit"),w=[n.default.join("minibrowser-gtk"),n.default.join("minibrowser-gtk","bin"),n.default.join("minibrowser-gtk","lib"),n.default.join("minibrowser-gtk","sys","lib"),n.default.join("minibrowser-wpe"),n.default.join("minibrowser-wpe","bin"),n.default.join("minibrowser-wpe","lib"),n.default.join("minibrowser-wpe","sys","lib")];this._executables.push({type:"browser",name:"webkit",browserName:"webkit",directory:g.dir,executablePath:()=>_,executablePathOrDie:e=>i("webkit",_,g.installByDefault,e),installType:g.installByDefault?"download-by-default":"download-on-demand",validateHostRequirements:e=>this._validateHostRequirements(e,"webkit",g.dir,w,["libGLESv2.so.2","libx264.so"],[""]),_install:()=>this._downloadExecutable(g,_,y.webkit[d.hostPlatform],"PLAYWRIGHT_WEBKIT_DOWNLOAD_HOST"),_dependencyGroup:"webkit",_isHermeticInstallation:!0});const v=t.find((e=>"ffmpeg"===e.name)),S=r(v.dir,"ffmpeg");this._executables.push({type:"tool",name:"ffmpeg",browserName:void 0,directory:v.dir,executablePath:()=>S,executablePathOrDie:e=>i("ffmpeg",S,v.installByDefault,e),installType:v.installByDefault?"download-by-default":"download-on-demand",validateHostRequirements:()=>Promise.resolve(),_install:()=>this._downloadExecutable(v,S,y.ffmpeg[d.hostPlatform],"PLAYWRIGHT_FFMPEG_DOWNLOAD_HOST"),_dependencyGroup:"tools",_isHermeticInstallation:!0})}_createChromiumChannel(e,t,r){const i=(i,o)=>{const s=t[process.platform];if(!s){if(o)throw new Error(`Chromium distribution '${e}' is not supported on ${process.platform}`);return}const a="win32"===process.platform?[process.env.LOCALAPPDATA,process.env.PROGRAMFILES,process.env["PROGRAMFILES(X86)"]].filter(Boolean):[""];for(const e of a){const t=n.default.join(e,s);if((0,u.canAccessFile)(t))return t}if(!o)return;const l=a.length?` at ${n.default.join(a[0],s)}`:"",c=r?`\nRun "${A(i,"install "+e)}"`:"";throw new Error(`Chromium distribution '${e}' is not found${l}${c}`)};return{type:"channel",name:e,browserName:"chromium",directory:void 0,executablePath:e=>i(e,!1),executablePathOrDie:e=>i(e,!0),installType:r?"install-script":"none",validateHostRequirements:()=>Promise.resolve(),_isHermeticInstallation:!1,_install:r}}executables(){return this._executables}findExecutable(e){return this._executables.find((t=>t.name===e))}defaultExecutables(){return this._executables.filter((e=>"download-by-default"===e.installType))}_addRequirementsAndDedupe(e){const t=new Set;for(const n of e)t.add(n),"chromium"===n.browserName&&t.add(this.findExecutable("ffmpeg"));return Array.from(t)}async _validateHostRequirements(e,r,i,o,a,l){if((0,c.getAsBooleanFromENV)("PLAYWRIGHT_SKIP_VALIDATE_HOST_REQUIREMENTS"))return void process.stdout.write("Skipping host requirements validation logic because `PLAYWRIGHT_SKIP_VALIDATE_HOST_REQUIREMENTS` env variable is set.\n");const u=await(0,s.getUbuntuVersion)();if("firefox"===r&&"16.04"===u)throw new Error("Cannot launch Firefox on Ubuntu 16.04! Minimum required Ubuntu version for Firefox browser is 18.04");return"linux"===t.platform()?await(0,p.validateDependenciesLinux)(e,o.map((e=>n.default.join(i,e))),a):"win32"===t.platform()&&"x64"===t.arch()?await(0,p.validateDependenciesWindows)(l.map((e=>n.default.join(i,e)))):void 0}async installDeps(e,n){const r=this._addRequirementsAndDedupe(e),i=new Set;for(const e of r)e._dependencyGroup&&i.add(e._dependencyGroup);return i.add("tools"),"win32"===t.platform()?await(0,p.installDependenciesWindows)(i,n):"linux"===t.platform()?await(0,p.installDependenciesLinux)(i,n):void 0}async install(e,t){const r=this._addRequirementsAndDedupe(e);await i.promises.mkdir(S,{recursive:!0});const s=n.default.join(S,"__dirlock"),a=n.default.join(S,".links");let u;try{u=await o.default.lock(S,{retries:{retries:20,factor:1.27579},onCompromised:e=>{throw new Error(`${e.message} Path: ${s}`)},lockfilePath:s}),await i.promises.mkdir(a,{recursive:!0}),await i.promises.writeFile(n.default.join(a,(0,c.calculateSha1)(w)),w),await this._validateInstallationCache(a);for(const e of r){if(!e._install)throw new Error(`ERROR: Playwright does not support installing ${e.name}`);const{langName:n}=(0,l.getClientLanguage)();if(!(0,c.getAsBooleanFromENV)("CI")&&!e._isHermeticInstallation&&!t&&e.executablePath(n)){const t=A(n,"install --force "+e.name);throw new Error("\n"+(0,c.wrapInASCIIBox)([`ATTENTION: "${e.name}" is already installed on the system!`,"",`"${e.name}" installation is not hermetic; installing newer version`,"requires *removal* of a current installation first.","",`To *uninstall* current version and re-install latest "${e.name}":`,"",`- Close all running instances of "${e.name}", if any`,'- Use "--force" to install browser:',"",`    ${t}`,"","<3 Playwright Team"].join("\n"),1))}await e._install()}}catch(e){if("ELOCKED"===e.code){const e="win32"===process.platform?"rm -R":"rm -rf";throw new Error("\n"+(0,c.wrapInASCIIBox)(["An active lockfile is found at:","",`  ${s}`,"","Either:","- wait a few minutes if other Playwright is installing browsers in parallel","- remove lock manually with:","",`    ${e} ${s}`,"","<3 Playwright Team"].join("\n"),1))}throw e}finally{u&&await u()}}async _downloadExecutable(e,t,n,o){if(!n||!t)throw new Error(`ERROR: Playwright does not support ${e.name} on ${d.hostPlatform}`);"generic-linux"!==d.hostPlatform&&"generic-linux-arm64"!==d.hostPlatform||(0,f.logPolitely)("BEWARE: your OS is not officially supported by Playwright; downloading Ubuntu build as a fallback.");const s=`${o&&(0,c.getFromENV)(o)||(0,c.getFromENV)("PLAYWRIGHT_DOWNLOAD_HOST")||"https://playwright.azureedge.net"}/${r.format(n,e.revision)}`,a=`${e.name} v${e.revision}`,l=`playwright-download-${e.name}-${d.hostPlatform}-${e.revision}.zip`;await(0,f.downloadBrowserWithProgressBar)(a,e.dir,t,s,l).catch((e=>{throw new Error(`Failed to download ${a}, caused by\n${e.stack}`)})),await i.promises.writeFile(O(e.dir),"")}async _installMSEdgeChannel(e,t){const n=[];if("linux"!==process.platform){const t=JSON.parse(await(0,a.fetchData)({url:"https://edgeupdates.microsoft.com/api/products"})),r={msedge:"Stable","msedge-beta":"Beta","msedge-dev":"Dev"}[e],i=t.find((e=>e.Product===r)),o={darwin:{platform:"MacOS",arch:"universal",artifact:"pkg"},win32:{platform:"Windows",arch:"x64",artifact:"msi"}}[process.platform],s=o?i.Releases.find((e=>e.Platform===o.platform&&e.Architecture===o.arch)):null,l=s?s.Artifacts.find((e=>e.ArtifactName===o.artifact)):null;if(!l)throw new Error(`Cannot install ${e} on ${process.platform}`);n.push(l.Location)}await this._installChromiumChannel(e,t,n)}async _installChromiumChannel(e,t,r=[]){const i=t[process.platform];if(!i)throw new Error(`Cannot install ${e} on ${process.platform}`);const o=v;if(i.endsWith(".ps1")){const t=["-ExecutionPolicy","Bypass","-File",n.default.join(v,i),...r],{code:s}=await(0,h.spawnAsync)("powershell.exe",t,{cwd:o,stdio:"inherit"});if(0!==s)throw new Error(`Failed to install ${e}`)}else{const{command:t,args:s,elevatedPermissions:a}=await(0,p.transformCommandsForRoot)([`bash "${n.default.join(v,i)}" ${r.join("")}`]);a&&console.log("Switching to root user to install dependencies...");const{code:l}=await(0,h.spawnAsync)(t,s,{cwd:o,stdio:"inherit"});if(0!==l)throw new Error(`Failed to install ${e}`)}}async _validateInstallationCache(e){const t=new Set;for(const r of await i.promises.readdir(e)){const o=n.default.join(e,r);let s="";try{s=(await i.promises.readFile(o)).toString();const e=x(kt(n.default.join(s,"browsers.json")));for(const n of k){const r=e.find((e=>e.name===n));if(!r)continue;const i=r.dir,o=parseInt(r.revision,10);("chromium"===n&&o>=786218||"firefox"===n&&o>=1128||"webkit"===n&&o>=1307||"firefox"!==n&&"chromium"!==n&&"webkit"!==n)&&!await(0,u.existsAsync)(O(i))||t.add(i)}}catch(e){await i.promises.unlink(o).catch((e=>{}))}}if(!(0,c.getAsBooleanFromENV)("PLAYWRIGHT_SKIP_BROWSER_GC")){let e=(await i.promises.readdir(S)).map((e=>n.default.join(S,e)));e=e.filter((e=>function(e){const t=n.default.basename(e);for(const e of k)if(t.startsWith(e+"-"))return!0;return!1}(e)));const r=new Set(e);for(const e of t)r.delete(e);for(const e of r)(0,f.logPolitely)("Removing unused browser at "+e);await(0,u.removeFolders)([...r])}}}function O(e){return n.default.join(e,"INSTALLATION_COMPLETE")}function A(e,t){switch(e){case"python":return`playwright ${t}`;case"java":return`mvn exec:java -e -Dexec.mainClass=com.microsoft.playwright.CLI -Dexec.args="${t}"`;case"csharp":return`pwsh bin\\Debug\\netX\\playwright.ps1 ${t}`;default:return`npx playwright ${t}`}}async function I(e){if((0,c.getAsBooleanFromENV)("PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD"))return(0,f.logPolitely)("Skipping browsers download because `PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD` env variable is set"),!1;const t=[];for(const n of e){const e=M.findExecutable(n);if(!e||"none"===e.installType)throw new Error(`Cannot install ${n}`);t.push(e)}await M.install(t,!1)}e.Registry=P;const M=new P(Cl);e.registry=M}(Et)),Et}var Pl={},Ol={},Al={};Object.defineProperty(Al,"__esModule",{value:!0}),Al.TimeoutError=void 0,Al.isSafeCloseError=function(e){return e.message.endsWith("Browser has been closed")||e.message.endsWith("Target page, context or browser has been closed")},Al.kBrowserOrContextClosedError=Al.kBrowserClosedError=void 0;class Il extends Error{constructor(e){super(e),this.name=this.constructor.name,Error.captureStackTrace(this,this.constructor)}}Al.TimeoutError=class extends Il{};Al.kBrowserClosedError="Browser has been closed";Al.kBrowserOrContextClosedError="Target page, context or browser has been closed",Object.defineProperty(Ol,"__esModule",{value:!0}),Ol.parseError=function(e){if(!e.error){if(void 0===e.value)throw new Error("Serialized error must have either an error or a value");return Fl(e.value,void 0)}if("TimeoutError"===e.error.name){const t=new Ml.TimeoutError(e.error.message);return t.stack=e.error.stack||"",t}const t=new Error(e.error.message);return t.stack=e.error.stack||"",t.name=e.error.name,t},Ol.parseSerializedValue=Fl,Ol.serializeError=function(e){return Rl(e)?{error:{message:e.message,stack:e.stack,name:e.name}}:{value:Nl(e,(e=>({fallThrough:e})),new Set)}},Ol.serializeValue=Nl;var Ml=Al;function Fl(e,t){if(void 0!==e.n)return e.n;if(void 0!==e.s)return e.s;if(void 0!==e.b)return e.b;if(void 0!==e.v){if("undefined"===e.v)return;if("null"===e.v)return null;if("NaN"===e.v)return NaN;if("Infinity"===e.v)return 1/0;if("-Infinity"===e.v)return-1/0;if("-0"===e.v)return-0}if(void 0!==e.d)return new Date(e.d);if(void 0!==e.r)return new RegExp(e.r.p,e.r.f);if(void 0!==e.a)return e.a.map((e=>Fl(e,t)));if(void 0!==e.o){const n={};for(const{k:r,v:i}of e.o)n[r]=Fl(i,t);return n}if(void 0!==e.h){if(void 0===t)throw new Error("Unexpected handle");return t[e.h]}throw new Error("Unexpected value")}function Nl(e,t,n){const r=t(e);if(!("fallThrough"in r))return r;if(e=r.fallThrough,n.has(e))throw new Error("Argument is a circular structure");if("symbol"==typeof e)return{v:"undefined"};if(Object.is(e,void 0))return{v:"undefined"};if(Object.is(e,null))return{v:"null"};if(Object.is(e,NaN))return{v:"NaN"};if(Object.is(e,1/0))return{v:"Infinity"};if(Object.is(e,-1/0))return{v:"-Infinity"};if(Object.is(e,-0))return{v:"-0"};if("boolean"==typeof e)return{b:e};if("number"==typeof e)return{n:e};if("string"==typeof e)return{s:e};if(Rl(e)){const t=e;return"captureStackTrace"in globalThis.Error?{s:t.stack||""}:{s:`${t.name}: ${t.message}\n${t.stack}`}}if(function(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}(e))return{d:e.toJSON()};if(function(e){return e instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(e)}(e))return{r:{p:e.source,f:e.flags}};if(Array.isArray(e)){const r=[];n.add(e);for(let i=0;i<e.length;++i)r.push(Nl(e[i],t,n));return n.delete(e),{a:r}}if("object"==typeof e){const r=[];n.add(e);for(const i of Object.keys(e))r.push({k:i,v:Nl(e[i],t,n)});return n.delete(e),{o:r}}throw new Error("Unexpected value")}function Rl(e){var t;return e instanceof Error||"Error"===(null==e||null===(t=e.__proto__)||void 0===t?void 0:t.name)||(null==e?void 0:e.__proto__)&&Rl(e.__proto__)}var jl={},Dl={};Object.defineProperty(Dl,"__esModule",{value:!0}),Dl.tUndefined=Dl.tString=Dl.tOptional=Dl.tObject=Dl.tNumber=Dl.tEnum=Dl.tBoolean=Dl.tBinary=Dl.tArray=Dl.tAny=Dl.ValidationError=void 0;var Ll=Ci;class Bl extends Error{}Dl.ValidationError=Bl;Dl.tNumber=(e,t)=>{if(e instanceof Number)return e.valueOf();if("number"==typeof e)return e;throw new Bl(`${t}: expected number, got ${typeof e}`)};Dl.tBoolean=(e,t)=>{if(e instanceof Boolean)return e.valueOf();if("boolean"==typeof e)return e;throw new Bl(`${t}: expected boolean, got ${typeof e}`)};Dl.tString=(e,t)=>{if(e instanceof String)return e.valueOf();if("string"==typeof e)return e;throw new Bl(`${t}: expected string, got ${typeof e}`)};Dl.tBinary=(e,t)=>{if(e instanceof String)return e.valueOf();if("string"==typeof e)return e;throw new Bl(`${t}: expected base64-encoded buffer, got ${typeof e}`)};Dl.tUndefined=(e,t)=>{if(Object.is(e,void 0))return e;throw new Bl(`${t}: expected undefined, got ${typeof e}`)};Dl.tAny=(e,t)=>e;Dl.tOptional=e=>(t,n)=>Object.is(t,void 0)?t:e(t,n);Dl.tArray=e=>(t,n)=>{if(!Array.isArray(t))throw new Bl(`${n}: expected array, got ${typeof t}`);return t.map(((t,r)=>e(t,n+"["+r+"]")))};Dl.tObject=e=>(t,n)=>{if(Object.is(t,null))throw new Bl(`${n}: expected object, got null`);if("object"!=typeof t)throw new Bl(`${n}: expected object, got ${typeof t}`);const r={};for(const[i,o]of Object.entries(e)){const e=o(t[i],n?n+"."+i:i);Object.is(e,void 0)||(r[i]=e)}if((0,Ll.isUnderTest)())for(const[e,n]of Object.entries(t))e.startsWith("__testHook")&&(r[e]=n);return r};Dl.tEnum=e=>(t,n)=>{if(!e.includes(t))throw new Bl(`${n}: expected one of (${e.join("|")})`);return t},function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"ValidationError",{enumerable:!0,get:function(){return t.ValidationError}}),e.createScheme=function(e){const n={},r=e=>(r,i)=>{const o=n[e];if(!o)throw new t.ValidationError(i+': unknown type "'+e+'"');return o(r,i)};return n.StackFrame=(0,t.tObject)({file:t.tString,line:(0,t.tOptional)(t.tNumber),column:(0,t.tOptional)(t.tNumber),function:(0,t.tOptional)(t.tString)}),n.Metadata=(0,t.tObject)({stack:(0,t.tOptional)((0,t.tArray)(r("StackFrame"))),apiName:(0,t.tOptional)(t.tString),internal:(0,t.tOptional)(t.tBoolean)}),n.Point=(0,t.tObject)({x:t.tNumber,y:t.tNumber}),n.Rect=(0,t.tObject)({x:t.tNumber,y:t.tNumber,width:t.tNumber,height:t.tNumber}),n.SerializedValue=(0,t.tObject)({n:(0,t.tOptional)(t.tNumber),b:(0,t.tOptional)(t.tBoolean),s:(0,t.tOptional)(t.tString),v:(0,t.tOptional)((0,t.tEnum)(["null","undefined","NaN","Infinity","-Infinity","-0"])),d:(0,t.tOptional)(t.tString),r:(0,t.tOptional)((0,t.tObject)({p:t.tString,f:t.tString})),a:(0,t.tOptional)((0,t.tArray)(r("SerializedValue"))),o:(0,t.tOptional)((0,t.tArray)((0,t.tObject)({k:t.tString,v:r("SerializedValue")}))),h:(0,t.tOptional)(t.tNumber)}),n.SerializedArgument=(0,t.tObject)({value:r("SerializedValue"),handles:(0,t.tArray)(e("*"))}),n.ExpectedTextValue=(0,t.tObject)({string:(0,t.tOptional)(t.tString),regexSource:(0,t.tOptional)(t.tString),regexFlags:(0,t.tOptional)(t.tString),matchSubstring:(0,t.tOptional)(t.tBoolean),normalizeWhiteSpace:(0,t.tOptional)(t.tBoolean)}),n.AXNode=(0,t.tObject)({role:t.tString,name:t.tString,valueString:(0,t.tOptional)(t.tString),valueNumber:(0,t.tOptional)(t.tNumber),description:(0,t.tOptional)(t.tString),keyshortcuts:(0,t.tOptional)(t.tString),roledescription:(0,t.tOptional)(t.tString),valuetext:(0,t.tOptional)(t.tString),disabled:(0,t.tOptional)(t.tBoolean),expanded:(0,t.tOptional)(t.tBoolean),focused:(0,t.tOptional)(t.tBoolean),modal:(0,t.tOptional)(t.tBoolean),multiline:(0,t.tOptional)(t.tBoolean),multiselectable:(0,t.tOptional)(t.tBoolean),readonly:(0,t.tOptional)(t.tBoolean),required:(0,t.tOptional)(t.tBoolean),selected:(0,t.tOptional)(t.tBoolean),checked:(0,t.tOptional)((0,t.tEnum)(["checked","unchecked","mixed"])),pressed:(0,t.tOptional)((0,t.tEnum)(["pressed","released","mixed"])),level:(0,t.tOptional)(t.tNumber),valuemin:(0,t.tOptional)(t.tNumber),valuemax:(0,t.tOptional)(t.tNumber),autocomplete:(0,t.tOptional)(t.tString),haspopup:(0,t.tOptional)(t.tString),invalid:(0,t.tOptional)(t.tString),orientation:(0,t.tOptional)(t.tString),children:(0,t.tOptional)((0,t.tArray)(r("AXNode")))}),n.SetNetworkCookie=(0,t.tObject)({name:t.tString,value:t.tString,url:(0,t.tOptional)(t.tString),domain:(0,t.tOptional)(t.tString),path:(0,t.tOptional)(t.tString),expires:(0,t.tOptional)(t.tNumber),httpOnly:(0,t.tOptional)(t.tBoolean),secure:(0,t.tOptional)(t.tBoolean),sameSite:(0,t.tOptional)((0,t.tEnum)(["Strict","Lax","None"]))}),n.NetworkCookie=(0,t.tObject)({name:t.tString,value:t.tString,domain:t.tString,path:t.tString,expires:t.tNumber,httpOnly:t.tBoolean,secure:t.tBoolean,sameSite:(0,t.tEnum)(["Strict","Lax","None"])}),n.NameValue=(0,t.tObject)({name:t.tString,value:t.tString}),n.OriginStorage=(0,t.tObject)({origin:t.tString,localStorage:(0,t.tArray)(r("NameValue"))}),n.SerializedError=(0,t.tObject)({error:(0,t.tOptional)((0,t.tObject)({message:t.tString,name:t.tString,stack:(0,t.tOptional)(t.tString)})),value:(0,t.tOptional)(r("SerializedValue"))}),n.FormField=(0,t.tObject)({name:t.tString,value:(0,t.tOptional)(t.tString),file:(0,t.tOptional)((0,t.tObject)({name:t.tString,mimeType:(0,t.tOptional)(t.tString),buffer:t.tBinary}))}),n.APIRequestContextFetchParams=(0,t.tObject)({url:t.tString,params:(0,t.tOptional)((0,t.tArray)(r("NameValue"))),method:(0,t.tOptional)(t.tString),headers:(0,t.tOptional)((0,t.tArray)(r("NameValue"))),postData:(0,t.tOptional)(t.tBinary),jsonData:(0,t.tOptional)(t.tAny),formData:(0,t.tOptional)((0,t.tArray)(r("NameValue"))),multipartData:(0,t.tOptional)((0,t.tArray)(r("FormField"))),timeout:(0,t.tOptional)(t.tNumber),failOnStatusCode:(0,t.tOptional)(t.tBoolean),ignoreHTTPSErrors:(0,t.tOptional)(t.tBoolean)}),n.APIRequestContextFetchResponseBodyParams=(0,t.tObject)({fetchUid:t.tString}),n.APIRequestContextFetchLogParams=(0,t.tObject)({fetchUid:t.tString}),n.APIRequestContextStorageStateParams=(0,t.tOptional)((0,t.tObject)({})),n.APIRequestContextDisposeAPIResponseParams=(0,t.tObject)({fetchUid:t.tString}),n.APIRequestContextDisposeParams=(0,t.tOptional)((0,t.tObject)({})),n.APIResponse=(0,t.tObject)({fetchUid:t.tString,url:t.tString,status:t.tNumber,statusText:t.tString,headers:(0,t.tArray)(r("NameValue"))}),n.LifecycleEvent=(0,t.tEnum)(["load","domcontentloaded","networkidle","commit"]),n.LocalUtilsZipParams=(0,t.tObject)({zipFile:t.tString,entries:(0,t.tArray)(r("NameValue"))}),n.RootInitializeParams=(0,t.tObject)({sdkLanguage:t.tString}),n.PlaywrightNewRequestParams=(0,t.tObject)({baseURL:(0,t.tOptional)(t.tString),userAgent:(0,t.tOptional)(t.tString),ignoreHTTPSErrors:(0,t.tOptional)(t.tBoolean),extraHTTPHeaders:(0,t.tOptional)((0,t.tArray)(r("NameValue"))),httpCredentials:(0,t.tOptional)((0,t.tObject)({username:t.tString,password:t.tString})),proxy:(0,t.tOptional)((0,t.tObject)({server:t.tString,bypass:(0,t.tOptional)(t.tString),username:(0,t.tOptional)(t.tString),password:(0,t.tOptional)(t.tString)})),timeout:(0,t.tOptional)(t.tNumber),storageState:(0,t.tOptional)((0,t.tObject)({cookies:(0,t.tArray)(r("NetworkCookie")),origins:(0,t.tArray)(r("OriginStorage"))})),tracesDir:(0,t.tOptional)(t.tString)}),n.PlaywrightHideHighlightParams=(0,t.tOptional)((0,t.tObject)({})),n.SocksSupportSocksConnectedParams=(0,t.tObject)({uid:t.tString,host:t.tString,port:t.tNumber}),n.SocksSupportSocksFailedParams=(0,t.tObject)({uid:t.tString,errorCode:t.tString}),n.SocksSupportSocksDataParams=(0,t.tObject)({uid:t.tString,data:t.tBinary}),n.SocksSupportSocksErrorParams=(0,t.tObject)({uid:t.tString,error:t.tString}),n.SocksSupportSocksEndParams=(0,t.tObject)({uid:t.tString}),n.SelectorsRegisterParams=(0,t.tObject)({name:t.tString,source:t.tString,contentScript:(0,t.tOptional)(t.tBoolean)}),n.BrowserTypeConnectParams=(0,t.tObject)({wsEndpoint:t.tString,headers:(0,t.tOptional)(t.tAny),slowMo:(0,t.tOptional)(t.tNumber),timeout:(0,t.tOptional)(t.tNumber),socksProxyRedirectPortForTest:(0,t.tOptional)(t.tNumber)}),n.BrowserTypeLaunchParams=(0,t.tObject)({channel:(0,t.tOptional)(t.tString),executablePath:(0,t.tOptional)(t.tString),args:(0,t.tOptional)((0,t.tArray)(t.tString)),ignoreAllDefaultArgs:(0,t.tOptional)(t.tBoolean),ignoreDefaultArgs:(0,t.tOptional)((0,t.tArray)(t.tString)),handleSIGINT:(0,t.tOptional)(t.tBoolean),handleSIGTERM:(0,t.tOptional)(t.tBoolean),handleSIGHUP:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber),env:(0,t.tOptional)((0,t.tArray)(r("NameValue"))),headless:(0,t.tOptional)(t.tBoolean),devtools:(0,t.tOptional)(t.tBoolean),proxy:(0,t.tOptional)((0,t.tObject)({server:t.tString,bypass:(0,t.tOptional)(t.tString),username:(0,t.tOptional)(t.tString),password:(0,t.tOptional)(t.tString)})),downloadsPath:(0,t.tOptional)(t.tString),tracesDir:(0,t.tOptional)(t.tString),chromiumSandbox:(0,t.tOptional)(t.tBoolean),firefoxUserPrefs:(0,t.tOptional)(t.tAny),slowMo:(0,t.tOptional)(t.tNumber)}),n.BrowserTypeLaunchPersistentContextParams=(0,t.tObject)({channel:(0,t.tOptional)(t.tString),executablePath:(0,t.tOptional)(t.tString),args:(0,t.tOptional)((0,t.tArray)(t.tString)),ignoreAllDefaultArgs:(0,t.tOptional)(t.tBoolean),ignoreDefaultArgs:(0,t.tOptional)((0,t.tArray)(t.tString)),handleSIGINT:(0,t.tOptional)(t.tBoolean),handleSIGTERM:(0,t.tOptional)(t.tBoolean),handleSIGHUP:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber),env:(0,t.tOptional)((0,t.tArray)(r("NameValue"))),headless:(0,t.tOptional)(t.tBoolean),devtools:(0,t.tOptional)(t.tBoolean),proxy:(0,t.tOptional)((0,t.tObject)({server:t.tString,bypass:(0,t.tOptional)(t.tString),username:(0,t.tOptional)(t.tString),password:(0,t.tOptional)(t.tString)})),downloadsPath:(0,t.tOptional)(t.tString),tracesDir:(0,t.tOptional)(t.tString),chromiumSandbox:(0,t.tOptional)(t.tBoolean),noDefaultViewport:(0,t.tOptional)(t.tBoolean),viewport:(0,t.tOptional)((0,t.tObject)({width:t.tNumber,height:t.tNumber})),screen:(0,t.tOptional)((0,t.tObject)({width:t.tNumber,height:t.tNumber})),ignoreHTTPSErrors:(0,t.tOptional)(t.tBoolean),javaScriptEnabled:(0,t.tOptional)(t.tBoolean),bypassCSP:(0,t.tOptional)(t.tBoolean),userAgent:(0,t.tOptional)(t.tString),locale:(0,t.tOptional)(t.tString),timezoneId:(0,t.tOptional)(t.tString),geolocation:(0,t.tOptional)((0,t.tObject)({longitude:t.tNumber,latitude:t.tNumber,accuracy:(0,t.tOptional)(t.tNumber)})),permissions:(0,t.tOptional)((0,t.tArray)(t.tString)),extraHTTPHeaders:(0,t.tOptional)((0,t.tArray)(r("NameValue"))),offline:(0,t.tOptional)(t.tBoolean),httpCredentials:(0,t.tOptional)((0,t.tObject)({username:t.tString,password:t.tString})),deviceScaleFactor:(0,t.tOptional)(t.tNumber),isMobile:(0,t.tOptional)(t.tBoolean),hasTouch:(0,t.tOptional)(t.tBoolean),colorScheme:(0,t.tOptional)((0,t.tEnum)(["dark","light","no-preference"])),reducedMotion:(0,t.tOptional)((0,t.tEnum)(["reduce","no-preference"])),forcedColors:(0,t.tOptional)((0,t.tEnum)(["active","none"])),acceptDownloads:(0,t.tOptional)(t.tBoolean),baseURL:(0,t.tOptional)(t.tString),recordVideo:(0,t.tOptional)((0,t.tObject)({dir:t.tString,size:(0,t.tOptional)((0,t.tObject)({width:t.tNumber,height:t.tNumber}))})),recordHar:(0,t.tOptional)((0,t.tObject)({omitContent:(0,t.tOptional)(t.tBoolean),path:t.tString})),strictSelectors:(0,t.tOptional)(t.tBoolean),userDataDir:t.tString,slowMo:(0,t.tOptional)(t.tNumber)}),n.BrowserTypeConnectOverCDPParams=(0,t.tObject)({endpointURL:t.tString,headers:(0,t.tOptional)((0,t.tArray)(r("NameValue"))),slowMo:(0,t.tOptional)(t.tNumber),timeout:(0,t.tOptional)(t.tNumber)}),n.BrowserCloseParams=(0,t.tOptional)((0,t.tObject)({})),n.BrowserKillForTestsParams=(0,t.tOptional)((0,t.tObject)({})),n.BrowserNewContextParams=(0,t.tObject)({noDefaultViewport:(0,t.tOptional)(t.tBoolean),viewport:(0,t.tOptional)((0,t.tObject)({width:t.tNumber,height:t.tNumber})),screen:(0,t.tOptional)((0,t.tObject)({width:t.tNumber,height:t.tNumber})),ignoreHTTPSErrors:(0,t.tOptional)(t.tBoolean),javaScriptEnabled:(0,t.tOptional)(t.tBoolean),bypassCSP:(0,t.tOptional)(t.tBoolean),userAgent:(0,t.tOptional)(t.tString),locale:(0,t.tOptional)(t.tString),timezoneId:(0,t.tOptional)(t.tString),geolocation:(0,t.tOptional)((0,t.tObject)({longitude:t.tNumber,latitude:t.tNumber,accuracy:(0,t.tOptional)(t.tNumber)})),permissions:(0,t.tOptional)((0,t.tArray)(t.tString)),extraHTTPHeaders:(0,t.tOptional)((0,t.tArray)(r("NameValue"))),offline:(0,t.tOptional)(t.tBoolean),httpCredentials:(0,t.tOptional)((0,t.tObject)({username:t.tString,password:t.tString})),deviceScaleFactor:(0,t.tOptional)(t.tNumber),isMobile:(0,t.tOptional)(t.tBoolean),hasTouch:(0,t.tOptional)(t.tBoolean),colorScheme:(0,t.tOptional)((0,t.tEnum)(["dark","light","no-preference"])),reducedMotion:(0,t.tOptional)((0,t.tEnum)(["reduce","no-preference"])),forcedColors:(0,t.tOptional)((0,t.tEnum)(["active","none"])),acceptDownloads:(0,t.tOptional)(t.tBoolean),baseURL:(0,t.tOptional)(t.tString),recordVideo:(0,t.tOptional)((0,t.tObject)({dir:t.tString,size:(0,t.tOptional)((0,t.tObject)({width:t.tNumber,height:t.tNumber}))})),recordHar:(0,t.tOptional)((0,t.tObject)({omitContent:(0,t.tOptional)(t.tBoolean),path:t.tString})),strictSelectors:(0,t.tOptional)(t.tBoolean),proxy:(0,t.tOptional)((0,t.tObject)({server:t.tString,bypass:(0,t.tOptional)(t.tString),username:(0,t.tOptional)(t.tString),password:(0,t.tOptional)(t.tString)})),storageState:(0,t.tOptional)((0,t.tObject)({cookies:(0,t.tOptional)((0,t.tArray)(r("SetNetworkCookie"))),origins:(0,t.tOptional)((0,t.tArray)(r("OriginStorage")))}))}),n.BrowserNewBrowserCDPSessionParams=(0,t.tOptional)((0,t.tObject)({})),n.BrowserStartTracingParams=(0,t.tObject)({page:(0,t.tOptional)(e("Page")),path:(0,t.tOptional)(t.tString),screenshots:(0,t.tOptional)(t.tBoolean),categories:(0,t.tOptional)((0,t.tArray)(t.tString))}),n.BrowserStopTracingParams=(0,t.tOptional)((0,t.tObject)({})),n.EventTargetWaitForEventInfoParams=(0,t.tObject)({info:(0,t.tObject)({waitId:t.tString,phase:(0,t.tEnum)(["before","after","log"]),event:(0,t.tOptional)(t.tString),message:(0,t.tOptional)(t.tString),error:(0,t.tOptional)(t.tString)})}),n.BrowserContextWaitForEventInfoParams=r("EventTargetWaitForEventInfoParams"),n.PageWaitForEventInfoParams=r("EventTargetWaitForEventInfoParams"),n.WebSocketWaitForEventInfoParams=r("EventTargetWaitForEventInfoParams"),n.ElectronApplicationWaitForEventInfoParams=r("EventTargetWaitForEventInfoParams"),n.AndroidDeviceWaitForEventInfoParams=r("EventTargetWaitForEventInfoParams"),n.BrowserContextAddCookiesParams=(0,t.tObject)({cookies:(0,t.tArray)(r("SetNetworkCookie"))}),n.BrowserContextAddInitScriptParams=(0,t.tObject)({source:t.tString}),n.BrowserContextRemoveInitScriptsParams=(0,t.tOptional)((0,t.tObject)({})),n.BrowserContextClearCookiesParams=(0,t.tOptional)((0,t.tObject)({})),n.BrowserContextClearPermissionsParams=(0,t.tOptional)((0,t.tObject)({})),n.BrowserContextCloseParams=(0,t.tOptional)((0,t.tObject)({})),n.BrowserContextCookiesParams=(0,t.tObject)({urls:(0,t.tArray)(t.tString)}),n.BrowserContextExposeBindingParams=(0,t.tObject)({name:t.tString,needsHandle:(0,t.tOptional)(t.tBoolean)}),n.BrowserContextRemoveExposedBindingsParams=(0,t.tOptional)((0,t.tObject)({})),n.BrowserContextGrantPermissionsParams=(0,t.tObject)({permissions:(0,t.tArray)(t.tString),origin:(0,t.tOptional)(t.tString)}),n.BrowserContextNewPageParams=(0,t.tOptional)((0,t.tObject)({})),n.BrowserContextSetDefaultNavigationTimeoutNoReplyParams=(0,t.tObject)({timeout:(0,t.tOptional)(t.tNumber)}),n.BrowserContextSetDefaultTimeoutNoReplyParams=(0,t.tObject)({timeout:(0,t.tOptional)(t.tNumber)}),n.BrowserContextSetExtraHTTPHeadersParams=(0,t.tObject)({headers:(0,t.tArray)(r("NameValue"))}),n.BrowserContextSetGeolocationParams=(0,t.tObject)({geolocation:(0,t.tOptional)((0,t.tObject)({longitude:t.tNumber,latitude:t.tNumber,accuracy:(0,t.tOptional)(t.tNumber)}))}),n.BrowserContextSetHTTPCredentialsParams=(0,t.tObject)({httpCredentials:(0,t.tOptional)((0,t.tObject)({username:t.tString,password:t.tString}))}),n.BrowserContextSetNetworkInterceptionEnabledParams=(0,t.tObject)({enabled:t.tBoolean}),n.BrowserContextSetOfflineParams=(0,t.tObject)({offline:t.tBoolean}),n.BrowserContextStorageStateParams=(0,t.tOptional)((0,t.tObject)({})),n.BrowserContextPauseParams=(0,t.tOptional)((0,t.tObject)({})),n.BrowserContextRecorderSupplementEnableParams=(0,t.tObject)({language:(0,t.tOptional)(t.tString),startRecording:(0,t.tOptional)(t.tBoolean),pauseOnNextStatement:(0,t.tOptional)(t.tBoolean),launchOptions:(0,t.tOptional)(t.tAny),contextOptions:(0,t.tOptional)(t.tAny),device:(0,t.tOptional)(t.tString),saveStorage:(0,t.tOptional)(t.tString),outputFile:(0,t.tOptional)(t.tString)}),n.BrowserContextNewCDPSessionParams=(0,t.tObject)({page:(0,t.tOptional)(e("Page")),frame:(0,t.tOptional)(e("Frame"))}),n.BrowserContextHarExportParams=(0,t.tOptional)((0,t.tObject)({})),n.BrowserContextCreateTempFileParams=(0,t.tObject)({name:t.tString}),n.PageSetDefaultNavigationTimeoutNoReplyParams=(0,t.tObject)({timeout:(0,t.tOptional)(t.tNumber)}),n.PageSetDefaultTimeoutNoReplyParams=(0,t.tObject)({timeout:(0,t.tOptional)(t.tNumber)}),n.PageSetFileChooserInterceptedNoReplyParams=(0,t.tObject)({intercepted:t.tBoolean}),n.PageAddInitScriptParams=(0,t.tObject)({source:t.tString}),n.PageRemoveInitScriptsParams=(0,t.tOptional)((0,t.tObject)({})),n.PageCloseParams=(0,t.tObject)({runBeforeUnload:(0,t.tOptional)(t.tBoolean)}),n.PageEmulateMediaParams=(0,t.tObject)({media:(0,t.tOptional)((0,t.tEnum)(["screen","print","null"])),colorScheme:(0,t.tOptional)((0,t.tEnum)(["dark","light","no-preference","null"])),reducedMotion:(0,t.tOptional)((0,t.tEnum)(["reduce","no-preference","null"])),forcedColors:(0,t.tOptional)((0,t.tEnum)(["active","none","null"]))}),n.PageExposeBindingParams=(0,t.tObject)({name:t.tString,needsHandle:(0,t.tOptional)(t.tBoolean)}),n.PageRemoveExposedBindingsParams=(0,t.tOptional)((0,t.tObject)({})),n.PageGoBackParams=(0,t.tObject)({timeout:(0,t.tOptional)(t.tNumber),waitUntil:(0,t.tOptional)(r("LifecycleEvent"))}),n.PageGoForwardParams=(0,t.tObject)({timeout:(0,t.tOptional)(t.tNumber),waitUntil:(0,t.tOptional)(r("LifecycleEvent"))}),n.PageReloadParams=(0,t.tObject)({timeout:(0,t.tOptional)(t.tNumber),waitUntil:(0,t.tOptional)(r("LifecycleEvent"))}),n.PageExpectScreenshotParams=(0,t.tObject)({expected:(0,t.tOptional)(t.tBinary),timeout:(0,t.tOptional)(t.tNumber),isNot:t.tBoolean,locator:(0,t.tOptional)((0,t.tObject)({frame:e("Frame"),selector:t.tString})),comparatorOptions:(0,t.tOptional)((0,t.tObject)({maxDiffPixels:(0,t.tOptional)(t.tNumber),maxDiffPixelRatio:(0,t.tOptional)(t.tNumber),threshold:(0,t.tOptional)(t.tNumber)})),screenshotOptions:(0,t.tOptional)((0,t.tObject)({fullPage:(0,t.tOptional)(t.tBoolean),clip:(0,t.tOptional)(r("Rect")),omitBackground:(0,t.tOptional)(t.tBoolean),caret:(0,t.tOptional)((0,t.tEnum)(["hide","initial"])),animations:(0,t.tOptional)((0,t.tEnum)(["disabled","allow"])),scale:(0,t.tOptional)((0,t.tEnum)(["css","device"])),fonts:(0,t.tOptional)((0,t.tEnum)(["ready","nowait"])),mask:(0,t.tOptional)((0,t.tArray)((0,t.tObject)({frame:e("Frame"),selector:t.tString})))}))}),n.PageScreenshotParams=(0,t.tObject)({timeout:(0,t.tOptional)(t.tNumber),type:(0,t.tOptional)((0,t.tEnum)(["png","jpeg"])),quality:(0,t.tOptional)(t.tNumber),fullPage:(0,t.tOptional)(t.tBoolean),clip:(0,t.tOptional)(r("Rect")),omitBackground:(0,t.tOptional)(t.tBoolean),caret:(0,t.tOptional)((0,t.tEnum)(["hide","initial"])),animations:(0,t.tOptional)((0,t.tEnum)(["disabled","allow"])),scale:(0,t.tOptional)((0,t.tEnum)(["css","device"])),fonts:(0,t.tOptional)((0,t.tEnum)(["ready","nowait"])),mask:(0,t.tOptional)((0,t.tArray)((0,t.tObject)({frame:e("Frame"),selector:t.tString})))}),n.PageSetExtraHTTPHeadersParams=(0,t.tObject)({headers:(0,t.tArray)(r("NameValue"))}),n.PageSetNetworkInterceptionEnabledParams=(0,t.tObject)({enabled:t.tBoolean}),n.PageSetViewportSizeParams=(0,t.tObject)({viewportSize:(0,t.tObject)({width:t.tNumber,height:t.tNumber})}),n.PageKeyboardDownParams=(0,t.tObject)({key:t.tString}),n.PageKeyboardUpParams=(0,t.tObject)({key:t.tString}),n.PageKeyboardInsertTextParams=(0,t.tObject)({text:t.tString}),n.PageKeyboardTypeParams=(0,t.tObject)({text:t.tString,delay:(0,t.tOptional)(t.tNumber)}),n.PageKeyboardPressParams=(0,t.tObject)({key:t.tString,delay:(0,t.tOptional)(t.tNumber)}),n.PageMouseMoveParams=(0,t.tObject)({x:t.tNumber,y:t.tNumber,steps:(0,t.tOptional)(t.tNumber)}),n.PageMouseDownParams=(0,t.tObject)({button:(0,t.tOptional)((0,t.tEnum)(["left","right","middle"])),clickCount:(0,t.tOptional)(t.tNumber)}),n.PageMouseUpParams=(0,t.tObject)({button:(0,t.tOptional)((0,t.tEnum)(["left","right","middle"])),clickCount:(0,t.tOptional)(t.tNumber)}),n.PageMouseClickParams=(0,t.tObject)({x:t.tNumber,y:t.tNumber,delay:(0,t.tOptional)(t.tNumber),button:(0,t.tOptional)((0,t.tEnum)(["left","right","middle"])),clickCount:(0,t.tOptional)(t.tNumber)}),n.PageMouseWheelParams=(0,t.tObject)({deltaX:t.tNumber,deltaY:t.tNumber}),n.PageTouchscreenTapParams=(0,t.tObject)({x:t.tNumber,y:t.tNumber}),n.PageAccessibilitySnapshotParams=(0,t.tObject)({interestingOnly:(0,t.tOptional)(t.tBoolean),root:(0,t.tOptional)(e("ElementHandle"))}),n.PagePdfParams=(0,t.tObject)({scale:(0,t.tOptional)(t.tNumber),displayHeaderFooter:(0,t.tOptional)(t.tBoolean),headerTemplate:(0,t.tOptional)(t.tString),footerTemplate:(0,t.tOptional)(t.tString),printBackground:(0,t.tOptional)(t.tBoolean),landscape:(0,t.tOptional)(t.tBoolean),pageRanges:(0,t.tOptional)(t.tString),format:(0,t.tOptional)(t.tString),width:(0,t.tOptional)(t.tString),height:(0,t.tOptional)(t.tString),preferCSSPageSize:(0,t.tOptional)(t.tBoolean),margin:(0,t.tOptional)((0,t.tObject)({top:(0,t.tOptional)(t.tString),bottom:(0,t.tOptional)(t.tString),left:(0,t.tOptional)(t.tString),right:(0,t.tOptional)(t.tString)}))}),n.PageStartJSCoverageParams=(0,t.tObject)({resetOnNavigation:(0,t.tOptional)(t.tBoolean),reportAnonymousScripts:(0,t.tOptional)(t.tBoolean)}),n.PageStopJSCoverageParams=(0,t.tOptional)((0,t.tObject)({})),n.PageStartCSSCoverageParams=(0,t.tObject)({resetOnNavigation:(0,t.tOptional)(t.tBoolean)}),n.PageStopCSSCoverageParams=(0,t.tOptional)((0,t.tObject)({})),n.PageBringToFrontParams=(0,t.tOptional)((0,t.tObject)({})),n.FrameEvalOnSelectorParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),expression:t.tString,isFunction:(0,t.tOptional)(t.tBoolean),arg:r("SerializedArgument")}),n.FrameEvalOnSelectorAllParams=(0,t.tObject)({selector:t.tString,expression:t.tString,isFunction:(0,t.tOptional)(t.tBoolean),arg:r("SerializedArgument")}),n.FrameAddScriptTagParams=(0,t.tObject)({url:(0,t.tOptional)(t.tString),content:(0,t.tOptional)(t.tString),type:(0,t.tOptional)(t.tString)}),n.FrameAddStyleTagParams=(0,t.tObject)({url:(0,t.tOptional)(t.tString),content:(0,t.tOptional)(t.tString)}),n.FrameCheckParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),force:(0,t.tOptional)(t.tBoolean),noWaitAfter:(0,t.tOptional)(t.tBoolean),position:(0,t.tOptional)(r("Point")),timeout:(0,t.tOptional)(t.tNumber),trial:(0,t.tOptional)(t.tBoolean)}),n.FrameClickParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),force:(0,t.tOptional)(t.tBoolean),noWaitAfter:(0,t.tOptional)(t.tBoolean),modifiers:(0,t.tOptional)((0,t.tArray)((0,t.tEnum)(["Alt","Control","Meta","Shift"]))),position:(0,t.tOptional)(r("Point")),delay:(0,t.tOptional)(t.tNumber),button:(0,t.tOptional)((0,t.tEnum)(["left","right","middle"])),clickCount:(0,t.tOptional)(t.tNumber),timeout:(0,t.tOptional)(t.tNumber),trial:(0,t.tOptional)(t.tBoolean)}),n.FrameContentParams=(0,t.tOptional)((0,t.tObject)({})),n.FrameDragAndDropParams=(0,t.tObject)({source:t.tString,target:t.tString,force:(0,t.tOptional)(t.tBoolean),noWaitAfter:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber),trial:(0,t.tOptional)(t.tBoolean),sourcePosition:(0,t.tOptional)(r("Point")),targetPosition:(0,t.tOptional)(r("Point")),strict:(0,t.tOptional)(t.tBoolean)}),n.FrameDblclickParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),force:(0,t.tOptional)(t.tBoolean),noWaitAfter:(0,t.tOptional)(t.tBoolean),modifiers:(0,t.tOptional)((0,t.tArray)((0,t.tEnum)(["Alt","Control","Meta","Shift"]))),position:(0,t.tOptional)(r("Point")),delay:(0,t.tOptional)(t.tNumber),button:(0,t.tOptional)((0,t.tEnum)(["left","right","middle"])),timeout:(0,t.tOptional)(t.tNumber),trial:(0,t.tOptional)(t.tBoolean)}),n.FrameDispatchEventParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),type:t.tString,eventInit:r("SerializedArgument"),timeout:(0,t.tOptional)(t.tNumber)}),n.FrameEvaluateExpressionParams=(0,t.tObject)({expression:t.tString,isFunction:(0,t.tOptional)(t.tBoolean),arg:r("SerializedArgument")}),n.FrameEvaluateExpressionHandleParams=(0,t.tObject)({expression:t.tString,isFunction:(0,t.tOptional)(t.tBoolean),arg:r("SerializedArgument")}),n.FrameFillParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),value:t.tString,force:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber),noWaitAfter:(0,t.tOptional)(t.tBoolean)}),n.FrameFocusParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber)}),n.FrameFrameElementParams=(0,t.tOptional)((0,t.tObject)({})),n.FrameHighlightParams=(0,t.tObject)({selector:t.tString}),n.FrameGetAttributeParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),name:t.tString,timeout:(0,t.tOptional)(t.tNumber)}),n.FrameGotoParams=(0,t.tObject)({url:t.tString,timeout:(0,t.tOptional)(t.tNumber),waitUntil:(0,t.tOptional)(r("LifecycleEvent")),referer:(0,t.tOptional)(t.tString)}),n.FrameHoverParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),force:(0,t.tOptional)(t.tBoolean),modifiers:(0,t.tOptional)((0,t.tArray)((0,t.tEnum)(["Alt","Control","Meta","Shift"]))),position:(0,t.tOptional)(r("Point")),timeout:(0,t.tOptional)(t.tNumber),trial:(0,t.tOptional)(t.tBoolean)}),n.FrameInnerHTMLParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber)}),n.FrameInnerTextParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber)}),n.FrameInputValueParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber)}),n.FrameIsCheckedParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber)}),n.FrameIsDisabledParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber)}),n.FrameIsEnabledParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber)}),n.FrameIsHiddenParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean)}),n.FrameIsVisibleParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean)}),n.FrameIsEditableParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber)}),n.FramePressParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),key:t.tString,delay:(0,t.tOptional)(t.tNumber),noWaitAfter:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber)}),n.FrameQuerySelectorParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean)}),n.FrameQuerySelectorAllParams=(0,t.tObject)({selector:t.tString}),n.FrameQueryCountParams=(0,t.tObject)({selector:t.tString}),n.FrameSelectOptionParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),elements:(0,t.tOptional)((0,t.tArray)(e("ElementHandle"))),options:(0,t.tOptional)((0,t.tArray)((0,t.tObject)({value:(0,t.tOptional)(t.tString),label:(0,t.tOptional)(t.tString),index:(0,t.tOptional)(t.tNumber)}))),force:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber),noWaitAfter:(0,t.tOptional)(t.tBoolean)}),n.FrameSetContentParams=(0,t.tObject)({html:t.tString,timeout:(0,t.tOptional)(t.tNumber),waitUntil:(0,t.tOptional)(r("LifecycleEvent"))}),n.FrameSetInputFilesParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),files:(0,t.tArray)((0,t.tObject)({name:t.tString,mimeType:(0,t.tOptional)(t.tString),buffer:t.tBinary})),timeout:(0,t.tOptional)(t.tNumber),noWaitAfter:(0,t.tOptional)(t.tBoolean)}),n.FrameSetInputFilePathsParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),localPaths:(0,t.tOptional)((0,t.tArray)(t.tString)),streams:(0,t.tOptional)((0,t.tArray)(e("WritableStream"))),timeout:(0,t.tOptional)(t.tNumber),noWaitAfter:(0,t.tOptional)(t.tBoolean)}),n.FrameTapParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),force:(0,t.tOptional)(t.tBoolean),noWaitAfter:(0,t.tOptional)(t.tBoolean),modifiers:(0,t.tOptional)((0,t.tArray)((0,t.tEnum)(["Alt","Control","Meta","Shift"]))),position:(0,t.tOptional)(r("Point")),timeout:(0,t.tOptional)(t.tNumber),trial:(0,t.tOptional)(t.tBoolean)}),n.FrameTextContentParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber)}),n.FrameTitleParams=(0,t.tOptional)((0,t.tObject)({})),n.FrameTypeParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),text:t.tString,delay:(0,t.tOptional)(t.tNumber),noWaitAfter:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber)}),n.FrameUncheckParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),force:(0,t.tOptional)(t.tBoolean),noWaitAfter:(0,t.tOptional)(t.tBoolean),position:(0,t.tOptional)(r("Point")),timeout:(0,t.tOptional)(t.tNumber),trial:(0,t.tOptional)(t.tBoolean)}),n.FrameWaitForTimeoutParams=(0,t.tObject)({timeout:t.tNumber}),n.FrameWaitForFunctionParams=(0,t.tObject)({expression:t.tString,isFunction:(0,t.tOptional)(t.tBoolean),arg:r("SerializedArgument"),timeout:(0,t.tOptional)(t.tNumber),pollingInterval:(0,t.tOptional)(t.tNumber)}),n.FrameWaitForSelectorParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber),state:(0,t.tOptional)((0,t.tEnum)(["attached","detached","visible","hidden"])),omitReturnValue:(0,t.tOptional)(t.tBoolean)}),n.FrameExpectParams=(0,t.tObject)({selector:t.tString,expression:t.tString,expressionArg:(0,t.tOptional)(t.tAny),expectedText:(0,t.tOptional)((0,t.tArray)(r("ExpectedTextValue"))),expectedNumber:(0,t.tOptional)(t.tNumber),expectedValue:(0,t.tOptional)(r("SerializedArgument")),useInnerText:(0,t.tOptional)(t.tBoolean),isNot:t.tBoolean,timeout:(0,t.tOptional)(t.tNumber)}),n.WorkerEvaluateExpressionParams=(0,t.tObject)({expression:t.tString,isFunction:(0,t.tOptional)(t.tBoolean),arg:r("SerializedArgument")}),n.WorkerEvaluateExpressionHandleParams=(0,t.tObject)({expression:t.tString,isFunction:(0,t.tOptional)(t.tBoolean),arg:r("SerializedArgument")}),n.JSHandleDisposeParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleDisposeParams=r("JSHandleDisposeParams"),n.JSHandleEvaluateExpressionParams=(0,t.tObject)({expression:t.tString,isFunction:(0,t.tOptional)(t.tBoolean),arg:r("SerializedArgument")}),n.ElementHandleEvaluateExpressionParams=r("JSHandleEvaluateExpressionParams"),n.JSHandleEvaluateExpressionHandleParams=(0,t.tObject)({expression:t.tString,isFunction:(0,t.tOptional)(t.tBoolean),arg:r("SerializedArgument")}),n.ElementHandleEvaluateExpressionHandleParams=r("JSHandleEvaluateExpressionHandleParams"),n.JSHandleGetPropertyListParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleGetPropertyListParams=r("JSHandleGetPropertyListParams"),n.JSHandleGetPropertyParams=(0,t.tObject)({name:t.tString}),n.ElementHandleGetPropertyParams=r("JSHandleGetPropertyParams"),n.JSHandleJsonValueParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleJsonValueParams=r("JSHandleJsonValueParams"),n.ElementHandleEvalOnSelectorParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),expression:t.tString,isFunction:(0,t.tOptional)(t.tBoolean),arg:r("SerializedArgument")}),n.ElementHandleEvalOnSelectorAllParams=(0,t.tObject)({selector:t.tString,expression:t.tString,isFunction:(0,t.tOptional)(t.tBoolean),arg:r("SerializedArgument")}),n.ElementHandleBoundingBoxParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleCheckParams=(0,t.tObject)({force:(0,t.tOptional)(t.tBoolean),noWaitAfter:(0,t.tOptional)(t.tBoolean),position:(0,t.tOptional)(r("Point")),timeout:(0,t.tOptional)(t.tNumber),trial:(0,t.tOptional)(t.tBoolean)}),n.ElementHandleClickParams=(0,t.tObject)({force:(0,t.tOptional)(t.tBoolean),noWaitAfter:(0,t.tOptional)(t.tBoolean),modifiers:(0,t.tOptional)((0,t.tArray)((0,t.tEnum)(["Alt","Control","Meta","Shift"]))),position:(0,t.tOptional)(r("Point")),delay:(0,t.tOptional)(t.tNumber),button:(0,t.tOptional)((0,t.tEnum)(["left","right","middle"])),clickCount:(0,t.tOptional)(t.tNumber),timeout:(0,t.tOptional)(t.tNumber),trial:(0,t.tOptional)(t.tBoolean)}),n.ElementHandleContentFrameParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleDblclickParams=(0,t.tObject)({force:(0,t.tOptional)(t.tBoolean),noWaitAfter:(0,t.tOptional)(t.tBoolean),modifiers:(0,t.tOptional)((0,t.tArray)((0,t.tEnum)(["Alt","Control","Meta","Shift"]))),position:(0,t.tOptional)(r("Point")),delay:(0,t.tOptional)(t.tNumber),button:(0,t.tOptional)((0,t.tEnum)(["left","right","middle"])),timeout:(0,t.tOptional)(t.tNumber),trial:(0,t.tOptional)(t.tBoolean)}),n.ElementHandleDispatchEventParams=(0,t.tObject)({type:t.tString,eventInit:r("SerializedArgument")}),n.ElementHandleFillParams=(0,t.tObject)({value:t.tString,force:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber),noWaitAfter:(0,t.tOptional)(t.tBoolean)}),n.ElementHandleFocusParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleGetAttributeParams=(0,t.tObject)({name:t.tString}),n.ElementHandleHoverParams=(0,t.tObject)({force:(0,t.tOptional)(t.tBoolean),modifiers:(0,t.tOptional)((0,t.tArray)((0,t.tEnum)(["Alt","Control","Meta","Shift"]))),position:(0,t.tOptional)(r("Point")),timeout:(0,t.tOptional)(t.tNumber),trial:(0,t.tOptional)(t.tBoolean)}),n.ElementHandleInnerHTMLParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleInnerTextParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleInputValueParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleIsCheckedParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleIsDisabledParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleIsEditableParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleIsEnabledParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleIsHiddenParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleIsVisibleParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleOwnerFrameParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandlePressParams=(0,t.tObject)({key:t.tString,delay:(0,t.tOptional)(t.tNumber),timeout:(0,t.tOptional)(t.tNumber),noWaitAfter:(0,t.tOptional)(t.tBoolean)}),n.ElementHandleQuerySelectorParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean)}),n.ElementHandleQuerySelectorAllParams=(0,t.tObject)({selector:t.tString}),n.ElementHandleScreenshotParams=(0,t.tObject)({timeout:(0,t.tOptional)(t.tNumber),type:(0,t.tOptional)((0,t.tEnum)(["png","jpeg"])),quality:(0,t.tOptional)(t.tNumber),omitBackground:(0,t.tOptional)(t.tBoolean),caret:(0,t.tOptional)((0,t.tEnum)(["hide","initial"])),animations:(0,t.tOptional)((0,t.tEnum)(["disabled","allow"])),scale:(0,t.tOptional)((0,t.tEnum)(["css","device"])),fonts:(0,t.tOptional)((0,t.tEnum)(["ready","nowait"])),mask:(0,t.tOptional)((0,t.tArray)((0,t.tObject)({frame:e("Frame"),selector:t.tString})))}),n.ElementHandleScrollIntoViewIfNeededParams=(0,t.tObject)({timeout:(0,t.tOptional)(t.tNumber)}),n.ElementHandleSelectOptionParams=(0,t.tObject)({elements:(0,t.tOptional)((0,t.tArray)(e("ElementHandle"))),options:(0,t.tOptional)((0,t.tArray)((0,t.tObject)({value:(0,t.tOptional)(t.tString),label:(0,t.tOptional)(t.tString),index:(0,t.tOptional)(t.tNumber)}))),force:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber),noWaitAfter:(0,t.tOptional)(t.tBoolean)}),n.ElementHandleSelectTextParams=(0,t.tObject)({force:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber)}),n.ElementHandleSetInputFilesParams=(0,t.tObject)({files:(0,t.tArray)((0,t.tObject)({name:t.tString,mimeType:(0,t.tOptional)(t.tString),buffer:t.tBinary})),timeout:(0,t.tOptional)(t.tNumber),noWaitAfter:(0,t.tOptional)(t.tBoolean)}),n.ElementHandleSetInputFilePathsParams=(0,t.tObject)({localPaths:(0,t.tOptional)((0,t.tArray)(t.tString)),streams:(0,t.tOptional)((0,t.tArray)(e("WritableStream"))),timeout:(0,t.tOptional)(t.tNumber),noWaitAfter:(0,t.tOptional)(t.tBoolean)}),n.ElementHandleTapParams=(0,t.tObject)({force:(0,t.tOptional)(t.tBoolean),noWaitAfter:(0,t.tOptional)(t.tBoolean),modifiers:(0,t.tOptional)((0,t.tArray)((0,t.tEnum)(["Alt","Control","Meta","Shift"]))),position:(0,t.tOptional)(r("Point")),timeout:(0,t.tOptional)(t.tNumber),trial:(0,t.tOptional)(t.tBoolean)}),n.ElementHandleTextContentParams=(0,t.tOptional)((0,t.tObject)({})),n.ElementHandleTypeParams=(0,t.tObject)({text:t.tString,delay:(0,t.tOptional)(t.tNumber),noWaitAfter:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber)}),n.ElementHandleUncheckParams=(0,t.tObject)({force:(0,t.tOptional)(t.tBoolean),noWaitAfter:(0,t.tOptional)(t.tBoolean),position:(0,t.tOptional)(r("Point")),timeout:(0,t.tOptional)(t.tNumber),trial:(0,t.tOptional)(t.tBoolean)}),n.ElementHandleWaitForElementStateParams=(0,t.tObject)({state:(0,t.tEnum)(["visible","hidden","stable","enabled","disabled","editable"]),timeout:(0,t.tOptional)(t.tNumber)}),n.ElementHandleWaitForSelectorParams=(0,t.tObject)({selector:t.tString,strict:(0,t.tOptional)(t.tBoolean),timeout:(0,t.tOptional)(t.tNumber),state:(0,t.tOptional)((0,t.tEnum)(["attached","detached","visible","hidden"]))}),n.RequestResponseParams=(0,t.tOptional)((0,t.tObject)({})),n.RequestRawRequestHeadersParams=(0,t.tOptional)((0,t.tObject)({})),n.RouteAbortParams=(0,t.tObject)({errorCode:(0,t.tOptional)(t.tString)}),n.RouteContinueParams=(0,t.tObject)({url:(0,t.tOptional)(t.tString),method:(0,t.tOptional)(t.tString),headers:(0,t.tOptional)((0,t.tArray)(r("NameValue"))),postData:(0,t.tOptional)(t.tBinary)}),n.RouteFulfillParams=(0,t.tObject)({status:(0,t.tOptional)(t.tNumber),headers:(0,t.tOptional)((0,t.tArray)(r("NameValue"))),body:(0,t.tOptional)(t.tString),isBase64:(0,t.tOptional)(t.tBoolean),fetchResponseUid:(0,t.tOptional)(t.tString)}),n.ResourceTiming=(0,t.tObject)({startTime:t.tNumber,domainLookupStart:t.tNumber,domainLookupEnd:t.tNumber,connectStart:t.tNumber,secureConnectionStart:t.tNumber,connectEnd:t.tNumber,requestStart:t.tNumber,responseStart:t.tNumber}),n.ResponseBodyParams=(0,t.tOptional)((0,t.tObject)({})),n.ResponseSecurityDetailsParams=(0,t.tOptional)((0,t.tObject)({})),n.ResponseServerAddrParams=(0,t.tOptional)((0,t.tObject)({})),n.ResponseRawResponseHeadersParams=(0,t.tOptional)((0,t.tObject)({})),n.ResponseSizesParams=(0,t.tOptional)((0,t.tObject)({})),n.SecurityDetails=(0,t.tObject)({issuer:(0,t.tOptional)(t.tString),protocol:(0,t.tOptional)(t.tString),subjectName:(0,t.tOptional)(t.tString),validFrom:(0,t.tOptional)(t.tNumber),validTo:(0,t.tOptional)(t.tNumber)}),n.RequestSizes=(0,t.tObject)({requestBodySize:t.tNumber,requestHeadersSize:t.tNumber,responseBodySize:t.tNumber,responseHeadersSize:t.tNumber}),n.RemoteAddr=(0,t.tObject)({ipAddress:t.tString,port:t.tNumber}),n.BindingCallRejectParams=(0,t.tObject)({error:r("SerializedError")}),n.BindingCallResolveParams=(0,t.tObject)({result:r("SerializedArgument")}),n.DialogAcceptParams=(0,t.tObject)({promptText:(0,t.tOptional)(t.tString)}),n.DialogDismissParams=(0,t.tOptional)((0,t.tObject)({})),n.TracingTracingStartParams=(0,t.tObject)({name:(0,t.tOptional)(t.tString),snapshots:(0,t.tOptional)(t.tBoolean),screenshots:(0,t.tOptional)(t.tBoolean),sources:(0,t.tOptional)(t.tBoolean)}),n.TracingTracingStartChunkParams=(0,t.tObject)({title:(0,t.tOptional)(t.tString)}),n.TracingTracingStopChunkParams=(0,t.tObject)({mode:(0,t.tEnum)(["doNotSave","compressTrace","compressTraceAndSources"])}),n.TracingTracingStopParams=(0,t.tOptional)((0,t.tObject)({})),n.ArtifactPathAfterFinishedParams=(0,t.tOptional)((0,t.tObject)({})),n.ArtifactSaveAsParams=(0,t.tObject)({path:t.tString}),n.ArtifactSaveAsStreamParams=(0,t.tOptional)((0,t.tObject)({})),n.ArtifactFailureParams=(0,t.tOptional)((0,t.tObject)({})),n.ArtifactStreamParams=(0,t.tOptional)((0,t.tObject)({})),n.ArtifactCancelParams=(0,t.tOptional)((0,t.tObject)({})),n.ArtifactDeleteParams=(0,t.tOptional)((0,t.tObject)({})),n.StreamReadParams=(0,t.tObject)({size:(0,t.tOptional)(t.tNumber)}),n.StreamCloseParams=(0,t.tOptional)((0,t.tObject)({})),n.WritableStreamWriteParams=(0,t.tObject)({binary:t.tBinary}),n.WritableStreamCloseParams=(0,t.tOptional)((0,t.tObject)({})),n.CDPSessionSendParams=(0,t.tObject)({method:t.tString,params:(0,t.tOptional)(t.tAny)}),n.CDPSessionDetachParams=(0,t.tOptional)((0,t.tObject)({})),n.ElectronLaunchParams=(0,t.tObject)({executablePath:(0,t.tOptional)(t.tString),args:(0,t.tOptional)((0,t.tArray)(t.tString)),cwd:(0,t.tOptional)(t.tString),env:(0,t.tOptional)((0,t.tArray)(r("NameValue"))),timeout:(0,t.tOptional)(t.tNumber),acceptDownloads:(0,t.tOptional)(t.tBoolean),bypassCSP:(0,t.tOptional)(t.tBoolean),colorScheme:(0,t.tOptional)((0,t.tEnum)(["dark","light","no-preference"])),extraHTTPHeaders:(0,t.tOptional)((0,t.tArray)(r("NameValue"))),geolocation:(0,t.tOptional)((0,t.tObject)({longitude:t.tNumber,latitude:t.tNumber,accuracy:(0,t.tOptional)(t.tNumber)})),httpCredentials:(0,t.tOptional)((0,t.tObject)({username:t.tString,password:t.tString})),ignoreHTTPSErrors:(0,t.tOptional)(t.tBoolean),locale:(0,t.tOptional)(t.tString),offline:(0,t.tOptional)(t.tBoolean),recordHar:(0,t.tOptional)((0,t.tObject)({omitContent:(0,t.tOptional)(t.tBoolean),path:t.tString})),recordVideo:(0,t.tOptional)((0,t.tObject)({dir:t.tString,size:(0,t.tOptional)((0,t.tObject)({width:t.tNumber,height:t.tNumber}))})),strictSelectors:(0,t.tOptional)(t.tBoolean),timezoneId:(0,t.tOptional)(t.tString)}),n.ElectronApplicationBrowserWindowParams=(0,t.tObject)({page:e("Page")}),n.ElectronApplicationEvaluateExpressionParams=(0,t.tObject)({expression:t.tString,isFunction:(0,t.tOptional)(t.tBoolean),arg:r("SerializedArgument")}),n.ElectronApplicationEvaluateExpressionHandleParams=(0,t.tObject)({expression:t.tString,isFunction:(0,t.tOptional)(t.tBoolean),arg:r("SerializedArgument")}),n.ElectronApplicationCloseParams=(0,t.tOptional)((0,t.tObject)({})),n.AndroidDevicesParams=(0,t.tObject)({port:(0,t.tOptional)(t.tNumber),omitDriverInstall:(0,t.tOptional)(t.tBoolean)}),n.AndroidSetDefaultTimeoutNoReplyParams=(0,t.tObject)({timeout:t.tNumber}),n.AndroidSocketWriteParams=(0,t.tObject)({data:t.tBinary}),n.AndroidSocketCloseParams=(0,t.tOptional)((0,t.tObject)({})),n.AndroidDeviceWaitParams=(0,t.tObject)({selector:r("AndroidSelector"),state:(0,t.tOptional)((0,t.tEnum)(["gone"])),timeout:(0,t.tOptional)(t.tNumber)}),n.AndroidDeviceFillParams=(0,t.tObject)({selector:r("AndroidSelector"),text:t.tString,timeout:(0,t.tOptional)(t.tNumber)}),n.AndroidDeviceTapParams=(0,t.tObject)({selector:r("AndroidSelector"),duration:(0,t.tOptional)(t.tNumber),timeout:(0,t.tOptional)(t.tNumber)}),n.AndroidDeviceDragParams=(0,t.tObject)({selector:r("AndroidSelector"),dest:r("Point"),speed:(0,t.tOptional)(t.tNumber),timeout:(0,t.tOptional)(t.tNumber)}),n.AndroidDeviceFlingParams=(0,t.tObject)({selector:r("AndroidSelector"),direction:(0,t.tEnum)(["up","down","left","right"]),speed:(0,t.tOptional)(t.tNumber),timeout:(0,t.tOptional)(t.tNumber)}),n.AndroidDeviceLongTapParams=(0,t.tObject)({selector:r("AndroidSelector"),timeout:(0,t.tOptional)(t.tNumber)}),n.AndroidDevicePinchCloseParams=(0,t.tObject)({selector:r("AndroidSelector"),percent:t.tNumber,speed:(0,t.tOptional)(t.tNumber),timeout:(0,t.tOptional)(t.tNumber)}),n.AndroidDevicePinchOpenParams=(0,t.tObject)({selector:r("AndroidSelector"),percent:t.tNumber,speed:(0,t.tOptional)(t.tNumber),timeout:(0,t.tOptional)(t.tNumber)}),n.AndroidDeviceScrollParams=(0,t.tObject)({selector:r("AndroidSelector"),direction:(0,t.tEnum)(["up","down","left","right"]),percent:t.tNumber,speed:(0,t.tOptional)(t.tNumber),timeout:(0,t.tOptional)(t.tNumber)}),n.AndroidDeviceSwipeParams=(0,t.tObject)({selector:r("AndroidSelector"),direction:(0,t.tEnum)(["up","down","left","right"]),percent:t.tNumber,speed:(0,t.tOptional)(t.tNumber),timeout:(0,t.tOptional)(t.tNumber)}),n.AndroidDeviceInfoParams=(0,t.tObject)({selector:r("AndroidSelector")}),n.AndroidDeviceScreenshotParams=(0,t.tOptional)((0,t.tObject)({})),n.AndroidDeviceInputTypeParams=(0,t.tObject)({text:t.tString}),n.AndroidDeviceInputPressParams=(0,t.tObject)({key:t.tString}),n.AndroidDeviceInputTapParams=(0,t.tObject)({point:r("Point")}),n.AndroidDeviceInputSwipeParams=(0,t.tObject)({segments:(0,t.tArray)(r("Point")),steps:t.tNumber}),n.AndroidDeviceInputDragParams=(0,t.tObject)({from:r("Point"),to:r("Point"),steps:t.tNumber}),n.AndroidDeviceLaunchBrowserParams=(0,t.tObject)({noDefaultViewport:(0,t.tOptional)(t.tBoolean),viewport:(0,t.tOptional)((0,t.tObject)({width:t.tNumber,height:t.tNumber})),screen:(0,t.tOptional)((0,t.tObject)({width:t.tNumber,height:t.tNumber})),ignoreHTTPSErrors:(0,t.tOptional)(t.tBoolean),javaScriptEnabled:(0,t.tOptional)(t.tBoolean),bypassCSP:(0,t.tOptional)(t.tBoolean),userAgent:(0,t.tOptional)(t.tString),locale:(0,t.tOptional)(t.tString),timezoneId:(0,t.tOptional)(t.tString),geolocation:(0,t.tOptional)((0,t.tObject)({longitude:t.tNumber,latitude:t.tNumber,accuracy:(0,t.tOptional)(t.tNumber)})),permissions:(0,t.tOptional)((0,t.tArray)(t.tString)),extraHTTPHeaders:(0,t.tOptional)((0,t.tArray)(r("NameValue"))),offline:(0,t.tOptional)(t.tBoolean),httpCredentials:(0,t.tOptional)((0,t.tObject)({username:t.tString,password:t.tString})),deviceScaleFactor:(0,t.tOptional)(t.tNumber),isMobile:(0,t.tOptional)(t.tBoolean),hasTouch:(0,t.tOptional)(t.tBoolean),colorScheme:(0,t.tOptional)((0,t.tEnum)(["dark","light","no-preference"])),reducedMotion:(0,t.tOptional)((0,t.tEnum)(["reduce","no-preference"])),forcedColors:(0,t.tOptional)((0,t.tEnum)(["active","none"])),acceptDownloads:(0,t.tOptional)(t.tBoolean),baseURL:(0,t.tOptional)(t.tString),recordVideo:(0,t.tOptional)((0,t.tObject)({dir:t.tString,size:(0,t.tOptional)((0,t.tObject)({width:t.tNumber,height:t.tNumber}))})),recordHar:(0,t.tOptional)((0,t.tObject)({omitContent:(0,t.tOptional)(t.tBoolean),path:t.tString})),strictSelectors:(0,t.tOptional)(t.tBoolean),pkg:(0,t.tOptional)(t.tString),proxy:(0,t.tOptional)((0,t.tObject)({server:t.tString,bypass:(0,t.tOptional)(t.tString),username:(0,t.tOptional)(t.tString),password:(0,t.tOptional)(t.tString)}))}),n.AndroidDeviceOpenParams=(0,t.tObject)({command:t.tString}),n.AndroidDeviceShellParams=(0,t.tObject)({command:t.tString}),n.AndroidDeviceInstallApkParams=(0,t.tObject)({file:t.tBinary,args:(0,t.tOptional)((0,t.tArray)(t.tString))}),n.AndroidDevicePushParams=(0,t.tObject)({file:t.tBinary,path:t.tString,mode:(0,t.tOptional)(t.tNumber)}),n.AndroidDeviceSetDefaultTimeoutNoReplyParams=(0,t.tObject)({timeout:t.tNumber}),n.AndroidDeviceConnectToWebViewParams=(0,t.tObject)({pid:t.tNumber}),n.AndroidDeviceCloseParams=(0,t.tOptional)((0,t.tObject)({})),n.AndroidWebView=(0,t.tObject)({pid:t.tNumber,pkg:t.tString}),n.AndroidSelector=(0,t.tObject)({checkable:(0,t.tOptional)(t.tBoolean),checked:(0,t.tOptional)(t.tBoolean),clazz:(0,t.tOptional)(t.tString),clickable:(0,t.tOptional)(t.tBoolean),depth:(0,t.tOptional)(t.tNumber),desc:(0,t.tOptional)(t.tString),enabled:(0,t.tOptional)(t.tBoolean),focusable:(0,t.tOptional)(t.tBoolean),focused:(0,t.tOptional)(t.tBoolean),hasChild:(0,t.tOptional)((0,t.tObject)({selector:r("AndroidSelector")})),hasDescendant:(0,t.tOptional)((0,t.tObject)({selector:r("AndroidSelector"),maxDepth:(0,t.tOptional)(t.tNumber)})),longClickable:(0,t.tOptional)(t.tBoolean),pkg:(0,t.tOptional)(t.tString),res:(0,t.tOptional)(t.tString),scrollable:(0,t.tOptional)(t.tBoolean),selected:(0,t.tOptional)(t.tBoolean),text:(0,t.tOptional)(t.tString)}),n.AndroidElementInfo=(0,t.tObject)({children:(0,t.tOptional)((0,t.tArray)(r("AndroidElementInfo"))),clazz:t.tString,desc:t.tString,res:t.tString,pkg:t.tString,text:t.tString,bounds:r("Rect"),checkable:t.tBoolean,checked:t.tBoolean,clickable:t.tBoolean,enabled:t.tBoolean,focusable:t.tBoolean,focused:t.tBoolean,longClickable:t.tBoolean,scrollable:t.tBoolean,selected:t.tBoolean}),n.JsonPipeSendParams=(0,t.tObject)({message:t.tAny}),n.JsonPipeCloseParams=(0,t.tOptional)((0,t.tObject)({})),n};var t=Dl}(jl);var Hl={};Object.defineProperty(Hl,"__esModule",{value:!0}),Hl.SdkObject=void 0,Hl.createInstrumentation=function(){const e=new Map;return new Proxy({},{get:(t,n)=>"addListener"===n?(t,n)=>e.set(t,n):"removeListener"===n?t=>e.delete(t):n.startsWith("on")?async(t,...r)=>{for(const[s,a]of e){var i,o;a&&t.attribution.context!==a||await(null===(i=(o=s)[n])||void 0===i?void 0:i.call(o,t,...r))}}:t[n]})},Hl.serverSideCallMetadata=function(){return{id:"",wallTime:0,startTime:0,endTime:0,type:"Internal",method:"",params:{},log:[],snapshots:[],isServerSide:!0}};var ql=M.default,Ul=Ci;class Wl extends ql.EventEmitter{constructor(e,t,n){super(),this.guid=void 0,this.attribution=void 0,this.instrumentation=void 0,this.guid=n||`${t||""}@${(0,Ul.createGuid)()}`,this.setMaxListeners(0),this.attribution={...e.attribution},this.instrumentation=e.instrumentation}}Hl.SdkObject=Wl;var $l={};const zl=/[|\\{}()[\]^$+*?.-]/g;const Vl=e=>{if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(zl,"\\$&")},Gl="object"==typeof process&&process&&"function"==typeof process.cwd?process.cwd():".",Kl=[].concat(z.default.builtinModules,"bootstrap_node","node").map((e=>new RegExp(`(?:\\((?:node:)?${e}(?:\\.js)?:\\d+:\\d+\\)$|^\\s*at (?:node:)?${e}(?:\\.js)?:\\d+:\\d+$)`)));Kl.push(/\((?:node:)?internal\/[^:]+:\d+:\d+\)$/,/\s*at (?:node:)?internal\/[^:]+:\d+:\d+$/,/\/\.node-spawn-wrap-\w+-\w+\/node:\d+:\d+\)?$/);class Jl{constructor(e){"internals"in(e={ignoredPackages:[],...e})==!1&&(e.internals=Jl.nodeInternals()),"cwd"in e==!1&&(e.cwd=Gl),this._cwd=e.cwd.replace(/\\/g,"/"),this._internals=[].concat(e.internals,function(e){if(0===e.length)return[];const t=e.map((e=>Vl(e)));return new RegExp(`[/\\\\]node_modules[/\\\\](?:${t.join("|")})[/\\\\][^:]+:\\d+:\\d+`)}(e.ignoredPackages)),this._wrapCallSite=e.wrapCallSite||!1}static nodeInternals(){return[...Kl]}clean(e,t=0){t=" ".repeat(t),Array.isArray(e)||(e=e.split("\n")),!/^\s*at /.test(e[0])&&/^\s*at /.test(e[1])&&(e=e.slice(1));let n=!1,r=null;const i=[];return e.forEach((e=>{if(e=e.replace(/\\/g,"/"),this._internals.some((t=>t.test(e))))return;const t=/^\s*at /.test(e);n?e=e.trimEnd().replace(/^(\s+)at /,"$1"):(e=e.trim(),t&&(e=e.slice(3))),(e=e.replace(`${this._cwd}/`,""))&&(t?(r&&(i.push(r),r=null),i.push(e)):(n=!0,r=e))})),i.map((e=>`${t}${e}\n`)).join("")}captureString(e,t=this.captureString){"function"==typeof e&&(t=e,e=1/0);const{stackTraceLimit:n}=Error;e&&(Error.stackTraceLimit=e);const r={};Error.captureStackTrace(r,t);const{stack:i}=r;return Error.stackTraceLimit=n,this.clean(i)}capture(e,t=this.capture){"function"==typeof e&&(t=e,e=1/0);const{prepareStackTrace:n,stackTraceLimit:r}=Error;Error.prepareStackTrace=(e,t)=>this._wrapCallSite?t.map(this._wrapCallSite):t,e&&(Error.stackTraceLimit=e);const i={};Error.captureStackTrace(i,t);const{stack:o}=i;return Object.assign(Error,{prepareStackTrace:n,stackTraceLimit:r}),o}at(e=this.at){const[t]=this.capture(1,e);if(!t)return{};const n={line:t.getLineNumber(),column:t.getColumnNumber()};let r;Yl(n,t.getFileName(),this._cwd),t.isConstructor()&&(n.constructor=!0),t.isEval()&&(n.evalOrigin=t.getEvalOrigin()),t.isNative()&&(n.native=!0);try{r=t.getTypeName()}catch(e){}r&&"Object"!==r&&"[object Object]"!==r&&(n.type=r);const i=t.getFunctionName();i&&(n.function=i);const o=t.getMethodName();return o&&i!==o&&(n.method=o),n}parseLine(e){const t=e&&e.match(Xl);if(!t)return null;const n="new"===t[1];let r=t[2];const i=t[3],o=t[4],s=Number(t[5]),a=Number(t[6]);let l=t[7];const c=t[8],u=t[9],d="native"===t[10],h=")"===t[11];let p;const f={};if(c&&(f.line=Number(c)),u&&(f.column=Number(u)),h&&l){let e=0;for(let t=l.length-1;t>0;t--)if(")"===l.charAt(t))e++;else if("("===l.charAt(t)&&" "===l.charAt(t-1)&&(e--,-1===e&&" "===l.charAt(t-1))){const e=l.slice(0,t-1),n=l.slice(t+1);l=n,r+=` (${e}`;break}}if(r){const e=r.match(Ql);e&&(r=e[1],p=e[2])}return Yl(f,l,this._cwd),n&&(f.constructor=!0),i&&(f.evalOrigin=i,f.evalLine=s,f.evalColumn=a,f.evalFile=o&&o.replace(/\\/g,"/")),d&&(f.native=!0),r&&(f.function=r),p&&r!==p&&(f.method=p),f}}function Yl(e,t,n){t&&((t=t.replace(/\\/g,"/")).startsWith(`${n}/`)&&(t=t.slice(n.length+1)),e.file=t)}const Xl=new RegExp("^(?:\\s*at )?(?:(new) )?(?:(.*?) \\()?(?:eval at ([^ ]+) \\((.+?):(\\d+):(\\d+)\\), )?(?:(.+?):(\\d+):(\\d+)|(native))(\\)?)$"),Ql=/^(.*?) \[as (.*?)\]$/;var Zl=Jl;Object.defineProperty($l,"__esModule",{value:!0}),$l.captureRawStack=hc,$l.captureStackTrace=function(e){const t=e||hc(),n=(0,nc.isUnderTest)();let r=t.split("\n").map((e=>{const t=ic.parseLine(e);if(!t||!t.file)return null;if(pc(t.file,t.function))return null;let r;if(r=t.file.startsWith("file://")?new URL(t.file).pathname:ec.default.resolve(process.cwd(),t.file),n&&r.includes(uc))return null;const i=r.startsWith(sc)||r.startsWith(ac);return{frame:{file:r,line:t.line,column:t.column,function:t.function},frameText:e,inCore:i}})).filter(Boolean),i="";const o=r;for(let e=0;e<r.length-1;e++)if(r[e].inCore&&!r[e+1].inCore){const t=r[e].frame;i=s(t.function),r=r.slice(e+1);break}function s(e){if(!e)return"";const t=e.match(/(API|JS|CDP|[A-Z])(.*)/);return t?t[1].toLowerCase()+t[2]:e}return r=r.filter(((e,t)=>!e.frame.file.startsWith(lc)&&!e.frame.file.startsWith(cc)&&(!t||!e.frame.file.startsWith(oc)))),{allFrames:o.map((e=>e.frame)),frames:r.map((e=>e.frame)),frameTexts:r.map((e=>e.frameText)),apiName:i}},$l.isInternalFileName=pc,$l.rewriteErrorMessage=function(e,t){var n;const r=((null===(n=e.stack)||void 0===n?void 0:n.split("\n"))||[]).filter((e=>e.startsWith("    at ")));e.message=t;const i=`${e.name}: ${e.message}`;r.length&&(e.stack=`${i}\n${r.join("\n")}`);return e},$l.splitErrorMessage=function(e){const t=e.indexOf(":");return{name:-1!==t?e.slice(0,t):"",message:-1!==t&&t+2<=e.length?e.substring(t+2):e}};var ec=rc(T.default),tc=rc(Zl),nc=Ci;function rc(e){return e&&e.__esModule?e:{default:e}}const ic=new tc.default;const oc=ec.default.resolve(__dirname,"..",".."),sc=ec.default.join(oc,"lib"),ac=ec.default.join(oc,"src"),lc=ec.default.resolve(oc,"..","playwright-test"),cc=ec.default.resolve(oc,"..","@playwright","test"),uc=ec.default.join(oc,"..","..","tests","config","coverage.js"),dc=ec.default.relative(process.cwd(),ec.default.dirname(require.resolve("ws")));function hc(){const e=Error.stackTraceLimit;Error.stackTraceLimit=30;const t=(new Error).stack;return Error.stackTraceLimit=e,t}function pc(e,t){return!(!e.startsWith("internal")&&!e.startsWith("node:"))||(!("events.js"!==e||null==t||!t.endsWith("emit"))||("_stream_readable.js"===e||"_stream_writable.js"===e||!!e.startsWith(dc)))}Object.defineProperty(Pl,"__esModule",{value:!0}),Pl.dispatcherSymbol=Pl.Root=Pl.DispatcherConnection=Pl.Dispatcher=void 0,Pl.existingDispatcher=function(e){return e[Sc]},Pl.lookupDispatcher=xc,Pl.lookupNullableDispatcher=function(e){return e?xc(e):void 0};var fc=M.default,mc=Ol,gc=jl,_c=Ci,wc=Dl,vc=Al,bc=Hl,yc=$l;const Sc=Symbol("dispatcher");function xc(e){const t=e[Sc];return(0,_c.debugAssert)(t),t}Pl.dispatcherSymbol=Sc;class kc extends fc.EventEmitter{constructor(e,t,n,r,i){super(),this._connection=void 0,this._isScope=void 0,this._parent=void 0,this._dispatchers=new Map,this._disposed=!1,this._guid=void 0,this._type=void 0,this._scope=void 0,this._object=void 0,this._connection=e instanceof Ec?e:e._connection,this._isScope=!!i,this._parent=e instanceof Ec?void 0:e,this._scope=i?this:this._parent;const o=t.guid;(0,_c.assert)(!this._connection._dispatchers.has(o)),this._connection._dispatchers.set(o,this),this._parent&&((0,_c.assert)(!this._parent._dispatchers.has(o)),this._parent._dispatchers.set(o,this)),this._type=n,this._guid=o,this._object=t,t[Sc]=this,this._parent&&this._connection.sendMessageToClient(this._parent._guid,n,"__create__",{type:n,initializer:r,guid:o},this._parent._object)}_dispatchEvent(e,t){if(this._disposed){if((0,_c.isUnderTest)())throw new Error(`${this._guid} is sending "${e}" event after being disposed`);return}const n=this._object instanceof bc.SdkObject?this._object:void 0;this._connection.sendMessageToClient(this._guid,this._type,e,t,n)}_dispose(){(0,_c.assert)(!this._disposed),this._disposed=!0,this._parent&&this._parent._dispatchers.delete(this._guid),this._connection._dispatchers.delete(this._guid);for(const e of[...this._dispatchers.values()])e._dispose();this._dispatchers.clear(),this._isScope&&this._connection.sendMessageToClient(this._guid,this._type,"__dispose__",{})}_debugScopeState(){return{_guid:this._guid,objects:Array.from(this._dispatchers.values()).map((e=>e._debugScopeState()))}}async waitForEventInfo(){}}Pl.Dispatcher=kc;Pl.Root=class extends kc{constructor(e,t){super(e,{guid:""},"Root",{},!0),this._initialized=!1,this.createPlaywright=t}async initialize(e){return(0,_c.assert)(this.createPlaywright),(0,_c.assert)(!this._initialized),this._initialized=!0,{playwright:await this.createPlaywright(this,e)}}};class Ec{sendMessageToClient(e,t,n,r,i){if(r=this._replaceDispatchersWithGuids(r),i){var o,s,a,l,c;const e={id:"event@"+ ++Cc,objectId:null==i?void 0:i.guid,pageId:null==i||null===(o=i.attribution)||void 0===o||null===(s=o.page)||void 0===s?void 0:s.guid,frameId:null==i||null===(a=i.attribution)||void 0===a||null===(l=a.frame)||void 0===l?void 0:l.guid,wallTime:Date.now(),startTime:(0,_c.monotonicTime)(),endTime:0,type:t,method:n,params:r||{},log:[],snapshots:[]};null===(c=i.instrumentation)||void 0===c||c.onEvent(i,e)}this.onmessage({guid:e,method:n,params:r})}constructor(){this._dispatchers=new Map,this.onmessage=e=>{},this._validateParams=void 0,this._validateMetadata=void 0,this._waitOperations=new Map;const e=(0,gc.createScheme)((e=>(t,n)=>{if(t&&"object"==typeof t&&"string"==typeof t.guid){const r=t.guid,i=this._dispatchers.get(r);if(!i)throw new gc.ValidationError(`${n}: no object with guid ${r}`);if("*"!==e&&i._type!==e)throw new gc.ValidationError(`${n}: object with guid ${r} has type ${i._type}, expected ${e}`);return i}throw new gc.ValidationError(`${n}: expected ${e}`)}));this._validateParams=(t,n,r)=>{const i=t+n[0].toUpperCase()+n.substring(1)+"Params";if(!e[i])throw new gc.ValidationError(`Unknown scheme for ${t}.${n}`);return e[i](r,"")},this._validateMetadata=t=>(0,wc.tOptional)(e.Metadata)(t,"")}async dispatch(e){var t,n,r,i,o;const{id:s,guid:a,method:l,params:c,metadata:u}=e,d=this._dispatchers.get(a);if(!d)return void this.onmessage({id:s,error:(0,mc.serializeError)(new Error(vc.kBrowserOrContextClosedError))});if("debugScopeState"===l){const e=this._dispatchers.get("");return void this.onmessage({id:s,result:e._debugScopeState()})}let h,p;try{if(h=this._validateParams(d._type,l,c),p=this._validateMetadata(u),"function"!=typeof d[l])throw new Error(`Mismatching dispatcher: "${d._type}" does not implement "${l}"`)}catch(e){return void this.onmessage({id:s,error:(0,mc.serializeError)(e)})}const f=d._object instanceof bc.SdkObject?d._object:void 0,m={id:`call@${s}`,stack:p.stack,apiName:p.apiName,internal:p.internal,objectId:null==f?void 0:f.guid,pageId:null==f||null===(t=f.attribution)||void 0===t||null===(n=t.page)||void 0===n?void 0:n.guid,frameId:null==f||null===(r=f.attribution)||void 0===r||null===(i=r.frame)||void 0===i?void 0:i.guid,wallTime:Date.now(),startTime:(0,_c.monotonicTime)(),endTime:0,type:d._type,method:l,params:c||{},log:[],snapshots:[]};if(f&&null!=c&&null!==(o=c.info)&&void 0!==o&&o.waitId){const e=c.info;switch(e.phase){case"before":return this._waitOperations.set(e.waitId,m),await f.instrumentation.onBeforeCall(f,m),void this.onmessage({id:s});case"log":{const t=this._waitOperations.get(e.waitId);return t.log.push(e.message),f.instrumentation.onCallLog(f,t,"api",e.message),void this.onmessage({id:s})}case"after":{const t=this._waitOperations.get(e.waitId);return t.endTime=(0,_c.monotonicTime)(),t.error=e.error?{error:{name:"Error",message:e.error}}:void 0,this._waitOperations.delete(e.waitId),await f.instrumentation.onAfterCall(f,t),void this.onmessage({id:s})}}}let g;await(null==f?void 0:f.instrumentation.onBeforeCall(f,m));try{const e=await d[l](h,m);m.result=this._replaceDispatchersWithGuids(e)}catch(e){m.error=(0,mc.serializeError)(e),m.log.length&&(0,yc.rewriteErrorMessage)(e,e.message+function(e){if(!e.length)return"";const t=" logs ",n=60,r=(n-t.length)/2,i=n-t.length-r;return`\n${"=".repeat(r)}${t}${"=".repeat(i)}\n${e.join("\n")}\n${"=".repeat(n)}`}(m.log)),g=(0,mc.serializeError)(e)}finally{m.endTime=(0,_c.monotonicTime)(),await(null==f?void 0:f.instrumentation.onAfterCall(f,m))}const _={id:s};m.result&&(_.result=m.result),g&&(_.error=g),this.onmessage(_)}_replaceDispatchersWithGuids(e){if(!e)return e;if(e instanceof kc)return{guid:e._guid};if(Array.isArray(e))return e.map((e=>this._replaceDispatchersWithGuids(e)));if("object"==typeof e){const t={};for(const n of Object.keys(e))t[n]=this._replaceDispatchersWithGuids(e[n]);return t}return e}}Pl.DispatcherConnection=Ec;let Cc=0;var Tc,Pc={},Oc={},Ac={},Ic={},Mc={},Fc={};function Nc(){return Tc||(Tc=1,function(e){var t=e,n=W.default.Buffer,r=E.default;t.toBuffer=function(e,t,r){var i;if(r=~~r,this.isV4Format(e))i=t||new n(r+4),e.split(/\./g).map((function(e){i[r++]=255&parseInt(e,10)}));else if(this.isV6Format(e)){var o,s=e.split(":",8);for(o=0;o<s.length;o++){var a;this.isV4Format(s[o])&&(a=this.toBuffer(s[o]),s[o]=a.slice(0,2).toString("hex")),a&&++o<8&&s.splice(o,0,a.slice(2,4).toString("hex"))}if(""===s[0])for(;s.length<8;)s.unshift("0");else if(""===s[s.length-1])for(;s.length<8;)s.push("0");else if(s.length<8){for(o=0;o<s.length&&""!==s[o];o++);var l=[o,1];for(o=9-s.length;o>0;o--)l.push("0");s.splice.apply(s,l)}for(i=t||new n(r+16),o=0;o<s.length;o++){var c=parseInt(s[o],16);i[r++]=c>>8&255,i[r++]=255&c}}if(!i)throw Error("Invalid ip address: "+e);return i},t.toString=function(e,t,n){t=~~t;var r=[];if(4===(n=n||e.length-t)){for(var i=0;i<n;i++)r.push(e[t+i]);r=r.join(".")}else if(16===n){for(i=0;i<n;i+=2)r.push(e.readUInt16BE(t+i).toString(16));r=(r=(r=r.join(":")).replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3")).replace(/:{3,4}/,"::")}return r};var i=/^(\d{1,3}\.){3,3}\d{1,3}$/,o=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;function s(e){return e?e.toLowerCase():"ipv4"}t.isV4Format=function(e){return i.test(e)},t.isV6Format=function(e){return o.test(e)},t.fromPrefixLen=function(e,r){var i=4;"ipv6"===(r=e>32?"ipv6":s(r))&&(i=16);for(var o=new n(i),a=0,l=o.length;a<l;++a){var c=8;e<8&&(c=e),e-=c,o[a]=255&~(255>>c)}return t.toString(o)},t.mask=function(e,r){e=t.toBuffer(e),r=t.toBuffer(r);var i=new n(Math.max(e.length,r.length)),o=0;if(e.length===r.length)for(o=0;o<e.length;o++)i[o]=e[o]&r[o];else if(4===r.length)for(o=0;o<r.length;o++)i[o]=e[e.length-4+o]&r[o];else{for(o=0;o<i.length-6;o++)i[o]=0;for(i[10]=255,i[11]=255,o=0;o<e.length;o++)i[o+12]=e[o]&r[o+12];o+=12}for(;o<i.length;o++)i[o]=0;return t.toString(i)},t.cidr=function(e){var n=e.split("/"),r=n[0];if(2!==n.length)throw new Error("invalid CIDR subnet: "+r);var i=t.fromPrefixLen(parseInt(n[1],10));return t.mask(r,i)},t.subnet=function(e,n){for(var r=t.toLong(t.mask(e,n)),i=t.toBuffer(n),o=0,s=0;s<i.length;s++)if(255===i[s])o+=8;else for(var a=255&i[s];a;)a=a<<1&255,o++;var l=Math.pow(2,32-o);return{networkAddress:t.fromLong(r),firstAddress:l<=2?t.fromLong(r):t.fromLong(r+1),lastAddress:l<=2?t.fromLong(r+l-1):t.fromLong(r+l-2),broadcastAddress:t.fromLong(r+l-1),subnetMask:n,subnetMaskLength:o,numHosts:l<=2?l:l-2,length:l,contains:function(e){return r===t.toLong(t.mask(e,n))}}},t.cidrSubnet=function(e){var n=e.split("/"),r=n[0];if(2!==n.length)throw new Error("invalid CIDR subnet: "+r);var i=t.fromPrefixLen(parseInt(n[1],10));return t.subnet(r,i)},t.not=function(e){for(var n=t.toBuffer(e),r=0;r<n.length;r++)n[r]=255^n[r];return t.toString(n)},t.or=function(e,n){if(e=t.toBuffer(e),n=t.toBuffer(n),e.length===n.length){for(var r=0;r<e.length;++r)e[r]|=n[r];return t.toString(e)}var i=e,o=n;n.length>e.length&&(i=n,o=e);var s=i.length-o.length;for(r=s;r<i.length;++r)i[r]|=o[r-s];return t.toString(i)},t.isEqual=function(e,n){if(e=t.toBuffer(e),n=t.toBuffer(n),e.length===n.length){for(var r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}if(4===n.length){var i=n;n=e,e=i}for(r=0;r<10;r++)if(0!==n[r])return!1;var o=n.readUInt16BE(10);if(0!==o&&65535!==o)return!1;for(r=0;r<4;r++)if(e[r]!==n[r+12])return!1;return!0},t.isPrivate=function(e){return/^(::f{4}:)?10\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?192\.168\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?172\.(1[6-9]|2\d|30|31)\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?169\.254\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^f[cd][0-9a-f]{2}:/i.test(e)||/^fe80:/i.test(e)||/^::1$/.test(e)||/^::$/.test(e)},t.isPublic=function(e){return!t.isPrivate(e)},t.isLoopback=function(e){return/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})/.test(e)||/^fe80::1$/.test(e)||/^::1$/.test(e)||/^::$/.test(e)},t.loopback=function(e){if("ipv4"!==(e=s(e))&&"ipv6"!==e)throw new Error("family must be ipv4 or ipv6");return"ipv4"===e?"127.0.0.1":"fe80::1"},t.address=function(e,n){var i,o=r.networkInterfaces();if(n=s(n),e&&"private"!==e&&"public"!==e){var a=o[e].filter((function(e){return e.family.toLowerCase()===n}));if(0===a.length)return;return a[0].address}return(i=Object.keys(o).map((function(r){var i=o[r].filter((function(r){return r.family=r.family.toLowerCase(),r.family===n&&!t.isLoopback(r.address)&&(!e||("public"===e?t.isPrivate(r.address):t.isPublic(r.address)))}));return i.length?i[0].address:void 0})).filter(Boolean)).length?i[0]:t.loopback(n)},t.toLong=function(e){var t=0;return e.split(".").forEach((function(e){t<<=8,t+=parseInt(e)})),t>>>0},t.fromLong=function(e){return(e>>>24)+"."+(e>>16&255)+"."+(e>>8&255)+"."+(255&e)}}(Fc)),Fc}var Rc,jc,Dc={},Lc={};function Bc(){if(Rc)return Lc;Rc=1,Object.defineProperty(Lc,"__esModule",{value:!0});const e=W.default,t={INVALID_ENCODING:"Invalid encoding provided. Please specify a valid encoding the internal Node.js Buffer supports.",INVALID_SMARTBUFFER_SIZE:"Invalid size provided. Size must be a valid integer greater than zero.",INVALID_SMARTBUFFER_BUFFER:"Invalid Buffer provided in SmartBufferOptions.",INVALID_SMARTBUFFER_OBJECT:"Invalid SmartBufferOptions object supplied to SmartBuffer constructor or factory methods.",INVALID_OFFSET:"An invalid offset value was provided.",INVALID_OFFSET_NON_NUMBER:"An invalid offset value was provided. A numeric value is required.",INVALID_LENGTH:"An invalid length value was provided.",INVALID_LENGTH_NON_NUMBER:"An invalid length value was provived. A numeric value is required.",INVALID_TARGET_OFFSET:"Target offset is beyond the bounds of the internal SmartBuffer data.",INVALID_TARGET_LENGTH:"Specified length value moves cursor beyong the bounds of the internal SmartBuffer data.",INVALID_READ_BEYOND_BOUNDS:"Attempted to read beyond the bounds of the managed data.",INVALID_WRITE_BEYOND_BOUNDS:"Attempted to write beyond the bounds of the managed data."};function n(e){return"number"==typeof e&&isFinite(e)&&function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}(e)}function r(e,r){if("number"!=typeof e)throw new Error(r?t.INVALID_OFFSET_NON_NUMBER:t.INVALID_LENGTH_NON_NUMBER);if(!n(e)||e<0)throw new Error(r?t.INVALID_OFFSET:t.INVALID_LENGTH)}return Lc.ERRORS=t,Lc.checkEncoding=function(n){if(!e.Buffer.isEncoding(n))throw new Error(t.INVALID_ENCODING)},Lc.isFiniteInteger=n,Lc.checkLengthValue=function(e){r(e,!1)},Lc.checkOffsetValue=function(e){r(e,!0)},Lc.checkTargetOffset=function(e,n){if(e<0||e>n.length)throw new Error(t.INVALID_TARGET_OFFSET)},Lc.bigIntAndBufferInt64Check=function(t){if("undefined"==typeof BigInt)throw new Error("Platform does not support JS BigInt type.");if(void 0===e.Buffer.prototype[t])throw new Error(`Platform does not support Buffer.prototype.${t}.`)},Lc}var Hc,qc={};function Uc(){if(Hc)return qc;Hc=1,Object.defineProperty(qc,"__esModule",{value:!0}),qc.SOCKS5_NO_ACCEPTABLE_AUTH=qc.SOCKS5_CUSTOM_AUTH_END=qc.SOCKS5_CUSTOM_AUTH_START=qc.SOCKS_INCOMING_PACKET_SIZES=qc.SocksClientState=qc.Socks5Response=qc.Socks5HostType=qc.Socks5Auth=qc.Socks4Response=qc.SocksCommand=qc.ERRORS=qc.DEFAULT_TIMEOUT=void 0;qc.DEFAULT_TIMEOUT=3e4;qc.ERRORS={InvalidSocksCommand:"An invalid SOCKS command was provided. Valid options are connect, bind, and associate.",InvalidSocksCommandForOperation:"An invalid SOCKS command was provided. Only a subset of commands are supported for this operation.",InvalidSocksCommandChain:"An invalid SOCKS command was provided. Chaining currently only supports the connect command.",InvalidSocksClientOptionsDestination:"An invalid destination host was provided.",InvalidSocksClientOptionsExistingSocket:"An invalid existing socket was provided. This should be an instance of stream.Duplex.",InvalidSocksClientOptionsProxy:"Invalid SOCKS proxy details were provided.",InvalidSocksClientOptionsTimeout:"An invalid timeout value was provided. Please enter a value above 0 (in ms).",InvalidSocksClientOptionsProxiesLength:"At least two socks proxies must be provided for chaining.",InvalidSocksClientOptionsCustomAuthRange:"Custom auth must be a value between 0x80 and 0xFE.",InvalidSocksClientOptionsCustomAuthOptions:"When a custom_auth_method is provided, custom_auth_request_handler, custom_auth_response_size, and custom_auth_response_handler must also be provided and valid.",NegotiationError:"Negotiation error",SocketClosed:"Socket closed",ProxyConnectionTimedOut:"Proxy connection timed out",InternalError:"SocksClient internal error (this should not happen)",InvalidSocks4HandshakeResponse:"Received invalid Socks4 handshake response",Socks4ProxyRejectedConnection:"Socks4 Proxy rejected connection",InvalidSocks4IncomingConnectionResponse:"Socks4 invalid incoming connection response",Socks4ProxyRejectedIncomingBoundConnection:"Socks4 Proxy rejected incoming bound connection",InvalidSocks5InitialHandshakeResponse:"Received invalid Socks5 initial handshake response",InvalidSocks5IntiailHandshakeSocksVersion:"Received invalid Socks5 initial handshake (invalid socks version)",InvalidSocks5InitialHandshakeNoAcceptedAuthType:"Received invalid Socks5 initial handshake (no accepted authentication type)",InvalidSocks5InitialHandshakeUnknownAuthType:"Received invalid Socks5 initial handshake (unknown authentication type)",Socks5AuthenticationFailed:"Socks5 Authentication failed",InvalidSocks5FinalHandshake:"Received invalid Socks5 final handshake response",InvalidSocks5FinalHandshakeRejected:"Socks5 proxy rejected connection",InvalidSocks5IncomingConnectionResponse:"Received invalid Socks5 incoming connection response",Socks5ProxyRejectedIncomingBoundConnection:"Socks5 Proxy rejected incoming bound connection"};var e,t,n;qc.SOCKS_INCOMING_PACKET_SIZES={Socks5InitialHandshakeResponse:2,Socks5UserPassAuthenticationResponse:2,Socks5ResponseHeader:5,Socks5ResponseIPv4:10,Socks5ResponseIPv6:22,Socks5ResponseHostname:e=>e+7,Socks4Response:8},function(e){e[e.connect=1]="connect",e[e.bind=2]="bind",e[e.associate=3]="associate"}(e||(e={})),qc.SocksCommand=e,function(e){e[e.Granted=90]="Granted",e[e.Failed=91]="Failed",e[e.Rejected=92]="Rejected",e[e.RejectedIdent=93]="RejectedIdent"}(t||(t={})),qc.Socks4Response=t,function(e){e[e.NoAuth=0]="NoAuth",e[e.GSSApi=1]="GSSApi",e[e.UserPass=2]="UserPass"}(n||(n={})),qc.Socks5Auth=n;qc.SOCKS5_CUSTOM_AUTH_START=128;qc.SOCKS5_CUSTOM_AUTH_END=254;var r,i,o;return qc.SOCKS5_NO_ACCEPTABLE_AUTH=255,function(e){e[e.Granted=0]="Granted",e[e.Failure=1]="Failure",e[e.NotAllowed=2]="NotAllowed",e[e.NetworkUnreachable=3]="NetworkUnreachable",e[e.HostUnreachable=4]="HostUnreachable",e[e.ConnectionRefused=5]="ConnectionRefused",e[e.TTLExpired=6]="TTLExpired",e[e.CommandNotSupported=7]="CommandNotSupported",e[e.AddressNotSupported=8]="AddressNotSupported"}(r||(r={})),qc.Socks5Response=r,function(e){e[e.IPv4=1]="IPv4",e[e.Hostname=3]="Hostname",e[e.IPv6=4]="IPv6"}(i||(i={})),qc.Socks5HostType=i,function(e){e[e.Created=0]="Created",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected",e[e.SentInitialHandshake=3]="SentInitialHandshake",e[e.ReceivedInitialHandshakeResponse=4]="ReceivedInitialHandshakeResponse",e[e.SentAuthentication=5]="SentAuthentication",e[e.ReceivedAuthenticationResponse=6]="ReceivedAuthenticationResponse",e[e.SentFinalHandshake=7]="SentFinalHandshake",e[e.ReceivedFinalResponse=8]="ReceivedFinalResponse",e[e.BoundWaitingForConnection=9]="BoundWaitingForConnection",e[e.Established=10]="Established",e[e.Disconnected=11]="Disconnected",e[e.Error=99]="Error"}(o||(o={})),qc.SocksClientState=o,qc}var Wc,$c,zc={},Vc={};function Gc(){if(Wc)return Vc;Wc=1,Object.defineProperty(Vc,"__esModule",{value:!0}),Vc.shuffleArray=Vc.SocksClientError=void 0;class e extends Error{constructor(e,t){super(e),this.options=t}}return Vc.SocksClientError=e,Vc.shuffleArray=function(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}},Vc}var Kc,Jc,Yc,Xc,Qc,Zc,eu={};function tu(){return Jc||(Jc=1,function(e){var t=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.SocksClientError=e.SocksClient=void 0;const n=M.default,r=A.default,i=Nc(),o=function(){if(jc)return Dc;jc=1,Object.defineProperty(Dc,"__esModule",{value:!0});const e=Bc();class t{constructor(n){if(this.length=0,this._encoding="utf8",this._writeOffset=0,this._readOffset=0,t.isSmartBufferOptions(n))if(n.encoding&&(e.checkEncoding(n.encoding),this._encoding=n.encoding),n.size){if(!(e.isFiniteInteger(n.size)&&n.size>0))throw new Error(e.ERRORS.INVALID_SMARTBUFFER_SIZE);this._buff=Buffer.allocUnsafe(n.size)}else if(n.buff){if(!Buffer.isBuffer(n.buff))throw new Error(e.ERRORS.INVALID_SMARTBUFFER_BUFFER);this._buff=n.buff,this.length=n.buff.length}else this._buff=Buffer.allocUnsafe(4096);else{if(void 0!==n)throw new Error(e.ERRORS.INVALID_SMARTBUFFER_OBJECT);this._buff=Buffer.allocUnsafe(4096)}}static fromSize(e,t){return new this({size:e,encoding:t})}static fromBuffer(e,t){return new this({buff:e,encoding:t})}static fromOptions(e){return new this(e)}static isSmartBufferOptions(e){const t=e;return t&&(void 0!==t.encoding||void 0!==t.size||void 0!==t.buff)}readInt8(e){return this._readNumberValue(Buffer.prototype.readInt8,1,e)}readInt16BE(e){return this._readNumberValue(Buffer.prototype.readInt16BE,2,e)}readInt16LE(e){return this._readNumberValue(Buffer.prototype.readInt16LE,2,e)}readInt32BE(e){return this._readNumberValue(Buffer.prototype.readInt32BE,4,e)}readInt32LE(e){return this._readNumberValue(Buffer.prototype.readInt32LE,4,e)}readBigInt64BE(t){return e.bigIntAndBufferInt64Check("readBigInt64BE"),this._readNumberValue(Buffer.prototype.readBigInt64BE,8,t)}readBigInt64LE(t){return e.bigIntAndBufferInt64Check("readBigInt64LE"),this._readNumberValue(Buffer.prototype.readBigInt64LE,8,t)}writeInt8(e,t){return this._writeNumberValue(Buffer.prototype.writeInt8,1,e,t),this}insertInt8(e,t){return this._insertNumberValue(Buffer.prototype.writeInt8,1,e,t)}writeInt16BE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt16BE,2,e,t)}insertInt16BE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt16BE,2,e,t)}writeInt16LE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt16LE,2,e,t)}insertInt16LE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt16LE,2,e,t)}writeInt32BE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt32BE,4,e,t)}insertInt32BE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt32BE,4,e,t)}writeInt32LE(e,t){return this._writeNumberValue(Buffer.prototype.writeInt32LE,4,e,t)}insertInt32LE(e,t){return this._insertNumberValue(Buffer.prototype.writeInt32LE,4,e,t)}writeBigInt64BE(t,n){return e.bigIntAndBufferInt64Check("writeBigInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigInt64BE,8,t,n)}insertBigInt64BE(t,n){return e.bigIntAndBufferInt64Check("writeBigInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigInt64BE,8,t,n)}writeBigInt64LE(t,n){return e.bigIntAndBufferInt64Check("writeBigInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigInt64LE,8,t,n)}insertBigInt64LE(t,n){return e.bigIntAndBufferInt64Check("writeBigInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigInt64LE,8,t,n)}readUInt8(e){return this._readNumberValue(Buffer.prototype.readUInt8,1,e)}readUInt16BE(e){return this._readNumberValue(Buffer.prototype.readUInt16BE,2,e)}readUInt16LE(e){return this._readNumberValue(Buffer.prototype.readUInt16LE,2,e)}readUInt32BE(e){return this._readNumberValue(Buffer.prototype.readUInt32BE,4,e)}readUInt32LE(e){return this._readNumberValue(Buffer.prototype.readUInt32LE,4,e)}readBigUInt64BE(t){return e.bigIntAndBufferInt64Check("readBigUInt64BE"),this._readNumberValue(Buffer.prototype.readBigUInt64BE,8,t)}readBigUInt64LE(t){return e.bigIntAndBufferInt64Check("readBigUInt64LE"),this._readNumberValue(Buffer.prototype.readBigUInt64LE,8,t)}writeUInt8(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt8,1,e,t)}insertUInt8(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt8,1,e,t)}writeUInt16BE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt16BE,2,e,t)}insertUInt16BE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt16BE,2,e,t)}writeUInt16LE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt16LE,2,e,t)}insertUInt16LE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt16LE,2,e,t)}writeUInt32BE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt32BE,4,e,t)}insertUInt32BE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt32BE,4,e,t)}writeUInt32LE(e,t){return this._writeNumberValue(Buffer.prototype.writeUInt32LE,4,e,t)}insertUInt32LE(e,t){return this._insertNumberValue(Buffer.prototype.writeUInt32LE,4,e,t)}writeBigUInt64BE(t,n){return e.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64BE,8,t,n)}insertBigUInt64BE(t,n){return e.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64BE,8,t,n)}writeBigUInt64LE(t,n){return e.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64LE,8,t,n)}insertBigUInt64LE(t,n){return e.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64LE,8,t,n)}readFloatBE(e){return this._readNumberValue(Buffer.prototype.readFloatBE,4,e)}readFloatLE(e){return this._readNumberValue(Buffer.prototype.readFloatLE,4,e)}writeFloatBE(e,t){return this._writeNumberValue(Buffer.prototype.writeFloatBE,4,e,t)}insertFloatBE(e,t){return this._insertNumberValue(Buffer.prototype.writeFloatBE,4,e,t)}writeFloatLE(e,t){return this._writeNumberValue(Buffer.prototype.writeFloatLE,4,e,t)}insertFloatLE(e,t){return this._insertNumberValue(Buffer.prototype.writeFloatLE,4,e,t)}readDoubleBE(e){return this._readNumberValue(Buffer.prototype.readDoubleBE,8,e)}readDoubleLE(e){return this._readNumberValue(Buffer.prototype.readDoubleLE,8,e)}writeDoubleBE(e,t){return this._writeNumberValue(Buffer.prototype.writeDoubleBE,8,e,t)}insertDoubleBE(e,t){return this._insertNumberValue(Buffer.prototype.writeDoubleBE,8,e,t)}writeDoubleLE(e,t){return this._writeNumberValue(Buffer.prototype.writeDoubleLE,8,e,t)}insertDoubleLE(e,t){return this._insertNumberValue(Buffer.prototype.writeDoubleLE,8,e,t)}readString(t,n){let r;"number"==typeof t?(e.checkLengthValue(t),r=Math.min(t,this.length-this._readOffset)):(n=t,r=this.length-this._readOffset),void 0!==n&&e.checkEncoding(n);const i=this._buff.slice(this._readOffset,this._readOffset+r).toString(n||this._encoding);return this._readOffset+=r,i}insertString(t,n,r){return e.checkOffsetValue(n),this._handleString(t,!0,n,r)}writeString(e,t,n){return this._handleString(e,!1,t,n)}readStringNT(t){void 0!==t&&e.checkEncoding(t);let n=this.length;for(let e=this._readOffset;e<this.length;e++)if(0===this._buff[e]){n=e;break}const r=this._buff.slice(this._readOffset,n);return this._readOffset=n+1,r.toString(t||this._encoding)}insertStringNT(t,n,r){return e.checkOffsetValue(n),this.insertString(t,n,r),this.insertUInt8(0,n+t.length),this}writeStringNT(e,t,n){return this.writeString(e,t,n),this.writeUInt8(0,"number"==typeof t?t+e.length:this.writeOffset),this}readBuffer(t){void 0!==t&&e.checkLengthValue(t);const n="number"==typeof t?t:this.length,r=Math.min(this.length,this._readOffset+n),i=this._buff.slice(this._readOffset,r);return this._readOffset=r,i}insertBuffer(t,n){return e.checkOffsetValue(n),this._handleBuffer(t,!0,n)}writeBuffer(e,t){return this._handleBuffer(e,!1,t)}readBufferNT(){let e=this.length;for(let t=this._readOffset;t<this.length;t++)if(0===this._buff[t]){e=t;break}const t=this._buff.slice(this._readOffset,e);return this._readOffset=e+1,t}insertBufferNT(t,n){return e.checkOffsetValue(n),this.insertBuffer(t,n),this.insertUInt8(0,n+t.length),this}writeBufferNT(t,n){return void 0!==n&&e.checkOffsetValue(n),this.writeBuffer(t,n),this.writeUInt8(0,"number"==typeof n?n+t.length:this._writeOffset),this}clear(){return this._writeOffset=0,this._readOffset=0,this.length=0,this}remaining(){return this.length-this._readOffset}get readOffset(){return this._readOffset}set readOffset(t){e.checkOffsetValue(t),e.checkTargetOffset(t,this),this._readOffset=t}get writeOffset(){return this._writeOffset}set writeOffset(t){e.checkOffsetValue(t),e.checkTargetOffset(t,this),this._writeOffset=t}get encoding(){return this._encoding}set encoding(t){e.checkEncoding(t),this._encoding=t}get internalBuffer(){return this._buff}toBuffer(){return this._buff.slice(0,this.length)}toString(t){const n="string"==typeof t?t:this._encoding;return e.checkEncoding(n),this._buff.toString(n,0,this.length)}destroy(){return this.clear(),this}_handleString(t,n,r,i){let o=this._writeOffset,s=this._encoding;"number"==typeof r?o=r:"string"==typeof r&&(e.checkEncoding(r),s=r),"string"==typeof i&&(e.checkEncoding(i),s=i);const a=Buffer.byteLength(t,s);return n?this.ensureInsertable(a,o):this._ensureWriteable(a,o),this._buff.write(t,o,a,s),n?this._writeOffset+=a:"number"==typeof r?this._writeOffset=Math.max(this._writeOffset,o+a):this._writeOffset+=a,this}_handleBuffer(e,t,n){const r="number"==typeof n?n:this._writeOffset;return t?this.ensureInsertable(e.length,r):this._ensureWriteable(e.length,r),e.copy(this._buff,r),t?this._writeOffset+=e.length:"number"==typeof n?this._writeOffset=Math.max(this._writeOffset,r+e.length):this._writeOffset+=e.length,this}ensureReadable(t,n){let r=this._readOffset;if(void 0!==n&&(e.checkOffsetValue(n),r=n),r<0||r+t>this.length)throw new Error(e.ERRORS.INVALID_READ_BEYOND_BOUNDS)}ensureInsertable(t,n){e.checkOffsetValue(n),this._ensureCapacity(this.length+t),n<this.length&&this._buff.copy(this._buff,n+t,n,this._buff.length),n+t>this.length?this.length=n+t:this.length+=t}_ensureWriteable(e,t){const n="number"==typeof t?t:this._writeOffset;this._ensureCapacity(n+e),n+e>this.length&&(this.length=n+e)}_ensureCapacity(e){const t=this._buff.length;if(e>t){let n=this._buff,r=3*t/2+1;r<e&&(r=e),this._buff=Buffer.allocUnsafe(r),n.copy(this._buff,0,0,t)}}_readNumberValue(e,t,n){this.ensureReadable(t,n);const r=e.call(this._buff,"number"==typeof n?n:this._readOffset);return void 0===n&&(this._readOffset+=t),r}_insertNumberValue(t,n,r,i){return e.checkOffsetValue(i),this.ensureInsertable(n,i),t.call(this._buff,r,i),this._writeOffset+=n,this}_writeNumberValue(t,n,r,i){if("number"==typeof i){if(i<0)throw new Error(e.ERRORS.INVALID_WRITE_BEYOND_BOUNDS);e.checkOffsetValue(i)}const o="number"==typeof i?i:this._writeOffset;return this._ensureWriteable(n,o),t.call(this._buff,r,o),"number"==typeof i?this._writeOffset=Math.max(this._writeOffset,o+n):this._writeOffset+=n,this}}return Dc.SmartBuffer=t,Dc}(),s=Uc(),a=function(){if($c)return zc;$c=1,Object.defineProperty(zc,"__esModule",{value:!0}),zc.validateSocksClientChainOptions=zc.validateSocksClientOptions=void 0;const e=Gc(),t=Uc(),n=B.default;function r(n,r){if(void 0!==n.custom_auth_method){if(n.custom_auth_method<t.SOCKS5_CUSTOM_AUTH_START||n.custom_auth_method>t.SOCKS5_CUSTOM_AUTH_END)throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsCustomAuthRange,r);if(void 0===n.custom_auth_request_handler||"function"!=typeof n.custom_auth_request_handler)throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,r);if(void 0===n.custom_auth_response_size)throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,r);if(void 0===n.custom_auth_response_handler||"function"!=typeof n.custom_auth_response_handler)throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,r)}}function i(e){return e&&"string"==typeof e.host&&"number"==typeof e.port&&e.port>=0&&e.port<=65535}function o(e){return e&&("string"==typeof e.host||"string"==typeof e.ipaddress)&&"number"==typeof e.port&&e.port>=0&&e.port<=65535&&(4===e.type||5===e.type)}function s(e){return"number"==typeof e&&e>0}return zc.validateSocksClientOptions=function(a,l=["connect","bind","associate"]){if(!t.SocksCommand[a.command])throw new e.SocksClientError(t.ERRORS.InvalidSocksCommand,a);if(-1===l.indexOf(a.command))throw new e.SocksClientError(t.ERRORS.InvalidSocksCommandForOperation,a);if(!i(a.destination))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsDestination,a);if(!o(a.proxy))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsProxy,a);if(r(a.proxy,a),a.timeout&&!s(a.timeout))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsTimeout,a);if(a.existing_socket&&!(a.existing_socket instanceof n.Duplex))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsExistingSocket,a)},zc.validateSocksClientChainOptions=function(n){if("connect"!==n.command)throw new e.SocksClientError(t.ERRORS.InvalidSocksCommandChain,n);if(!i(n.destination))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsDestination,n);if(!(n.proxies&&Array.isArray(n.proxies)&&n.proxies.length>=2))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsProxiesLength,n);if(n.proxies.forEach((i=>{if(!o(i))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsProxy,n);r(i,n)})),n.timeout&&!s(n.timeout))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsTimeout,n)},zc}(),l=(Kc||(Kc=1,Object.defineProperty(eu,"__esModule",{value:!0}),eu.ReceiveBuffer=void 0,eu.ReceiveBuffer=class{constructor(e=4096){this.buffer=Buffer.allocUnsafe(e),this.offset=0,this.originalSize=e}get length(){return this.offset}append(e){if(!Buffer.isBuffer(e))throw new Error("Attempted to append a non-buffer instance to ReceiveBuffer.");if(this.offset+e.length>=this.buffer.length){const t=this.buffer;this.buffer=Buffer.allocUnsafe(Math.max(this.buffer.length+this.originalSize,this.buffer.length+e.length)),t.copy(this.buffer)}return e.copy(this.buffer,this.offset),this.offset+=e.length}peek(e){if(e>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");return this.buffer.slice(0,e)}get(e){if(e>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");const t=Buffer.allocUnsafe(e);return this.buffer.slice(0,e).copy(t),this.buffer.copyWithin(0,e,e+this.offset-e),this.offset-=e,t}}),eu),c=Gc();Object.defineProperty(e,"SocksClientError",{enumerable:!0,get:function(){return c.SocksClientError}});class u extends n.EventEmitter{constructor(e){super(),this.options=Object.assign({},e),(0,a.validateSocksClientOptions)(e),this.setState(s.SocksClientState.Created)}static createConnection(e,t){return new Promise(((n,r)=>{try{(0,a.validateSocksClientOptions)(e,["connect"])}catch(e){return"function"==typeof t?(t(e),n(e)):r(e)}const i=new u(e);i.connect(e.existing_socket),i.once("established",(e=>{i.removeAllListeners(),"function"==typeof t?(t(null,e),n(e)):n(e)})),i.once("error",(e=>{i.removeAllListeners(),"function"==typeof t?(t(e),n(e)):r(e)}))}))}static createConnectionChain(e,n){return new Promise(((r,i)=>t(this,void 0,void 0,(function*(){try{(0,a.validateSocksClientChainOptions)(e)}catch(e){return"function"==typeof n?(n(e),r(e)):i(e)}let t;e.randomizeChain&&(0,c.shuffleArray)(e.proxies);try{for(let n=0;n<e.proxies.length;n++){const r=e.proxies[n],i=n===e.proxies.length-1?e.destination:{host:e.proxies[n+1].host||e.proxies[n+1].ipaddress,port:e.proxies[n+1].port},o=yield u.createConnection({command:"connect",proxy:r,destination:i});t||(t=o.socket)}"function"==typeof n?(n(null,{socket:t}),r({socket:t})):r({socket:t})}catch(e){"function"==typeof n?(n(e),r(e)):i(e)}}))))}static createUDPFrame(e){const t=new o.SmartBuffer;return t.writeUInt16BE(0),t.writeUInt8(e.frameNumber||0),r.isIPv4(e.remoteHost.host)?(t.writeUInt8(s.Socks5HostType.IPv4),t.writeUInt32BE(i.toLong(e.remoteHost.host))):r.isIPv6(e.remoteHost.host)?(t.writeUInt8(s.Socks5HostType.IPv6),t.writeBuffer(i.toBuffer(e.remoteHost.host))):(t.writeUInt8(s.Socks5HostType.Hostname),t.writeUInt8(Buffer.byteLength(e.remoteHost.host)),t.writeString(e.remoteHost.host)),t.writeUInt16BE(e.remoteHost.port),t.writeBuffer(e.data),t.toBuffer()}static parseUDPFrame(e){const t=o.SmartBuffer.fromBuffer(e);t.readOffset=2;const n=t.readUInt8(),r=t.readUInt8();let a;a=r===s.Socks5HostType.IPv4?i.fromLong(t.readUInt32BE()):r===s.Socks5HostType.IPv6?i.toString(t.readBuffer(16)):t.readString(t.readUInt8());return{frameNumber:n,remoteHost:{host:a,port:t.readUInt16BE()},data:t.readBuffer()}}setState(e){this.state!==s.SocksClientState.Error&&(this.state=e)}connect(e){this.onDataReceived=e=>this.onDataReceivedHandler(e),this.onClose=()=>this.onCloseHandler(),this.onError=e=>this.onErrorHandler(e),this.onConnect=()=>this.onConnectHandler();const t=setTimeout((()=>this.onEstablishedTimeout()),this.options.timeout||s.DEFAULT_TIMEOUT);t.unref&&"function"==typeof t.unref&&t.unref(),this.socket=e||new r.Socket,this.socket.once("close",this.onClose),this.socket.once("error",this.onError),this.socket.once("connect",this.onConnect),this.socket.on("data",this.onDataReceived),this.setState(s.SocksClientState.Connecting),this.receiveBuffer=new l.ReceiveBuffer,e?this.socket.emit("connect"):(this.socket.connect(this.getSocketOptions()),void 0!==this.options.set_tcp_nodelay&&null!==this.options.set_tcp_nodelay&&this.socket.setNoDelay(!!this.options.set_tcp_nodelay)),this.prependOnceListener("established",(e=>{setImmediate((()=>{if(this.receiveBuffer.length>0){const t=this.receiveBuffer.get(this.receiveBuffer.length);e.socket.emit("data",t)}e.socket.resume()}))}))}getSocketOptions(){return Object.assign(Object.assign({},this.options.socket_options),{host:this.options.proxy.host||this.options.proxy.ipaddress,port:this.options.proxy.port})}onEstablishedTimeout(){this.state!==s.SocksClientState.Established&&this.state!==s.SocksClientState.BoundWaitingForConnection&&this.closeSocket(s.ERRORS.ProxyConnectionTimedOut)}onConnectHandler(){this.setState(s.SocksClientState.Connected),4===this.options.proxy.type?this.sendSocks4InitialHandshake():this.sendSocks5InitialHandshake(),this.setState(s.SocksClientState.SentInitialHandshake)}onDataReceivedHandler(e){this.receiveBuffer.append(e),this.processData()}processData(){for(;this.state!==s.SocksClientState.Established&&this.state!==s.SocksClientState.Error&&this.receiveBuffer.length>=this.nextRequiredPacketBufferSize;)if(this.state===s.SocksClientState.SentInitialHandshake)4===this.options.proxy.type?this.handleSocks4FinalHandshakeResponse():this.handleInitialSocks5HandshakeResponse();else if(this.state===s.SocksClientState.SentAuthentication)this.handleInitialSocks5AuthenticationHandshakeResponse();else if(this.state===s.SocksClientState.SentFinalHandshake)this.handleSocks5FinalHandshakeResponse();else{if(this.state!==s.SocksClientState.BoundWaitingForConnection){this.closeSocket(s.ERRORS.InternalError);break}4===this.options.proxy.type?this.handleSocks4IncomingConnectionResponse():this.handleSocks5IncomingConnectionResponse()}}onCloseHandler(){this.closeSocket(s.ERRORS.SocketClosed)}onErrorHandler(e){this.closeSocket(e.message)}removeInternalSocketHandlers(){this.socket.pause(),this.socket.removeListener("data",this.onDataReceived),this.socket.removeListener("close",this.onClose),this.socket.removeListener("error",this.onError),this.socket.removeListener("connect",this.onConnect)}closeSocket(e){this.state!==s.SocksClientState.Error&&(this.setState(s.SocksClientState.Error),this.socket.destroy(),this.removeInternalSocketHandlers(),this.emit("error",new c.SocksClientError(e,this.options)))}sendSocks4InitialHandshake(){const e=this.options.proxy.userId||"",t=new o.SmartBuffer;t.writeUInt8(4),t.writeUInt8(s.SocksCommand[this.options.command]),t.writeUInt16BE(this.options.destination.port),r.isIPv4(this.options.destination.host)?(t.writeBuffer(i.toBuffer(this.options.destination.host)),t.writeStringNT(e)):(t.writeUInt8(0),t.writeUInt8(0),t.writeUInt8(0),t.writeUInt8(1),t.writeStringNT(e),t.writeStringNT(this.options.destination.host)),this.nextRequiredPacketBufferSize=s.SOCKS_INCOMING_PACKET_SIZES.Socks4Response,this.socket.write(t.toBuffer())}handleSocks4FinalHandshakeResponse(){const e=this.receiveBuffer.get(8);if(e[1]!==s.Socks4Response.Granted)this.closeSocket(`${s.ERRORS.Socks4ProxyRejectedConnection} - (${s.Socks4Response[e[1]]})`);else if(s.SocksCommand[this.options.command]===s.SocksCommand.bind){const t=o.SmartBuffer.fromBuffer(e);t.readOffset=2;const n={port:t.readUInt16BE(),host:i.fromLong(t.readUInt32BE())};"0.0.0.0"===n.host&&(n.host=this.options.proxy.ipaddress),this.setState(s.SocksClientState.BoundWaitingForConnection),this.emit("bound",{remoteHost:n,socket:this.socket})}else this.setState(s.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{socket:this.socket})}handleSocks4IncomingConnectionResponse(){const e=this.receiveBuffer.get(8);if(e[1]!==s.Socks4Response.Granted)this.closeSocket(`${s.ERRORS.Socks4ProxyRejectedIncomingBoundConnection} - (${s.Socks4Response[e[1]]})`);else{const t=o.SmartBuffer.fromBuffer(e);t.readOffset=2;const n={port:t.readUInt16BE(),host:i.fromLong(t.readUInt32BE())};this.setState(s.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:n,socket:this.socket})}}sendSocks5InitialHandshake(){const e=new o.SmartBuffer,t=[s.Socks5Auth.NoAuth];(this.options.proxy.userId||this.options.proxy.password)&&t.push(s.Socks5Auth.UserPass),void 0!==this.options.proxy.custom_auth_method&&t.push(this.options.proxy.custom_auth_method),e.writeUInt8(5),e.writeUInt8(t.length);for(const n of t)e.writeUInt8(n);this.nextRequiredPacketBufferSize=s.SOCKS_INCOMING_PACKET_SIZES.Socks5InitialHandshakeResponse,this.socket.write(e.toBuffer()),this.setState(s.SocksClientState.SentInitialHandshake)}handleInitialSocks5HandshakeResponse(){const e=this.receiveBuffer.get(2);5!==e[0]?this.closeSocket(s.ERRORS.InvalidSocks5IntiailHandshakeSocksVersion):e[1]===s.SOCKS5_NO_ACCEPTABLE_AUTH?this.closeSocket(s.ERRORS.InvalidSocks5InitialHandshakeNoAcceptedAuthType):e[1]===s.Socks5Auth.NoAuth?(this.socks5ChosenAuthType=s.Socks5Auth.NoAuth,this.sendSocks5CommandRequest()):e[1]===s.Socks5Auth.UserPass?(this.socks5ChosenAuthType=s.Socks5Auth.UserPass,this.sendSocks5UserPassAuthentication()):e[1]===this.options.proxy.custom_auth_method?(this.socks5ChosenAuthType=this.options.proxy.custom_auth_method,this.sendSocks5CustomAuthentication()):this.closeSocket(s.ERRORS.InvalidSocks5InitialHandshakeUnknownAuthType)}sendSocks5UserPassAuthentication(){const e=this.options.proxy.userId||"",t=this.options.proxy.password||"",n=new o.SmartBuffer;n.writeUInt8(1),n.writeUInt8(Buffer.byteLength(e)),n.writeString(e),n.writeUInt8(Buffer.byteLength(t)),n.writeString(t),this.nextRequiredPacketBufferSize=s.SOCKS_INCOMING_PACKET_SIZES.Socks5UserPassAuthenticationResponse,this.socket.write(n.toBuffer()),this.setState(s.SocksClientState.SentAuthentication)}sendSocks5CustomAuthentication(){return t(this,void 0,void 0,(function*(){this.nextRequiredPacketBufferSize=this.options.proxy.custom_auth_response_size,this.socket.write(yield this.options.proxy.custom_auth_request_handler()),this.setState(s.SocksClientState.SentAuthentication)}))}handleSocks5CustomAuthHandshakeResponse(e){return t(this,void 0,void 0,(function*(){return yield this.options.proxy.custom_auth_response_handler(e)}))}handleSocks5AuthenticationNoAuthHandshakeResponse(e){return t(this,void 0,void 0,(function*(){return 0===e[1]}))}handleSocks5AuthenticationUserPassHandshakeResponse(e){return t(this,void 0,void 0,(function*(){return 0===e[1]}))}handleInitialSocks5AuthenticationHandshakeResponse(){return t(this,void 0,void 0,(function*(){this.setState(s.SocksClientState.ReceivedAuthenticationResponse);let e=!1;this.socks5ChosenAuthType===s.Socks5Auth.NoAuth?e=yield this.handleSocks5AuthenticationNoAuthHandshakeResponse(this.receiveBuffer.get(2)):this.socks5ChosenAuthType===s.Socks5Auth.UserPass?e=yield this.handleSocks5AuthenticationUserPassHandshakeResponse(this.receiveBuffer.get(2)):this.socks5ChosenAuthType===this.options.proxy.custom_auth_method&&(e=yield this.handleSocks5CustomAuthHandshakeResponse(this.receiveBuffer.get(this.options.proxy.custom_auth_response_size))),e?this.sendSocks5CommandRequest():this.closeSocket(s.ERRORS.Socks5AuthenticationFailed)}))}sendSocks5CommandRequest(){const e=new o.SmartBuffer;e.writeUInt8(5),e.writeUInt8(s.SocksCommand[this.options.command]),e.writeUInt8(0),r.isIPv4(this.options.destination.host)?(e.writeUInt8(s.Socks5HostType.IPv4),e.writeBuffer(i.toBuffer(this.options.destination.host))):r.isIPv6(this.options.destination.host)?(e.writeUInt8(s.Socks5HostType.IPv6),e.writeBuffer(i.toBuffer(this.options.destination.host))):(e.writeUInt8(s.Socks5HostType.Hostname),e.writeUInt8(this.options.destination.host.length),e.writeString(this.options.destination.host)),e.writeUInt16BE(this.options.destination.port),this.nextRequiredPacketBufferSize=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.socket.write(e.toBuffer()),this.setState(s.SocksClientState.SentFinalHandshake)}handleSocks5FinalHandshakeResponse(){const e=this.receiveBuffer.peek(5);if(5!==e[0]||e[1]!==s.Socks5Response.Granted)this.closeSocket(`${s.ERRORS.InvalidSocks5FinalHandshakeRejected} - ${s.Socks5Response[e[1]]}`);else{const t=e[3];let n,r;if(t===s.Socks5HostType.IPv4){const e=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<e)return void(this.nextRequiredPacketBufferSize=e);r=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(e).slice(4)),n={host:i.fromLong(r.readUInt32BE()),port:r.readUInt16BE()},"0.0.0.0"===n.host&&(n.host=this.options.proxy.ipaddress)}else if(t===s.Socks5HostType.Hostname){const t=e[4],i=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(t);if(this.receiveBuffer.length<i)return void(this.nextRequiredPacketBufferSize=i);r=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(i).slice(5)),n={host:r.readString(t),port:r.readUInt16BE()}}else if(t===s.Socks5HostType.IPv6){const e=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<e)return void(this.nextRequiredPacketBufferSize=e);r=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(e).slice(4)),n={host:i.toString(r.readBuffer(16)),port:r.readUInt16BE()}}this.setState(s.SocksClientState.ReceivedFinalResponse),s.SocksCommand[this.options.command]===s.SocksCommand.connect?(this.setState(s.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:n,socket:this.socket})):s.SocksCommand[this.options.command]===s.SocksCommand.bind?(this.setState(s.SocksClientState.BoundWaitingForConnection),this.nextRequiredPacketBufferSize=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.emit("bound",{remoteHost:n,socket:this.socket})):s.SocksCommand[this.options.command]===s.SocksCommand.associate&&(this.setState(s.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:n,socket:this.socket}))}}handleSocks5IncomingConnectionResponse(){const e=this.receiveBuffer.peek(5);if(5!==e[0]||e[1]!==s.Socks5Response.Granted)this.closeSocket(`${s.ERRORS.Socks5ProxyRejectedIncomingBoundConnection} - ${s.Socks5Response[e[1]]}`);else{const t=e[3];let n,r;if(t===s.Socks5HostType.IPv4){const e=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<e)return void(this.nextRequiredPacketBufferSize=e);r=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(e).slice(4)),n={host:i.fromLong(r.readUInt32BE()),port:r.readUInt16BE()},"0.0.0.0"===n.host&&(n.host=this.options.proxy.ipaddress)}else if(t===s.Socks5HostType.Hostname){const t=e[4],i=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(t);if(this.receiveBuffer.length<i)return void(this.nextRequiredPacketBufferSize=i);r=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(i).slice(5)),n={host:r.readString(t),port:r.readUInt16BE()}}else if(t===s.Socks5HostType.IPv6){const e=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<e)return void(this.nextRequiredPacketBufferSize=e);r=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(e).slice(4)),n={host:i.toString(r.readBuffer(16)),port:r.readUInt16BE()}}this.setState(s.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:n,socket:this.socket})}}get socksClientOptions(){return Object.assign({},this.options)}}e.SocksClient=u}(Mc)),Mc}function nu(){if(Xc)return Ac;Xc=1;var e=Y&&Y.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},t=Y&&Y.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ac,"__esModule",{value:!0});const n=t(V.default),r=t(I.default),i=t(H.default),o=t(Ir.exports),s=Ur(),a=(Yc||(Yc=1,function(e){var t=Y&&Y.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=Y&&Y.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),n(tu(),e)}(Ic)),Ic),l=o.default("socks-proxy-agent");class c extends s.Agent{constructor(e){let t;if(t="string"==typeof e?i.default.parse(e):e,!t)throw new TypeError("a SOCKS proxy server `host` and `port` must be specified!");super(t);const n=function(e){let t=0,n=!1,r=5;const i=e.hostname||e.host;if(!i)throw new TypeError('No "host"');if("number"==typeof e.port?t=e.port:"string"==typeof e.port&&(t=parseInt(e.port,10)),t||(t=1080),e.protocol)switch(e.protocol.replace(":","")){case"socks4":n=!0;case"socks4a":r=4;break;case"socks5":n=!0;case"socks":case"socks5h":r=5;break;default:throw new TypeError(`A "socks" protocol must be specified! Got: ${e.protocol}`)}if(void 0!==e.type){if(4!==e.type&&5!==e.type)throw new TypeError(`"type" must be 4 or 5, got: ${e.type}`);r=e.type}const o={host:i,port:t,type:r};let s=e.userId||e.username,a=e.password;if(e.auth){const t=e.auth.split(":");s=t[0],a=t[1]}return s&&Object.defineProperty(o,"userId",{value:s,enumerable:!1}),a&&Object.defineProperty(o,"password",{value:a,enumerable:!1}),{lookup:n,proxy:o}}(t);this.lookup=n.lookup,this.proxy=n.proxy,this.tlsConnectionOptions=t.tls||{}}callback(t,i){return e(this,void 0,void 0,(function*(){const{lookup:e,proxy:t}=this;let{host:o,port:s,timeout:c}=i;if(!o)throw new Error("No `host` defined!");e&&(o=yield function(e){return new Promise(((t,r)=>{n.default.lookup(e,((e,n)=>{e?r(e):t(n)}))}))}(o));const u={proxy:t,destination:{host:o,port:s},command:"connect",timeout:c};l("Creating socks proxy connection: %o",u);const{socket:d}=yield a.SocksClient.createConnection(u);if(l("Successfully created socks proxy connection"),i.secureEndpoint){l("Upgrading socket connection to TLS");const e=i.servername||i.host;return r.default.connect(Object.assign(Object.assign(Object.assign({},function(e,...t){const n={};let r;for(r in e)t.includes(r)||(n[r]=e[r]);return n}(i,"host","hostname","path","port")),{socket:d,servername:e}),this.tlsConnectionOptions))}return d}))}}return Ac.default=c,Ac}var ru={};Object.defineProperty(ru,"__esModule",{value:!0}),ru.TimeoutSettings=ru.DEFAULT_TIMEOUT=void 0;var iu=Ci;ru.DEFAULT_TIMEOUT=3e4;ru.TimeoutSettings=class{constructor(e){this._parent=void 0,this._defaultTimeout=void 0,this._defaultNavigationTimeout=void 0,this._parent=e}setDefaultTimeout(e){this._defaultTimeout=e}setDefaultNavigationTimeout(e){this._defaultNavigationTimeout=e}navigationTimeout(e){return"number"==typeof e.timeout?e.timeout:void 0!==this._defaultNavigationTimeout?this._defaultNavigationTimeout:(0,iu.debugMode)()?0:void 0!==this._defaultTimeout?this._defaultTimeout:this._parent?this._parent.navigationTimeout(e):3e4}timeout(e){return"number"==typeof e.timeout?e.timeout:(0,iu.debugMode)()?0:void 0!==this._defaultTimeout?this._defaultTimeout:this._parent?this._parent.timeout(e):3e4}static timeout(e){return"number"==typeof e.timeout?e.timeout:(0,iu.debugMode)()?0:3e4}};var ou={},su={},au={};Object.defineProperty(au,"__esModule",{value:!0}),au.eventsHelper=void 0;const lu=class{static addEventListener(e,t,n){return e.on(t,n),{emitter:e,eventName:t,handler:n}}static removeEventListeners(e){for(const t of e)t.emitter.removeListener(t.eventName,t.handler);e.splice(0,e.length)}};au.eventsHelper=lu,Object.defineProperty(su,"__esModule",{value:!0}),su.helper=void 0;var cu=Ka,uu=au;const du=class{static completeUserURL(e){return(e.startsWith("localhost")||e.startsWith("127.0.0.1"))&&(e="http://"+e),e}static enclosingIntRect(e){const t=Math.floor(e.x+.001),n=Math.floor(e.y+.001);return{x:t,y:n,width:Math.ceil(e.x+e.width-.001)-t,height:Math.ceil(e.y+e.height-.001)-n}}static enclosingIntSize(e){return{width:Math.floor(e.width+.001),height:Math.floor(e.height+.001)}}static getViewportSizeFromWindowFeatures(e){const t=e.find((e=>e.startsWith("width="))),n=e.find((e=>e.startsWith("height="))),r=t?parseInt(t.substring(6),10):NaN,i=n?parseInt(n.substring(7),10):NaN;return Number.isNaN(r)||Number.isNaN(i)?null:{width:r,height:i}}static waitForEvent(e,t,n,r){const i=[],o=new Promise(((e,o)=>{i.push(uu.eventsHelper.addEventListener(t,n,(t=>{try{if(r&&!r(t))return;uu.eventsHelper.removeEventListeners(i),e(t)}catch(e){uu.eventsHelper.removeEventListeners(i),o(e)}})))})),s=()=>uu.eventsHelper.removeEventListeners(i);return e&&e.cleanupWhenAborted(s),{promise:o,dispose:s}}static secondsToRoundishMillis(e){return(1e6*e|0)/1e3}static millisToRoundishMillis(e){return(1e3*e|0)/1e3}static debugProtocolLogger(e){return(t,n)=>{e&&e(t,n),cu.debugLogger.isEnabled("protocol")&&cu.debugLogger.log("protocol",("send"===t?"SEND  ":" RECV ")+JSON.stringify(n))}}static formatBrowserLogs(e){return e.length?"\n"+"=".repeat(20)+" Browser output: "+"=".repeat(20)+"\n"+e.join("\n"):""}};su.helper=du;var hu={},pu={};let fu,mu;Object.defineProperty(pu,"__esModule",{value:!0}),pu.ManualPromise=void 0,fu=Symbol.species,mu=Symbol.toStringTag;var gu;function _u(){if(gu)return hu;gu=1,Object.defineProperty(hu,"__esModule",{value:!0}),hu.WebSocket=hu.STATUS_TEXTS=hu.Route=hu.Response=hu.Request=void 0,hu.filterCookies=function(e,t){const n=t.map((e=>new URL(e)));return e.filter((e=>{if(!n.length)return!0;for(const t of n){let n=e.domain;if(n.startsWith(".")||(n="."+n),("."+t.hostname).endsWith(n)&&t.pathname.startsWith(e.path)&&("https:"===t.protocol||"localhost"===t.hostname||!e.secure))return!0}return!1}))},hu.mergeHeaders=function(e){const t=new Map,n=new Map;for(const r of e)if(r)for(const{name:e,value:i}of r){const r=e.toLowerCase();n.set(r,e),t.set(r,i)}const r=[];for(const[e,i]of t)r.push({name:n.get(e),value:i});return r},hu.parsedURL=function(e){try{return new URL(e)}catch(e){return null}},hu.rewriteCookies=function(t){return t.map((t=>{(0,e.assert)(t.url||t.domain&&t.path,"Cookie should have a url or a domain/path pair"),(0,e.assert)(!(t.url&&t.domain),"Cookie should have either url or domain"),(0,e.assert)(!(t.url&&t.path),"Cookie should have either url or path"),(0,e.assert)(!(t.expires&&t.expires<0&&-1!==t.expires),"Cookie should have a valid expires, only -1 or a positive number for the unix timestamp in seconds is allowed"),(0,e.assert)(!(t.expires&&t.expires>0&&t.expires>253402300799),"Cookie should have a valid expires, only -1 or a positive number for the unix timestamp in seconds is allowed");const n={...t};if(n.url){(0,e.assert)("about:blank"!==n.url,`Blank page can not have cookie "${t.name}"`),(0,e.assert)(!n.url.startsWith("data:"),`Data URL page can not have cookie "${t.name}"`);const r=new URL(n.url);n.domain=r.hostname,n.path=r.pathname.substring(0,r.pathname.lastIndexOf("/")+1),n.secure="https:"===r.protocol}return n}))},hu.singleHeader=function(e,t){return[{name:e,value:t}]},hu.stripFragmentFromUrl=i;var e=Ci,t=pu,n=Hl,r=xx();function i(e){return e.includes("#")?e.substring(0,e.indexOf("#")):e}class o extends n.SdkObject{constructor(n,r,o,s,a,l,c,u){super(n,"request"),this._response=null,this._redirectedFrom=void 0,this._redirectedTo=null,this._documentId=void 0,this._isFavicon=void 0,this._failureText=null,this._url=void 0,this._resourceType=void 0,this._method=void 0,this._postData=void 0,this._headers=void 0,this._headersMap=new Map,this._rawRequestHeadersPromise=void 0,this._frame=void 0,this._waitForResponsePromise=new t.ManualPromise,this._responseEndTiming=-1,this.responseSize={encodedBodySize:0,transferSize:0,responseHeadersSize:0},(0,e.assert)(!s.startsWith("data:"),"Data urls should not fire requests"),this._frame=n,this._redirectedFrom=r,r&&(r._redirectedTo=this),this._documentId=o,this._url=i(s),this._resourceType=a,this._method=l,this._postData=c,this._headers=u;for(const{name:e,value:t}of this._headers)this._headersMap.set(e.toLowerCase(),t);this._isFavicon=s.endsWith("/favicon.ico")||!(null==r||!r._isFavicon)}_setFailureText(e){this._failureText=e,this._waitForResponsePromise.resolve(null)}url(){return this._url}resourceType(){return this._resourceType}method(){return this._method}postDataBuffer(){return this._postData}headers(){return this._headers}headerValue(e){return this._headersMap.get(e)}setWillReceiveExtraHeaders(){this._rawRequestHeadersPromise||(this._rawRequestHeadersPromise=new t.ManualPromise)}setRawRequestHeaders(e){this._rawRequestHeadersPromise||(this._rawRequestHeadersPromise=new t.ManualPromise),this._rawRequestHeadersPromise.resolve(e)}async rawRequestHeaders(){return this._rawRequestHeadersPromise||Promise.resolve(this._headers)}rawRequestHeadersPromise(){return this._rawRequestHeadersPromise}response(){return this._waitForResponsePromise}_existingResponse(){return this._response}_setResponse(e){this._response=e,this._waitForResponsePromise.resolve(e)}_finalRequest(){return this._redirectedTo?this._redirectedTo._finalRequest():this}frame(){return this._frame}isNavigationRequest(){return!!this._documentId}redirectedFrom(){return this._redirectedFrom}failure(){return null===this._failureText?null:{errorText:this._failureText}}bodySize(){var e;return(null===(e=this.postDataBuffer())||void 0===e?void 0:e.length)||0}async requestHeadersSize(){let e=4;e+=this.method().length,e+=new URL(this.url()).pathname.length,e+=8;const t=this.rawRequestHeadersPromise()?await this.rawRequestHeadersPromise():this._headers;for(const n of t)e+=n.name.length+n.value.length+4;return e}}hu.Request=o;class s extends n.SdkObject{constructor(e,t){super(e.frame(),"route"),this._request=void 0,this._delegate=void 0,this._handled=!1,this._request=e,this._delegate=t}request(){return this._request}async abort(e="failed"){this._startHandling(),await this._delegate.abort(e)}async fulfill(t){this._startHandling();let n=t.body,i=t.isBase64||!1;if(void 0===n)if(t.fetchResponseUid){const o=this._request.frame()._page._browserContext.fetchRequest.fetchResponses.get(t.fetchResponseUid)||r.APIRequestContext.findResponseBody(t.fetchResponseUid);(0,e.assert)(o,"Fetch response has been disposed"),n=o.toString("base64"),i=!0}else n="",i=!1;const o=[...t.headers||[]];this._maybeAddCorsHeaders(o),await this._delegate.fulfill({status:t.status||200,headers:o,body:n,isBase64:i})}_maybeAddCorsHeaders(e){const t=this._request.headerValue("origin");if(!t)return;const n=new URL(this._request.url());if(!n.protocol.startsWith("http"))return;if(n.origin===t.trim())return;const r=e.find((({name:e})=>"access-control-allow-origin"===e));r||(e.push({name:"access-control-allow-origin",value:t}),e.push({name:"access-control-allow-credentials",value:"true"}),e.push({name:"vary",value:"Origin"}))}async continue(e={}){if(this._startHandling(),e.url){const t=new URL(e.url);if(new URL(this._request.url()).protocol!==t.protocol)throw new Error("New URL must have same protocol as overridden URL")}await this._delegate.continue(this._request,e)}_startHandling(){(0,e.assert)(!this._handled,"Route is already handled!"),this._handled=!0}}hu.Route=s;class a extends n.SdkObject{constructor(e,n,r,i,o,s,a){super(e.frame(),"response"),this._request=void 0,this._contentPromise=null,this._finishedPromise=new t.ManualPromise,this._status=void 0,this._statusText=void 0,this._url=void 0,this._headers=void 0,this._headersMap=new Map,this._getResponseBodyCallback=void 0,this._timing=void 0,this._serverAddrPromise=new t.ManualPromise,this._securityDetailsPromise=new t.ManualPromise,this._rawResponseHeadersPromise=void 0,this._httpVersion=void 0,this._request=e,this._timing=o,this._status=n,this._statusText=r,this._url=e.url(),this._headers=i;for(const{name:e,value:t}of this._headers)this._headersMap.set(e.toLowerCase(),t);this._getResponseBodyCallback=s,this._request._setResponse(this),this._httpVersion=a}_serverAddrFinished(e){this._serverAddrPromise.resolve(e)}_securityDetailsFinished(e){this._securityDetailsPromise.resolve(e)}_requestFinished(e){this._request._responseEndTiming=Math.max(e,this._timing.responseStart),this._finishedPromise.resolve()}_setHttpVersion(e){this._httpVersion=e}url(){return this._url}status(){return this._status}statusText(){return this._statusText}headers(){return this._headers}headerValue(e){return this._headersMap.get(e)}async rawResponseHeaders(){return this._rawResponseHeadersPromise||Promise.resolve(this._headers)}setWillReceiveExtraHeaders(){this._request.setWillReceiveExtraHeaders(),this._rawResponseHeadersPromise=new t.ManualPromise}setRawResponseHeaders(e){this._rawResponseHeadersPromise||(this._rawResponseHeadersPromise=new t.ManualPromise),this._rawResponseHeadersPromise.resolve(e)}timing(){return this._timing}async serverAddr(){return await this._serverAddrPromise||null}async securityDetails(){return await this._securityDetailsPromise||null}body(){return this._contentPromise||(this._contentPromise=this._finishedPromise.then((async()=>{if(this._status>=300&&this._status<=399)throw new Error("Response body is unavailable for redirect responses");return this._getResponseBodyCallback()}))),this._contentPromise}request(){return this._request}frame(){return this._request.frame()}httpVersion(){return this._httpVersion?"http/1.1"===this._httpVersion?"HTTP/1.1":"h2"===this._httpVersion?"HTTP/2.0":this._httpVersion:"HTTP/1.1"}async _responseHeadersSize(){if(this._request.responseSize.responseHeadersSize)return this._request.responseSize.responseHeadersSize;let e=4;e+=8,e+=3,e+=this.statusText().length;const t=await this._bestEffortResponseHeaders();for(const n of t)e+=n.name.length+n.value.length+4;return e+=2,e}async _bestEffortResponseHeaders(){return this._rawResponseHeadersPromise?await this._rawResponseHeadersPromise:this._headers}async sizes(){await this._finishedPromise;const e=await this._request.requestHeadersSize(),t=await this._responseHeadersSize();let{encodedBodySize:n}=this._request.responseSize;if(!n){var r;const e=null===(r=(await this._bestEffortResponseHeaders()).find((e=>"content-length"===e.name.toLowerCase())))||void 0===r?void 0:r.value;n=e?+e:0}return{requestBodySize:this._request.bodySize(),requestHeadersSize:e,responseBodySize:n,responseHeadersSize:t}}}hu.Response=a;class l extends n.SdkObject{constructor(e,t){super(e,"ws"),this._url=void 0,this._notified=!1,this._url=t}markAsNotified(){return!this._notified&&(this._notified=!0,!0)}url(){return this._url}frameSent(e,t){this.emit(l.Events.FrameSent,{opcode:e,data:t})}frameReceived(e,t){this.emit(l.Events.FrameReceived,{opcode:e,data:t})}error(e){this.emit(l.Events.SocketError,e)}closed(){this.emit(l.Events.Close)}}hu.WebSocket=l,l.Events={Close:"close",SocketError:"socketerror",FrameReceived:"framereceived",FrameSent:"framesent"};return hu.STATUS_TEXTS={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Switch Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"},hu}pu.ManualPromise=class extends Promise{constructor(){let e,t;super(((n,r)=>{e=n,t=r})),this._resolve=void 0,this._reject=void 0,this._isDone=void 0,this._isDone=!1,this._resolve=e,this._reject=t}isDone(){return this._isDone}resolve(e){this._isDone=!0,this._resolve(e)}reject(e){this._isDone=!0,this._reject(e)}static get[fu](){return Promise}get[mu](){return"ManualPromise"}};var wu={},vu={},bu={};function yu(){this._types=Object.create(null),this._extensions=Object.create(null);for(let e=0;e<arguments.length;e++)this.define(arguments[e]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}yu.prototype.define=function(e,t){for(let n in e){let r=e[n].map((function(e){return e.toLowerCase()}));n=n.toLowerCase();for(let e=0;e<r.length;e++){const i=r[e];if("*"!==i[0]){if(!t&&i in this._types)throw new Error('Attempt to change mapping for "'+i+'" extension from "'+this._types[i]+'" to "'+n+'". Pass `force=true` to allow this, otherwise remove "'+i+'" from the list of extensions for "'+n+'".');this._types[i]=n}}if(t||!this._extensions[n]){const e=r[0];this._extensions[n]="*"!==e[0]?e:e.substr(1)}}},yu.prototype.getType=function(e){let t=(e=String(e)).replace(/^.*[/\\]/,"").toLowerCase(),n=t.replace(/^.*\./,"").toLowerCase(),r=t.length<e.length;return(n.length<t.length-1||!r)&&this._types[n]||null},yu.prototype.getExtension=function(e){return(e=/^\s*([^;\s]*)/.test(e)&&RegExp.$1)&&this._extensions[e.toLowerCase()]||null};var Su=new yu({"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]},{"application/prs.cww":["cww"],"application/vnd.1000minds.decision-model+xml":["1km"],"application/vnd.3gpp.pic-bw-large":["plb"],"application/vnd.3gpp.pic-bw-small":["psb"],"application/vnd.3gpp.pic-bw-var":["pvb"],"application/vnd.3gpp2.tcap":["tcap"],"application/vnd.3m.post-it-notes":["pwn"],"application/vnd.accpac.simply.aso":["aso"],"application/vnd.accpac.simply.imp":["imp"],"application/vnd.acucobol":["acu"],"application/vnd.acucorp":["atc","acutc"],"application/vnd.adobe.air-application-installer-package+zip":["air"],"application/vnd.adobe.formscentral.fcdt":["fcdt"],"application/vnd.adobe.fxp":["fxp","fxpl"],"application/vnd.adobe.xdp+xml":["xdp"],"application/vnd.adobe.xfdf":["xfdf"],"application/vnd.ahead.space":["ahead"],"application/vnd.airzip.filesecure.azf":["azf"],"application/vnd.airzip.filesecure.azs":["azs"],"application/vnd.amazon.ebook":["azw"],"application/vnd.americandynamics.acc":["acc"],"application/vnd.amiga.ami":["ami"],"application/vnd.android.package-archive":["apk"],"application/vnd.anser-web-certificate-issue-initiation":["cii"],"application/vnd.anser-web-funds-transfer-initiation":["fti"],"application/vnd.antix.game-component":["atx"],"application/vnd.apple.installer+xml":["mpkg"],"application/vnd.apple.keynote":["key"],"application/vnd.apple.mpegurl":["m3u8"],"application/vnd.apple.numbers":["numbers"],"application/vnd.apple.pages":["pages"],"application/vnd.apple.pkpass":["pkpass"],"application/vnd.aristanetworks.swi":["swi"],"application/vnd.astraea-software.iota":["iota"],"application/vnd.audiograph":["aep"],"application/vnd.balsamiq.bmml+xml":["bmml"],"application/vnd.blueice.multipass":["mpm"],"application/vnd.bmi":["bmi"],"application/vnd.businessobjects":["rep"],"application/vnd.chemdraw+xml":["cdxml"],"application/vnd.chipnuts.karaoke-mmd":["mmd"],"application/vnd.cinderella":["cdy"],"application/vnd.citationstyles.style+xml":["csl"],"application/vnd.claymore":["cla"],"application/vnd.cloanto.rp9":["rp9"],"application/vnd.clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"application/vnd.cluetrust.cartomobile-config":["c11amc"],"application/vnd.cluetrust.cartomobile-config-pkg":["c11amz"],"application/vnd.commonspace":["csp"],"application/vnd.contact.cmsg":["cdbcmsg"],"application/vnd.cosmocaller":["cmc"],"application/vnd.crick.clicker":["clkx"],"application/vnd.crick.clicker.keyboard":["clkk"],"application/vnd.crick.clicker.palette":["clkp"],"application/vnd.crick.clicker.template":["clkt"],"application/vnd.crick.clicker.wordbank":["clkw"],"application/vnd.criticaltools.wbs+xml":["wbs"],"application/vnd.ctc-posml":["pml"],"application/vnd.cups-ppd":["ppd"],"application/vnd.curl.car":["car"],"application/vnd.curl.pcurl":["pcurl"],"application/vnd.dart":["dart"],"application/vnd.data-vision.rdz":["rdz"],"application/vnd.dbf":["dbf"],"application/vnd.dece.data":["uvf","uvvf","uvd","uvvd"],"application/vnd.dece.ttml+xml":["uvt","uvvt"],"application/vnd.dece.unspecified":["uvx","uvvx"],"application/vnd.dece.zip":["uvz","uvvz"],"application/vnd.denovo.fcselayout-link":["fe_launch"],"application/vnd.dna":["dna"],"application/vnd.dolby.mlp":["mlp"],"application/vnd.dpgraph":["dpg"],"application/vnd.dreamfactory":["dfac"],"application/vnd.ds-keypoint":["kpxx"],"application/vnd.dvb.ait":["ait"],"application/vnd.dvb.service":["svc"],"application/vnd.dynageo":["geo"],"application/vnd.ecowin.chart":["mag"],"application/vnd.enliven":["nml"],"application/vnd.epson.esf":["esf"],"application/vnd.epson.msf":["msf"],"application/vnd.epson.quickanime":["qam"],"application/vnd.epson.salt":["slt"],"application/vnd.epson.ssf":["ssf"],"application/vnd.eszigno3+xml":["es3","et3"],"application/vnd.ezpix-album":["ez2"],"application/vnd.ezpix-package":["ez3"],"application/vnd.fdf":["fdf"],"application/vnd.fdsn.mseed":["mseed"],"application/vnd.fdsn.seed":["seed","dataless"],"application/vnd.flographit":["gph"],"application/vnd.fluxtime.clip":["ftc"],"application/vnd.framemaker":["fm","frame","maker","book"],"application/vnd.frogans.fnc":["fnc"],"application/vnd.frogans.ltf":["ltf"],"application/vnd.fsc.weblaunch":["fsc"],"application/vnd.fujitsu.oasys":["oas"],"application/vnd.fujitsu.oasys2":["oa2"],"application/vnd.fujitsu.oasys3":["oa3"],"application/vnd.fujitsu.oasysgp":["fg5"],"application/vnd.fujitsu.oasysprs":["bh2"],"application/vnd.fujixerox.ddd":["ddd"],"application/vnd.fujixerox.docuworks":["xdw"],"application/vnd.fujixerox.docuworks.binder":["xbd"],"application/vnd.fuzzysheet":["fzs"],"application/vnd.genomatix.tuxedo":["txd"],"application/vnd.geogebra.file":["ggb"],"application/vnd.geogebra.tool":["ggt"],"application/vnd.geometry-explorer":["gex","gre"],"application/vnd.geonext":["gxt"],"application/vnd.geoplan":["g2w"],"application/vnd.geospace":["g3w"],"application/vnd.gmx":["gmx"],"application/vnd.google-apps.document":["gdoc"],"application/vnd.google-apps.presentation":["gslides"],"application/vnd.google-apps.spreadsheet":["gsheet"],"application/vnd.google-earth.kml+xml":["kml"],"application/vnd.google-earth.kmz":["kmz"],"application/vnd.grafeq":["gqf","gqs"],"application/vnd.groove-account":["gac"],"application/vnd.groove-help":["ghf"],"application/vnd.groove-identity-message":["gim"],"application/vnd.groove-injector":["grv"],"application/vnd.groove-tool-message":["gtm"],"application/vnd.groove-tool-template":["tpl"],"application/vnd.groove-vcard":["vcg"],"application/vnd.hal+xml":["hal"],"application/vnd.handheld-entertainment+xml":["zmm"],"application/vnd.hbci":["hbci"],"application/vnd.hhe.lesson-player":["les"],"application/vnd.hp-hpgl":["hpgl"],"application/vnd.hp-hpid":["hpid"],"application/vnd.hp-hps":["hps"],"application/vnd.hp-jlyt":["jlt"],"application/vnd.hp-pcl":["pcl"],"application/vnd.hp-pclxl":["pclxl"],"application/vnd.hydrostatix.sof-data":["sfd-hdstx"],"application/vnd.ibm.minipay":["mpy"],"application/vnd.ibm.modcap":["afp","listafp","list3820"],"application/vnd.ibm.rights-management":["irm"],"application/vnd.ibm.secure-container":["sc"],"application/vnd.iccprofile":["icc","icm"],"application/vnd.igloader":["igl"],"application/vnd.immervision-ivp":["ivp"],"application/vnd.immervision-ivu":["ivu"],"application/vnd.insors.igm":["igm"],"application/vnd.intercon.formnet":["xpw","xpx"],"application/vnd.intergeo":["i2g"],"application/vnd.intu.qbo":["qbo"],"application/vnd.intu.qfx":["qfx"],"application/vnd.ipunplugged.rcprofile":["rcprofile"],"application/vnd.irepository.package+xml":["irp"],"application/vnd.is-xpr":["xpr"],"application/vnd.isac.fcs":["fcs"],"application/vnd.jam":["jam"],"application/vnd.jcp.javame.midlet-rms":["rms"],"application/vnd.jisp":["jisp"],"application/vnd.joost.joda-archive":["joda"],"application/vnd.kahootz":["ktz","ktr"],"application/vnd.kde.karbon":["karbon"],"application/vnd.kde.kchart":["chrt"],"application/vnd.kde.kformula":["kfo"],"application/vnd.kde.kivio":["flw"],"application/vnd.kde.kontour":["kon"],"application/vnd.kde.kpresenter":["kpr","kpt"],"application/vnd.kde.kspread":["ksp"],"application/vnd.kde.kword":["kwd","kwt"],"application/vnd.kenameaapp":["htke"],"application/vnd.kidspiration":["kia"],"application/vnd.kinar":["kne","knp"],"application/vnd.koan":["skp","skd","skt","skm"],"application/vnd.kodak-descriptor":["sse"],"application/vnd.las.las+xml":["lasxml"],"application/vnd.llamagraphics.life-balance.desktop":["lbd"],"application/vnd.llamagraphics.life-balance.exchange+xml":["lbe"],"application/vnd.lotus-1-2-3":["123"],"application/vnd.lotus-approach":["apr"],"application/vnd.lotus-freelance":["pre"],"application/vnd.lotus-notes":["nsf"],"application/vnd.lotus-organizer":["org"],"application/vnd.lotus-screencam":["scm"],"application/vnd.lotus-wordpro":["lwp"],"application/vnd.macports.portpkg":["portpkg"],"application/vnd.mapbox-vector-tile":["mvt"],"application/vnd.mcd":["mcd"],"application/vnd.medcalcdata":["mc1"],"application/vnd.mediastation.cdkey":["cdkey"],"application/vnd.mfer":["mwf"],"application/vnd.mfmp":["mfm"],"application/vnd.micrografx.flo":["flo"],"application/vnd.micrografx.igx":["igx"],"application/vnd.mif":["mif"],"application/vnd.mobius.daf":["daf"],"application/vnd.mobius.dis":["dis"],"application/vnd.mobius.mbk":["mbk"],"application/vnd.mobius.mqy":["mqy"],"application/vnd.mobius.msl":["msl"],"application/vnd.mobius.plc":["plc"],"application/vnd.mobius.txf":["txf"],"application/vnd.mophun.application":["mpn"],"application/vnd.mophun.certificate":["mpc"],"application/vnd.mozilla.xul+xml":["xul"],"application/vnd.ms-artgalry":["cil"],"application/vnd.ms-cab-compressed":["cab"],"application/vnd.ms-excel":["xls","xlm","xla","xlc","xlt","xlw"],"application/vnd.ms-excel.addin.macroenabled.12":["xlam"],"application/vnd.ms-excel.sheet.binary.macroenabled.12":["xlsb"],"application/vnd.ms-excel.sheet.macroenabled.12":["xlsm"],"application/vnd.ms-excel.template.macroenabled.12":["xltm"],"application/vnd.ms-fontobject":["eot"],"application/vnd.ms-htmlhelp":["chm"],"application/vnd.ms-ims":["ims"],"application/vnd.ms-lrm":["lrm"],"application/vnd.ms-officetheme":["thmx"],"application/vnd.ms-outlook":["msg"],"application/vnd.ms-pki.seccat":["cat"],"application/vnd.ms-pki.stl":["*stl"],"application/vnd.ms-powerpoint":["ppt","pps","pot"],"application/vnd.ms-powerpoint.addin.macroenabled.12":["ppam"],"application/vnd.ms-powerpoint.presentation.macroenabled.12":["pptm"],"application/vnd.ms-powerpoint.slide.macroenabled.12":["sldm"],"application/vnd.ms-powerpoint.slideshow.macroenabled.12":["ppsm"],"application/vnd.ms-powerpoint.template.macroenabled.12":["potm"],"application/vnd.ms-project":["mpp","mpt"],"application/vnd.ms-word.document.macroenabled.12":["docm"],"application/vnd.ms-word.template.macroenabled.12":["dotm"],"application/vnd.ms-works":["wps","wks","wcm","wdb"],"application/vnd.ms-wpl":["wpl"],"application/vnd.ms-xpsdocument":["xps"],"application/vnd.mseq":["mseq"],"application/vnd.musician":["mus"],"application/vnd.muvee.style":["msty"],"application/vnd.mynfc":["taglet"],"application/vnd.neurolanguage.nlu":["nlu"],"application/vnd.nitf":["ntf","nitf"],"application/vnd.noblenet-directory":["nnd"],"application/vnd.noblenet-sealer":["nns"],"application/vnd.noblenet-web":["nnw"],"application/vnd.nokia.n-gage.ac+xml":["*ac"],"application/vnd.nokia.n-gage.data":["ngdat"],"application/vnd.nokia.n-gage.symbian.install":["n-gage"],"application/vnd.nokia.radio-preset":["rpst"],"application/vnd.nokia.radio-presets":["rpss"],"application/vnd.novadigm.edm":["edm"],"application/vnd.novadigm.edx":["edx"],"application/vnd.novadigm.ext":["ext"],"application/vnd.oasis.opendocument.chart":["odc"],"application/vnd.oasis.opendocument.chart-template":["otc"],"application/vnd.oasis.opendocument.database":["odb"],"application/vnd.oasis.opendocument.formula":["odf"],"application/vnd.oasis.opendocument.formula-template":["odft"],"application/vnd.oasis.opendocument.graphics":["odg"],"application/vnd.oasis.opendocument.graphics-template":["otg"],"application/vnd.oasis.opendocument.image":["odi"],"application/vnd.oasis.opendocument.image-template":["oti"],"application/vnd.oasis.opendocument.presentation":["odp"],"application/vnd.oasis.opendocument.presentation-template":["otp"],"application/vnd.oasis.opendocument.spreadsheet":["ods"],"application/vnd.oasis.opendocument.spreadsheet-template":["ots"],"application/vnd.oasis.opendocument.text":["odt"],"application/vnd.oasis.opendocument.text-master":["odm"],"application/vnd.oasis.opendocument.text-template":["ott"],"application/vnd.oasis.opendocument.text-web":["oth"],"application/vnd.olpc-sugar":["xo"],"application/vnd.oma.dd2+xml":["dd2"],"application/vnd.openblox.game+xml":["obgx"],"application/vnd.openofficeorg.extension":["oxt"],"application/vnd.openstreetmap.data+xml":["osm"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/vnd.openxmlformats-officedocument.presentationml.slide":["sldx"],"application/vnd.openxmlformats-officedocument.presentationml.slideshow":["ppsx"],"application/vnd.openxmlformats-officedocument.presentationml.template":["potx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.template":["xltx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.template":["dotx"],"application/vnd.osgeo.mapguide.package":["mgp"],"application/vnd.osgi.dp":["dp"],"application/vnd.osgi.subsystem":["esa"],"application/vnd.palm":["pdb","pqa","oprc"],"application/vnd.pawaafile":["paw"],"application/vnd.pg.format":["str"],"application/vnd.pg.osasli":["ei6"],"application/vnd.picsel":["efif"],"application/vnd.pmi.widget":["wg"],"application/vnd.pocketlearn":["plf"],"application/vnd.powerbuilder6":["pbd"],"application/vnd.previewsystems.box":["box"],"application/vnd.proteus.magazine":["mgz"],"application/vnd.publishare-delta-tree":["qps"],"application/vnd.pvi.ptid1":["ptid"],"application/vnd.quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"application/vnd.rar":["rar"],"application/vnd.realvnc.bed":["bed"],"application/vnd.recordare.musicxml":["mxl"],"application/vnd.recordare.musicxml+xml":["musicxml"],"application/vnd.rig.cryptonote":["cryptonote"],"application/vnd.rim.cod":["cod"],"application/vnd.rn-realmedia":["rm"],"application/vnd.rn-realmedia-vbr":["rmvb"],"application/vnd.route66.link66+xml":["link66"],"application/vnd.sailingtracker.track":["st"],"application/vnd.seemail":["see"],"application/vnd.sema":["sema"],"application/vnd.semd":["semd"],"application/vnd.semf":["semf"],"application/vnd.shana.informed.formdata":["ifm"],"application/vnd.shana.informed.formtemplate":["itp"],"application/vnd.shana.informed.interchange":["iif"],"application/vnd.shana.informed.package":["ipk"],"application/vnd.simtech-mindmapper":["twd","twds"],"application/vnd.smaf":["mmf"],"application/vnd.smart.teacher":["teacher"],"application/vnd.software602.filler.form+xml":["fo"],"application/vnd.solent.sdkm+xml":["sdkm","sdkd"],"application/vnd.spotfire.dxp":["dxp"],"application/vnd.spotfire.sfs":["sfs"],"application/vnd.stardivision.calc":["sdc"],"application/vnd.stardivision.draw":["sda"],"application/vnd.stardivision.impress":["sdd"],"application/vnd.stardivision.math":["smf"],"application/vnd.stardivision.writer":["sdw","vor"],"application/vnd.stardivision.writer-global":["sgl"],"application/vnd.stepmania.package":["smzip"],"application/vnd.stepmania.stepchart":["sm"],"application/vnd.sun.wadl+xml":["wadl"],"application/vnd.sun.xml.calc":["sxc"],"application/vnd.sun.xml.calc.template":["stc"],"application/vnd.sun.xml.draw":["sxd"],"application/vnd.sun.xml.draw.template":["std"],"application/vnd.sun.xml.impress":["sxi"],"application/vnd.sun.xml.impress.template":["sti"],"application/vnd.sun.xml.math":["sxm"],"application/vnd.sun.xml.writer":["sxw"],"application/vnd.sun.xml.writer.global":["sxg"],"application/vnd.sun.xml.writer.template":["stw"],"application/vnd.sus-calendar":["sus","susp"],"application/vnd.svd":["svd"],"application/vnd.symbian.install":["sis","sisx"],"application/vnd.syncml+xml":["xsm"],"application/vnd.syncml.dm+wbxml":["bdm"],"application/vnd.syncml.dm+xml":["xdm"],"application/vnd.syncml.dmddf+xml":["ddf"],"application/vnd.tao.intent-module-archive":["tao"],"application/vnd.tcpdump.pcap":["pcap","cap","dmp"],"application/vnd.tmobile-livetv":["tmo"],"application/vnd.trid.tpt":["tpt"],"application/vnd.triscape.mxs":["mxs"],"application/vnd.trueapp":["tra"],"application/vnd.ufdl":["ufd","ufdl"],"application/vnd.uiq.theme":["utz"],"application/vnd.umajin":["umj"],"application/vnd.unity":["unityweb"],"application/vnd.uoml+xml":["uoml"],"application/vnd.vcx":["vcx"],"application/vnd.visio":["vsd","vst","vss","vsw"],"application/vnd.visionary":["vis"],"application/vnd.vsf":["vsf"],"application/vnd.wap.wbxml":["wbxml"],"application/vnd.wap.wmlc":["wmlc"],"application/vnd.wap.wmlscriptc":["wmlsc"],"application/vnd.webturbo":["wtb"],"application/vnd.wolfram.player":["nbp"],"application/vnd.wordperfect":["wpd"],"application/vnd.wqd":["wqd"],"application/vnd.wt.stf":["stf"],"application/vnd.xara":["xar"],"application/vnd.xfdl":["xfdl"],"application/vnd.yamaha.hv-dic":["hvd"],"application/vnd.yamaha.hv-script":["hvs"],"application/vnd.yamaha.hv-voice":["hvp"],"application/vnd.yamaha.openscoreformat":["osf"],"application/vnd.yamaha.openscoreformat.osfpvg+xml":["osfpvg"],"application/vnd.yamaha.smaf-audio":["saf"],"application/vnd.yamaha.smaf-phrase":["spf"],"application/vnd.yellowriver-custom-menu":["cmp"],"application/vnd.zul":["zir","zirz"],"application/vnd.zzazz.deck+xml":["zaz"],"application/x-7z-compressed":["7z"],"application/x-abiword":["abw"],"application/x-ace-compressed":["ace"],"application/x-apple-diskimage":["*dmg"],"application/x-arj":["arj"],"application/x-authorware-bin":["aab","x32","u32","vox"],"application/x-authorware-map":["aam"],"application/x-authorware-seg":["aas"],"application/x-bcpio":["bcpio"],"application/x-bdoc":["*bdoc"],"application/x-bittorrent":["torrent"],"application/x-blorb":["blb","blorb"],"application/x-bzip":["bz"],"application/x-bzip2":["bz2","boz"],"application/x-cbr":["cbr","cba","cbt","cbz","cb7"],"application/x-cdlink":["vcd"],"application/x-cfs-compressed":["cfs"],"application/x-chat":["chat"],"application/x-chess-pgn":["pgn"],"application/x-chrome-extension":["crx"],"application/x-cocoa":["cco"],"application/x-conference":["nsc"],"application/x-cpio":["cpio"],"application/x-csh":["csh"],"application/x-debian-package":["*deb","udeb"],"application/x-dgc-compressed":["dgc"],"application/x-director":["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"],"application/x-doom":["wad"],"application/x-dtbncx+xml":["ncx"],"application/x-dtbook+xml":["dtb"],"application/x-dtbresource+xml":["res"],"application/x-dvi":["dvi"],"application/x-envoy":["evy"],"application/x-eva":["eva"],"application/x-font-bdf":["bdf"],"application/x-font-ghostscript":["gsf"],"application/x-font-linux-psf":["psf"],"application/x-font-pcf":["pcf"],"application/x-font-snf":["snf"],"application/x-font-type1":["pfa","pfb","pfm","afm"],"application/x-freearc":["arc"],"application/x-futuresplash":["spl"],"application/x-gca-compressed":["gca"],"application/x-glulx":["ulx"],"application/x-gnumeric":["gnumeric"],"application/x-gramps-xml":["gramps"],"application/x-gtar":["gtar"],"application/x-hdf":["hdf"],"application/x-httpd-php":["php"],"application/x-install-instructions":["install"],"application/x-iso9660-image":["*iso"],"application/x-iwork-keynote-sffkey":["*key"],"application/x-iwork-numbers-sffnumbers":["*numbers"],"application/x-iwork-pages-sffpages":["*pages"],"application/x-java-archive-diff":["jardiff"],"application/x-java-jnlp-file":["jnlp"],"application/x-keepass2":["kdbx"],"application/x-latex":["latex"],"application/x-lua-bytecode":["luac"],"application/x-lzh-compressed":["lzh","lha"],"application/x-makeself":["run"],"application/x-mie":["mie"],"application/x-mobipocket-ebook":["prc","mobi"],"application/x-ms-application":["application"],"application/x-ms-shortcut":["lnk"],"application/x-ms-wmd":["wmd"],"application/x-ms-wmz":["wmz"],"application/x-ms-xbap":["xbap"],"application/x-msaccess":["mdb"],"application/x-msbinder":["obd"],"application/x-mscardfile":["crd"],"application/x-msclip":["clp"],"application/x-msdos-program":["*exe"],"application/x-msdownload":["*exe","*dll","com","bat","*msi"],"application/x-msmediaview":["mvb","m13","m14"],"application/x-msmetafile":["*wmf","*wmz","*emf","emz"],"application/x-msmoney":["mny"],"application/x-mspublisher":["pub"],"application/x-msschedule":["scd"],"application/x-msterminal":["trm"],"application/x-mswrite":["wri"],"application/x-netcdf":["nc","cdf"],"application/x-ns-proxy-autoconfig":["pac"],"application/x-nzb":["nzb"],"application/x-perl":["pl","pm"],"application/x-pilot":["*prc","*pdb"],"application/x-pkcs12":["p12","pfx"],"application/x-pkcs7-certificates":["p7b","spc"],"application/x-pkcs7-certreqresp":["p7r"],"application/x-rar-compressed":["*rar"],"application/x-redhat-package-manager":["rpm"],"application/x-research-info-systems":["ris"],"application/x-sea":["sea"],"application/x-sh":["sh"],"application/x-shar":["shar"],"application/x-shockwave-flash":["swf"],"application/x-silverlight-app":["xap"],"application/x-sql":["sql"],"application/x-stuffit":["sit"],"application/x-stuffitx":["sitx"],"application/x-subrip":["srt"],"application/x-sv4cpio":["sv4cpio"],"application/x-sv4crc":["sv4crc"],"application/x-t3vm-image":["t3"],"application/x-tads":["gam"],"application/x-tar":["tar"],"application/x-tcl":["tcl","tk"],"application/x-tex":["tex"],"application/x-tex-tfm":["tfm"],"application/x-texinfo":["texinfo","texi"],"application/x-tgif":["*obj"],"application/x-ustar":["ustar"],"application/x-virtualbox-hdd":["hdd"],"application/x-virtualbox-ova":["ova"],"application/x-virtualbox-ovf":["ovf"],"application/x-virtualbox-vbox":["vbox"],"application/x-virtualbox-vbox-extpack":["vbox-extpack"],"application/x-virtualbox-vdi":["vdi"],"application/x-virtualbox-vhd":["vhd"],"application/x-virtualbox-vmdk":["vmdk"],"application/x-wais-source":["src"],"application/x-web-app-manifest+json":["webapp"],"application/x-x509-ca-cert":["der","crt","pem"],"application/x-xfig":["fig"],"application/x-xliff+xml":["*xlf"],"application/x-xpinstall":["xpi"],"application/x-xz":["xz"],"application/x-zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"audio/vnd.dece.audio":["uva","uvva"],"audio/vnd.digital-winds":["eol"],"audio/vnd.dra":["dra"],"audio/vnd.dts":["dts"],"audio/vnd.dts.hd":["dtshd"],"audio/vnd.lucent.voice":["lvp"],"audio/vnd.ms-playready.media.pya":["pya"],"audio/vnd.nuera.ecelp4800":["ecelp4800"],"audio/vnd.nuera.ecelp7470":["ecelp7470"],"audio/vnd.nuera.ecelp9600":["ecelp9600"],"audio/vnd.rip":["rip"],"audio/x-aac":["aac"],"audio/x-aiff":["aif","aiff","aifc"],"audio/x-caf":["caf"],"audio/x-flac":["flac"],"audio/x-m4a":["*m4a"],"audio/x-matroska":["mka"],"audio/x-mpegurl":["m3u"],"audio/x-ms-wax":["wax"],"audio/x-ms-wma":["wma"],"audio/x-pn-realaudio":["ram","ra"],"audio/x-pn-realaudio-plugin":["rmp"],"audio/x-realaudio":["*ra"],"audio/x-wav":["*wav"],"chemical/x-cdx":["cdx"],"chemical/x-cif":["cif"],"chemical/x-cmdf":["cmdf"],"chemical/x-cml":["cml"],"chemical/x-csml":["csml"],"chemical/x-xyz":["xyz"],"image/prs.btif":["btif"],"image/prs.pti":["pti"],"image/vnd.adobe.photoshop":["psd"],"image/vnd.airzip.accelerator.azv":["azv"],"image/vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"image/vnd.djvu":["djvu","djv"],"image/vnd.dvb.subtitle":["*sub"],"image/vnd.dwg":["dwg"],"image/vnd.dxf":["dxf"],"image/vnd.fastbidsheet":["fbs"],"image/vnd.fpx":["fpx"],"image/vnd.fst":["fst"],"image/vnd.fujixerox.edmics-mmr":["mmr"],"image/vnd.fujixerox.edmics-rlc":["rlc"],"image/vnd.microsoft.icon":["ico"],"image/vnd.ms-dds":["dds"],"image/vnd.ms-modi":["mdi"],"image/vnd.ms-photo":["wdp"],"image/vnd.net-fpx":["npx"],"image/vnd.pco.b16":["b16"],"image/vnd.tencent.tap":["tap"],"image/vnd.valve.source.texture":["vtf"],"image/vnd.wap.wbmp":["wbmp"],"image/vnd.xiff":["xif"],"image/vnd.zbrush.pcx":["pcx"],"image/x-3ds":["3ds"],"image/x-cmu-raster":["ras"],"image/x-cmx":["cmx"],"image/x-freehand":["fh","fhc","fh4","fh5","fh7"],"image/x-icon":["*ico"],"image/x-jng":["jng"],"image/x-mrsid-image":["sid"],"image/x-ms-bmp":["*bmp"],"image/x-pcx":["*pcx"],"image/x-pict":["pic","pct"],"image/x-portable-anymap":["pnm"],"image/x-portable-bitmap":["pbm"],"image/x-portable-graymap":["pgm"],"image/x-portable-pixmap":["ppm"],"image/x-rgb":["rgb"],"image/x-tga":["tga"],"image/x-xbitmap":["xbm"],"image/x-xpixmap":["xpm"],"image/x-xwindowdump":["xwd"],"message/vnd.wfa.wsc":["wsc"],"model/vnd.collada+xml":["dae"],"model/vnd.dwf":["dwf"],"model/vnd.gdl":["gdl"],"model/vnd.gtw":["gtw"],"model/vnd.mts":["mts"],"model/vnd.opengex":["ogex"],"model/vnd.parasolid.transmit.binary":["x_b"],"model/vnd.parasolid.transmit.text":["x_t"],"model/vnd.sap.vds":["vds"],"model/vnd.usdz+zip":["usdz"],"model/vnd.valve.source.compiled-map":["bsp"],"model/vnd.vtu":["vtu"],"text/prs.lines.tag":["dsc"],"text/vnd.curl":["curl"],"text/vnd.curl.dcurl":["dcurl"],"text/vnd.curl.mcurl":["mcurl"],"text/vnd.curl.scurl":["scurl"],"text/vnd.dvb.subtitle":["sub"],"text/vnd.fly":["fly"],"text/vnd.fmi.flexstor":["flx"],"text/vnd.graphviz":["gv"],"text/vnd.in3d.3dml":["3dml"],"text/vnd.in3d.spot":["spot"],"text/vnd.sun.j2me.app-descriptor":["jad"],"text/vnd.wap.wml":["wml"],"text/vnd.wap.wmlscript":["wmls"],"text/x-asm":["s","asm"],"text/x-c":["c","cc","cxx","cpp","h","hh","dic"],"text/x-component":["htc"],"text/x-fortran":["f","for","f77","f90"],"text/x-handlebars-template":["hbs"],"text/x-java-source":["java"],"text/x-lua":["lua"],"text/x-markdown":["mkd"],"text/x-nfo":["nfo"],"text/x-opml":["opml"],"text/x-org":["*org"],"text/x-pascal":["p","pas"],"text/x-processing":["pde"],"text/x-sass":["sass"],"text/x-scss":["scss"],"text/x-setext":["etx"],"text/x-sfv":["sfv"],"text/x-suse-ymp":["ymp"],"text/x-uuencode":["uu"],"text/x-vcalendar":["vcs"],"text/x-vcard":["vcf"],"video/vnd.dece.hd":["uvh","uvvh"],"video/vnd.dece.mobile":["uvm","uvvm"],"video/vnd.dece.pd":["uvp","uvvp"],"video/vnd.dece.sd":["uvs","uvvs"],"video/vnd.dece.video":["uvv","uvvv"],"video/vnd.dvb.file":["dvb"],"video/vnd.fvt":["fvt"],"video/vnd.mpegurl":["mxu","m4u"],"video/vnd.ms-playready.media.pyv":["pyv"],"video/vnd.uvvu.mp4":["uvu","uvvu"],"video/vnd.vivo":["viv"],"video/x-f4v":["f4v"],"video/x-fli":["fli"],"video/x-flv":["flv"],"video/x-m4v":["m4v"],"video/x-matroska":["mkv","mk3d","mks"],"video/x-mng":["mng"],"video/x-ms-asf":["asf","asx"],"video/x-ms-vob":["vob"],"video/x-ms-wm":["wm"],"video/x-ms-wmv":["wmv"],"video/x-ms-wmx":["wmx"],"video/x-ms-wvx":["wvx"],"video/x-msvideo":["avi"],"video/x-sgi-movie":["movie"],"video/x-smv":["smv"],"x-conference/x-cooltalk":["ice"]}),xu={};Object.defineProperty(xu,"__esModule",{value:!0}),xu.source=void 0;xu.source='var __create = Object.create;\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __getProtoOf = Object.getPrototypeOf;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __commonJS = (cb, mod) => function __require() {\n  return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;\n};\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === "object" || typeof from === "function") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target, mod));\nvar __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);\n\n// packages/playwright-core/src/server/isomorphic/cssTokenizer.js\nvar require_cssTokenizer = __commonJS({\n  "packages/playwright-core/src/server/isomorphic/cssTokenizer.js"(exports) {\n    (function(root, factory) {\n      if (typeof define === "function" && define.amd) {\n        define(["exports"], factory);\n      } else if (typeof exports !== "undefined") {\n        factory(exports);\n      } else {\n        factory(root);\n      }\n    })(exports, function(exports2) {\n      var between = function(num, first, last) {\n        return num >= first && num <= last;\n      };\n      function digit(code) {\n        return between(code, 48, 57);\n      }\n      function hexdigit(code) {\n        return digit(code) || between(code, 65, 70) || between(code, 97, 102);\n      }\n      function uppercaseletter(code) {\n        return between(code, 65, 90);\n      }\n      function lowercaseletter(code) {\n        return between(code, 97, 122);\n      }\n      function letter(code) {\n        return uppercaseletter(code) || lowercaseletter(code);\n      }\n      function nonascii(code) {\n        return code >= 128;\n      }\n      function namestartchar(code) {\n        return letter(code) || nonascii(code) || code == 95;\n      }\n      function namechar(code) {\n        return namestartchar(code) || digit(code) || code == 45;\n      }\n      function nonprintable(code) {\n        return between(code, 0, 8) || code == 11 || between(code, 14, 31) || code == 127;\n      }\n      function newline(code) {\n        return code == 10;\n      }\n      function whitespace(code) {\n        return newline(code) || code == 9 || code == 32;\n      }\n      function badescape(code) {\n        return newline(code) || isNaN(code);\n      }\n      var maximumallowedcodepoint = 1114111;\n      var InvalidCharacterError = function(message) {\n        this.message = message;\n      };\n      InvalidCharacterError.prototype = new Error();\n      InvalidCharacterError.prototype.name = "InvalidCharacterError";\n      function preprocess(str) {\n        var codepoints = [];\n        for (var i = 0; i < str.length; i++) {\n          var code = str.charCodeAt(i);\n          if (code == 13 && str.charCodeAt(i + 1) == 10) {\n            code = 10;\n            i++;\n          }\n          if (code == 13 || code == 12)\n            code = 10;\n          if (code == 0)\n            code = 65533;\n          if (between(code, 55296, 56319) && between(str.charCodeAt(i + 1), 56320, 57343)) {\n            var lead = code - 55296;\n            var trail = str.charCodeAt(i + 1) - 56320;\n            code = Math.pow(2, 16) + lead * Math.pow(2, 10) + trail;\n            i++;\n          }\n          codepoints.push(code);\n        }\n        return codepoints;\n      }\n      function stringFromCode(code) {\n        if (code <= 65535)\n          return String.fromCharCode(code);\n        code -= Math.pow(2, 16);\n        var lead = Math.floor(code / Math.pow(2, 10)) + 55296;\n        var trail = code % Math.pow(2, 10) + 56320;\n        return String.fromCharCode(lead) + String.fromCharCode(trail);\n      }\n      function tokenize2(str) {\n        str = preprocess(str);\n        var i = -1;\n        var tokens = [];\n        var code;\n        var line = 0;\n        var column = 0;\n        var lastLineLength = 0;\n        var incrLineno = function() {\n          line += 1;\n          lastLineLength = column;\n          column = 0;\n        };\n        var locStart = { line, column };\n        var codepoint = function(i2) {\n          if (i2 >= str.length) {\n            return -1;\n          }\n          return str[i2];\n        };\n        var next = function(num) {\n          if (num === void 0)\n            num = 1;\n          if (num > 3)\n            throw "Spec Error: no more than three codepoints of lookahead.";\n          return codepoint(i + num);\n        };\n        var consume = function(num) {\n          if (num === void 0)\n            num = 1;\n          i += num;\n          code = codepoint(i);\n          if (newline(code))\n            incrLineno();\n          else\n            column += num;\n          return true;\n        };\n        var reconsume = function() {\n          i -= 1;\n          if (newline(code)) {\n            line -= 1;\n            column = lastLineLength;\n          } else {\n            column -= 1;\n          }\n          locStart.line = line;\n          locStart.column = column;\n          return true;\n        };\n        var eof = function(codepoint2) {\n          if (codepoint2 === void 0)\n            codepoint2 = code;\n          return codepoint2 == -1;\n        };\n        var donothing = function() {\n        };\n        var parseerror = function() {\n          console.log("Parse error at index " + i + ", processing codepoint 0x" + code.toString(16) + ".");\n          return true;\n        };\n        var consumeAToken = function() {\n          consumeComments();\n          consume();\n          if (whitespace(code)) {\n            while (whitespace(next()))\n              consume();\n            return new WhitespaceToken2();\n          } else if (code == 34)\n            return consumeAStringToken();\n          else if (code == 35) {\n            if (namechar(next()) || areAValidEscape(next(1), next(2))) {\n              var token = new HashToken2();\n              if (wouldStartAnIdentifier(next(1), next(2), next(3)))\n                token.type = "id";\n              token.value = consumeAName();\n              return token;\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 36) {\n            if (next() == 61) {\n              consume();\n              return new SuffixMatchToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 39)\n            return consumeAStringToken();\n          else if (code == 40)\n            return new OpenParenToken();\n          else if (code == 41)\n            return new CloseParenToken2();\n          else if (code == 42) {\n            if (next() == 61) {\n              consume();\n              return new SubstringMatchToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 43) {\n            if (startsWithANumber()) {\n              reconsume();\n              return consumeANumericToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 44)\n            return new CommaToken2();\n          else if (code == 45) {\n            if (startsWithANumber()) {\n              reconsume();\n              return consumeANumericToken();\n            } else if (next(1) == 45 && next(2) == 62) {\n              consume(2);\n              return new CDCToken2();\n            } else if (startsWithAnIdentifier()) {\n              reconsume();\n              return consumeAnIdentlikeToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 46) {\n            if (startsWithANumber()) {\n              reconsume();\n              return consumeANumericToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 58)\n            return new ColonToken2();\n          else if (code == 59)\n            return new SemicolonToken2();\n          else if (code == 60) {\n            if (next(1) == 33 && next(2) == 45 && next(3) == 45) {\n              consume(3);\n              return new CDOToken2();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 64) {\n            if (wouldStartAnIdentifier(next(1), next(2), next(3))) {\n              return new AtKeywordToken2(consumeAName());\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 91)\n            return new OpenSquareToken2();\n          else if (code == 92) {\n            if (startsWithAValidEscape()) {\n              reconsume();\n              return consumeAnIdentlikeToken();\n            } else {\n              parseerror();\n              return new DelimToken2(code);\n            }\n          } else if (code == 93)\n            return new CloseSquareToken2();\n          else if (code == 94) {\n            if (next() == 61) {\n              consume();\n              return new PrefixMatchToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 123)\n            return new OpenCurlyToken2();\n          else if (code == 124) {\n            if (next() == 61) {\n              consume();\n              return new DashMatchToken();\n            } else if (next() == 124) {\n              consume();\n              return new ColumnToken2();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 125)\n            return new CloseCurlyToken2();\n          else if (code == 126) {\n            if (next() == 61) {\n              consume();\n              return new IncludeMatchToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (digit(code)) {\n            reconsume();\n            return consumeANumericToken();\n          } else if (namestartchar(code)) {\n            reconsume();\n            return consumeAnIdentlikeToken();\n          } else if (eof())\n            return new EOFToken2();\n          else\n            return new DelimToken2(code);\n        };\n        var consumeComments = function() {\n          while (next(1) == 47 && next(2) == 42) {\n            consume(2);\n            while (true) {\n              consume();\n              if (code == 42 && next() == 47) {\n                consume();\n                break;\n              } else if (eof()) {\n                parseerror();\n                return;\n              }\n            }\n          }\n        };\n        var consumeANumericToken = function() {\n          var num = consumeANumber();\n          if (wouldStartAnIdentifier(next(1), next(2), next(3))) {\n            var token = new DimensionToken();\n            token.value = num.value;\n            token.repr = num.repr;\n            token.type = num.type;\n            token.unit = consumeAName();\n            return token;\n          } else if (next() == 37) {\n            consume();\n            var token = new PercentageToken2();\n            token.value = num.value;\n            token.repr = num.repr;\n            return token;\n          } else {\n            var token = new NumberToken2();\n            token.value = num.value;\n            token.repr = num.repr;\n            token.type = num.type;\n            return token;\n          }\n        };\n        var consumeAnIdentlikeToken = function() {\n          var str2 = consumeAName();\n          if (str2.toLowerCase() == "url" && next() == 40) {\n            consume();\n            while (whitespace(next(1)) && whitespace(next(2)))\n              consume();\n            if (next() == 34 || next() == 39) {\n              return new FunctionToken2(str2);\n            } else if (whitespace(next()) && (next(2) == 34 || next(2) == 39)) {\n              return new FunctionToken2(str2);\n            } else {\n              return consumeAURLToken();\n            }\n          } else if (next() == 40) {\n            consume();\n            return new FunctionToken2(str2);\n          } else {\n            return new IdentToken2(str2);\n          }\n        };\n        var consumeAStringToken = function(endingCodePoint) {\n          if (endingCodePoint === void 0)\n            endingCodePoint = code;\n          var string = "";\n          while (consume()) {\n            if (code == endingCodePoint || eof()) {\n              return new StringToken2(string);\n            } else if (newline(code)) {\n              parseerror();\n              reconsume();\n              return new BadStringToken2();\n            } else if (code == 92) {\n              if (eof(next())) {\n                donothing();\n              } else if (newline(next())) {\n                consume();\n              } else {\n                string += stringFromCode(consumeEscape());\n              }\n            } else {\n              string += stringFromCode(code);\n            }\n          }\n        };\n        var consumeAURLToken = function() {\n          var token = new URLToken2("");\n          while (whitespace(next()))\n            consume();\n          if (eof(next()))\n            return token;\n          while (consume()) {\n            if (code == 41 || eof()) {\n              return token;\n            } else if (whitespace(code)) {\n              while (whitespace(next()))\n                consume();\n              if (next() == 41 || eof(next())) {\n                consume();\n                return token;\n              } else {\n                consumeTheRemnantsOfABadURL();\n                return new BadURLToken2();\n              }\n            } else if (code == 34 || code == 39 || code == 40 || nonprintable(code)) {\n              parseerror();\n              consumeTheRemnantsOfABadURL();\n              return new BadURLToken2();\n            } else if (code == 92) {\n              if (startsWithAValidEscape()) {\n                token.value += stringFromCode(consumeEscape());\n              } else {\n                parseerror();\n                consumeTheRemnantsOfABadURL();\n                return new BadURLToken2();\n              }\n            } else {\n              token.value += stringFromCode(code);\n            }\n          }\n        };\n        var consumeEscape = function() {\n          consume();\n          if (hexdigit(code)) {\n            var digits = [code];\n            for (var total = 0; total < 5; total++) {\n              if (hexdigit(next())) {\n                consume();\n                digits.push(code);\n              } else {\n                break;\n              }\n            }\n            if (whitespace(next()))\n              consume();\n            var value = parseInt(digits.map(function(x) {\n              return String.fromCharCode(x);\n            }).join(""), 16);\n            if (value > maximumallowedcodepoint)\n              value = 65533;\n            return value;\n          } else if (eof()) {\n            return 65533;\n          } else {\n            return code;\n          }\n        };\n        var areAValidEscape = function(c1, c2) {\n          if (c1 != 92)\n            return false;\n          if (newline(c2))\n            return false;\n          return true;\n        };\n        var startsWithAValidEscape = function() {\n          return areAValidEscape(code, next());\n        };\n        var wouldStartAnIdentifier = function(c1, c2, c3) {\n          if (c1 == 45) {\n            return namestartchar(c2) || c2 == 45 || areAValidEscape(c2, c3);\n          } else if (namestartchar(c1)) {\n            return true;\n          } else if (c1 == 92) {\n            return areAValidEscape(c1, c2);\n          } else {\n            return false;\n          }\n        };\n        var startsWithAnIdentifier = function() {\n          return wouldStartAnIdentifier(code, next(1), next(2));\n        };\n        var wouldStartANumber = function(c1, c2, c3) {\n          if (c1 == 43 || c1 == 45) {\n            if (digit(c2))\n              return true;\n            if (c2 == 46 && digit(c3))\n              return true;\n            return false;\n          } else if (c1 == 46) {\n            if (digit(c2))\n              return true;\n            return false;\n          } else if (digit(c1)) {\n            return true;\n          } else {\n            return false;\n          }\n        };\n        var startsWithANumber = function() {\n          return wouldStartANumber(code, next(1), next(2));\n        };\n        var consumeAName = function() {\n          var result = "";\n          while (consume()) {\n            if (namechar(code)) {\n              result += stringFromCode(code);\n            } else if (startsWithAValidEscape()) {\n              result += stringFromCode(consumeEscape());\n            } else {\n              reconsume();\n              return result;\n            }\n          }\n        };\n        var consumeANumber = function() {\n          var repr = [];\n          var type = "integer";\n          if (next() == 43 || next() == 45) {\n            consume();\n            repr += stringFromCode(code);\n          }\n          while (digit(next())) {\n            consume();\n            repr += stringFromCode(code);\n          }\n          if (next(1) == 46 && digit(next(2))) {\n            consume();\n            repr += stringFromCode(code);\n            consume();\n            repr += stringFromCode(code);\n            type = "number";\n            while (digit(next())) {\n              consume();\n              repr += stringFromCode(code);\n            }\n          }\n          var c1 = next(1), c2 = next(2), c3 = next(3);\n          if ((c1 == 69 || c1 == 101) && digit(c2)) {\n            consume();\n            repr += stringFromCode(code);\n            consume();\n            repr += stringFromCode(code);\n            type = "number";\n            while (digit(next())) {\n              consume();\n              repr += stringFromCode(code);\n            }\n          } else if ((c1 == 69 || c1 == 101) && (c2 == 43 || c2 == 45) && digit(c3)) {\n            consume();\n            repr += stringFromCode(code);\n            consume();\n            repr += stringFromCode(code);\n            consume();\n            repr += stringFromCode(code);\n            type = "number";\n            while (digit(next())) {\n              consume();\n              repr += stringFromCode(code);\n            }\n          }\n          var value = convertAStringToANumber(repr);\n          return { type, value, repr };\n        };\n        var convertAStringToANumber = function(string) {\n          return +string;\n        };\n        var consumeTheRemnantsOfABadURL = function() {\n          while (consume()) {\n            if (code == 41 || eof()) {\n              return;\n            } else if (startsWithAValidEscape()) {\n              consumeEscape();\n              donothing();\n            } else {\n              donothing();\n            }\n          }\n        };\n        var iterationCount = 0;\n        while (!eof(next())) {\n          tokens.push(consumeAToken());\n          iterationCount++;\n          if (iterationCount > str.length * 2)\n            return "I\'m infinite-looping!";\n        }\n        return tokens;\n      }\n      function CSSParserToken() {\n        throw "Abstract Base Class";\n      }\n      CSSParserToken.prototype.toJSON = function() {\n        return { token: this.tokenType };\n      };\n      CSSParserToken.prototype.toString = function() {\n        return this.tokenType;\n      };\n      CSSParserToken.prototype.toSource = function() {\n        return "" + this;\n      };\n      function BadStringToken2() {\n        return this;\n      }\n      BadStringToken2.prototype = Object.create(CSSParserToken.prototype);\n      BadStringToken2.prototype.tokenType = "BADSTRING";\n      function BadURLToken2() {\n        return this;\n      }\n      BadURLToken2.prototype = Object.create(CSSParserToken.prototype);\n      BadURLToken2.prototype.tokenType = "BADURL";\n      function WhitespaceToken2() {\n        return this;\n      }\n      WhitespaceToken2.prototype = Object.create(CSSParserToken.prototype);\n      WhitespaceToken2.prototype.tokenType = "WHITESPACE";\n      WhitespaceToken2.prototype.toString = function() {\n        return "WS";\n      };\n      WhitespaceToken2.prototype.toSource = function() {\n        return " ";\n      };\n      function CDOToken2() {\n        return this;\n      }\n      CDOToken2.prototype = Object.create(CSSParserToken.prototype);\n      CDOToken2.prototype.tokenType = "CDO";\n      CDOToken2.prototype.toSource = function() {\n        return "\x3c!--";\n      };\n      function CDCToken2() {\n        return this;\n      }\n      CDCToken2.prototype = Object.create(CSSParserToken.prototype);\n      CDCToken2.prototype.tokenType = "CDC";\n      CDCToken2.prototype.toSource = function() {\n        return "--\x3e";\n      };\n      function ColonToken2() {\n        return this;\n      }\n      ColonToken2.prototype = Object.create(CSSParserToken.prototype);\n      ColonToken2.prototype.tokenType = ":";\n      function SemicolonToken2() {\n        return this;\n      }\n      SemicolonToken2.prototype = Object.create(CSSParserToken.prototype);\n      SemicolonToken2.prototype.tokenType = ";";\n      function CommaToken2() {\n        return this;\n      }\n      CommaToken2.prototype = Object.create(CSSParserToken.prototype);\n      CommaToken2.prototype.tokenType = ",";\n      function GroupingToken() {\n        throw "Abstract Base Class";\n      }\n      GroupingToken.prototype = Object.create(CSSParserToken.prototype);\n      function OpenCurlyToken2() {\n        this.value = "{";\n        this.mirror = "}";\n        return this;\n      }\n      OpenCurlyToken2.prototype = Object.create(GroupingToken.prototype);\n      OpenCurlyToken2.prototype.tokenType = "{";\n      function CloseCurlyToken2() {\n        this.value = "}";\n        this.mirror = "{";\n        return this;\n      }\n      CloseCurlyToken2.prototype = Object.create(GroupingToken.prototype);\n      CloseCurlyToken2.prototype.tokenType = "}";\n      function OpenSquareToken2() {\n        this.value = "[";\n        this.mirror = "]";\n        return this;\n      }\n      OpenSquareToken2.prototype = Object.create(GroupingToken.prototype);\n      OpenSquareToken2.prototype.tokenType = "[";\n      function CloseSquareToken2() {\n        this.value = "]";\n        this.mirror = "[";\n        return this;\n      }\n      CloseSquareToken2.prototype = Object.create(GroupingToken.prototype);\n      CloseSquareToken2.prototype.tokenType = "]";\n      function OpenParenToken() {\n        this.value = "(";\n        this.mirror = ")";\n        return this;\n      }\n      OpenParenToken.prototype = Object.create(GroupingToken.prototype);\n      OpenParenToken.prototype.tokenType = "(";\n      function CloseParenToken2() {\n        this.value = ")";\n        this.mirror = "(";\n        return this;\n      }\n      CloseParenToken2.prototype = Object.create(GroupingToken.prototype);\n      CloseParenToken2.prototype.tokenType = ")";\n      function IncludeMatchToken() {\n        return this;\n      }\n      IncludeMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      IncludeMatchToken.prototype.tokenType = "~=";\n      function DashMatchToken() {\n        return this;\n      }\n      DashMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      DashMatchToken.prototype.tokenType = "|=";\n      function PrefixMatchToken() {\n        return this;\n      }\n      PrefixMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      PrefixMatchToken.prototype.tokenType = "^=";\n      function SuffixMatchToken() {\n        return this;\n      }\n      SuffixMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      SuffixMatchToken.prototype.tokenType = "$=";\n      function SubstringMatchToken() {\n        return this;\n      }\n      SubstringMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      SubstringMatchToken.prototype.tokenType = "*=";\n      function ColumnToken2() {\n        return this;\n      }\n      ColumnToken2.prototype = Object.create(CSSParserToken.prototype);\n      ColumnToken2.prototype.tokenType = "||";\n      function EOFToken2() {\n        return this;\n      }\n      EOFToken2.prototype = Object.create(CSSParserToken.prototype);\n      EOFToken2.prototype.tokenType = "EOF";\n      EOFToken2.prototype.toSource = function() {\n        return "";\n      };\n      function DelimToken2(code) {\n        this.value = stringFromCode(code);\n        return this;\n      }\n      DelimToken2.prototype = Object.create(CSSParserToken.prototype);\n      DelimToken2.prototype.tokenType = "DELIM";\n      DelimToken2.prototype.toString = function() {\n        return "DELIM(" + this.value + ")";\n      };\n      DelimToken2.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        return json;\n      };\n      DelimToken2.prototype.toSource = function() {\n        if (this.value == "\\\\")\n          return "\\\\\\n";\n        else\n          return this.value;\n      };\n      function StringValuedToken() {\n        throw "Abstract Base Class";\n      }\n      StringValuedToken.prototype = Object.create(CSSParserToken.prototype);\n      StringValuedToken.prototype.ASCIIMatch = function(str) {\n        return this.value.toLowerCase() == str.toLowerCase();\n      };\n      StringValuedToken.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        return json;\n      };\n      function IdentToken2(val) {\n        this.value = val;\n      }\n      IdentToken2.prototype = Object.create(StringValuedToken.prototype);\n      IdentToken2.prototype.tokenType = "IDENT";\n      IdentToken2.prototype.toString = function() {\n        return "IDENT(" + this.value + ")";\n      };\n      IdentToken2.prototype.toSource = function() {\n        return escapeIdent(this.value);\n      };\n      function FunctionToken2(val) {\n        this.value = val;\n        this.mirror = ")";\n      }\n      FunctionToken2.prototype = Object.create(StringValuedToken.prototype);\n      FunctionToken2.prototype.tokenType = "FUNCTION";\n      FunctionToken2.prototype.toString = function() {\n        return "FUNCTION(" + this.value + ")";\n      };\n      FunctionToken2.prototype.toSource = function() {\n        return escapeIdent(this.value) + "(";\n      };\n      function AtKeywordToken2(val) {\n        this.value = val;\n      }\n      AtKeywordToken2.prototype = Object.create(StringValuedToken.prototype);\n      AtKeywordToken2.prototype.tokenType = "AT-KEYWORD";\n      AtKeywordToken2.prototype.toString = function() {\n        return "AT(" + this.value + ")";\n      };\n      AtKeywordToken2.prototype.toSource = function() {\n        return "@" + escapeIdent(this.value);\n      };\n      function HashToken2(val) {\n        this.value = val;\n        this.type = "unrestricted";\n      }\n      HashToken2.prototype = Object.create(StringValuedToken.prototype);\n      HashToken2.prototype.tokenType = "HASH";\n      HashToken2.prototype.toString = function() {\n        return "HASH(" + this.value + ")";\n      };\n      HashToken2.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        json.type = this.type;\n        return json;\n      };\n      HashToken2.prototype.toSource = function() {\n        if (this.type == "id") {\n          return "#" + escapeIdent(this.value);\n        } else {\n          return "#" + escapeHash(this.value);\n        }\n      };\n      function StringToken2(val) {\n        this.value = val;\n      }\n      StringToken2.prototype = Object.create(StringValuedToken.prototype);\n      StringToken2.prototype.tokenType = "STRING";\n      StringToken2.prototype.toString = function() {\n        return \'"\' + escapeString(this.value) + \'"\';\n      };\n      function URLToken2(val) {\n        this.value = val;\n      }\n      URLToken2.prototype = Object.create(StringValuedToken.prototype);\n      URLToken2.prototype.tokenType = "URL";\n      URLToken2.prototype.toString = function() {\n        return "URL(" + this.value + ")";\n      };\n      URLToken2.prototype.toSource = function() {\n        return \'url("\' + escapeString(this.value) + \'")\';\n      };\n      function NumberToken2() {\n        this.value = null;\n        this.type = "integer";\n        this.repr = "";\n      }\n      NumberToken2.prototype = Object.create(CSSParserToken.prototype);\n      NumberToken2.prototype.tokenType = "NUMBER";\n      NumberToken2.prototype.toString = function() {\n        if (this.type == "integer")\n          return "INT(" + this.value + ")";\n        return "NUMBER(" + this.value + ")";\n      };\n      NumberToken2.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        json.type = this.type;\n        json.repr = this.repr;\n        return json;\n      };\n      NumberToken2.prototype.toSource = function() {\n        return this.repr;\n      };\n      function PercentageToken2() {\n        this.value = null;\n        this.repr = "";\n      }\n      PercentageToken2.prototype = Object.create(CSSParserToken.prototype);\n      PercentageToken2.prototype.tokenType = "PERCENTAGE";\n      PercentageToken2.prototype.toString = function() {\n        return "PERCENTAGE(" + this.value + ")";\n      };\n      PercentageToken2.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        json.repr = this.repr;\n        return json;\n      };\n      PercentageToken2.prototype.toSource = function() {\n        return this.repr + "%";\n      };\n      function DimensionToken() {\n        this.value = null;\n        this.type = "integer";\n        this.repr = "";\n        this.unit = "";\n      }\n      DimensionToken.prototype = Object.create(CSSParserToken.prototype);\n      DimensionToken.prototype.tokenType = "DIMENSION";\n      DimensionToken.prototype.toString = function() {\n        return "DIM(" + this.value + "," + this.unit + ")";\n      };\n      DimensionToken.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        json.type = this.type;\n        json.repr = this.repr;\n        json.unit = this.unit;\n        return json;\n      };\n      DimensionToken.prototype.toSource = function() {\n        var source = this.repr;\n        var unit = escapeIdent(this.unit);\n        if (unit[0].toLowerCase() == "e" && (unit[1] == "-" || between(unit.charCodeAt(1), 48, 57))) {\n          unit = "\\\\65 " + unit.slice(1, unit.length);\n        }\n        return source + unit;\n      };\n      function escapeIdent(string) {\n        string = "" + string;\n        var result = "";\n        var firstcode = string.charCodeAt(0);\n        for (var i = 0; i < string.length; i++) {\n          var code = string.charCodeAt(i);\n          if (code == 0) {\n            throw new InvalidCharacterError("Invalid character: the input contains U+0000.");\n          }\n          if (between(code, 1, 31) || code == 127 || i == 0 && between(code, 48, 57) || i == 1 && between(code, 48, 57) && firstcode == 45) {\n            result += "\\\\" + code.toString(16) + " ";\n          } else if (code >= 128 || code == 45 || code == 95 || between(code, 48, 57) || between(code, 65, 90) || between(code, 97, 122)) {\n            result += string[i];\n          } else {\n            result += "\\\\" + string[i];\n          }\n        }\n        return result;\n      }\n      function escapeHash(string) {\n        string = "" + string;\n        var result = "";\n        var firstcode = string.charCodeAt(0);\n        for (var i = 0; i < string.length; i++) {\n          var code = string.charCodeAt(i);\n          if (code == 0) {\n            throw new InvalidCharacterError("Invalid character: the input contains U+0000.");\n          }\n          if (code >= 128 || code == 45 || code == 95 || between(code, 48, 57) || between(code, 65, 90) || between(code, 97, 122)) {\n            result += string[i];\n          } else {\n            result += "\\\\" + code.toString(16) + " ";\n          }\n        }\n        return result;\n      }\n      function escapeString(string) {\n        string = "" + string;\n        var result = "";\n        for (var i = 0; i < string.length; i++) {\n          var code = string.charCodeAt(i);\n          if (code == 0) {\n            throw new InvalidCharacterError("Invalid character: the input contains U+0000.");\n          }\n          if (between(code, 1, 31) || code == 127) {\n            result += "\\\\" + code.toString(16) + " ";\n          } else if (code == 34 || code == 92) {\n            result += "\\\\" + string[i];\n          } else {\n            result += string[i];\n          }\n        }\n        return result;\n      }\n      exports2.tokenize = tokenize2;\n      exports2.IdentToken = IdentToken2;\n      exports2.FunctionToken = FunctionToken2;\n      exports2.AtKeywordToken = AtKeywordToken2;\n      exports2.HashToken = HashToken2;\n      exports2.StringToken = StringToken2;\n      exports2.BadStringToken = BadStringToken2;\n      exports2.URLToken = URLToken2;\n      exports2.BadURLToken = BadURLToken2;\n      exports2.DelimToken = DelimToken2;\n      exports2.NumberToken = NumberToken2;\n      exports2.PercentageToken = PercentageToken2;\n      exports2.DimensionToken = DimensionToken;\n      exports2.IncludeMatchToken = IncludeMatchToken;\n      exports2.DashMatchToken = DashMatchToken;\n      exports2.PrefixMatchToken = PrefixMatchToken;\n      exports2.SuffixMatchToken = SuffixMatchToken;\n      exports2.SubstringMatchToken = SubstringMatchToken;\n      exports2.ColumnToken = ColumnToken2;\n      exports2.WhitespaceToken = WhitespaceToken2;\n      exports2.CDOToken = CDOToken2;\n      exports2.CDCToken = CDCToken2;\n      exports2.ColonToken = ColonToken2;\n      exports2.SemicolonToken = SemicolonToken2;\n      exports2.CommaToken = CommaToken2;\n      exports2.OpenParenToken = OpenParenToken;\n      exports2.CloseParenToken = CloseParenToken2;\n      exports2.OpenSquareToken = OpenSquareToken2;\n      exports2.CloseSquareToken = CloseSquareToken2;\n      exports2.OpenCurlyToken = OpenCurlyToken2;\n      exports2.CloseCurlyToken = CloseCurlyToken2;\n      exports2.EOFToken = EOFToken2;\n      exports2.CSSParserToken = CSSParserToken;\n      exports2.GroupingToken = GroupingToken;\n    });\n  }\n});\n\n// packages/playwright-core/src/server/injected/injectedScript.ts\nvar injectedScript_exports = {};\n__export(injectedScript_exports, {\n  InjectedScript: () => InjectedScript\n});\nmodule.exports = __toCommonJS(injectedScript_exports);\n\n// packages/playwright-core/src/server/injected/xpathSelectorEngine.ts\nvar XPathEngine = {\n  queryAll(root, selector) {\n    if (selector.startsWith("/"))\n      selector = "." + selector;\n    const result = [];\n    const document2 = root instanceof Document ? root : root.ownerDocument;\n    if (!document2)\n      return result;\n    const it = document2.evaluate(selector, root, null, XPathResult.ORDERED_NODE_ITERATOR_TYPE);\n    for (let node = it.iterateNext(); node; node = it.iterateNext()) {\n      if (node.nodeType === Node.ELEMENT_NODE)\n        result.push(node);\n    }\n    return result;\n  }\n};\n\n// packages/playwright-core/src/server/isomorphic/cssParser.ts\nvar css = __toESM(require_cssTokenizer());\nvar InvalidSelectorError = class extends Error {\n};\nfunction parseCSS(selector, customNames) {\n  let tokens;\n  try {\n    tokens = css.tokenize(selector);\n    if (!(tokens[tokens.length - 1] instanceof css.EOFToken))\n      tokens.push(new css.EOFToken());\n  } catch (e) {\n    const newMessage = e.message + ` while parsing selector "${selector}"`;\n    const index = (e.stack || "").indexOf(e.message);\n    if (index !== -1)\n      e.stack = e.stack.substring(0, index) + newMessage + e.stack.substring(index + e.message.length);\n    e.message = newMessage;\n    throw e;\n  }\n  const unsupportedToken = tokens.find((token) => {\n    return token instanceof css.AtKeywordToken || token instanceof css.BadStringToken || token instanceof css.BadURLToken || token instanceof css.ColumnToken || token instanceof css.CDOToken || token instanceof css.CDCToken || token instanceof css.SemicolonToken || token instanceof css.OpenCurlyToken || token instanceof css.CloseCurlyToken || token instanceof css.URLToken || token instanceof css.PercentageToken;\n  });\n  if (unsupportedToken)\n    throw new InvalidSelectorError(`Unsupported token "${unsupportedToken.toSource()}" while parsing selector "${selector}"`);\n  let pos = 0;\n  const names = /* @__PURE__ */ new Set();\n  function unexpected() {\n    return new InvalidSelectorError(`Unexpected token "${tokens[pos].toSource()}" while parsing selector "${selector}"`);\n  }\n  function skipWhitespace() {\n    while (tokens[pos] instanceof css.WhitespaceToken)\n      pos++;\n  }\n  function isIdent(p = pos) {\n    return tokens[p] instanceof css.IdentToken;\n  }\n  function isString(p = pos) {\n    return tokens[p] instanceof css.StringToken;\n  }\n  function isNumber(p = pos) {\n    return tokens[p] instanceof css.NumberToken;\n  }\n  function isComma(p = pos) {\n    return tokens[p] instanceof css.CommaToken;\n  }\n  function isCloseParen(p = pos) {\n    return tokens[p] instanceof css.CloseParenToken;\n  }\n  function isStar(p = pos) {\n    return tokens[p] instanceof css.DelimToken && tokens[p].value === "*";\n  }\n  function isEOF(p = pos) {\n    return tokens[p] instanceof css.EOFToken;\n  }\n  function isClauseCombinator(p = pos) {\n    return tokens[p] instanceof css.DelimToken && [">", "+", "~"].includes(tokens[p].value);\n  }\n  function isSelectorClauseEnd(p = pos) {\n    return isComma(p) || isCloseParen(p) || isEOF(p) || isClauseCombinator(p) || tokens[p] instanceof css.WhitespaceToken;\n  }\n  function consumeFunctionArguments() {\n    const result2 = [consumeArgument()];\n    while (true) {\n      skipWhitespace();\n      if (!isComma())\n        break;\n      pos++;\n      result2.push(consumeArgument());\n    }\n    return result2;\n  }\n  function consumeArgument() {\n    skipWhitespace();\n    if (isNumber())\n      return tokens[pos++].value;\n    if (isString())\n      return tokens[pos++].value;\n    return consumeComplexSelector();\n  }\n  function consumeComplexSelector() {\n    const result2 = { simples: [] };\n    skipWhitespace();\n    if (isClauseCombinator()) {\n      result2.simples.push({ selector: { functions: [{ name: "scope", args: [] }] }, combinator: "" });\n    } else {\n      result2.simples.push({ selector: consumeSimpleSelector(), combinator: "" });\n    }\n    while (true) {\n      skipWhitespace();\n      if (isClauseCombinator()) {\n        result2.simples[result2.simples.length - 1].combinator = tokens[pos++].value;\n        skipWhitespace();\n      } else if (isSelectorClauseEnd()) {\n        break;\n      }\n      result2.simples.push({ combinator: "", selector: consumeSimpleSelector() });\n    }\n    return result2;\n  }\n  function consumeSimpleSelector() {\n    let rawCSSString = "";\n    const functions = [];\n    while (!isSelectorClauseEnd()) {\n      if (isIdent() || isStar()) {\n        rawCSSString += tokens[pos++].toSource();\n      } else if (tokens[pos] instanceof css.HashToken) {\n        rawCSSString += tokens[pos++].toSource();\n      } else if (tokens[pos] instanceof css.DelimToken && tokens[pos].value === ".") {\n        pos++;\n        if (isIdent())\n          rawCSSString += "." + tokens[pos++].toSource();\n        else\n          throw unexpected();\n      } else if (tokens[pos] instanceof css.ColonToken) {\n        pos++;\n        if (isIdent()) {\n          if (!customNames.has(tokens[pos].value.toLowerCase())) {\n            rawCSSString += ":" + tokens[pos++].toSource();\n          } else {\n            const name = tokens[pos++].value.toLowerCase();\n            functions.push({ name, args: [] });\n            names.add(name);\n          }\n        } else if (tokens[pos] instanceof css.FunctionToken) {\n          const name = tokens[pos++].value.toLowerCase();\n          if (!customNames.has(name)) {\n            rawCSSString += `:${name}(${consumeBuiltinFunctionArguments()})`;\n          } else {\n            functions.push({ name, args: consumeFunctionArguments() });\n            names.add(name);\n          }\n          skipWhitespace();\n          if (!isCloseParen())\n            throw unexpected();\n          pos++;\n        } else {\n          throw unexpected();\n        }\n      } else if (tokens[pos] instanceof css.OpenSquareToken) {\n        rawCSSString += "[";\n        pos++;\n        while (!(tokens[pos] instanceof css.CloseSquareToken) && !isEOF())\n          rawCSSString += tokens[pos++].toSource();\n        if (!(tokens[pos] instanceof css.CloseSquareToken))\n          throw unexpected();\n        rawCSSString += "]";\n        pos++;\n      } else {\n        throw unexpected();\n      }\n    }\n    if (!rawCSSString && !functions.length)\n      throw unexpected();\n    return { css: rawCSSString || void 0, functions };\n  }\n  function consumeBuiltinFunctionArguments() {\n    let s = "";\n    while (!isCloseParen() && !isEOF())\n      s += tokens[pos++].toSource();\n    return s;\n  }\n  const result = consumeFunctionArguments();\n  if (!isEOF())\n    throw new InvalidSelectorError(`Error while parsing selector "${selector}"`);\n  if (result.some((arg) => typeof arg !== "object" || !("simples" in arg)))\n    throw new InvalidSelectorError(`Error while parsing selector "${selector}"`);\n  return { selector: result, names: Array.from(names) };\n}\n\n// packages/playwright-core/src/server/isomorphic/selectorParser.ts\nvar customCSSNames = /* @__PURE__ */ new Set(["not", "is", "where", "has", "scope", "light", "visible", "text", "text-matches", "text-is", "has-text", "above", "below", "right-of", "left-of", "near", "nth-match"]);\nvar kNestedSelectorNames = /* @__PURE__ */ new Set(["has"]);\nfunction parseSelector(selector) {\n  const result = parseSelectorString(selector);\n  const parts = result.parts.map((part) => {\n    if (part.name === "css" || part.name === "css:light") {\n      if (part.name === "css:light")\n        part.body = ":light(" + part.body + ")";\n      const parsedCSS = parseCSS(part.body, customCSSNames);\n      return {\n        name: "css",\n        body: parsedCSS.selector,\n        source: part.body\n      };\n    }\n    if (kNestedSelectorNames.has(part.name)) {\n      let innerSelector;\n      try {\n        const unescaped = JSON.parse(part.body);\n        if (typeof unescaped !== "string")\n          throw new Error(`Malformed selector: ${part.name}=` + part.body);\n        innerSelector = unescaped;\n      } catch (e) {\n        throw new Error(`Malformed selector: ${part.name}=` + part.body);\n      }\n      const result2 = { name: part.name, source: part.body, body: parseSelector(innerSelector) };\n      if (result2.body.parts.some((part2) => part2.name === "control" && part2.body === "enter-frame"))\n        throw new Error(`Frames are not allowed inside "${part.name}" selectors`);\n      return result2;\n    }\n    return { ...part, source: part.body };\n  });\n  if (kNestedSelectorNames.has(parts[0].name))\n    throw new Error(`"${parts[0].name}" selector cannot be first`);\n  return {\n    capture: result.capture,\n    parts\n  };\n}\nfunction stringifySelector(selector) {\n  if (typeof selector === "string")\n    return selector;\n  return selector.parts.map((p, i) => {\n    const prefix = p.name === "css" ? "" : p.name + "=";\n    return `${i === selector.capture ? "*" : ""}${prefix}${p.source}`;\n  }).join(" >> ");\n}\nfunction allEngineNames(selector) {\n  const result = /* @__PURE__ */ new Set();\n  const visit = (selector2) => {\n    for (const part of selector2.parts) {\n      result.add(part.name);\n      if (kNestedSelectorNames.has(part.name))\n        visit(part.body);\n    }\n  };\n  visit(selector);\n  return result;\n}\nfunction parseSelectorString(selector) {\n  let index = 0;\n  let quote;\n  let start = 0;\n  const result = { parts: [] };\n  const append = () => {\n    const part = selector.substring(start, index).trim();\n    const eqIndex = part.indexOf("=");\n    let name;\n    let body;\n    if (eqIndex !== -1 && part.substring(0, eqIndex).trim().match(/^[a-zA-Z_0-9-+:*]+$/)) {\n      name = part.substring(0, eqIndex).trim();\n      body = part.substring(eqIndex + 1);\n    } else if (part.length > 1 && part[0] === \'"\' && part[part.length - 1] === \'"\') {\n      name = "text";\n      body = part;\n    } else if (part.length > 1 && part[0] === "\'" && part[part.length - 1] === "\'") {\n      name = "text";\n      body = part;\n    } else if (/^\\(*\\/\\//.test(part) || part.startsWith("..")) {\n      name = "xpath";\n      body = part;\n    } else {\n      name = "css";\n      body = part;\n    }\n    let capture = false;\n    if (name[0] === "*") {\n      capture = true;\n      name = name.substring(1);\n    }\n    result.parts.push({ name, body });\n    if (capture) {\n      if (result.capture !== void 0)\n        throw new InvalidSelectorError(`Only one of the selectors can capture using * modifier`);\n      result.capture = result.parts.length - 1;\n    }\n  };\n  if (!selector.includes(">>")) {\n    index = selector.length;\n    append();\n    return result;\n  }\n  const shouldIgnoreTextSelectorQuote = () => {\n    const prefix = selector.substring(start, index);\n    const match = prefix.match(/^\\s*text\\s*=(.*)$/);\n    return !!match && !!match[1];\n  };\n  while (index < selector.length) {\n    const c = selector[index];\n    if (c === "\\\\" && index + 1 < selector.length) {\n      index += 2;\n    } else if (c === quote) {\n      quote = void 0;\n      index++;\n    } else if (!quote && (c === \'"\' || c === "\'" || c === "`") && !shouldIgnoreTextSelectorQuote()) {\n      quote = c;\n      index++;\n    } else if (!quote && c === ">" && selector[index + 1] === ">") {\n      append();\n      index += 2;\n      start = index;\n    } else {\n      index++;\n    }\n  }\n  append();\n  return result;\n}\n\n// packages/playwright-core/src/server/injected/selectorEvaluator.ts\nvar SelectorEvaluatorImpl = class {\n  constructor(extraEngines) {\n    this._engines = /* @__PURE__ */ new Map();\n    this._cacheQueryCSS = /* @__PURE__ */ new Map();\n    this._cacheMatches = /* @__PURE__ */ new Map();\n    this._cacheQuery = /* @__PURE__ */ new Map();\n    this._cacheMatchesSimple = /* @__PURE__ */ new Map();\n    this._cacheMatchesParents = /* @__PURE__ */ new Map();\n    this._cacheCallMatches = /* @__PURE__ */ new Map();\n    this._cacheCallQuery = /* @__PURE__ */ new Map();\n    this._cacheQuerySimple = /* @__PURE__ */ new Map();\n    this._cacheText = /* @__PURE__ */ new Map();\n    this._retainCacheCounter = 0;\n    for (const [name, engine] of extraEngines)\n      this._engines.set(name, engine);\n    this._engines.set("not", notEngine);\n    this._engines.set("is", isEngine);\n    this._engines.set("where", isEngine);\n    this._engines.set("has", hasEngine);\n    this._engines.set("scope", scopeEngine);\n    this._engines.set("light", lightEngine);\n    this._engines.set("visible", visibleEngine);\n    this._engines.set("text", textEngine);\n    this._engines.set("text-is", textIsEngine);\n    this._engines.set("text-matches", textMatchesEngine);\n    this._engines.set("has-text", hasTextEngine);\n    this._engines.set("right-of", createPositionEngine("right-of", boxRightOf));\n    this._engines.set("left-of", createPositionEngine("left-of", boxLeftOf));\n    this._engines.set("above", createPositionEngine("above", boxAbove));\n    this._engines.set("below", createPositionEngine("below", boxBelow));\n    this._engines.set("near", createPositionEngine("near", boxNear));\n    this._engines.set("nth-match", nthMatchEngine);\n    const allNames = [...this._engines.keys()];\n    allNames.sort();\n    const parserNames = [...customCSSNames];\n    parserNames.sort();\n    if (allNames.join("|") !== parserNames.join("|"))\n      throw new Error(`Please keep customCSSNames in sync with evaluator engines: ${allNames.join("|")} vs ${parserNames.join("|")}`);\n  }\n  begin() {\n    ++this._retainCacheCounter;\n  }\n  end() {\n    --this._retainCacheCounter;\n    if (!this._retainCacheCounter) {\n      this._cacheQueryCSS.clear();\n      this._cacheMatches.clear();\n      this._cacheQuery.clear();\n      this._cacheMatchesSimple.clear();\n      this._cacheMatchesParents.clear();\n      this._cacheCallMatches.clear();\n      this._cacheCallQuery.clear();\n      this._cacheQuerySimple.clear();\n      this._cacheText.clear();\n    }\n  }\n  _cached(cache, main, rest, cb) {\n    if (!cache.has(main))\n      cache.set(main, []);\n    const entries = cache.get(main);\n    const entry = entries.find((e) => rest.every((value, index) => e.rest[index] === value));\n    if (entry)\n      return entry.result;\n    const result = cb();\n    entries.push({ rest, result });\n    return result;\n  }\n  _checkSelector(s) {\n    const wellFormed = typeof s === "object" && s && (Array.isArray(s) || "simples" in s && s.simples.length);\n    if (!wellFormed)\n      throw new Error(`Malformed selector "${s}"`);\n    return s;\n  }\n  matches(element, s, context) {\n    const selector = this._checkSelector(s);\n    this.begin();\n    try {\n      return this._cached(this._cacheMatches, element, [selector, context.scope, context.pierceShadow], () => {\n        if (Array.isArray(selector))\n          return this._matchesEngine(isEngine, element, selector, context);\n        if (!this._matchesSimple(element, selector.simples[selector.simples.length - 1].selector, context))\n          return false;\n        return this._matchesParents(element, selector, selector.simples.length - 2, context);\n      });\n    } finally {\n      this.end();\n    }\n  }\n  query(context, s) {\n    const selector = this._checkSelector(s);\n    this.begin();\n    try {\n      return this._cached(this._cacheQuery, selector, [context.scope, context.pierceShadow], () => {\n        if (Array.isArray(selector))\n          return this._queryEngine(isEngine, context, selector);\n        const previousScoreMap = this._scoreMap;\n        this._scoreMap = /* @__PURE__ */ new Map();\n        let elements = this._querySimple(context, selector.simples[selector.simples.length - 1].selector);\n        elements = elements.filter((element) => this._matchesParents(element, selector, selector.simples.length - 2, context));\n        if (this._scoreMap.size) {\n          elements.sort((a, b) => {\n            const aScore = this._scoreMap.get(a);\n            const bScore = this._scoreMap.get(b);\n            if (aScore === bScore)\n              return 0;\n            if (aScore === void 0)\n              return 1;\n            if (bScore === void 0)\n              return -1;\n            return aScore - bScore;\n          });\n        }\n        this._scoreMap = previousScoreMap;\n        return elements;\n      });\n    } finally {\n      this.end();\n    }\n  }\n  _markScore(element, score) {\n    if (this._scoreMap)\n      this._scoreMap.set(element, score);\n  }\n  _matchesSimple(element, simple, context) {\n    return this._cached(this._cacheMatchesSimple, element, [simple, context.scope, context.pierceShadow], () => {\n      const isPossiblyScopeClause = simple.functions.some((f) => f.name === "scope" || f.name === "is");\n      if (!isPossiblyScopeClause && element === context.scope)\n        return false;\n      if (simple.css && !this._matchesCSS(element, simple.css))\n        return false;\n      for (const func of simple.functions) {\n        if (!this._matchesEngine(this._getEngine(func.name), element, func.args, context))\n          return false;\n      }\n      return true;\n    });\n  }\n  _querySimple(context, simple) {\n    if (!simple.functions.length)\n      return this._queryCSS(context, simple.css || "*");\n    return this._cached(this._cacheQuerySimple, simple, [context.scope, context.pierceShadow], () => {\n      let css2 = simple.css;\n      const funcs = simple.functions;\n      if (css2 === "*" && funcs.length)\n        css2 = void 0;\n      let elements;\n      let firstIndex = -1;\n      if (css2 !== void 0) {\n        elements = this._queryCSS(context, css2);\n        const hasScopeClause = funcs.some((f) => f.name === "scope");\n        if (hasScopeClause && context.scope.nodeType === 1)\n          elements.unshift(context.scope);\n      } else {\n        firstIndex = funcs.findIndex((func) => this._getEngine(func.name).query !== void 0);\n        if (firstIndex === -1)\n          firstIndex = 0;\n        elements = this._queryEngine(this._getEngine(funcs[firstIndex].name), context, funcs[firstIndex].args);\n      }\n      for (let i = 0; i < funcs.length; i++) {\n        if (i === firstIndex)\n          continue;\n        const engine = this._getEngine(funcs[i].name);\n        if (engine.matches !== void 0)\n          elements = elements.filter((e) => this._matchesEngine(engine, e, funcs[i].args, context));\n      }\n      for (let i = 0; i < funcs.length; i++) {\n        if (i === firstIndex)\n          continue;\n        const engine = this._getEngine(funcs[i].name);\n        if (engine.matches === void 0)\n          elements = elements.filter((e) => this._matchesEngine(engine, e, funcs[i].args, context));\n      }\n      return elements;\n    });\n  }\n  _matchesParents(element, complex, index, context) {\n    if (index < 0)\n      return true;\n    return this._cached(this._cacheMatchesParents, element, [complex, index, context.scope, context.pierceShadow], () => {\n      const { selector: simple, combinator } = complex.simples[index];\n      if (combinator === ">") {\n        const parent = parentElementOrShadowHostInContext(element, context);\n        if (!parent || !this._matchesSimple(parent, simple, context))\n          return false;\n        return this._matchesParents(parent, complex, index - 1, context);\n      }\n      if (combinator === "+") {\n        const previousSibling = previousSiblingInContext(element, context);\n        if (!previousSibling || !this._matchesSimple(previousSibling, simple, context))\n          return false;\n        return this._matchesParents(previousSibling, complex, index - 1, context);\n      }\n      if (combinator === "") {\n        let parent = parentElementOrShadowHostInContext(element, context);\n        while (parent) {\n          if (this._matchesSimple(parent, simple, context)) {\n            if (this._matchesParents(parent, complex, index - 1, context))\n              return true;\n            if (complex.simples[index - 1].combinator === "")\n              break;\n          }\n          parent = parentElementOrShadowHostInContext(parent, context);\n        }\n        return false;\n      }\n      if (combinator === "~") {\n        let previousSibling = previousSiblingInContext(element, context);\n        while (previousSibling) {\n          if (this._matchesSimple(previousSibling, simple, context)) {\n            if (this._matchesParents(previousSibling, complex, index - 1, context))\n              return true;\n            if (complex.simples[index - 1].combinator === "~")\n              break;\n          }\n          previousSibling = previousSiblingInContext(previousSibling, context);\n        }\n        return false;\n      }\n      if (combinator === ">=") {\n        let parent = element;\n        while (parent) {\n          if (this._matchesSimple(parent, simple, context)) {\n            if (this._matchesParents(parent, complex, index - 1, context))\n              return true;\n            if (complex.simples[index - 1].combinator === "")\n              break;\n          }\n          parent = parentElementOrShadowHostInContext(parent, context);\n        }\n        return false;\n      }\n      throw new Error(`Unsupported combinator "${combinator}"`);\n    });\n  }\n  _matchesEngine(engine, element, args, context) {\n    if (engine.matches)\n      return this._callMatches(engine, element, args, context);\n    if (engine.query)\n      return this._callQuery(engine, args, context).includes(element);\n    throw new Error(`Selector engine should implement "matches" or "query"`);\n  }\n  _queryEngine(engine, context, args) {\n    if (engine.query)\n      return this._callQuery(engine, args, context);\n    if (engine.matches)\n      return this._queryCSS(context, "*").filter((element) => this._callMatches(engine, element, args, context));\n    throw new Error(`Selector engine should implement "matches" or "query"`);\n  }\n  _callMatches(engine, element, args, context) {\n    return this._cached(this._cacheCallMatches, element, [engine, context.scope, context.pierceShadow, ...args], () => {\n      return engine.matches(element, args, context, this);\n    });\n  }\n  _callQuery(engine, args, context) {\n    return this._cached(this._cacheCallQuery, engine, [context.scope, context.pierceShadow, ...args], () => {\n      return engine.query(context, args, this);\n    });\n  }\n  _matchesCSS(element, css2) {\n    return element.matches(css2);\n  }\n  _queryCSS(context, css2) {\n    return this._cached(this._cacheQueryCSS, css2, [context.scope, context.pierceShadow], () => {\n      let result = [];\n      function query(root) {\n        result = result.concat([...root.querySelectorAll(css2)]);\n        if (!context.pierceShadow)\n          return;\n        if (root.shadowRoot)\n          query(root.shadowRoot);\n        for (const element of root.querySelectorAll("*")) {\n          if (element.shadowRoot)\n            query(element.shadowRoot);\n        }\n      }\n      query(context.scope);\n      return result;\n    });\n  }\n  _getEngine(name) {\n    const engine = this._engines.get(name);\n    if (!engine)\n      throw new Error(`Unknown selector engine "${name}"`);\n    return engine;\n  }\n};\nvar isEngine = {\n  matches(element, args, context, evaluator) {\n    if (args.length === 0)\n      throw new Error(`"is" engine expects non-empty selector list`);\n    return args.some((selector) => evaluator.matches(element, selector, context));\n  },\n  query(context, args, evaluator) {\n    if (args.length === 0)\n      throw new Error(`"is" engine expects non-empty selector list`);\n    let elements = [];\n    for (const arg of args)\n      elements = elements.concat(evaluator.query(context, arg));\n    return args.length === 1 ? elements : sortInDOMOrder(elements);\n  }\n};\nvar hasEngine = {\n  matches(element, args, context, evaluator) {\n    if (args.length === 0)\n      throw new Error(`"has" engine expects non-empty selector list`);\n    return evaluator.query({ ...context, scope: element }, args).length > 0;\n  }\n};\nvar scopeEngine = {\n  matches(element, args, context, evaluator) {\n    if (args.length !== 0)\n      throw new Error(`"scope" engine expects no arguments`);\n    if (context.scope.nodeType === 9)\n      return element === context.scope.documentElement;\n    return element === context.scope;\n  },\n  query(context, args, evaluator) {\n    if (args.length !== 0)\n      throw new Error(`"scope" engine expects no arguments`);\n    if (context.scope.nodeType === 9) {\n      const root = context.scope.documentElement;\n      return root ? [root] : [];\n    }\n    if (context.scope.nodeType === 1)\n      return [context.scope];\n    return [];\n  }\n};\nvar notEngine = {\n  matches(element, args, context, evaluator) {\n    if (args.length === 0)\n      throw new Error(`"not" engine expects non-empty selector list`);\n    return !evaluator.matches(element, args, context);\n  }\n};\nvar lightEngine = {\n  query(context, args, evaluator) {\n    return evaluator.query({ ...context, pierceShadow: false }, args);\n  },\n  matches(element, args, context, evaluator) {\n    return evaluator.matches(element, args, { ...context, pierceShadow: false });\n  }\n};\nvar visibleEngine = {\n  matches(element, args, context, evaluator) {\n    if (args.length)\n      throw new Error(`"visible" engine expects no arguments`);\n    return isVisible(element);\n  }\n};\nvar textEngine = {\n  matches(element, args, context, evaluator) {\n    if (args.length !== 1 || typeof args[0] !== "string")\n      throw new Error(`"text" engine expects a single string`);\n    const matcher = createLaxTextMatcher(args[0]);\n    return elementMatchesText(evaluator, element, matcher) === "self";\n  }\n};\nvar textIsEngine = {\n  matches(element, args, context, evaluator) {\n    if (args.length !== 1 || typeof args[0] !== "string")\n      throw new Error(`"text-is" engine expects a single string`);\n    const matcher = createStrictTextMatcher(args[0]);\n    return elementMatchesText(evaluator, element, matcher) !== "none";\n  }\n};\nvar textMatchesEngine = {\n  matches(element, args, context, evaluator) {\n    if (args.length === 0 || typeof args[0] !== "string" || args.length > 2 || args.length === 2 && typeof args[1] !== "string")\n      throw new Error(`"text-matches" engine expects a regexp body and optional regexp flags`);\n    const matcher = createRegexTextMatcher(args[0], args.length === 2 ? args[1] : void 0);\n    return elementMatchesText(evaluator, element, matcher) === "self";\n  }\n};\nvar hasTextEngine = {\n  matches(element, args, context, evaluator) {\n    if (args.length !== 1 || typeof args[0] !== "string")\n      throw new Error(`"has-text" engine expects a single string`);\n    if (shouldSkipForTextMatching(element))\n      return false;\n    const matcher = createLaxTextMatcher(args[0]);\n    return matcher(elementText(evaluator, element));\n  }\n};\nfunction createLaxTextMatcher(text) {\n  text = text.trim().replace(/\\s+/g, " ").toLowerCase();\n  return (elementText2) => {\n    const s = elementText2.full.trim().replace(/\\s+/g, " ").toLowerCase();\n    return s.includes(text);\n  };\n}\nfunction createStrictTextMatcher(text) {\n  text = text.trim().replace(/\\s+/g, " ");\n  return (elementText2) => {\n    if (!text && !elementText2.immediate.length)\n      return true;\n    return elementText2.immediate.some((s) => s.trim().replace(/\\s+/g, " ") === text);\n  };\n}\nfunction createRegexTextMatcher(source, flags) {\n  const re = new RegExp(source, flags);\n  return (elementText2) => {\n    return re.test(elementText2.full);\n  };\n}\nfunction shouldSkipForTextMatching(element) {\n  return element.nodeName === "SCRIPT" || element.nodeName === "STYLE" || document.head && document.head.contains(element);\n}\nfunction elementText(evaluator, root) {\n  let value = evaluator._cacheText.get(root);\n  if (value === void 0) {\n    value = { full: "", immediate: [] };\n    if (!shouldSkipForTextMatching(root)) {\n      let currentImmediate = "";\n      if (root instanceof HTMLInputElement && (root.type === "submit" || root.type === "button")) {\n        value = { full: root.value, immediate: [root.value] };\n      } else {\n        for (let child = root.firstChild; child; child = child.nextSibling) {\n          if (child.nodeType === Node.TEXT_NODE) {\n            value.full += child.nodeValue || "";\n            currentImmediate += child.nodeValue || "";\n          } else {\n            if (currentImmediate)\n              value.immediate.push(currentImmediate);\n            currentImmediate = "";\n            if (child.nodeType === Node.ELEMENT_NODE)\n              value.full += elementText(evaluator, child).full;\n          }\n        }\n        if (currentImmediate)\n          value.immediate.push(currentImmediate);\n        if (root.shadowRoot)\n          value.full += elementText(evaluator, root.shadowRoot).full;\n      }\n    }\n    evaluator._cacheText.set(root, value);\n  }\n  return value;\n}\nfunction elementMatchesText(evaluator, element, matcher) {\n  if (shouldSkipForTextMatching(element))\n    return "none";\n  if (!matcher(elementText(evaluator, element)))\n    return "none";\n  for (let child = element.firstChild; child; child = child.nextSibling) {\n    if (child.nodeType === Node.ELEMENT_NODE && matcher(elementText(evaluator, child)))\n      return "selfAndChildren";\n  }\n  if (element.shadowRoot && matcher(elementText(evaluator, element.shadowRoot)))\n    return "selfAndChildren";\n  return "self";\n}\nfunction boxRightOf(box1, box2, maxDistance) {\n  const distance = box1.left - box2.right;\n  if (distance < 0 || maxDistance !== void 0 && distance > maxDistance)\n    return;\n  return distance + Math.max(box2.bottom - box1.bottom, 0) + Math.max(box1.top - box2.top, 0);\n}\nfunction boxLeftOf(box1, box2, maxDistance) {\n  const distance = box2.left - box1.right;\n  if (distance < 0 || maxDistance !== void 0 && distance > maxDistance)\n    return;\n  return distance + Math.max(box2.bottom - box1.bottom, 0) + Math.max(box1.top - box2.top, 0);\n}\nfunction boxAbove(box1, box2, maxDistance) {\n  const distance = box2.top - box1.bottom;\n  if (distance < 0 || maxDistance !== void 0 && distance > maxDistance)\n    return;\n  return distance + Math.max(box1.left - box2.left, 0) + Math.max(box2.right - box1.right, 0);\n}\nfunction boxBelow(box1, box2, maxDistance) {\n  const distance = box1.top - box2.bottom;\n  if (distance < 0 || maxDistance !== void 0 && distance > maxDistance)\n    return;\n  return distance + Math.max(box1.left - box2.left, 0) + Math.max(box2.right - box1.right, 0);\n}\nfunction boxNear(box1, box2, maxDistance) {\n  const kThreshold = maxDistance === void 0 ? 50 : maxDistance;\n  let score = 0;\n  if (box1.left - box2.right >= 0)\n    score += box1.left - box2.right;\n  if (box2.left - box1.right >= 0)\n    score += box2.left - box1.right;\n  if (box2.top - box1.bottom >= 0)\n    score += box2.top - box1.bottom;\n  if (box1.top - box2.bottom >= 0)\n    score += box1.top - box2.bottom;\n  return score > kThreshold ? void 0 : score;\n}\nfunction createPositionEngine(name, scorer) {\n  return {\n    matches(element, args, context, evaluator) {\n      const maxDistance = args.length && typeof args[args.length - 1] === "number" ? args[args.length - 1] : void 0;\n      const queryArgs = maxDistance === void 0 ? args : args.slice(0, args.length - 1);\n      if (args.length < 1 + (maxDistance === void 0 ? 0 : 1))\n        throw new Error(`"${name}" engine expects a selector list and optional maximum distance in pixels`);\n      const box = element.getBoundingClientRect();\n      let bestScore;\n      for (const e of evaluator.query(context, queryArgs)) {\n        if (e === element)\n          continue;\n        const score = scorer(box, e.getBoundingClientRect(), maxDistance);\n        if (score === void 0)\n          continue;\n        if (bestScore === void 0 || score < bestScore)\n          bestScore = score;\n      }\n      if (bestScore === void 0)\n        return false;\n      evaluator._markScore(element, bestScore);\n      return true;\n    }\n  };\n}\nvar nthMatchEngine = {\n  query(context, args, evaluator) {\n    let index = args[args.length - 1];\n    if (args.length < 2)\n      throw new Error(`"nth-match" engine expects non-empty selector list and an index argument`);\n    if (typeof index !== "number" || index < 1)\n      throw new Error(`"nth-match" engine expects a one-based index as the last argument`);\n    const elements = isEngine.query(context, args.slice(0, args.length - 1), evaluator);\n    index--;\n    return index < elements.length ? [elements[index]] : [];\n  }\n};\nfunction isInsideScope(scope, element) {\n  while (element) {\n    if (scope.contains(element))\n      return true;\n    element = enclosingShadowHost(element);\n  }\n  return false;\n}\nfunction parentElementOrShadowHost(element) {\n  if (element.parentElement)\n    return element.parentElement;\n  if (!element.parentNode)\n    return;\n  if (element.parentNode.nodeType === 11 && element.parentNode.host)\n    return element.parentNode.host;\n}\nfunction enclosingShadowRootOrDocument(element) {\n  let node = element;\n  while (node.parentNode)\n    node = node.parentNode;\n  if (node.nodeType === 11 || node.nodeType === 9)\n    return node;\n}\nfunction enclosingShadowHost(element) {\n  while (element.parentElement)\n    element = element.parentElement;\n  return parentElementOrShadowHost(element);\n}\nfunction closestCrossShadow(element, css2) {\n  while (element) {\n    const closest = element.closest(css2);\n    if (closest)\n      return closest;\n    element = enclosingShadowHost(element);\n  }\n}\nfunction parentElementOrShadowHostInContext(element, context) {\n  if (element === context.scope)\n    return;\n  if (!context.pierceShadow)\n    return element.parentElement || void 0;\n  return parentElementOrShadowHost(element);\n}\nfunction previousSiblingInContext(element, context) {\n  if (element === context.scope)\n    return;\n  return element.previousElementSibling || void 0;\n}\nfunction isVisible(element) {\n  if (!element.ownerDocument || !element.ownerDocument.defaultView)\n    return true;\n  const style = element.ownerDocument.defaultView.getComputedStyle(element);\n  if (!style || style.visibility === "hidden")\n    return false;\n  if (style.display === "contents") {\n    for (let child = element.firstChild; child; child = child.nextSibling) {\n      if (child.nodeType === 1 && isVisible(child))\n        return true;\n      if (child.nodeType === 3 && isVisibleTextNode(child))\n        return true;\n    }\n    return false;\n  }\n  const rect = element.getBoundingClientRect();\n  return rect.width > 0 && rect.height > 0;\n}\nfunction isVisibleTextNode(node) {\n  const range = document.createRange();\n  range.selectNode(node);\n  const rect = range.getBoundingClientRect();\n  return rect.width > 0 && rect.height > 0;\n}\nfunction sortInDOMOrder(elements) {\n  const elementToEntry = /* @__PURE__ */ new Map();\n  const roots = [];\n  const result = [];\n  function append(element) {\n    let entry = elementToEntry.get(element);\n    if (entry)\n      return entry;\n    const parent = parentElementOrShadowHost(element);\n    if (parent) {\n      const parentEntry = append(parent);\n      parentEntry.children.push(element);\n    } else {\n      roots.push(element);\n    }\n    entry = { children: [], taken: false };\n    elementToEntry.set(element, entry);\n    return entry;\n  }\n  elements.forEach((e) => append(e).taken = true);\n  function visit(element) {\n    const entry = elementToEntry.get(element);\n    if (entry.taken)\n      result.push(element);\n    if (entry.children.length > 1) {\n      const set = new Set(entry.children);\n      entry.children = [];\n      let child = element.firstElementChild;\n      while (child && entry.children.length < set.size) {\n        if (set.has(child))\n          entry.children.push(child);\n        child = child.nextElementSibling;\n      }\n      child = element.shadowRoot ? element.shadowRoot.firstElementChild : null;\n      while (child && entry.children.length < set.size) {\n        if (set.has(child))\n          entry.children.push(child);\n        child = child.nextElementSibling;\n      }\n    }\n    entry.children.forEach(visit);\n  }\n  roots.forEach(visit);\n  return result;\n}\n\n// packages/playwright-core/src/server/injected/componentUtils.ts\nfunction checkComponentAttribute(obj, attr) {\n  for (const token of attr.jsonPath) {\n    if (obj !== void 0 && obj !== null)\n      obj = obj[token];\n  }\n  return matchesAttribute(obj, attr);\n}\nfunction matchesAttribute(value, attr) {\n  const objValue = typeof value === "string" && !attr.caseSensitive ? value.toUpperCase() : value;\n  const attrValue = typeof attr.value === "string" && !attr.caseSensitive ? attr.value.toUpperCase() : attr.value;\n  if (attr.op === "<truthy>")\n    return !!objValue;\n  if (attr.op === "=") {\n    if (attrValue instanceof RegExp)\n      return typeof objValue === "string" && !!objValue.match(attrValue);\n    return objValue === attrValue;\n  }\n  if (typeof objValue !== "string" || typeof attrValue !== "string")\n    return false;\n  if (attr.op === "*=")\n    return objValue.includes(attrValue);\n  if (attr.op === "^=")\n    return objValue.startsWith(attrValue);\n  if (attr.op === "$=")\n    return objValue.endsWith(attrValue);\n  if (attr.op === "|=")\n    return objValue === attrValue || objValue.startsWith(attrValue + "-");\n  if (attr.op === "~=")\n    return objValue.split(" ").includes(attrValue);\n  return false;\n}\nfunction parseComponentSelector(selector, allowUnquotedStrings) {\n  let wp = 0;\n  let EOL = selector.length === 0;\n  const next = () => selector[wp] || "";\n  const eat1 = () => {\n    const result2 = next();\n    ++wp;\n    EOL = wp >= selector.length;\n    return result2;\n  };\n  const syntaxError = (stage) => {\n    if (EOL)\n      throw new Error(`Unexpected end of selector while parsing selector \\`${selector}\\``);\n    throw new Error(`Error while parsing selector \\`${selector}\\` - unexpected symbol "${next()}" at position ${wp}` + (stage ? " during " + stage : ""));\n  };\n  function skipSpaces() {\n    while (!EOL && /\\s/.test(next()))\n      eat1();\n  }\n  function isCSSNameChar(char) {\n    return char >= "\\x80" || char >= "0" && char <= "9" || char >= "A" && char <= "Z" || char >= "a" && char <= "z" || char >= "0" && char <= "9" || char === "_" || char === "-";\n  }\n  function readIdentifier() {\n    let result2 = "";\n    skipSpaces();\n    while (!EOL && isCSSNameChar(next()))\n      result2 += eat1();\n    return result2;\n  }\n  function readQuotedString(quote) {\n    let result2 = eat1();\n    if (result2 !== quote)\n      syntaxError("parsing quoted string");\n    while (!EOL && next() !== quote) {\n      if (next() === "\\\\")\n        eat1();\n      result2 += eat1();\n    }\n    if (next() !== quote)\n      syntaxError("parsing quoted string");\n    result2 += eat1();\n    return result2;\n  }\n  function readRegularExpression() {\n    if (eat1() !== "/")\n      syntaxError("parsing regular expression");\n    let source = "";\n    let inClass = false;\n    while (!EOL) {\n      if (next() === "\\\\") {\n        source += eat1();\n        if (EOL)\n          syntaxError("parsing regular expressiion");\n      } else if (inClass && next() === "]") {\n        inClass = false;\n      } else if (!inClass && next() === "[") {\n        inClass = true;\n      } else if (!inClass && next() === "/") {\n        break;\n      }\n      source += eat1();\n    }\n    if (eat1() !== "/")\n      syntaxError("parsing regular expression");\n    let flags = "";\n    while (!EOL && next().match(/[dgimsuy]/))\n      flags += eat1();\n    try {\n      return new RegExp(source, flags);\n    } catch (e) {\n      throw new Error(`Error while parsing selector \\`${selector}\\`: ${e.message}`);\n    }\n  }\n  function readAttributeToken() {\n    let token = "";\n    skipSpaces();\n    if (next() === `\'` || next() === `"`)\n      token = readQuotedString(next()).slice(1, -1);\n    else\n      token = readIdentifier();\n    if (!token)\n      syntaxError("parsing property path");\n    return token;\n  }\n  function readOperator() {\n    skipSpaces();\n    let op = "";\n    if (!EOL)\n      op += eat1();\n    if (!EOL && op !== "=")\n      op += eat1();\n    if (!["=", "*=", "^=", "$=", "|=", "~="].includes(op))\n      syntaxError("parsing operator");\n    return op;\n  }\n  function readAttribute() {\n    eat1();\n    const jsonPath = [];\n    jsonPath.push(readAttributeToken());\n    skipSpaces();\n    while (next() === ".") {\n      eat1();\n      jsonPath.push(readAttributeToken());\n      skipSpaces();\n    }\n    if (next() === "]") {\n      eat1();\n      return { name: jsonPath.join("."), jsonPath, op: "<truthy>", value: null, caseSensitive: false };\n    }\n    const operator = readOperator();\n    let value = void 0;\n    let caseSensitive = true;\n    skipSpaces();\n    if (next() === "/") {\n      if (operator !== "=")\n        throw new Error(`Error while parsing selector \\`${selector}\\` - cannot use ${operator} in attribute with regular expression`);\n      value = readRegularExpression();\n    } else if (next() === `\'` || next() === `"`) {\n      value = readQuotedString(next()).slice(1, -1);\n      skipSpaces();\n      if (next() === "i" || next() === "I") {\n        caseSensitive = false;\n        eat1();\n      } else if (next() === "s" || next() === "S") {\n        caseSensitive = true;\n        eat1();\n      }\n    } else {\n      value = "";\n      while (!EOL && (isCSSNameChar(next()) || next() === "+" || next() === "."))\n        value += eat1();\n      if (value === "true") {\n        value = true;\n      } else if (value === "false") {\n        value = false;\n      } else {\n        if (!allowUnquotedStrings) {\n          value = +value;\n          if (Number.isNaN(value))\n            syntaxError("parsing attribute value");\n        }\n      }\n    }\n    skipSpaces();\n    if (next() !== "]")\n      syntaxError("parsing attribute value");\n    eat1();\n    if (operator !== "=" && typeof value !== "string")\n      throw new Error(`Error while parsing selector \\`${selector}\\` - cannot use ${operator} in attribute with non-string matching value - ${value}`);\n    return { name: jsonPath.join("."), jsonPath, op: operator, value, caseSensitive };\n  }\n  const result = {\n    name: "",\n    attributes: []\n  };\n  result.name = readIdentifier();\n  skipSpaces();\n  while (next() === "[") {\n    result.attributes.push(readAttribute());\n    skipSpaces();\n  }\n  if (!EOL)\n    syntaxError(void 0);\n  if (!result.name && !result.attributes.length)\n    throw new Error(`Error while parsing selector \\`${selector}\\` - selector cannot be empty`);\n  return result;\n}\n\n// packages/playwright-core/src/server/injected/reactSelectorEngine.ts\nfunction getComponentName(reactElement) {\n  if (typeof reactElement.type === "function")\n    return reactElement.type.displayName || reactElement.type.name || "Anonymous";\n  if (typeof reactElement.type === "string")\n    return reactElement.type;\n  if (reactElement._currentElement) {\n    const elementType = reactElement._currentElement.type;\n    if (typeof elementType === "string")\n      return elementType;\n    if (typeof elementType === "function")\n      return elementType.displayName || elementType.name || "Anonymous";\n  }\n  return "";\n}\nfunction getComponentKey(reactElement) {\n  var _a, _b;\n  return (_b = reactElement.key) != null ? _b : (_a = reactElement._currentElement) == null ? void 0 : _a.key;\n}\nfunction getChildren(reactElement) {\n  if (reactElement.child) {\n    const children = [];\n    for (let child = reactElement.child; child; child = child.sibling)\n      children.push(child);\n    return children;\n  }\n  if (!reactElement._currentElement)\n    return [];\n  const isKnownElement = (reactElement2) => {\n    var _a;\n    const elementType = (_a = reactElement2._currentElement) == null ? void 0 : _a.type;\n    return typeof elementType === "function" || typeof elementType === "string";\n  };\n  if (reactElement._renderedComponent) {\n    const child = reactElement._renderedComponent;\n    return isKnownElement(child) ? [child] : [];\n  }\n  if (reactElement._renderedChildren)\n    return [...Object.values(reactElement._renderedChildren)].filter(isKnownElement);\n  return [];\n}\nfunction getProps(reactElement) {\n  var _a;\n  const props = reactElement.memoizedProps || ((_a = reactElement._currentElement) == null ? void 0 : _a.props);\n  if (!props || typeof props === "string")\n    return props;\n  const result = { ...props };\n  delete result.children;\n  return result;\n}\nfunction buildComponentsTree(reactElement) {\n  var _a;\n  const treeNode = {\n    key: getComponentKey(reactElement),\n    name: getComponentName(reactElement),\n    children: getChildren(reactElement).map(buildComponentsTree),\n    rootElements: [],\n    props: getProps(reactElement)\n  };\n  const rootElement = reactElement.stateNode || reactElement._hostNode || ((_a = reactElement._renderedComponent) == null ? void 0 : _a._hostNode);\n  if (rootElement instanceof Element) {\n    treeNode.rootElements.push(rootElement);\n  } else {\n    for (const child of treeNode.children)\n      treeNode.rootElements.push(...child.rootElements);\n  }\n  return treeNode;\n}\nfunction filterComponentsTree(treeNode, searchFn, result = []) {\n  if (searchFn(treeNode))\n    result.push(treeNode);\n  for (const child of treeNode.children)\n    filterComponentsTree(child, searchFn, result);\n  return result;\n}\nfunction findReactRoots(root, roots = []) {\n  const walker = document.createTreeWalker(root, NodeFilter.SHOW_ELEMENT);\n  do {\n    const node = walker.currentNode;\n    if (node.hasOwnProperty("_reactRootContainer"))\n      roots.push(node._reactRootContainer._internalRoot.current);\n    if (node instanceof Element && node.hasAttribute("data-reactroot")) {\n      for (const key of Object.keys(node)) {\n        if (key.startsWith("__reactInternalInstance") || key.startsWith("__reactFiber"))\n          roots.push(node[key]);\n      }\n    }\n    const shadowRoot = node instanceof Element ? node.shadowRoot : null;\n    if (shadowRoot)\n      findReactRoots(shadowRoot, roots);\n  } while (walker.nextNode());\n  return roots;\n}\nvar ReactEngine = {\n  queryAll(scope, selector) {\n    const { name, attributes } = parseComponentSelector(selector, false);\n    const reactRoots = findReactRoots(document);\n    const trees = reactRoots.map((reactRoot) => buildComponentsTree(reactRoot));\n    const treeNodes = trees.map((tree) => filterComponentsTree(tree, (treeNode) => {\n      var _a;\n      const props = (_a = treeNode.props) != null ? _a : {};\n      if (treeNode.key !== void 0)\n        props.key = treeNode.key;\n      if (name && treeNode.name !== name)\n        return false;\n      if (treeNode.rootElements.some((domNode) => !isInsideScope(scope, domNode)))\n        return false;\n      for (const attr of attributes) {\n        if (!checkComponentAttribute(props, attr))\n          return false;\n      }\n      return true;\n    })).flat();\n    const allRootElements = /* @__PURE__ */ new Set();\n    for (const treeNode of treeNodes) {\n      for (const domNode of treeNode.rootElements)\n        allRootElements.add(domNode);\n    }\n    return [...allRootElements];\n  }\n};\n\n// packages/playwright-core/src/server/injected/vueSelectorEngine.ts\nfunction basename(filename, ext) {\n  const normalized = filename.replace(/^[a-zA-Z]:/, "").replace(/\\\\/g, "/");\n  let result = normalized.substring(normalized.lastIndexOf("/") + 1);\n  if (ext && result.endsWith(ext))\n    result = result.substring(0, result.length - ext.length);\n  return result;\n}\nfunction toUpper(_, c) {\n  return c ? c.toUpperCase() : "";\n}\nvar classifyRE = /(?:^|[-_/])(\\w)/g;\nvar classify = (str) => {\n  return str && str.replace(classifyRE, toUpper);\n};\nfunction buildComponentsTreeVue3(instance) {\n  function getComponentTypeName(options) {\n    const name = options.name || options._componentTag || options.__playwright_guessedName;\n    if (name)\n      return name;\n    const file = options.__file;\n    if (file)\n      return classify(basename(file, ".vue"));\n  }\n  function saveComponentName(instance2, key) {\n    instance2.type.__playwright_guessedName = key;\n    return key;\n  }\n  function getInstanceName(instance2) {\n    var _a, _b, _c, _d;\n    const name = getComponentTypeName(instance2.type || {});\n    if (name)\n      return name;\n    if (instance2.root === instance2)\n      return "Root";\n    for (const key in (_b = (_a = instance2.parent) == null ? void 0 : _a.type) == null ? void 0 : _b.components)\n      if (((_c = instance2.parent) == null ? void 0 : _c.type.components[key]) === instance2.type)\n        return saveComponentName(instance2, key);\n    for (const key in (_d = instance2.appContext) == null ? void 0 : _d.components)\n      if (instance2.appContext.components[key] === instance2.type)\n        return saveComponentName(instance2, key);\n    return "Anonymous Component";\n  }\n  function isBeingDestroyed(instance2) {\n    return instance2._isBeingDestroyed || instance2.isUnmounted;\n  }\n  function isFragment(instance2) {\n    return instance2.subTree.type.toString() === "Symbol(Fragment)";\n  }\n  function getInternalInstanceChildren(subTree) {\n    const list = [];\n    if (subTree.component)\n      list.push(subTree.component);\n    if (subTree.suspense)\n      list.push(...getInternalInstanceChildren(subTree.suspense.activeBranch));\n    if (Array.isArray(subTree.children)) {\n      subTree.children.forEach((childSubTree) => {\n        if (childSubTree.component)\n          list.push(childSubTree.component);\n        else\n          list.push(...getInternalInstanceChildren(childSubTree));\n      });\n    }\n    return list.filter((child) => {\n      var _a;\n      return !isBeingDestroyed(child) && !((_a = child.type.devtools) == null ? void 0 : _a.hide);\n    });\n  }\n  function getRootElementsFromComponentInstance(instance2) {\n    if (isFragment(instance2))\n      return getFragmentRootElements(instance2.subTree);\n    return [instance2.subTree.el];\n  }\n  function getFragmentRootElements(vnode) {\n    if (!vnode.children)\n      return [];\n    const list = [];\n    for (let i = 0, l = vnode.children.length; i < l; i++) {\n      const childVnode = vnode.children[i];\n      if (childVnode.component)\n        list.push(...getRootElementsFromComponentInstance(childVnode.component));\n      else if (childVnode.el)\n        list.push(childVnode.el);\n    }\n    return list;\n  }\n  function buildComponentsTree2(instance2) {\n    return {\n      name: getInstanceName(instance2),\n      children: getInternalInstanceChildren(instance2.subTree).map(buildComponentsTree2),\n      rootElements: getRootElementsFromComponentInstance(instance2),\n      props: instance2.props\n    };\n  }\n  return buildComponentsTree2(instance);\n}\nfunction buildComponentsTreeVue2(instance) {\n  function getComponentName2(options) {\n    const name = options.displayName || options.name || options._componentTag;\n    if (name)\n      return name;\n    const file = options.__file;\n    if (file)\n      return classify(basename(file, ".vue"));\n  }\n  function getInstanceName(instance2) {\n    const name = getComponentName2(instance2.$options || instance2.fnOptions || {});\n    if (name)\n      return name;\n    return instance2.$root === instance2 ? "Root" : "Anonymous Component";\n  }\n  function getInternalInstanceChildren(instance2) {\n    if (instance2.$children)\n      return instance2.$children;\n    if (Array.isArray(instance2.subTree.children))\n      return instance2.subTree.children.filter((vnode) => !!vnode.component).map((vnode) => vnode.component);\n    return [];\n  }\n  function buildComponentsTree2(instance2) {\n    return {\n      name: getInstanceName(instance2),\n      children: getInternalInstanceChildren(instance2).map(buildComponentsTree2),\n      rootElements: [instance2.$el],\n      props: instance2._props\n    };\n  }\n  return buildComponentsTree2(instance);\n}\nfunction filterComponentsTree2(treeNode, searchFn, result = []) {\n  if (searchFn(treeNode))\n    result.push(treeNode);\n  for (const child of treeNode.children)\n    filterComponentsTree2(child, searchFn, result);\n  return result;\n}\nfunction findVueRoots(root, roots = []) {\n  const walker = document.createTreeWalker(root, NodeFilter.SHOW_ELEMENT);\n  const vue2Roots = /* @__PURE__ */ new Set();\n  do {\n    const node = walker.currentNode;\n    if (node.__vue__)\n      vue2Roots.add(node.__vue__.$root);\n    if (node.__vue_app__ && node._vnode && node._vnode.component)\n      roots.push({ root: node._vnode.component, version: 3 });\n    const shadowRoot = node instanceof Element ? node.shadowRoot : null;\n    if (shadowRoot)\n      findVueRoots(shadowRoot, roots);\n  } while (walker.nextNode());\n  for (const vue2root of vue2Roots) {\n    roots.push({\n      version: 2,\n      root: vue2root\n    });\n  }\n  return roots;\n}\nvar VueEngine = {\n  queryAll(scope, selector) {\n    const { name, attributes } = parseComponentSelector(selector, false);\n    const vueRoots = findVueRoots(document);\n    const trees = vueRoots.map((vueRoot) => vueRoot.version === 3 ? buildComponentsTreeVue3(vueRoot.root) : buildComponentsTreeVue2(vueRoot.root));\n    const treeNodes = trees.map((tree) => filterComponentsTree2(tree, (treeNode) => {\n      if (name && treeNode.name !== name)\n        return false;\n      if (treeNode.rootElements.some((rootElement) => !isInsideScope(scope, rootElement)))\n        return false;\n      for (const attr of attributes) {\n        if (!checkComponentAttribute(treeNode.props, attr))\n          return false;\n      }\n      return true;\n    })).flat();\n    const allRootElements = /* @__PURE__ */ new Set();\n    for (const treeNode of treeNodes) {\n      for (const rootElement of treeNode.rootElements)\n        allRootElements.add(rootElement);\n    }\n    return [...allRootElements];\n  }\n};\n\n// packages/playwright-core/src/server/injected/roleUtils.ts\nfunction hasExplicitAccessibleName(e) {\n  return e.hasAttribute("aria-label") || e.hasAttribute("aria-labelledby");\n}\nvar kAncestorPreventingLandmark = "article:not([role]), aside:not([role]), main:not([role]), nav:not([role]), section:not([role]), [role=article], [role=complementary], [role=main], [role=navigation], [role=region]";\nvar kGlobalAriaAttributes = [\n  "aria-atomic",\n  "aria-busy",\n  "aria-controls",\n  "aria-current",\n  "aria-describedby",\n  "aria-details",\n  "aria-disabled",\n  "aria-dropeffect",\n  "aria-errormessage",\n  "aria-flowto",\n  "aria-grabbed",\n  "aria-haspopup",\n  "aria-hidden",\n  "aria-invalid",\n  "aria-keyshortcuts",\n  "aria-label",\n  "aria-labelledby",\n  "aria-live",\n  "aria-owns",\n  "aria-relevant",\n  "aria-roledescription"\n];\nfunction hasGlobalAriaAttribute(e) {\n  return kGlobalAriaAttributes.some((a) => e.hasAttribute(a));\n}\nvar kImplicitRoleByTagName = {\n  "A": (e) => {\n    return e.hasAttribute("href") ? "link" : null;\n  },\n  "AREA": (e) => {\n    return e.hasAttribute("href") ? "link" : null;\n  },\n  "ARTICLE": () => "article",\n  "ASIDE": () => "complementary",\n  "BLOCKQUOTE": () => "blockquote",\n  "BUTTON": () => "button",\n  "CAPTION": () => "caption",\n  "CODE": () => "code",\n  "DATALIST": () => "listbox",\n  "DD": () => "definition",\n  "DEL": () => "deletion",\n  "DETAILS": () => "group",\n  "DFN": () => "term",\n  "DIALOG": () => "dialog",\n  "DT": () => "term",\n  "EM": () => "emphasis",\n  "FIELDSET": () => "group",\n  "FIGURE": () => "figure",\n  "FOOTER": (e) => closestCrossShadow(e, kAncestorPreventingLandmark) ? null : "contentinfo",\n  "FORM": (e) => hasExplicitAccessibleName(e) ? "form" : null,\n  "H1": () => "heading",\n  "H2": () => "heading",\n  "H3": () => "heading",\n  "H4": () => "heading",\n  "H5": () => "heading",\n  "H6": () => "heading",\n  "HEADER": (e) => closestCrossShadow(e, kAncestorPreventingLandmark) ? null : "banner",\n  "HR": () => "separator",\n  "HTML": () => "document",\n  "IMG": (e) => e.getAttribute("alt") === "" && !hasGlobalAriaAttribute(e) && Number.isNaN(Number(String(e.getAttribute("tabindex")))) ? "presentation" : "img",\n  "INPUT": (e) => {\n    const type = e.type.toLowerCase();\n    if (type === "search")\n      return e.hasAttribute("list") ? "combobox" : "searchbox";\n    if (["email", "tel", "text", "url", ""].includes(type)) {\n      const list = getIdRefs(e, e.getAttribute("list"))[0];\n      return list && list.tagName === "DATALIST" ? "combobox" : "textbox";\n    }\n    if (type === "hidden")\n      return "";\n    return {\n      "button": "button",\n      "checkbox": "checkbox",\n      "image": "button",\n      "number": "spinbutton",\n      "radio": "radio",\n      "range": "slider",\n      "reset": "button",\n      "submit": "button"\n    }[type] || "textbox";\n  },\n  "INS": () => "insertion",\n  "LI": () => "listitem",\n  "MAIN": () => "main",\n  "MARK": () => "mark",\n  "MATH": () => "math",\n  "MENU": () => "list",\n  "METER": () => "meter",\n  "NAV": () => "navigation",\n  "OL": () => "list",\n  "OPTGROUP": () => "group",\n  "OPTION": () => "option",\n  "OUTPUT": () => "status",\n  "P": () => "paragraph",\n  "PROGRESS": () => "progressbar",\n  "SECTION": (e) => hasExplicitAccessibleName(e) ? "region" : null,\n  "SELECT": (e) => e.hasAttribute("multiple") || e.size > 1 ? "listbox" : "combobox",\n  "STRONG": () => "strong",\n  "SUB": () => "subscript",\n  "SUP": () => "superscript",\n  "TABLE": () => "table",\n  "TBODY": () => "rowgroup",\n  "TD": (e) => {\n    const table = closestCrossShadow(e, "table");\n    const role = table ? getExplicitAriaRole(table) : "";\n    return role === "grid" || role === "treegrid" ? "gridcell" : "cell";\n  },\n  "TEXTAREA": () => "textbox",\n  "TFOOT": () => "rowgroup",\n  "TH": (e) => {\n    if (e.getAttribute("scope") === "col")\n      return "columnheader";\n    if (e.getAttribute("scope") === "row")\n      return "rowheader";\n    const table = closestCrossShadow(e, "table");\n    const role = table ? getExplicitAriaRole(table) : "";\n    return role === "grid" || role === "treegrid" ? "gridcell" : "cell";\n  },\n  "THEAD": () => "rowgroup",\n  "TIME": () => "time",\n  "TR": () => "row",\n  "UL": () => "list"\n};\nvar kPresentationInheritanceParents = {\n  "DD": ["DL", "DIV"],\n  "DIV": ["DL"],\n  "DT": ["DL", "DIV"],\n  "LI": ["OL", "UL"],\n  "TBODY": ["TABLE"],\n  "TD": ["TR"],\n  "TFOOT": ["TABLE"],\n  "TH": ["TR"],\n  "THEAD": ["TABLE"],\n  "TR": ["THEAD", "TBODY", "TFOOT", "TABLE"]\n};\nfunction getImplicitAriaRole(element) {\n  var _a;\n  const implicitRole = ((_a = kImplicitRoleByTagName[element.tagName]) == null ? void 0 : _a.call(kImplicitRoleByTagName, element)) || "";\n  if (!implicitRole)\n    return null;\n  let ancestor = element;\n  while (ancestor) {\n    const parent = parentElementOrShadowHost(ancestor);\n    const parents = kPresentationInheritanceParents[ancestor.tagName];\n    if (!parents || !parent || !parents.includes(parent.tagName))\n      break;\n    const parentExplicitRole = getExplicitAriaRole(parent);\n    if ((parentExplicitRole === "none" || parentExplicitRole === "presentation") && !hasPresentationConflictResolution(parent))\n      return parentExplicitRole;\n    ancestor = parent;\n  }\n  return implicitRole;\n}\nvar allRoles = [\n  "alert",\n  "alertdialog",\n  "application",\n  "article",\n  "banner",\n  "blockquote",\n  "button",\n  "caption",\n  "cell",\n  "checkbox",\n  "code",\n  "columnheader",\n  "combobox",\n  "command",\n  "complementary",\n  "composite",\n  "contentinfo",\n  "definition",\n  "deletion",\n  "dialog",\n  "directory",\n  "document",\n  "emphasis",\n  "feed",\n  "figure",\n  "form",\n  "generic",\n  "grid",\n  "gridcell",\n  "group",\n  "heading",\n  "img",\n  "input",\n  "insertion",\n  "landmark",\n  "link",\n  "list",\n  "listbox",\n  "listitem",\n  "log",\n  "main",\n  "marquee",\n  "math",\n  "meter",\n  "menu",\n  "menubar",\n  "menuitem",\n  "menuitemcheckbox",\n  "menuitemradio",\n  "navigation",\n  "none",\n  "note",\n  "option",\n  "paragraph",\n  "presentation",\n  "progressbar",\n  "radio",\n  "radiogroup",\n  "range",\n  "region",\n  "roletype",\n  "row",\n  "rowgroup",\n  "rowheader",\n  "scrollbar",\n  "search",\n  "searchbox",\n  "section",\n  "sectionhead",\n  "select",\n  "separator",\n  "slider",\n  "spinbutton",\n  "status",\n  "strong",\n  "structure",\n  "subscript",\n  "superscript",\n  "switch",\n  "tab",\n  "table",\n  "tablist",\n  "tabpanel",\n  "term",\n  "textbox",\n  "time",\n  "timer",\n  "toolbar",\n  "tooltip",\n  "tree",\n  "treegrid",\n  "treeitem",\n  "widget",\n  "window"\n];\nvar abstractRoles = ["command", "composite", "input", "landmark", "range", "roletype", "section", "sectionhead", "select", "structure", "widget", "window"];\nvar validRoles = allRoles.filter((role) => !abstractRoles.includes(role));\nfunction getExplicitAriaRole(element) {\n  const roles = (element.getAttribute("role") || "").split(" ").map((role) => role.trim());\n  return roles.find((role) => validRoles.includes(role)) || null;\n}\nfunction hasPresentationConflictResolution(element) {\n  return !hasGlobalAriaAttribute(element);\n}\nfunction getAriaRole(element) {\n  const explicitRole = getExplicitAriaRole(element);\n  if (!explicitRole)\n    return getImplicitAriaRole(element);\n  if ((explicitRole === "none" || explicitRole === "presentation") && hasPresentationConflictResolution(element))\n    return getImplicitAriaRole(element);\n  return explicitRole;\n}\nfunction getAriaBoolean(attr) {\n  return attr === null ? void 0 : attr.toLowerCase() === "true";\n}\nfunction getComputedStyle(element, pseudo) {\n  return element.ownerDocument && element.ownerDocument.defaultView ? element.ownerDocument.defaultView.getComputedStyle(element, pseudo) : void 0;\n}\nfunction isElementHiddenForAria(element, cache) {\n  if (["STYLE", "SCRIPT", "NOSCRIPT", "TEMPLATE"].includes(element.tagName))\n    return true;\n  const style = getComputedStyle(element);\n  if (!style || style.visibility === "hidden")\n    return true;\n  return belongsToDisplayNoneOrAriaHidden(element, cache);\n}\nfunction belongsToDisplayNoneOrAriaHidden(element, cache) {\n  if (!cache.has(element)) {\n    const style = getComputedStyle(element);\n    let hidden = !style || style.display === "none" || getAriaBoolean(element.getAttribute("aria-hidden")) === true;\n    if (!hidden) {\n      const parent = parentElementOrShadowHost(element);\n      if (parent)\n        hidden = hidden || belongsToDisplayNoneOrAriaHidden(parent, cache);\n    }\n    cache.set(element, hidden);\n  }\n  return cache.get(element);\n}\nfunction getIdRefs(element, ref) {\n  if (!ref)\n    return [];\n  const root = enclosingShadowRootOrDocument(element);\n  if (!root)\n    return [];\n  try {\n    const ids = ref.split(" ").filter((id) => !!id);\n    const set = /* @__PURE__ */ new Set();\n    for (const id of ids) {\n      const firstElement = root.querySelector("#" + CSS.escape(id));\n      if (firstElement)\n        set.add(firstElement);\n    }\n    return [...set];\n  } catch (e) {\n    return [];\n  }\n}\nfunction normalizeAccessbileName(s) {\n  return s.replace(/\\r\\n/g, "\\n").replace(/\\u00A0/g, " ").replace(/\\s\\s+/g, " ").trim();\n}\nfunction queryInAriaOwned(element, selector) {\n  const result = [...element.querySelectorAll(selector)];\n  for (const owned of getIdRefs(element, element.getAttribute("aria-owns"))) {\n    if (owned.matches(selector))\n      result.push(owned);\n    result.push(...owned.querySelectorAll(selector));\n  }\n  return result;\n}\nfunction getPseudoContent(pseudoStyle) {\n  if (!pseudoStyle)\n    return "";\n  const content = pseudoStyle.getPropertyValue("content");\n  if (content[0] === "\'" && content[content.length - 1] === "\'" || content[0] === \'"\' && content[content.length - 1] === \'"\') {\n    const unquoted = content.substring(1, content.length - 1);\n    const display = pseudoStyle.getPropertyValue("display") || "inline";\n    if (display !== "inline")\n      return " " + unquoted + " ";\n    return unquoted;\n  }\n  return "";\n}\nfunction getElementAccessibleName(element, includeHidden, hiddenCache) {\n  const elementProhibitsNaming = ["caption", "code", "definition", "deletion", "emphasis", "generic", "insertion", "mark", "paragraph", "presentation", "strong", "subscript", "suggestion", "superscript", "term", "time"].includes(getAriaRole(element) || "");\n  if (elementProhibitsNaming)\n    return "";\n  const accessibleName = normalizeAccessbileName(getElementAccessibleNameInternal(element, {\n    includeHidden,\n    hiddenCache,\n    visitedElements: /* @__PURE__ */ new Set(),\n    embeddedInLabelledBy: "none",\n    embeddedInLabel: "none",\n    embeddedInTextAlternativeElement: false,\n    embeddedInTargetElement: "self"\n  }));\n  return accessibleName;\n}\nfunction getElementAccessibleNameInternal(element, options) {\n  if (options.visitedElements.has(element))\n    return "";\n  const childOptions = {\n    ...options,\n    embeddedInLabel: options.embeddedInLabel === "self" ? "descendant" : options.embeddedInLabel,\n    embeddedInLabelledBy: options.embeddedInLabelledBy === "self" ? "descendant" : options.embeddedInLabelledBy,\n    embeddedInTargetElement: options.embeddedInTargetElement === "self" ? "descendant" : options.embeddedInTargetElement\n  };\n  if (!options.includeHidden && options.embeddedInLabelledBy !== "self" && isElementHiddenForAria(element, options.hiddenCache)) {\n    options.visitedElements.add(element);\n    return "";\n  }\n  if (options.embeddedInLabelledBy === "none") {\n    const refs = getIdRefs(element, element.getAttribute("aria-labelledby"));\n    const accessibleName = refs.map((ref) => getElementAccessibleNameInternal(ref, {\n      ...options,\n      embeddedInLabelledBy: "self",\n      embeddedInTargetElement: "none",\n      embeddedInLabel: "none",\n      embeddedInTextAlternativeElement: false\n    })).join(" ");\n    if (accessibleName)\n      return accessibleName;\n  }\n  const role = getAriaRole(element) || "";\n  if (options.embeddedInLabel !== "none" || options.embeddedInLabelledBy !== "none") {\n    const isOwnLabel = [...element.labels || []].includes(element);\n    const isOwnLabelledBy = getIdRefs(element, element.getAttribute("aria-labelledby")).includes(element);\n    if (!isOwnLabel && !isOwnLabelledBy) {\n      if (role === "textbox") {\n        options.visitedElements.add(element);\n        if (element.tagName === "INPUT" || element.tagName === "TEXTAREA")\n          return element.value;\n        return element.textContent || "";\n      }\n      if (["combobox", "listbox"].includes(role)) {\n        options.visitedElements.add(element);\n        let selectedOptions;\n        if (element.tagName === "SELECT") {\n          selectedOptions = [...element.selectedOptions];\n          if (!selectedOptions.length && element.options.length)\n            selectedOptions.push(element.options[0]);\n        } else {\n          const listbox = role === "combobox" ? queryInAriaOwned(element, "*").find((e) => getAriaRole(e) === "listbox") : element;\n          selectedOptions = listbox ? queryInAriaOwned(listbox, \'[aria-selected="true"]\').filter((e) => getAriaRole(e) === "option") : [];\n        }\n        return selectedOptions.map((option) => getElementAccessibleNameInternal(option, childOptions)).join(" ");\n      }\n      if (["progressbar", "scrollbar", "slider", "spinbutton", "meter"].includes(role)) {\n        options.visitedElements.add(element);\n        if (element.hasAttribute("aria-valuetext"))\n          return element.getAttribute("aria-valuetext") || "";\n        if (element.hasAttribute("aria-valuenow"))\n          return element.getAttribute("aria-valuenow") || "";\n        return element.getAttribute("value") || "";\n      }\n      if (["menu"].includes(role)) {\n        options.visitedElements.add(element);\n        return "";\n      }\n    }\n  }\n  const ariaLabel = element.getAttribute("aria-label") || "";\n  if (ariaLabel.trim()) {\n    options.visitedElements.add(element);\n    return ariaLabel;\n  }\n  if (!["presentation", "none"].includes(role)) {\n    if (element.tagName === "INPUT" && ["button", "submit", "reset"].includes(element.type)) {\n      options.visitedElements.add(element);\n      const value = element.value || "";\n      if (value.trim())\n        return value;\n      if (element.type === "submit")\n        return "Submit";\n      if (element.type === "reset")\n        return "Reset";\n      const title = element.getAttribute("title") || "";\n      return title;\n    }\n    if (element.tagName === "INPUT" && element.type === "image") {\n      options.visitedElements.add(element);\n      const alt = element.getAttribute("alt") || "";\n      if (alt.trim())\n        return alt;\n      const labels = element.labels || [];\n      if (labels.length) {\n        return [...labels].map((label) => getElementAccessibleNameInternal(label, {\n          ...options,\n          embeddedInLabel: "self",\n          embeddedInTextAlternativeElement: false,\n          embeddedInLabelledBy: "none",\n          embeddedInTargetElement: "none"\n        })).filter((accessibleName) => !!accessibleName).join(" ");\n      }\n      const title = element.getAttribute("title") || "";\n      if (title.trim())\n        return title;\n      return "Submit";\n    }\n    if (element.tagName === "TEXTAREA" || element.tagName === "SELECT" || element.tagName === "INPUT") {\n      options.visitedElements.add(element);\n      const labels = element.labels || [];\n      if (labels.length) {\n        return [...labels].map((label) => getElementAccessibleNameInternal(label, {\n          ...options,\n          embeddedInLabel: "self",\n          embeddedInTextAlternativeElement: false,\n          embeddedInLabelledBy: "none",\n          embeddedInTargetElement: "none"\n        })).filter((accessibleName) => !!accessibleName).join(" ");\n      }\n      const usePlaceholder = element.tagName === "INPUT" && ["text", "password", "search", "tel", "email", "url"].includes(element.type) || element.tagName === "TEXTAREA";\n      const placeholder = element.getAttribute("placeholder") || "";\n      const title = element.getAttribute("title") || "";\n      if (!usePlaceholder || title)\n        return title;\n      return placeholder;\n    }\n    if (element.tagName === "FIELDSET") {\n      options.visitedElements.add(element);\n      for (let child = element.firstElementChild; child; child = child.nextElementSibling) {\n        if (child.tagName === "LEGEND") {\n          return getElementAccessibleNameInternal(child, {\n            ...childOptions,\n            embeddedInTextAlternativeElement: true\n          });\n        }\n      }\n      const title = element.getAttribute("title") || "";\n      return title;\n    }\n    if (element.tagName === "FIGURE") {\n      options.visitedElements.add(element);\n      for (let child = element.firstElementChild; child; child = child.nextElementSibling) {\n        if (child.tagName === "FIGCAPTION") {\n          return getElementAccessibleNameInternal(child, {\n            ...childOptions,\n            embeddedInTextAlternativeElement: true\n          });\n        }\n      }\n      const title = element.getAttribute("title") || "";\n      return title;\n    }\n    if (element.tagName === "IMG") {\n      options.visitedElements.add(element);\n      const alt = element.getAttribute("alt") || "";\n      if (alt.trim())\n        return alt;\n      const title = element.getAttribute("title") || "";\n      return title;\n    }\n    if (element.tagName === "TABLE") {\n      options.visitedElements.add(element);\n      for (let child = element.firstElementChild; child; child = child.nextElementSibling) {\n        if (child.tagName === "CAPTION") {\n          return getElementAccessibleNameInternal(child, {\n            ...childOptions,\n            embeddedInTextAlternativeElement: true\n          });\n        }\n      }\n      const summary = element.getAttribute("summary") || "";\n      if (summary)\n        return summary;\n    }\n    if (element.tagName === "AREA") {\n      options.visitedElements.add(element);\n      const alt = element.getAttribute("alt") || "";\n      if (alt.trim())\n        return alt;\n      const title = element.getAttribute("title") || "";\n      return title;\n    }\n    if (element.tagName === "SVG" && element.ownerSVGElement) {\n      options.visitedElements.add(element);\n      for (let child = element.firstElementChild; child; child = child.nextElementSibling) {\n        if (child.tagName === "TITLE" && element.ownerSVGElement) {\n          return getElementAccessibleNameInternal(child, {\n            ...childOptions,\n            embeddedInTextAlternativeElement: true\n          });\n        }\n      }\n    }\n  }\n  const allowsNameFromContent = ["button", "cell", "checkbox", "columnheader", "gridcell", "heading", "link", "menuitem", "menuitemcheckbox", "menuitemradio", "option", "radio", "row", "rowheader", "switch", "tab", "tooltip", "treeitem"].includes(role);\n  if (allowsNameFromContent || options.embeddedInLabelledBy !== "none" || options.embeddedInLabel !== "none" || options.embeddedInTextAlternativeElement || options.embeddedInTargetElement === "descendant") {\n    options.visitedElements.add(element);\n    const tokens = [];\n    const visit = (node) => {\n      var _a;\n      if (node.nodeType === 1) {\n        const display = ((_a = getComputedStyle(node)) == null ? void 0 : _a.getPropertyValue("display")) || "inline";\n        let token = getElementAccessibleNameInternal(node, childOptions);\n        if (display !== "inline" || node.nodeName === "BR")\n          token = " " + token + " ";\n        tokens.push(token);\n      } else if (node.nodeType === 3) {\n        tokens.push(node.textContent || "");\n      }\n    };\n    tokens.push(getPseudoContent(getComputedStyle(element, "::before")));\n    for (let child = element.firstChild; child; child = child.nextSibling)\n      visit(child);\n    if (element.shadowRoot) {\n      for (let child = element.shadowRoot.firstChild; child; child = child.nextSibling)\n        visit(child);\n    }\n    for (const owned of getIdRefs(element, element.getAttribute("aria-owns")))\n      visit(owned);\n    tokens.push(getPseudoContent(getComputedStyle(element, "::after")));\n    const accessibleName = tokens.join("");\n    if (accessibleName.trim())\n      return accessibleName;\n  }\n  if (!["presentation", "none"].includes(role) || element.tagName === "IFRAME") {\n    options.visitedElements.add(element);\n    const title = element.getAttribute("title") || "";\n    if (title.trim())\n      return title;\n  }\n  options.visitedElements.add(element);\n  return "";\n}\nvar kAriaSelectedRoles = ["gridcell", "option", "row", "tab", "rowheader", "columnheader", "treeitem"];\nfunction getAriaSelected(element) {\n  if (element.tagName === "OPTION")\n    return element.selected;\n  if (kAriaSelectedRoles.includes(getAriaRole(element) || ""))\n    return getAriaBoolean(element.getAttribute("aria-selected")) === true;\n  return false;\n}\nvar kAriaCheckedRoles = ["checkbox", "menuitemcheckbox", "option", "radio", "switch", "menuitemradio", "treeitem"];\nfunction getAriaChecked(element) {\n  if (element.tagName === "INPUT" && element.indeterminate)\n    return "mixed";\n  if (element.tagName === "INPUT" && ["checkbox", "radio"].includes(element.type))\n    return element.checked;\n  if (kAriaCheckedRoles.includes(getAriaRole(element) || "")) {\n    const checked = element.getAttribute("aria-checked");\n    if (checked === "true")\n      return true;\n    if (checked === "mixed")\n      return "mixed";\n  }\n  return false;\n}\nvar kAriaPressedRoles = ["button"];\nfunction getAriaPressed(element) {\n  if (kAriaPressedRoles.includes(getAriaRole(element) || "")) {\n    const pressed = element.getAttribute("aria-pressed");\n    if (pressed === "true")\n      return true;\n    if (pressed === "mixed")\n      return "mixed";\n  }\n  return false;\n}\nvar kAriaExpandedRoles = ["application", "button", "checkbox", "combobox", "gridcell", "link", "listbox", "menuitem", "row", "rowheader", "tab", "treeitem", "columnheader", "menuitemcheckbox", "menuitemradio", "rowheader", "switch"];\nfunction getAriaExpanded(element) {\n  if (element.tagName === "DETAILS")\n    return element.open;\n  if (kAriaExpandedRoles.includes(getAriaRole(element) || ""))\n    return getAriaBoolean(element.getAttribute("aria-expanded")) === true;\n  return false;\n}\nvar kAriaLevelRoles = ["heading", "listitem", "row", "treeitem"];\nfunction getAriaLevel(element) {\n  const native = { "H1": 1, "H2": 2, "H3": 3, "H4": 4, "H5": 5, "H6": 6 }[element.tagName];\n  if (native)\n    return native;\n  if (kAriaLevelRoles.includes(getAriaRole(element) || "")) {\n    const attr = element.getAttribute("aria-level");\n    const value = attr === null ? Number.NaN : Number(attr);\n    if (Number.isInteger(value) && value >= 1)\n      return value;\n  }\n  return 0;\n}\nvar kAriaDisabledRoles = ["application", "button", "composite", "gridcell", "group", "input", "link", "menuitem", "scrollbar", "separator", "tab", "checkbox", "columnheader", "combobox", "grid", "listbox", "menu", "menubar", "menuitemcheckbox", "menuitemradio", "option", "radio", "radiogroup", "row", "rowheader", "searchbox", "select", "slider", "spinbutton", "switch", "tablist", "textbox", "toolbar", "tree", "treegrid", "treeitem"];\nfunction getAriaDisabled(element) {\n  const isNativeFormControl = ["BUTTON", "INPUT", "SELECT", "TEXTAREA", "OPTION", "OPTGROUP"].includes(element.tagName);\n  if (isNativeFormControl && (element.hasAttribute("disabled") || belongsToDisabledFieldSet(element)))\n    return true;\n  return hasExplicitAriaDisabled(element);\n}\nfunction belongsToDisabledFieldSet(element) {\n  if (!element)\n    return false;\n  if (element.tagName === "FIELDSET" && element.hasAttribute("disabled"))\n    return true;\n  return belongsToDisabledFieldSet(element.parentElement);\n}\nfunction hasExplicitAriaDisabled(element) {\n  if (!element)\n    return false;\n  if (kAriaDisabledRoles.includes(getAriaRole(element) || "")) {\n    const attribute = (element.getAttribute("aria-disabled") || "").toLowerCase();\n    if (attribute === "true")\n      return true;\n    if (attribute === "false")\n      return false;\n  }\n  return hasExplicitAriaDisabled(parentElementOrShadowHost(element));\n}\n\n// packages/playwright-core/src/server/injected/roleSelectorEngine.ts\nvar kSupportedAttributes = ["selected", "checked", "pressed", "expanded", "level", "disabled", "name", "include-hidden"];\nkSupportedAttributes.sort();\nfunction validateSupportedRole(attr, roles, role) {\n  if (!roles.includes(role))\n    throw new Error(`"${attr}" attribute is only supported for roles: ${roles.slice().sort().map((role2) => `"${role2}"`).join(", ")}`);\n}\nfunction validateSupportedValues(attr, values) {\n  if (attr.op !== "<truthy>" && !values.includes(attr.value))\n    throw new Error(`"${attr.name}" must be one of ${values.map((v) => JSON.stringify(v)).join(", ")}`);\n}\nfunction validateSupportedOp(attr, ops) {\n  if (!ops.includes(attr.op))\n    throw new Error(`"${attr.name}" does not support "${attr.op}" matcher`);\n}\nfunction validateAttributes(attrs, role) {\n  for (const attr of attrs) {\n    switch (attr.name) {\n      case "checked": {\n        validateSupportedRole(attr.name, kAriaCheckedRoles, role);\n        validateSupportedValues(attr, [true, false, "mixed"]);\n        validateSupportedOp(attr, ["<truthy>", "="]);\n        if (attr.op === "<truthy>") {\n          attr.op = "=";\n          attr.value = true;\n        }\n        break;\n      }\n      case "pressed": {\n        validateSupportedRole(attr.name, kAriaPressedRoles, role);\n        validateSupportedValues(attr, [true, false, "mixed"]);\n        validateSupportedOp(attr, ["<truthy>", "="]);\n        if (attr.op === "<truthy>") {\n          attr.op = "=";\n          attr.value = true;\n        }\n        break;\n      }\n      case "selected": {\n        validateSupportedRole(attr.name, kAriaSelectedRoles, role);\n        validateSupportedValues(attr, [true, false]);\n        validateSupportedOp(attr, ["<truthy>", "="]);\n        break;\n      }\n      case "expanded": {\n        validateSupportedRole(attr.name, kAriaExpandedRoles, role);\n        validateSupportedValues(attr, [true, false]);\n        validateSupportedOp(attr, ["<truthy>", "="]);\n        break;\n      }\n      case "level": {\n        validateSupportedRole(attr.name, kAriaLevelRoles, role);\n        if (typeof attr.value === "string")\n          attr.value = +attr.value;\n        if (attr.op !== "=" || typeof attr.value !== "number" || Number.isNaN(attr.value))\n          throw new Error(`"level" attribute must be compared to a number`);\n        break;\n      }\n      case "disabled": {\n        validateSupportedValues(attr, [true, false]);\n        validateSupportedOp(attr, ["<truthy>", "="]);\n        break;\n      }\n      case "name": {\n        if (attr.op === "<truthy>")\n          throw new Error(`"name" attribute must have a value`);\n        if (typeof attr.value !== "string" && !(attr.value instanceof RegExp))\n          throw new Error(`"name" attribute must be a string or a regular expression`);\n        break;\n      }\n      case "include-hidden": {\n        validateSupportedValues(attr, [true, false]);\n        validateSupportedOp(attr, ["<truthy>", "="]);\n        break;\n      }\n      default: {\n        throw new Error(`Unknown attribute "${attr.name}", must be one of ${kSupportedAttributes.map((a) => `"${a}"`).join(", ")}.`);\n      }\n    }\n  }\n}\nvar RoleEngine = {\n  queryAll(scope, selector) {\n    const parsed = parseComponentSelector(selector, true);\n    const role = parsed.name.toLowerCase();\n    if (!role)\n      throw new Error(`Role must not be empty`);\n    validateAttributes(parsed.attributes, role);\n    const hiddenCache = /* @__PURE__ */ new Map();\n    const result = [];\n    const match = (element) => {\n      if (getAriaRole(element) !== role)\n        return;\n      let includeHidden = false;\n      let nameAttr;\n      for (const attr of parsed.attributes) {\n        if (attr.name === "include-hidden") {\n          includeHidden = attr.op === "<truthy>" || !!attr.value;\n          continue;\n        }\n        if (attr.name === "name") {\n          nameAttr = attr;\n          continue;\n        }\n        let actual;\n        switch (attr.name) {\n          case "selected":\n            actual = getAriaSelected(element);\n            break;\n          case "checked":\n            actual = getAriaChecked(element);\n            break;\n          case "pressed":\n            actual = getAriaPressed(element);\n            break;\n          case "expanded":\n            actual = getAriaExpanded(element);\n            break;\n          case "level":\n            actual = getAriaLevel(element);\n            break;\n          case "disabled":\n            actual = getAriaDisabled(element);\n            break;\n        }\n        if (!matchesAttribute(actual, attr))\n          return;\n      }\n      if (!includeHidden) {\n        const isHidden = isElementHiddenForAria(element, hiddenCache);\n        if (isHidden)\n          return;\n      }\n      if (nameAttr !== void 0) {\n        const accessibleName = getElementAccessibleName(element, includeHidden, hiddenCache);\n        if (!matchesAttribute(accessibleName, nameAttr))\n          return;\n      }\n      result.push(element);\n    };\n    const query = (root) => {\n      const shadows = [];\n      if (root.shadowRoot)\n        shadows.push(root.shadowRoot);\n      for (const element of root.querySelectorAll("*")) {\n        match(element);\n        if (element.shadowRoot)\n          shadows.push(element.shadowRoot);\n      }\n      shadows.forEach(query);\n    };\n    query(scope);\n    return result;\n  }\n};\n\n// packages/playwright-core/src/server/injected/selectorGenerator.ts\nvar cacheAllowText = /* @__PURE__ */ new Map();\nvar cacheDisallowText = /* @__PURE__ */ new Map();\nvar kNthScore = 1e3;\nfunction generateSelector(injectedScript, targetElement, strict) {\n  injectedScript._evaluator.begin();\n  try {\n    targetElement = targetElement.closest("button,select,input,[role=button],[role=checkbox],[role=radio]") || targetElement;\n    const targetTokens = generateSelectorFor(injectedScript, targetElement, strict);\n    const bestTokens = targetTokens || cssFallback(injectedScript, targetElement, strict);\n    const selector = joinTokens(bestTokens);\n    const parsedSelector = injectedScript.parseSelector(selector);\n    return {\n      selector,\n      elements: injectedScript.querySelectorAll(parsedSelector, targetElement.ownerDocument)\n    };\n  } finally {\n    cacheAllowText.clear();\n    cacheDisallowText.clear();\n    injectedScript._evaluator.end();\n  }\n}\nfunction filterRegexTokens(textCandidates) {\n  return textCandidates.filter((c) => c[0].selector[0] !== "/");\n}\nfunction generateSelectorFor(injectedScript, targetElement, strict) {\n  if (targetElement.ownerDocument.documentElement === targetElement)\n    return [{ engine: "css", selector: "html", score: 1 }];\n  const calculate = (element, allowText) => {\n    const allowNthMatch = element === targetElement;\n    let textCandidates = allowText ? buildTextCandidates(injectedScript, element, element === targetElement).map((token) => [token]) : [];\n    if (element !== targetElement) {\n      textCandidates = filterRegexTokens(textCandidates);\n    }\n    const noTextCandidates = buildCandidates(injectedScript, element).map((token) => [token]);\n    let result = chooseFirstSelector(injectedScript, targetElement.ownerDocument, element, [...textCandidates, ...noTextCandidates], allowNthMatch, strict);\n    textCandidates = filterRegexTokens(textCandidates);\n    const checkWithText = (textCandidatesToUse) => {\n      const allowParentText = allowText && !textCandidatesToUse.length;\n      const candidates = [...textCandidatesToUse, ...noTextCandidates].filter((c) => {\n        if (!result)\n          return true;\n        return combineScores(c) < combineScores(result);\n      });\n      let bestPossibleInParent = candidates[0];\n      if (!bestPossibleInParent)\n        return;\n      for (let parent = parentElementOrShadowHost2(element); parent; parent = parentElementOrShadowHost2(parent)) {\n        const parentTokens = calculateCached(parent, allowParentText);\n        if (!parentTokens)\n          continue;\n        if (result && combineScores([...parentTokens, ...bestPossibleInParent]) >= combineScores(result))\n          continue;\n        bestPossibleInParent = chooseFirstSelector(injectedScript, parent, element, candidates, allowNthMatch, strict);\n        if (!bestPossibleInParent)\n          return;\n        const combined = [...parentTokens, ...bestPossibleInParent];\n        if (!result || combineScores(combined) < combineScores(result))\n          result = combined;\n      }\n    };\n    checkWithText(textCandidates);\n    if (element === targetElement && textCandidates.length)\n      checkWithText([]);\n    return result;\n  };\n  const calculateCached = (element, allowText) => {\n    const cache = allowText ? cacheAllowText : cacheDisallowText;\n    let value = cache.get(element);\n    if (value === void 0) {\n      value = calculate(element, allowText);\n      cache.set(element, value);\n    }\n    return value;\n  };\n  return calculateCached(targetElement, true);\n}\nfunction buildCandidates(injectedScript, element) {\n  const candidates = [];\n  for (const attribute of ["data-testid", "data-test-id", "data-test"]) {\n    if (element.getAttribute(attribute))\n      candidates.push({ engine: "css", selector: `[${attribute}=${quoteAttributeValue(element.getAttribute(attribute))}]`, score: 1 });\n  }\n  if (element.nodeName === "INPUT") {\n    const input = element;\n    if (input.placeholder)\n      candidates.push({ engine: "css", selector: `[placeholder=${quoteAttributeValue(input.placeholder)}]`, score: 10 });\n  }\n  if (element.getAttribute("aria-label"))\n    candidates.push({ engine: "css", selector: `[aria-label=${quoteAttributeValue(element.getAttribute("aria-label"))}]`, score: 10 });\n  if (element.getAttribute("alt") && ["APPLET", "AREA", "IMG", "INPUT"].includes(element.nodeName))\n    candidates.push({ engine: "css", selector: `${cssEscape(element.nodeName.toLowerCase())}[alt=${quoteAttributeValue(element.getAttribute("alt"))}]`, score: 10 });\n  if (element.getAttribute("role"))\n    candidates.push({ engine: "css", selector: `${cssEscape(element.nodeName.toLowerCase())}[role=${quoteAttributeValue(element.getAttribute("role"))}]`, score: 50 });\n  if (element.getAttribute("name") && ["BUTTON", "FORM", "FIELDSET", "IFRAME", "INPUT", "KEYGEN", "OBJECT", "OUTPUT", "SELECT", "TEXTAREA", "MAP", "META", "PARAM"].includes(element.nodeName))\n    candidates.push({ engine: "css", selector: `${cssEscape(element.nodeName.toLowerCase())}[name=${quoteAttributeValue(element.getAttribute("name"))}]`, score: 50 });\n  if (["INPUT", "TEXTAREA"].includes(element.nodeName) && element.getAttribute("type") !== "hidden") {\n    if (element.getAttribute("type"))\n      candidates.push({ engine: "css", selector: `${cssEscape(element.nodeName.toLowerCase())}[type=${quoteAttributeValue(element.getAttribute("type"))}]`, score: 50 });\n  }\n  if (["INPUT", "TEXTAREA", "SELECT"].includes(element.nodeName))\n    candidates.push({ engine: "css", selector: cssEscape(element.nodeName.toLowerCase()), score: 50 });\n  const idAttr = element.getAttribute("id");\n  if (idAttr && !isGuidLike(idAttr))\n    candidates.push({ engine: "css", selector: makeSelectorForId(idAttr), score: 100 });\n  candidates.push({ engine: "css", selector: cssEscape(element.nodeName.toLowerCase()), score: 200 });\n  return candidates;\n}\nfunction buildTextCandidates(injectedScript, element, allowHasText) {\n  if (element.nodeName === "SELECT")\n    return [];\n  const text = elementText(injectedScript._evaluator, element).full.trim().replace(/\\s+/g, " ").substring(0, 80);\n  if (!text)\n    return [];\n  const candidates = [];\n  let escaped = text;\n  if (text.includes(\'"\') || text.includes(">>") || text[0] === "/")\n    escaped = `/.*${escapeForRegex(text)}.*/`;\n  candidates.push({ engine: "text", selector: escaped, score: 10 });\n  if (allowHasText && escaped === text) {\n    let prefix = element.nodeName.toLowerCase();\n    if (element.hasAttribute("role"))\n      prefix += `[role=${quoteAttributeValue(element.getAttribute("role"))}]`;\n    candidates.push({ engine: "css", selector: `${prefix}:has-text("${text}")`, score: 30 });\n  }\n  return candidates;\n}\nfunction parentElementOrShadowHost2(element) {\n  if (element.parentElement)\n    return element.parentElement;\n  if (!element.parentNode)\n    return null;\n  if (element.parentNode.nodeType === Node.DOCUMENT_FRAGMENT_NODE && element.parentNode.host)\n    return element.parentNode.host;\n  return null;\n}\nfunction makeSelectorForId(id) {\n  return /^[a-zA-Z][a-zA-Z0-9\\-\\_]+$/.test(id) ? "#" + id : `[id="${cssEscape(id)}"]`;\n}\nfunction cssFallback(injectedScript, targetElement, strict) {\n  const kFallbackScore = 1e7;\n  const root = targetElement.ownerDocument;\n  const tokens = [];\n  function uniqueCSSSelector(prefix) {\n    const path = tokens.slice();\n    if (prefix)\n      path.unshift(prefix);\n    const selector = path.join(" ");\n    const parsedSelector = injectedScript.parseSelector(selector);\n    const node = injectedScript.querySelector(parsedSelector, targetElement.ownerDocument, false);\n    return node === targetElement ? selector : void 0;\n  }\n  function makeStrict(selector) {\n    const token = { engine: "css", selector, score: kFallbackScore };\n    if (!strict)\n      return [token];\n    const parsedSelector = injectedScript.parseSelector(selector);\n    const elements = injectedScript.querySelectorAll(parsedSelector, targetElement.ownerDocument);\n    if (elements.length === 1)\n      return [token];\n    const nth = { engine: "nth", selector: String(elements.indexOf(targetElement)), score: kNthScore };\n    return [token, nth];\n  }\n  for (let element = targetElement; element && element !== root; element = parentElementOrShadowHost2(element)) {\n    const nodeName = element.nodeName.toLowerCase();\n    let bestTokenForLevel = "";\n    if (element.id) {\n      const token = makeSelectorForId(element.id);\n      const selector = uniqueCSSSelector(token);\n      if (selector)\n        return makeStrict(selector);\n      bestTokenForLevel = token;\n    }\n    const parent = element.parentNode;\n    const classes = [...element.classList];\n    for (let i = 0; i < classes.length; ++i) {\n      const token = "." + classes.slice(0, i + 1).join(".");\n      const selector = uniqueCSSSelector(token);\n      if (selector)\n        return makeStrict(selector);\n      if (!bestTokenForLevel && parent) {\n        const sameClassSiblings = parent.querySelectorAll(token);\n        if (sameClassSiblings.length === 1)\n          bestTokenForLevel = token;\n      }\n    }\n    if (parent) {\n      const siblings = [...parent.children];\n      const sameTagSiblings = siblings.filter((sibling) => sibling.nodeName.toLowerCase() === nodeName);\n      const token = sameTagSiblings.indexOf(element) === 0 ? cssEscape(nodeName) : `${cssEscape(nodeName)}:nth-child(${1 + siblings.indexOf(element)})`;\n      const selector = uniqueCSSSelector(token);\n      if (selector)\n        return makeStrict(selector);\n      if (!bestTokenForLevel)\n        bestTokenForLevel = token;\n    } else if (!bestTokenForLevel) {\n      bestTokenForLevel = nodeName;\n    }\n    tokens.unshift(bestTokenForLevel);\n  }\n  return makeStrict(uniqueCSSSelector());\n}\nfunction escapeForRegex(text) {\n  return text.replace(/[.*+?^>${}()|[\\]\\\\]/g, "\\\\$&");\n}\nfunction quoteAttributeValue(text) {\n  return `"${cssEscape(text).replace(/\\\\ /g, " ")}"`;\n}\nfunction joinTokens(tokens) {\n  const parts = [];\n  let lastEngine = "";\n  for (const { engine, selector } of tokens) {\n    if (parts.length && (lastEngine !== "css" || engine !== "css" || selector.startsWith(":nth-match(")))\n      parts.push(">>");\n    lastEngine = engine;\n    if (engine === "css")\n      parts.push(selector);\n    else\n      parts.push(`${engine}=${selector}`);\n  }\n  return parts.join(" ");\n}\nfunction combineScores(tokens) {\n  let score = 0;\n  for (let i = 0; i < tokens.length; i++)\n    score += tokens[i].score * (tokens.length - i);\n  return score;\n}\nfunction chooseFirstSelector(injectedScript, scope, targetElement, selectors, allowNthMatch, strict) {\n  const joined = selectors.map((tokens) => ({ tokens, score: combineScores(tokens) }));\n  joined.sort((a, b) => a.score - b.score);\n  let bestWithIndex = null;\n  for (const { tokens } of joined) {\n    const parsedSelector = injectedScript.parseSelector(joinTokens(tokens));\n    const result = injectedScript.querySelectorAll(parsedSelector, scope);\n    const isStrictEnough = !strict || result.length === 1;\n    const index = result.indexOf(targetElement);\n    if (index === 0 && isStrictEnough) {\n      return tokens;\n    }\n    if (!allowNthMatch || bestWithIndex || index === -1 || result.length > 5)\n      continue;\n    const nth = { engine: "nth", selector: String(index), score: kNthScore };\n    bestWithIndex = [...tokens, nth];\n  }\n  return bestWithIndex;\n}\nfunction isGuidLike(id) {\n  let lastCharacterType;\n  let transitionCount = 0;\n  for (let i = 0; i < id.length; ++i) {\n    const c = id[i];\n    let characterType;\n    if (c === "-" || c === "_")\n      continue;\n    if (c >= "a" && c <= "z")\n      characterType = "lower";\n    else if (c >= "A" && c <= "Z")\n      characterType = "upper";\n    else if (c >= "0" && c <= "9")\n      characterType = "digit";\n    else\n      characterType = "other";\n    if (characterType === "lower" && lastCharacterType === "upper") {\n      lastCharacterType = characterType;\n      continue;\n    }\n    if (lastCharacterType && lastCharacterType !== characterType)\n      ++transitionCount;\n    lastCharacterType = characterType;\n  }\n  return transitionCount >= id.length / 4;\n}\nfunction cssEscape(s) {\n  let result = "";\n  for (let i = 0; i < s.length; i++)\n    result += cssEscapeOne(s, i);\n  return result;\n}\nfunction cssEscapeOne(s, i) {\n  const c = s.charCodeAt(i);\n  if (c === 0)\n    return "\\uFFFD";\n  if (c >= 1 && c <= 31 || c >= 48 && c <= 57 && (i === 0 || i === 1 && s.charCodeAt(0) === 45))\n    return "\\\\" + c.toString(16) + " ";\n  if (i === 0 && c === 45 && s.length === 1)\n    return "\\\\" + s.charAt(i);\n  if (c >= 128 || c === 45 || c === 95 || c >= 48 && c <= 57 || c >= 65 && c <= 90 || c >= 97 && c <= 122)\n    return s.charAt(i);\n  return "\\\\" + s.charAt(i);\n}\n\n// packages/playwright-core/src/server/injected/highlight.ts\nvar Highlight = class {\n  constructor(isUnderTest) {\n    this._highlightElements = [];\n    this._isUnderTest = isUnderTest;\n    this._outerGlassPaneElement = document.createElement("x-pw-glass");\n    this._outerGlassPaneElement.style.position = "fixed";\n    this._outerGlassPaneElement.style.top = "0";\n    this._outerGlassPaneElement.style.right = "0";\n    this._outerGlassPaneElement.style.bottom = "0";\n    this._outerGlassPaneElement.style.left = "0";\n    this._outerGlassPaneElement.style.zIndex = "2147483647";\n    this._outerGlassPaneElement.style.pointerEvents = "none";\n    this._outerGlassPaneElement.style.display = "flex";\n    this._tooltipElement = document.createElement("x-pw-tooltip");\n    this._actionPointElement = document.createElement("x-pw-action-point");\n    this._actionPointElement.setAttribute("hidden", "true");\n    this._innerGlassPaneElement = document.createElement("x-pw-glass-inner");\n    this._innerGlassPaneElement.style.flex = "auto";\n    this._innerGlassPaneElement.appendChild(this._tooltipElement);\n    this._glassPaneShadow = this._outerGlassPaneElement.attachShadow({ mode: isUnderTest ? "open" : "closed" });\n    this._glassPaneShadow.appendChild(this._innerGlassPaneElement);\n    this._glassPaneShadow.appendChild(this._actionPointElement);\n    const styleElement = document.createElement("style");\n    styleElement.textContent = `\n        x-pw-tooltip {\n          align-items: center;\n          backdrop-filter: blur(5px);\n          background-color: rgba(0, 0, 0, 0.7);\n          border-radius: 2px;\n          box-shadow: rgba(0, 0, 0, 0.1) 0px 3.6px 3.7px,\n                      rgba(0, 0, 0, 0.15) 0px 12.1px 12.3px,\n                      rgba(0, 0, 0, 0.1) 0px -2px 4px,\n                      rgba(0, 0, 0, 0.15) 0px -12.1px 24px,\n                      rgba(0, 0, 0, 0.25) 0px 54px 55px;\n          color: rgb(204, 204, 204);\n          display: none;\n          font-family: \'Dank Mono\', \'Operator Mono\', Inconsolata, \'Fira Mono\',\n                      \'SF Mono\', Monaco, \'Droid Sans Mono\', \'Source Code Pro\', monospace;\n          font-size: 12.8px;\n          font-weight: normal;\n          left: 0;\n          line-height: 1.5;\n          max-width: 600px;\n          padding: 3.2px 5.12px 3.2px;\n          position: absolute;\n          top: 0;\n        }\n        x-pw-action-point {\n          position: absolute;\n          width: 20px;\n          height: 20px;\n          background: red;\n          border-radius: 10px;\n          pointer-events: none;\n          margin: -10px 0 0 -10px;\n          z-index: 2;\n        }\n        *[hidden] {\n          display: none !important;\n        }\n    `;\n    this._glassPaneShadow.appendChild(styleElement);\n  }\n  install() {\n    document.documentElement.appendChild(this._outerGlassPaneElement);\n  }\n  uninstall() {\n    this._outerGlassPaneElement.remove();\n  }\n  isInstalled() {\n    return this._outerGlassPaneElement.parentElement === document.documentElement && !this._outerGlassPaneElement.nextElementSibling;\n  }\n  showActionPoint(x, y) {\n    this._actionPointElement.style.top = y + "px";\n    this._actionPointElement.style.left = x + "px";\n    this._actionPointElement.hidden = false;\n    if (this._isUnderTest)\n      console.error("Action point for test: " + JSON.stringify({ x, y }));\n  }\n  hideActionPoint() {\n    this._actionPointElement.hidden = true;\n  }\n  updateHighlight(elements, selector, isRecording) {\n    this._tooltipElement.textContent = selector;\n    this._tooltipElement.style.top = "0";\n    this._tooltipElement.style.left = "0";\n    this._tooltipElement.style.display = "flex";\n    const boxes = elements.map((e) => e.getBoundingClientRect());\n    const tooltipWidth = this._tooltipElement.offsetWidth;\n    const tooltipHeight = this._tooltipElement.offsetHeight;\n    const totalWidth = this._innerGlassPaneElement.offsetWidth;\n    const totalHeight = this._innerGlassPaneElement.offsetHeight;\n    if (boxes.length) {\n      const primaryBox = boxes[0];\n      let anchorLeft = primaryBox.left;\n      if (anchorLeft + tooltipWidth > totalWidth - 5)\n        anchorLeft = totalWidth - tooltipWidth - 5;\n      let anchorTop = primaryBox.bottom + 5;\n      if (anchorTop + tooltipHeight > totalHeight - 5) {\n        if (primaryBox.top > tooltipHeight + 5) {\n          anchorTop = primaryBox.top - tooltipHeight - 5;\n        } else {\n          anchorTop = totalHeight - 5 - tooltipHeight;\n        }\n      }\n      this._tooltipElement.style.top = anchorTop + "px";\n      this._tooltipElement.style.left = anchorLeft + "px";\n    } else {\n      this._tooltipElement.style.display = "none";\n    }\n    const pool = this._highlightElements;\n    this._highlightElements = [];\n    for (const box of boxes) {\n      const highlightElement = pool.length ? pool.shift() : this._createHighlightElement();\n      const color = isRecording ? "#dc6f6f7f" : "#6fa8dc7f";\n      highlightElement.style.backgroundColor = this._highlightElements.length ? "#f6b26b7f" : color;\n      highlightElement.style.left = box.x + "px";\n      highlightElement.style.top = box.y + "px";\n      highlightElement.style.width = box.width + "px";\n      highlightElement.style.height = box.height + "px";\n      highlightElement.style.display = "block";\n      this._highlightElements.push(highlightElement);\n      if (this._isUnderTest)\n        console.error("Highlight box for test: " + JSON.stringify({ x: box.x, y: box.y, width: box.width, height: box.height }));\n    }\n    for (const highlightElement of pool) {\n      highlightElement.style.display = "none";\n      this._highlightElements.push(highlightElement);\n    }\n  }\n  maskElements(elements) {\n    const boxes = elements.map((e) => e.getBoundingClientRect());\n    const pool = this._highlightElements;\n    this._highlightElements = [];\n    for (const box of boxes) {\n      const highlightElement = pool.length ? pool.shift() : this._createHighlightElement();\n      highlightElement.style.backgroundColor = "#F0F";\n      highlightElement.style.left = box.x + "px";\n      highlightElement.style.top = box.y + "px";\n      highlightElement.style.width = box.width + "px";\n      highlightElement.style.height = box.height + "px";\n      highlightElement.style.display = "block";\n      this._highlightElements.push(highlightElement);\n    }\n    for (const highlightElement of pool) {\n      highlightElement.style.display = "none";\n      this._highlightElements.push(highlightElement);\n    }\n  }\n  _createHighlightElement() {\n    const highlightElement = document.createElement("x-pw-highlight");\n    highlightElement.style.position = "absolute";\n    highlightElement.style.top = "0";\n    highlightElement.style.left = "0";\n    highlightElement.style.width = "0";\n    highlightElement.style.height = "0";\n    highlightElement.style.boxSizing = "border-box";\n    this._glassPaneShadow.appendChild(highlightElement);\n    return highlightElement;\n  }\n};\n\n// packages/playwright-core/src/server/injected/injectedScript.ts\nvar InjectedScript = class {\n  constructor(isUnderTest, stableRafCount, browserName, experimentalFeaturesEnabled, customEngines) {\n    this.onGlobalListenersRemoved = /* @__PURE__ */ new Set();\n    this.isUnderTest = isUnderTest;\n    this._evaluator = new SelectorEvaluatorImpl(/* @__PURE__ */ new Map());\n    this._engines = /* @__PURE__ */ new Map();\n    this._engines.set("xpath", XPathEngine);\n    this._engines.set("xpath:light", XPathEngine);\n    this._engines.set("_react", ReactEngine);\n    this._engines.set("_vue", VueEngine);\n    if (experimentalFeaturesEnabled)\n      this._engines.set("role", RoleEngine);\n    this._engines.set("text", this._createTextEngine(true));\n    this._engines.set("text:light", this._createTextEngine(false));\n    this._engines.set("id", this._createAttributeEngine("id", true));\n    this._engines.set("id:light", this._createAttributeEngine("id", false));\n    this._engines.set("data-testid", this._createAttributeEngine("data-testid", true));\n    this._engines.set("data-testid:light", this._createAttributeEngine("data-testid", false));\n    this._engines.set("data-test-id", this._createAttributeEngine("data-test-id", true));\n    this._engines.set("data-test-id:light", this._createAttributeEngine("data-test-id", false));\n    this._engines.set("data-test", this._createAttributeEngine("data-test", true));\n    this._engines.set("data-test:light", this._createAttributeEngine("data-test", false));\n    this._engines.set("css", this._createCSSEngine());\n    this._engines.set("nth", { queryAll: () => [] });\n    this._engines.set("visible", { queryAll: () => [] });\n    this._engines.set("control", this._createControlEngine());\n    this._engines.set("has", this._createHasEngine());\n    for (const { name, engine } of customEngines)\n      this._engines.set(name, engine);\n    this._stableRafCount = stableRafCount;\n    this._browserName = browserName;\n    this._setupGlobalListenersRemovalDetection();\n    this._setupHitTargetInterceptors();\n    if (isUnderTest)\n      window.__injectedScript = this;\n  }\n  eval(expression) {\n    return globalThis.eval(expression);\n  }\n  parseSelector(selector) {\n    const result = parseSelector(selector);\n    for (const name of allEngineNames(result)) {\n      if (!this._engines.has(name))\n        throw this.createStacklessError(`Unknown engine "${name}" while parsing selector ${selector}`);\n    }\n    return result;\n  }\n  generateSelector(targetElement) {\n    return generateSelector(this, targetElement, true).selector;\n  }\n  querySelector(selector, root, strict) {\n    var _a, _b;\n    if (!root["querySelector"])\n      throw this.createStacklessError("Node is not queryable.");\n    this._evaluator.begin();\n    try {\n      const result = this._querySelectorRecursively([{ element: root, capture: void 0 }], selector, 0, /* @__PURE__ */ new Map());\n      if (strict && result.length > 1)\n        throw this.strictModeViolationError(selector, result.map((r) => r.element));\n      return ((_a = result[0]) == null ? void 0 : _a.capture) || ((_b = result[0]) == null ? void 0 : _b.element);\n    } finally {\n      this._evaluator.end();\n    }\n  }\n  _querySelectorRecursively(roots, selector, index, queryCache) {\n    if (index === selector.parts.length)\n      return roots;\n    const part = selector.parts[index];\n    if (part.name === "nth") {\n      let filtered = [];\n      if (part.body === "0") {\n        filtered = roots.slice(0, 1);\n      } else if (part.body === "-1") {\n        if (roots.length)\n          filtered = roots.slice(roots.length - 1);\n      } else {\n        if (typeof selector.capture === "number")\n          throw this.createStacklessError(`Can\'t query n-th element in a request with the capture.`);\n        const nth = +part.body;\n        const set = /* @__PURE__ */ new Set();\n        for (const root of roots) {\n          set.add(root.element);\n          if (nth + 1 === set.size)\n            filtered = [root];\n        }\n      }\n      return this._querySelectorRecursively(filtered, selector, index + 1, queryCache);\n    }\n    if (part.name === "visible") {\n      const visible = Boolean(part.body);\n      const filtered = roots.filter((match) => visible === isVisible(match.element));\n      return this._querySelectorRecursively(filtered, selector, index + 1, queryCache);\n    }\n    const result = [];\n    for (const root of roots) {\n      const capture = index - 1 === selector.capture ? root.element : root.capture;\n      let queryResults = queryCache.get(root.element);\n      if (!queryResults) {\n        queryResults = [];\n        queryCache.set(root.element, queryResults);\n      }\n      let all = queryResults[index];\n      if (!all) {\n        all = this._queryEngineAll(part, root.element);\n        queryResults[index] = all;\n      }\n      for (const element of all) {\n        if (!("nodeName" in element))\n          throw this.createStacklessError(`Expected a Node but got ${Object.prototype.toString.call(element)}`);\n        result.push({ element, capture });\n      }\n    }\n    return this._querySelectorRecursively(result, selector, index + 1, queryCache);\n  }\n  querySelectorAll(selector, root) {\n    if (!root["querySelectorAll"])\n      throw this.createStacklessError("Node is not queryable.");\n    this._evaluator.begin();\n    try {\n      const result = this._querySelectorRecursively([{ element: root, capture: void 0 }], selector, 0, /* @__PURE__ */ new Map());\n      const set = /* @__PURE__ */ new Set();\n      for (const r of result)\n        set.add(r.capture || r.element);\n      return [...set];\n    } finally {\n      this._evaluator.end();\n    }\n  }\n  _queryEngineAll(part, root) {\n    return this._engines.get(part.name).queryAll(root, part.body);\n  }\n  _createAttributeEngine(attribute, shadow) {\n    const toCSS = (selector) => {\n      const css2 = `[${attribute}=${JSON.stringify(selector)}]`;\n      return [{ simples: [{ selector: { css: css2, functions: [] }, combinator: "" }] }];\n    };\n    return {\n      queryAll: (root, selector) => {\n        return this._evaluator.query({ scope: root, pierceShadow: shadow }, toCSS(selector));\n      }\n    };\n  }\n  _createCSSEngine() {\n    const evaluator = this._evaluator;\n    return {\n      queryAll(root, body) {\n        return evaluator.query({ scope: root, pierceShadow: true }, body);\n      }\n    };\n  }\n  _createTextEngine(shadow) {\n    const queryList = (root, selector) => {\n      const { matcher, kind } = createTextMatcher(selector);\n      const result = [];\n      let lastDidNotMatchSelf = null;\n      const appendElement = (element) => {\n        if (kind === "lax" && lastDidNotMatchSelf && lastDidNotMatchSelf.contains(element))\n          return false;\n        const matches = elementMatchesText(this._evaluator, element, matcher);\n        if (matches === "none")\n          lastDidNotMatchSelf = element;\n        if (matches === "self" || matches === "selfAndChildren" && kind === "strict")\n          result.push(element);\n      };\n      if (root.nodeType === Node.ELEMENT_NODE)\n        appendElement(root);\n      const elements = this._evaluator._queryCSS({ scope: root, pierceShadow: shadow }, "*");\n      for (const element of elements)\n        appendElement(element);\n      return result;\n    };\n    return {\n      queryAll: (root, selector) => {\n        return queryList(root, selector);\n      }\n    };\n  }\n  _createControlEngine() {\n    return {\n      queryAll(root, body) {\n        if (body === "enter-frame")\n          return [];\n        if (body === "return-empty")\n          return [];\n        throw new Error(`Internal error, unknown control selector ${body}`);\n      }\n    };\n  }\n  _createHasEngine() {\n    const queryAll = (root, body) => {\n      if (root.nodeType !== 1)\n        return [];\n      const has = !!this.querySelector(body, root, false);\n      return has ? [root] : [];\n    };\n    return { queryAll };\n  }\n  extend(source, params) {\n    const constrFunction = globalThis.eval(`\n    (() => {\n      const module = {};\n      ${source}\n      return module.exports;\n    })()`);\n    return new constrFunction(this, params);\n  }\n  isVisible(element) {\n    return isVisible(element);\n  }\n  pollRaf(predicate) {\n    return this.poll(predicate, (next) => requestAnimationFrame(next));\n  }\n  pollInterval(pollInterval, predicate) {\n    return this.poll(predicate, (next) => setTimeout(next, pollInterval));\n  }\n  pollLogScale(predicate) {\n    const pollIntervals = [100, 250, 500];\n    let attempts = 0;\n    return this.poll(predicate, (next) => setTimeout(next, pollIntervals[attempts++] || 1e3));\n  }\n  poll(predicate, scheduleNext) {\n    return this._runAbortableTask((progress) => {\n      let fulfill;\n      let reject;\n      const result = new Promise((f, r) => {\n        fulfill = f;\n        reject = r;\n      });\n      const next = () => {\n        if (progress.aborted)\n          return;\n        try {\n          const success = predicate(progress);\n          if (success !== progress.continuePolling)\n            fulfill(success);\n          else\n            scheduleNext(next);\n        } catch (e) {\n          progress.log("  " + e.message);\n          reject(e);\n        }\n      };\n      next();\n      return result;\n    });\n  }\n  _runAbortableTask(task) {\n    let unsentLog = [];\n    let takeNextLogsCallback;\n    let taskFinished = false;\n    const logReady = () => {\n      if (!takeNextLogsCallback)\n        return;\n      takeNextLogsCallback(unsentLog);\n      unsentLog = [];\n      takeNextLogsCallback = void 0;\n    };\n    const takeNextLogs = () => new Promise((fulfill) => {\n      takeNextLogsCallback = fulfill;\n      if (unsentLog.length || taskFinished)\n        logReady();\n    });\n    let lastMessage = "";\n    let lastIntermediateResult = void 0;\n    const progress = {\n      injectedScript: this,\n      aborted: false,\n      continuePolling: Symbol("continuePolling"),\n      log: (message) => {\n        lastMessage = message;\n        unsentLog.push({ message });\n        logReady();\n      },\n      logRepeating: (message) => {\n        if (message !== lastMessage)\n          progress.log(message);\n      },\n      setIntermediateResult: (intermediateResult) => {\n        if (lastIntermediateResult === intermediateResult)\n          return;\n        lastIntermediateResult = intermediateResult;\n        unsentLog.push({ intermediateResult });\n        logReady();\n      }\n    };\n    const run = () => {\n      const result = task(progress);\n      result.finally(() => {\n        taskFinished = true;\n        logReady();\n      });\n      return result;\n    };\n    return {\n      takeNextLogs,\n      run,\n      cancel: () => {\n        progress.aborted = true;\n      },\n      takeLastLogs: () => unsentLog\n    };\n  }\n  getElementBorderWidth(node) {\n    if (node.nodeType !== Node.ELEMENT_NODE || !node.ownerDocument || !node.ownerDocument.defaultView)\n      return { left: 0, top: 0 };\n    const style = node.ownerDocument.defaultView.getComputedStyle(node);\n    return { left: parseInt(style.borderLeftWidth || "", 10), top: parseInt(style.borderTopWidth || "", 10) };\n  }\n  retarget(node, behavior) {\n    let element = node.nodeType === Node.ELEMENT_NODE ? node : node.parentElement;\n    if (!element)\n      return null;\n    if (!element.matches("input, textarea, select"))\n      element = element.closest("button, [role=button], [role=checkbox], [role=radio]") || element;\n    if (behavior === "follow-label") {\n      if (!element.matches("input, textarea, button, select, [role=button], [role=checkbox], [role=radio]") && !element.isContentEditable) {\n        element = element.closest("label") || element;\n      }\n      if (element.nodeName === "LABEL")\n        element = element.control || element;\n    }\n    return element;\n  }\n  waitForElementStatesAndPerformAction(node, states, force, callback) {\n    let lastRect;\n    let counter = 0;\n    let samePositionCounter = 0;\n    let lastTime = 0;\n    return this.pollRaf((progress) => {\n      if (force) {\n        progress.log(`    forcing action`);\n        return callback(node, progress);\n      }\n      for (const state of states) {\n        if (state !== "stable") {\n          const result = this.elementState(node, state);\n          if (typeof result !== "boolean")\n            return result;\n          if (!result) {\n            progress.logRepeating(`    element is not ${state} - waiting...`);\n            return progress.continuePolling;\n          }\n          continue;\n        }\n        const element = this.retarget(node, "no-follow-label");\n        if (!element)\n          return "error:notconnected";\n        if (++counter === 1)\n          return progress.continuePolling;\n        const time = performance.now();\n        if (this._stableRafCount > 1 && time - lastTime < 15)\n          return progress.continuePolling;\n        lastTime = time;\n        const clientRect = element.getBoundingClientRect();\n        const rect = { x: clientRect.top, y: clientRect.left, width: clientRect.width, height: clientRect.height };\n        const samePosition = lastRect && rect.x === lastRect.x && rect.y === lastRect.y && rect.width === lastRect.width && rect.height === lastRect.height;\n        if (samePosition)\n          ++samePositionCounter;\n        else\n          samePositionCounter = 0;\n        const isStable = samePositionCounter >= this._stableRafCount;\n        const isStableForLogs = isStable || !lastRect;\n        lastRect = rect;\n        if (!isStableForLogs)\n          progress.logRepeating(`    element is not stable - waiting...`);\n        if (!isStable)\n          return progress.continuePolling;\n      }\n      return callback(node, progress);\n    });\n  }\n  elementState(node, state) {\n    const element = this.retarget(node, ["stable", "visible", "hidden"].includes(state) ? "no-follow-label" : "follow-label");\n    if (!element || !element.isConnected) {\n      if (state === "hidden")\n        return true;\n      return "error:notconnected";\n    }\n    if (state === "visible")\n      return this.isVisible(element);\n    if (state === "hidden")\n      return !this.isVisible(element);\n    const disabled = getAriaDisabled(element);\n    if (state === "disabled")\n      return disabled;\n    if (state === "enabled")\n      return !disabled;\n    const editable = !(["INPUT", "TEXTAREA", "SELECT"].includes(element.nodeName) && element.hasAttribute("readonly"));\n    if (state === "editable")\n      return !disabled && editable;\n    if (state === "checked" || state === "unchecked") {\n      if (["checkbox", "radio"].includes(element.getAttribute("role") || "")) {\n        const result2 = element.getAttribute("aria-checked") === "true";\n        return state === "checked" ? result2 : !result2;\n      }\n      if (element.nodeName !== "INPUT")\n        throw this.createStacklessError("Not a checkbox or radio button");\n      if (!["radio", "checkbox"].includes(element.type.toLowerCase()))\n        throw this.createStacklessError("Not a checkbox or radio button");\n      const result = element.checked;\n      return state === "checked" ? result : !result;\n    }\n    throw this.createStacklessError(`Unexpected element state "${state}"`);\n  }\n  selectOptions(optionsToSelect, node, progress) {\n    const element = this.retarget(node, "follow-label");\n    if (!element)\n      return "error:notconnected";\n    if (element.nodeName.toLowerCase() !== "select")\n      throw this.createStacklessError("Element is not a <select> element");\n    const select = element;\n    const options = [...select.options];\n    const selectedOptions = [];\n    let remainingOptionsToSelect = optionsToSelect.slice();\n    for (let index = 0; index < options.length; index++) {\n      const option = options[index];\n      const filter = (optionToSelect) => {\n        if (optionToSelect instanceof Node)\n          return option === optionToSelect;\n        let matches = true;\n        if (optionToSelect.value !== void 0)\n          matches = matches && optionToSelect.value === option.value;\n        if (optionToSelect.label !== void 0)\n          matches = matches && optionToSelect.label === option.label;\n        if (optionToSelect.index !== void 0)\n          matches = matches && optionToSelect.index === index;\n        return matches;\n      };\n      if (!remainingOptionsToSelect.some(filter))\n        continue;\n      selectedOptions.push(option);\n      if (select.multiple) {\n        remainingOptionsToSelect = remainingOptionsToSelect.filter((o) => !filter(o));\n      } else {\n        remainingOptionsToSelect = [];\n        break;\n      }\n    }\n    if (remainingOptionsToSelect.length) {\n      progress.logRepeating("    did not find some options - waiting... ");\n      return progress.continuePolling;\n    }\n    select.value = void 0;\n    selectedOptions.forEach((option) => option.selected = true);\n    progress.log("    selected specified option(s)");\n    select.dispatchEvent(new Event("input", { "bubbles": true }));\n    select.dispatchEvent(new Event("change", { "bubbles": true }));\n    return selectedOptions.map((option) => option.value);\n  }\n  fill(value, node, progress) {\n    const element = this.retarget(node, "follow-label");\n    if (!element)\n      return "error:notconnected";\n    if (element.nodeName.toLowerCase() === "input") {\n      const input = element;\n      const type = input.type.toLowerCase();\n      const kInputTypesToSetValue = /* @__PURE__ */ new Set(["color", "date", "time", "datetime", "datetime-local", "month", "range", "week"]);\n      const kInputTypesToTypeInto = /* @__PURE__ */ new Set(["", "email", "number", "password", "search", "tel", "text", "url"]);\n      if (!kInputTypesToTypeInto.has(type) && !kInputTypesToSetValue.has(type)) {\n        progress.log(`    input of type "${type}" cannot be filled`);\n        throw this.createStacklessError(`Input of type "${type}" cannot be filled`);\n      }\n      if (type === "number") {\n        value = value.trim();\n        if (isNaN(Number(value)))\n          throw this.createStacklessError("Cannot type text into input[type=number]");\n      }\n      if (kInputTypesToSetValue.has(type)) {\n        value = value.trim();\n        input.focus();\n        input.value = value;\n        if (input.value !== value)\n          throw this.createStacklessError("Malformed value");\n        element.dispatchEvent(new Event("input", { "bubbles": true }));\n        element.dispatchEvent(new Event("change", { "bubbles": true }));\n        return "done";\n      }\n    } else if (element.nodeName.toLowerCase() === "textarea") {\n    } else if (!element.isContentEditable) {\n      throw this.createStacklessError("Element is not an <input>, <textarea> or [contenteditable] element");\n    }\n    this.selectText(element);\n    return "needsinput";\n  }\n  selectText(node) {\n    const element = this.retarget(node, "follow-label");\n    if (!element)\n      return "error:notconnected";\n    if (element.nodeName.toLowerCase() === "input") {\n      const input = element;\n      input.select();\n      input.focus();\n      return "done";\n    }\n    if (element.nodeName.toLowerCase() === "textarea") {\n      const textarea = element;\n      textarea.selectionStart = 0;\n      textarea.selectionEnd = textarea.value.length;\n      textarea.focus();\n      return "done";\n    }\n    const range = element.ownerDocument.createRange();\n    range.selectNodeContents(element);\n    const selection = element.ownerDocument.defaultView.getSelection();\n    if (selection) {\n      selection.removeAllRanges();\n      selection.addRange(range);\n    }\n    element.focus();\n    return "done";\n  }\n  focusNode(node, resetSelectionIfNotFocused) {\n    if (!node.isConnected)\n      return "error:notconnected";\n    if (node.nodeType !== Node.ELEMENT_NODE)\n      throw this.createStacklessError("Node is not an element");\n    const wasFocused = node.getRootNode().activeElement === node && node.ownerDocument && node.ownerDocument.hasFocus();\n    node.focus();\n    if (resetSelectionIfNotFocused && !wasFocused && node.nodeName.toLowerCase() === "input") {\n      try {\n        const input = node;\n        input.setSelectionRange(0, 0);\n      } catch (e) {\n      }\n    }\n    return "done";\n  }\n  setInputFiles(node, payloads) {\n    if (node.nodeType !== Node.ELEMENT_NODE)\n      return "Node is not of type HTMLElement";\n    const element = node;\n    if (element.nodeName !== "INPUT")\n      return "Not an <input> element";\n    const input = element;\n    const type = (input.getAttribute("type") || "").toLowerCase();\n    if (type !== "file")\n      return "Not an input[type=file] element";\n    const files = payloads.map((file) => {\n      const bytes = Uint8Array.from(atob(file.buffer), (c) => c.charCodeAt(0));\n      return new File([bytes], file.name, { type: file.mimeType });\n    });\n    const dt = new DataTransfer();\n    for (const file of files)\n      dt.items.add(file);\n    input.files = dt.files;\n    input.dispatchEvent(new Event("input", { "bubbles": true }));\n    input.dispatchEvent(new Event("change", { "bubbles": true }));\n  }\n  checkHitTargetAt(node, point) {\n    let element = node.nodeType === Node.ELEMENT_NODE ? node : node.parentElement;\n    if (!element || !element.isConnected)\n      return "error:notconnected";\n    element = element.closest("button, [role=button]") || element;\n    const hitElement = this.deepElementFromPoint(document, point.x, point.y);\n    return this._expectHitTargetParent(hitElement, element);\n  }\n  _expectHitTargetParent(hitElement, targetElement) {\n    const hitParents = [];\n    while (hitElement && hitElement !== targetElement) {\n      hitParents.push(hitElement);\n      hitElement = parentElementOrShadowHost(hitElement);\n    }\n    if (hitElement === targetElement)\n      return "done";\n    const hitTargetDescription = this.previewNode(hitParents[0] || document.documentElement);\n    let rootHitTargetDescription;\n    let element = targetElement;\n    while (element) {\n      const index = hitParents.indexOf(element);\n      if (index !== -1) {\n        if (index > 1)\n          rootHitTargetDescription = this.previewNode(hitParents[index - 1]);\n        break;\n      }\n      element = parentElementOrShadowHost(element);\n    }\n    if (rootHitTargetDescription)\n      return { hitTargetDescription: `${hitTargetDescription} from ${rootHitTargetDescription} subtree` };\n    return { hitTargetDescription };\n  }\n  setupHitTargetInterceptor(node, action, blockAllEvents) {\n    const maybeElement = node.nodeType === Node.ELEMENT_NODE ? node : node.parentElement;\n    if (!maybeElement || !maybeElement.isConnected)\n      return "error:notconnected";\n    const element = maybeElement.closest("button, [role=button]") || maybeElement;\n    const events = {\n      "hover": kHoverHitTargetInterceptorEvents,\n      "tap": kTapHitTargetInterceptorEvents,\n      "mouse": kMouseHitTargetInterceptorEvents\n    }[action];\n    let result;\n    const listener = (event) => {\n      if (!events.has(event.type))\n        return;\n      if (!event.isTrusted)\n        return;\n      const point = !!window.TouchEvent && event instanceof window.TouchEvent ? event.touches[0] : event;\n      if (result === void 0 && point) {\n        const hitElement = this.deepElementFromPoint(document, point.clientX, point.clientY);\n        result = this._expectHitTargetParent(hitElement, element);\n      }\n      if (blockAllEvents || result !== "done" && result !== void 0) {\n        event.preventDefault();\n        event.stopPropagation();\n        event.stopImmediatePropagation();\n      }\n    };\n    const stop = () => {\n      if (this._hitTargetInterceptor === listener)\n        this._hitTargetInterceptor = void 0;\n      return result || "done";\n    };\n    this._hitTargetInterceptor = listener;\n    return { stop };\n  }\n  dispatchEvent(node, type, eventInit) {\n    let event;\n    eventInit = { bubbles: true, cancelable: true, composed: true, ...eventInit };\n    switch (eventType.get(type)) {\n      case "mouse":\n        event = new MouseEvent(type, eventInit);\n        break;\n      case "keyboard":\n        event = new KeyboardEvent(type, eventInit);\n        break;\n      case "touch":\n        event = new TouchEvent(type, eventInit);\n        break;\n      case "pointer":\n        event = new PointerEvent(type, eventInit);\n        break;\n      case "focus":\n        event = new FocusEvent(type, eventInit);\n        break;\n      case "drag":\n        event = new DragEvent(type, eventInit);\n        break;\n      default:\n        event = new Event(type, eventInit);\n        break;\n    }\n    node.dispatchEvent(event);\n  }\n  deepElementFromPoint(document2, x, y) {\n    let container = document2;\n    let element;\n    while (container) {\n      const elements = container.elementsFromPoint(x, y);\n      const innerElement = elements[0];\n      if (!innerElement || element === innerElement)\n        break;\n      element = innerElement;\n      container = element.shadowRoot;\n    }\n    return element;\n  }\n  previewNode(node) {\n    if (node.nodeType === Node.TEXT_NODE)\n      return oneLine(`#text=${node.nodeValue || ""}`);\n    if (node.nodeType !== Node.ELEMENT_NODE)\n      return oneLine(`<${node.nodeName.toLowerCase()} />`);\n    const element = node;\n    const attrs = [];\n    for (let i = 0; i < element.attributes.length; i++) {\n      const { name, value } = element.attributes[i];\n      if (name === "style" || name.startsWith("__playwright"))\n        continue;\n      if (!value && booleanAttributes.has(name))\n        attrs.push(` ${name}`);\n      else\n        attrs.push(` ${name}="${value}"`);\n    }\n    attrs.sort((a, b) => a.length - b.length);\n    let attrText = attrs.join("");\n    if (attrText.length > 50)\n      attrText = attrText.substring(0, 49) + "\\u2026";\n    if (autoClosingTags.has(element.nodeName))\n      return oneLine(`<${element.nodeName.toLowerCase()}${attrText}/>`);\n    const children = element.childNodes;\n    let onlyText = false;\n    if (children.length <= 5) {\n      onlyText = true;\n      for (let i = 0; i < children.length; i++)\n        onlyText = onlyText && children[i].nodeType === Node.TEXT_NODE;\n    }\n    let text = onlyText ? element.textContent || "" : children.length ? "\\u2026" : "";\n    if (text.length > 50)\n      text = text.substring(0, 49) + "\\u2026";\n    return oneLine(`<${element.nodeName.toLowerCase()}${attrText}>${text}</${element.nodeName.toLowerCase()}>`);\n  }\n  strictModeViolationError(selector, matches) {\n    const infos = matches.slice(0, 10).map((m) => ({\n      preview: this.previewNode(m),\n      selector: this.generateSelector(m)\n    }));\n    const lines = infos.map((info, i) => `\n    ${i + 1}) ${info.preview} aka playwright.$("${info.selector}")`);\n    if (infos.length < matches.length)\n      lines.push("\\n    ...");\n    return this.createStacklessError(`strict mode violation: "${stringifySelector(selector)}" resolved to ${matches.length} elements:${lines.join("")}\n`);\n  }\n  createStacklessError(message) {\n    if (this._browserName === "firefox") {\n      const error2 = new Error("Error: " + message);\n      error2.stack = "";\n      return error2;\n    }\n    const error = new Error(message);\n    delete error.stack;\n    return error;\n  }\n  maskSelectors(selectors) {\n    if (this._highlight)\n      this.hideHighlight();\n    this._highlight = new Highlight(this.isUnderTest);\n    this._highlight.install();\n    const elements = [];\n    for (const selector of selectors)\n      elements.push(this.querySelectorAll(selector, document.documentElement));\n    this._highlight.maskElements(elements.flat());\n  }\n  highlight(selector) {\n    if (!this._highlight) {\n      this._highlight = new Highlight(this.isUnderTest);\n      this._highlight.install();\n    }\n    this._runHighlightOnRaf(selector);\n  }\n  _runHighlightOnRaf(selector) {\n    if (!this._highlight)\n      return;\n    this._highlight.updateHighlight(this.querySelectorAll(selector, document.documentElement), stringifySelector(selector), false);\n    requestAnimationFrame(() => this._runHighlightOnRaf(selector));\n  }\n  hideHighlight() {\n    if (this._highlight) {\n      this._highlight.uninstall();\n      delete this._highlight;\n    }\n  }\n  _setupGlobalListenersRemovalDetection() {\n    const customEventName = "__playwright_global_listeners_check__";\n    let seenEvent = false;\n    const handleCustomEvent = () => seenEvent = true;\n    window.addEventListener(customEventName, handleCustomEvent);\n    new MutationObserver((entries) => {\n      const newDocumentElement = entries.some((entry) => Array.from(entry.addedNodes).includes(document.documentElement));\n      if (!newDocumentElement)\n        return;\n      seenEvent = false;\n      window.dispatchEvent(new CustomEvent(customEventName));\n      if (seenEvent)\n        return;\n      window.addEventListener(customEventName, handleCustomEvent);\n      for (const callback of this.onGlobalListenersRemoved)\n        callback();\n    }).observe(document, { childList: true });\n  }\n  _setupHitTargetInterceptors() {\n    const listener = (event) => {\n      var _a;\n      return (_a = this._hitTargetInterceptor) == null ? void 0 : _a.call(this, event);\n    };\n    const addHitTargetInterceptorListeners = () => {\n      for (const event of kAllHitTargetInterceptorEvents)\n        window.addEventListener(event, listener, { capture: true, passive: false });\n    };\n    addHitTargetInterceptorListeners();\n    this.onGlobalListenersRemoved.add(addHitTargetInterceptorListeners);\n  }\n  expectSingleElement(progress, element, options) {\n    var _a;\n    const injected = progress.injectedScript;\n    const expression = options.expression;\n    {\n      let elementState;\n      if (expression === "to.be.checked") {\n        elementState = progress.injectedScript.elementState(element, "checked");\n      } else if (expression === "to.be.unchecked") {\n        elementState = progress.injectedScript.elementState(element, "unchecked");\n      } else if (expression === "to.be.disabled") {\n        elementState = progress.injectedScript.elementState(element, "disabled");\n      } else if (expression === "to.be.editable") {\n        elementState = progress.injectedScript.elementState(element, "editable");\n      } else if (expression === "to.be.empty") {\n        if (element.nodeName === "INPUT" || element.nodeName === "TEXTAREA")\n          elementState = !element.value;\n        else\n          elementState = !((_a = element.textContent) == null ? void 0 : _a.trim());\n      } else if (expression === "to.be.enabled") {\n        elementState = progress.injectedScript.elementState(element, "enabled");\n      } else if (expression === "to.be.focused") {\n        elementState = document.activeElement === element;\n      } else if (expression === "to.be.hidden") {\n        elementState = progress.injectedScript.elementState(element, "hidden");\n      } else if (expression === "to.be.visible") {\n        elementState = progress.injectedScript.elementState(element, "visible");\n      }\n      if (elementState !== void 0) {\n        if (elementState === "error:notcheckbox")\n          throw injected.createStacklessError("Element is not a checkbox");\n        if (elementState === "error:notconnected")\n          throw injected.createStacklessError("Element is not connected");\n        return { received: elementState, matches: elementState };\n      }\n    }\n    {\n      if (expression === "to.have.property") {\n        const received = element[options.expressionArg];\n        const matches = deepEquals(received, options.expectedValue);\n        return { received, matches };\n      }\n    }\n    {\n      let received;\n      if (expression === "to.have.attribute") {\n        received = element.getAttribute(options.expressionArg) || "";\n      } else if (expression === "to.have.class") {\n        received = element.className;\n      } else if (expression === "to.have.css") {\n        received = window.getComputedStyle(element).getPropertyValue(options.expressionArg);\n      } else if (expression === "to.have.id") {\n        received = element.id;\n      } else if (expression === "to.have.text") {\n        received = options.useInnerText ? element.innerText : element.textContent || "";\n      } else if (expression === "to.have.title") {\n        received = document.title;\n      } else if (expression === "to.have.url") {\n        received = document.location.href;\n      } else if (expression === "to.have.value") {\n        element = this.retarget(element, "follow-label");\n        if (element.nodeName !== "INPUT" && element.nodeName !== "TEXTAREA" && element.nodeName !== "SELECT")\n          throw this.createStacklessError("Not an input element");\n        received = element.value;\n      }\n      if (received !== void 0 && options.expectedText) {\n        const matcher = new ExpectedTextMatcher(options.expectedText[0]);\n        return { received, matches: matcher.matches(received) };\n      }\n    }\n    throw this.createStacklessError("Unknown expect matcher: " + expression);\n  }\n  expectArray(elements, options) {\n    const expression = options.expression;\n    if (expression === "to.have.count") {\n      const received2 = elements.length;\n      const matches = received2 === options.expectedNumber;\n      return { received: received2, matches };\n    }\n    let received;\n    if (expression === "to.have.text.array" || expression === "to.contain.text.array")\n      received = elements.map((e) => options.useInnerText ? e.innerText : e.textContent || "");\n    else if (expression === "to.have.class.array")\n      received = elements.map((e) => e.className);\n    if (received && options.expectedText) {\n      const lengthShouldMatch = expression !== "to.contain.text.array";\n      const matchesLength = received.length === options.expectedText.length || !lengthShouldMatch;\n      if (!matchesLength)\n        return { received, matches: false };\n      let i = 0;\n      const matchers = options.expectedText.map((e) => new ExpectedTextMatcher(e));\n      let allMatchesFound = true;\n      for (const matcher of matchers) {\n        while (i < received.length && !matcher.matches(received[i]))\n          i++;\n        if (i >= received.length) {\n          allMatchesFound = false;\n          break;\n        }\n      }\n      return { received, matches: allMatchesFound };\n    }\n    throw this.createStacklessError("Unknown expect matcher: " + expression);\n  }\n  getElementAccessibleName(element, includeHidden) {\n    const hiddenCache = /* @__PURE__ */ new Map();\n    return getElementAccessibleName(element, !!includeHidden, hiddenCache);\n  }\n  getAriaRole(element) {\n    return getAriaRole(element);\n  }\n};\nvar autoClosingTags = /* @__PURE__ */ new Set(["AREA", "BASE", "BR", "COL", "COMMAND", "EMBED", "HR", "IMG", "INPUT", "KEYGEN", "LINK", "MENUITEM", "META", "PARAM", "SOURCE", "TRACK", "WBR"]);\nvar booleanAttributes = /* @__PURE__ */ new Set(["checked", "selected", "disabled", "readonly", "multiple"]);\nfunction oneLine(s) {\n  return s.replace(/\\n/g, "\\u21B5").replace(/\\t/g, "\\u21C6");\n}\nvar eventType = /* @__PURE__ */ new Map([\n  ["auxclick", "mouse"],\n  ["click", "mouse"],\n  ["dblclick", "mouse"],\n  ["mousedown", "mouse"],\n  ["mouseeenter", "mouse"],\n  ["mouseleave", "mouse"],\n  ["mousemove", "mouse"],\n  ["mouseout", "mouse"],\n  ["mouseover", "mouse"],\n  ["mouseup", "mouse"],\n  ["mouseleave", "mouse"],\n  ["mousewheel", "mouse"],\n  ["keydown", "keyboard"],\n  ["keyup", "keyboard"],\n  ["keypress", "keyboard"],\n  ["textInput", "keyboard"],\n  ["touchstart", "touch"],\n  ["touchmove", "touch"],\n  ["touchend", "touch"],\n  ["touchcancel", "touch"],\n  ["pointerover", "pointer"],\n  ["pointerout", "pointer"],\n  ["pointerenter", "pointer"],\n  ["pointerleave", "pointer"],\n  ["pointerdown", "pointer"],\n  ["pointerup", "pointer"],\n  ["pointermove", "pointer"],\n  ["pointercancel", "pointer"],\n  ["gotpointercapture", "pointer"],\n  ["lostpointercapture", "pointer"],\n  ["focus", "focus"],\n  ["blur", "focus"],\n  ["drag", "drag"],\n  ["dragstart", "drag"],\n  ["dragend", "drag"],\n  ["dragover", "drag"],\n  ["dragenter", "drag"],\n  ["dragleave", "drag"],\n  ["dragexit", "drag"],\n  ["drop", "drag"]\n]);\nvar kHoverHitTargetInterceptorEvents = /* @__PURE__ */ new Set(["mousemove"]);\nvar kTapHitTargetInterceptorEvents = /* @__PURE__ */ new Set(["pointerdown", "pointerup", "touchstart", "touchend", "touchcancel"]);\nvar kMouseHitTargetInterceptorEvents = /* @__PURE__ */ new Set(["mousedown", "mouseup", "pointerdown", "pointerup", "click", "auxclick", "dblclick", "contextmenu"]);\nvar kAllHitTargetInterceptorEvents = /* @__PURE__ */ new Set([...kHoverHitTargetInterceptorEvents, ...kTapHitTargetInterceptorEvents, ...kMouseHitTargetInterceptorEvents]);\nfunction unescape(s) {\n  if (!s.includes("\\\\"))\n    return s;\n  const r = [];\n  let i = 0;\n  while (i < s.length) {\n    if (s[i] === "\\\\" && i + 1 < s.length)\n      i++;\n    r.push(s[i++]);\n  }\n  return r.join("");\n}\nfunction createTextMatcher(selector) {\n  if (selector[0] === "/" && selector.lastIndexOf("/") > 0) {\n    const lastSlash = selector.lastIndexOf("/");\n    const matcher2 = createRegexTextMatcher(selector.substring(1, lastSlash), selector.substring(lastSlash + 1));\n    return { matcher: matcher2, kind: "regex" };\n  }\n  let strict = false;\n  if (selector.length > 1 && selector[0] === \'"\' && selector[selector.length - 1] === \'"\') {\n    selector = unescape(selector.substring(1, selector.length - 1));\n    strict = true;\n  }\n  if (selector.length > 1 && selector[0] === "\'" && selector[selector.length - 1] === "\'") {\n    selector = unescape(selector.substring(1, selector.length - 1));\n    strict = true;\n  }\n  const matcher = strict ? createStrictTextMatcher(selector) : createLaxTextMatcher(selector);\n  return { matcher, kind: strict ? "strict" : "lax" };\n}\nvar ExpectedTextMatcher = class {\n  constructor(expected) {\n    this._normalizeWhiteSpace = expected.normalizeWhiteSpace;\n    this._string = expected.matchSubstring ? void 0 : this.normalizeWhiteSpace(expected.string);\n    this._substring = expected.matchSubstring ? this.normalizeWhiteSpace(expected.string) : void 0;\n    this._regex = expected.regexSource ? new RegExp(expected.regexSource, expected.regexFlags) : void 0;\n  }\n  matches(text) {\n    if (this._normalizeWhiteSpace && !this._regex)\n      text = this.normalizeWhiteSpace(text);\n    if (this._string !== void 0)\n      return text === this._string;\n    if (this._substring !== void 0)\n      return text.includes(this._substring);\n    if (this._regex)\n      return !!this._regex.test(text);\n    return false;\n  }\n  normalizeWhiteSpace(s) {\n    if (!s)\n      return s;\n    return this._normalizeWhiteSpace ? s.trim().replace(/\\u200b/g, "").replace(/\\s+/g, " ") : s;\n  }\n};\nfunction deepEquals(a, b) {\n  if (a === b)\n    return true;\n  if (a && b && typeof a === "object" && typeof b === "object") {\n    if (a.constructor !== b.constructor)\n      return false;\n    if (Array.isArray(a)) {\n      if (a.length !== b.length)\n        return false;\n      for (let i = 0; i < a.length; ++i) {\n        if (!deepEquals(a[i], b[i]))\n          return false;\n      }\n      return true;\n    }\n    if (a instanceof RegExp)\n      return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf)\n      return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString)\n      return a.toString() === b.toString();\n    const keys = Object.keys(a);\n    if (keys.length !== Object.keys(b).length)\n      return false;\n    for (let i = 0; i < keys.length; ++i) {\n      if (!b.hasOwnProperty(keys[i]))\n        return false;\n    }\n    for (const key of keys) {\n      if (!deepEquals(a[key], b[key]))\n        return false;\n    }\n    return true;\n  }\n  if (typeof a === "number" && typeof b === "number")\n    return isNaN(a) && isNaN(b);\n  return false;\n}\nmodule.exports = InjectedScript;\n';var ku={};Object.defineProperty(ku,"__esModule",{value:!0}),ku.ProtocolError=void 0,ku.isSessionClosedError=function(e){return e instanceof Eu&&e.sessionClosed};class Eu extends Error{constructor(e,t){super(t),this.sessionClosed=void 0,this.sessionClosed=e||!1}}ku.ProtocolError=Eu;var Cu={},Tu={};Object.defineProperty(Tu,"__esModule",{value:!0}),Tu.source=void 0;Tu.source='var __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === "object" || typeof from === "function") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);\n\n// packages/playwright-core/src/server/injected/utilityScript.ts\nvar utilityScript_exports = {};\n__export(utilityScript_exports, {\n  UtilityScript: () => UtilityScript\n});\nmodule.exports = __toCommonJS(utilityScript_exports);\n\n// packages/playwright-core/src/server/isomorphic/utilityScriptSerializers.ts\nfunction isRegExp(obj) {\n  return obj instanceof RegExp || Object.prototype.toString.call(obj) === "[object RegExp]";\n}\nfunction isDate(obj) {\n  return obj instanceof Date || Object.prototype.toString.call(obj) === "[object Date]";\n}\nfunction isError(obj) {\n  return obj instanceof Error || obj && obj.__proto__ && obj.__proto__.name === "Error";\n}\nfunction parseEvaluationResultValue(value, handles = []) {\n  if (Object.is(value, void 0))\n    return void 0;\n  if (typeof value === "object" && value) {\n    if ("v" in value) {\n      if (value.v === "undefined")\n        return void 0;\n      if (value.v === "null")\n        return null;\n      if (value.v === "NaN")\n        return NaN;\n      if (value.v === "Infinity")\n        return Infinity;\n      if (value.v === "-Infinity")\n        return -Infinity;\n      if (value.v === "-0")\n        return -0;\n      return void 0;\n    }\n    if ("d" in value)\n      return new Date(value.d);\n    if ("r" in value)\n      return new RegExp(value.r.p, value.r.f);\n    if ("a" in value)\n      return value.a.map((a) => parseEvaluationResultValue(a, handles));\n    if ("o" in value) {\n      const result = {};\n      for (const { k, v } of value.o)\n        result[k] = parseEvaluationResultValue(v, handles);\n      return result;\n    }\n    if ("h" in value)\n      return handles[value.h];\n  }\n  return value;\n}\nfunction serializeAsCallArgument(value, handleSerializer) {\n  return serialize(value, handleSerializer, /* @__PURE__ */ new Set());\n}\nfunction serialize(value, handleSerializer, visited) {\n  const result = handleSerializer(value);\n  if ("fallThrough" in result)\n    value = result.fallThrough;\n  else\n    return result;\n  if (visited.has(value))\n    throw new Error("Argument is a circular structure");\n  if (typeof value === "symbol")\n    return { v: "undefined" };\n  if (Object.is(value, void 0))\n    return { v: "undefined" };\n  if (Object.is(value, null))\n    return { v: "null" };\n  if (Object.is(value, NaN))\n    return { v: "NaN" };\n  if (Object.is(value, Infinity))\n    return { v: "Infinity" };\n  if (Object.is(value, -Infinity))\n    return { v: "-Infinity" };\n  if (Object.is(value, -0))\n    return { v: "-0" };\n  if (typeof value === "boolean")\n    return value;\n  if (typeof value === "number")\n    return value;\n  if (typeof value === "string")\n    return value;\n  if (isError(value)) {\n    const error = value;\n    if ("captureStackTrace" in globalThis.Error) {\n      return error.stack || "";\n    }\n    return `${error.name}: ${error.message}\n${error.stack}`;\n  }\n  if (isDate(value))\n    return { d: value.toJSON() };\n  if (isRegExp(value))\n    return { r: { p: value.source, f: value.flags } };\n  if (Array.isArray(value)) {\n    const a = [];\n    visited.add(value);\n    for (let i = 0; i < value.length; ++i)\n      a.push(serialize(value[i], handleSerializer, visited));\n    visited.delete(value);\n    return { a };\n  }\n  if (typeof value === "object") {\n    const o = [];\n    visited.add(value);\n    for (const name of Object.keys(value)) {\n      let item;\n      try {\n        item = value[name];\n      } catch (e) {\n        continue;\n      }\n      if (name === "toJSON" && typeof item === "function")\n        o.push({ k: name, v: { o: [] } });\n      else\n        o.push({ k: name, v: serialize(item, handleSerializer, visited) });\n    }\n    visited.delete(value);\n    return { o };\n  }\n}\n\n// packages/playwright-core/src/server/injected/utilityScript.ts\nvar UtilityScript = class {\n  evaluate(isFunction, returnByValue, expression, argCount, ...argsAndHandles) {\n    const args = argsAndHandles.slice(0, argCount);\n    const handles = argsAndHandles.slice(argCount);\n    const parameters = args.map((a) => parseEvaluationResultValue(a, handles));\n    let result = globalThis.eval(expression);\n    if (isFunction === true) {\n      result = result(...parameters);\n    } else if (isFunction === false) {\n      result = result;\n    } else {\n      if (typeof result === "function")\n        result = result(...parameters);\n    }\n    return returnByValue ? this._promiseAwareJsonValueNoThrow(result) : result;\n  }\n  jsonValue(returnByValue, value) {\n    if (Object.is(value, void 0))\n      return void 0;\n    return serializeAsCallArgument(value, (value2) => ({ fallThrough: value2 }));\n  }\n  _promiseAwareJsonValueNoThrow(value) {\n    const safeJson = (value2) => {\n      try {\n        return this.jsonValue(true, value2);\n      } catch (e) {\n        return void 0;\n      }\n    };\n    if (value && typeof value === "object" && typeof value.then === "function") {\n      return (async () => {\n        const promiseValue = await value;\n        return safeJson(promiseValue);\n      })();\n    }\n    return safeJson(value);\n  }\n};\nmodule.exports = UtilityScript;\n';var Pu={};function Ou(e,t,n){const r=t(e);if(!("fallThrough"in r))return r;if(e=r.fallThrough,n.has(e))throw new Error("Argument is a circular structure");if("symbol"==typeof e)return{v:"undefined"};if(Object.is(e,void 0))return{v:"undefined"};if(Object.is(e,null))return{v:"null"};if(Object.is(e,NaN))return{v:"NaN"};if(Object.is(e,1/0))return{v:"Infinity"};if(Object.is(e,-1/0))return{v:"-Infinity"};if(Object.is(e,-0))return{v:"-0"};if("boolean"==typeof e)return e;if("number"==typeof e)return e;if("string"==typeof e)return e;if(function(e){return e instanceof Error||e&&e.__proto__&&"Error"===e.__proto__.name}(e)){const t=e;return"captureStackTrace"in globalThis.Error?t.stack||"":`${t.name}: ${t.message}\n${t.stack}`}if(function(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}(e))return{d:e.toJSON()};if(function(e){return e instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(e)}(e))return{r:{p:e.source,f:e.flags}};if(Array.isArray(e)){const r=[];n.add(e);for(let i=0;i<e.length;++i)r.push(Ou(e[i],t,n));return n.delete(e),{a:r}}if("object"==typeof e){const r=[];n.add(e);for(const i of Object.keys(e)){let o;try{o=e[i]}catch(e){continue}"toJSON"===i&&"function"==typeof o?r.push({k:i,v:{o:[]}}):r.push({k:i,v:Ou(o,t,n)})}return n.delete(e),{o:r}}}Object.defineProperty(Pu,"__esModule",{value:!0}),Pu.parseEvaluationResultValue=function e(t,n=[]){if(Object.is(t,void 0))return;if("object"==typeof t&&t){if("v"in t){if("undefined"===t.v)return;return"null"===t.v?null:"NaN"===t.v?NaN:"Infinity"===t.v?1/0:"-Infinity"===t.v?-1/0:"-0"===t.v?-0:void 0}if("d"in t)return new Date(t.d);if("r"in t)return new RegExp(t.r.p,t.r.f);if("a"in t)return t.a.map((t=>e(t,n)));if("o"in t){const r={};for(const{k:i,v:o}of t.o)r[i]=e(o,n);return r}if("h"in t)return n[t.h]}return t},Pu.serializeAsCallArgument=function(e,t){return Ou(e,t,new Set)},Object.defineProperty(Cu,"__esModule",{value:!0}),Cu.JavaScriptErrorInEvaluate=Cu.JSHandle=Cu.ExecutionContext=void 0,Cu.evaluate=Du,Cu.evaluateExpression=Lu,Cu.evaluateExpressionAndWaitForSignals=Bu,Cu.isJavaScriptErrorInEvaluate=function(e){return e instanceof qu},Cu.normalizeEvaluationExpression=Hu,Cu.parseUnserializableValue=function(e){if("NaN"===e)return NaN;if("Infinity"===e)return 1/0;if("-Infinity"===e)return-1/0;if("-0"===e)return-0};var Au=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=Nu(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(Tu),Iu=Pu,Mu=Hl,Fu=pu;function Nu(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(Nu=function(e){return e?n:t})(e)}class Ru extends Mu.SdkObject{constructor(e,t){super(e,"execution-context"),this._delegate=void 0,this._utilityScriptPromise=void 0,this._destroyedPromise=new Fu.ManualPromise,this._delegate=t}contextDestroyed(e){this._destroyedPromise.resolve(e)}_raceAgainstContextDestroyed(e){return Promise.race([this._destroyedPromise.then((e=>{throw e})),e])}rawEvaluateJSON(e){return this._raceAgainstContextDestroyed(this._delegate.rawEvaluateJSON(e))}rawEvaluateHandle(e){return this._raceAgainstContextDestroyed(this._delegate.rawEvaluateHandle(e))}rawCallFunctionNoReply(e,...t){this._delegate.rawCallFunctionNoReply(e,...t)}evaluateWithArguments(e,t,n,r,i){return this._raceAgainstContextDestroyed(this._delegate.evaluateWithArguments(e,t,n,r,i))}getProperties(e,t){return this._raceAgainstContextDestroyed(this._delegate.getProperties(e,t))}createHandle(e){return this._delegate.createHandle(this,e)}releaseHandle(e){return this._delegate.releaseHandle(e)}async waitForSignalsCreatedBy(e){return e()}adoptIfNeeded(e){return null}utilityScript(){if(!this._utilityScriptPromise){const e=`\n      (() => {\n        const module = {};\n        ${Au.source}\n        return new module.exports();\n      })();`;this._utilityScriptPromise=this._raceAgainstContextDestroyed(this._delegate.rawEvaluateHandle(e).then((e=>new ju(this,"object",void 0,e))))}return this._utilityScriptPromise}async doSlowMo(){}}Cu.ExecutionContext=Ru;class ju extends Mu.SdkObject{constructor(e,t,n,r,i){super(e,"handle"),this._context=void 0,this._disposed=!1,this._objectId=void 0,this._value=void 0,this._objectType=void 0,this._preview=void 0,this._previewCallback=void 0,this._context=e,this._objectId=r,this._value=i,this._objectType=t,this._preview=this._objectId?n||`JSHandle@${this._objectType}`:String(i)}callFunctionNoReply(e,t){this._context.rawCallFunctionNoReply(e,this,t)}async evaluate(e,t){return Du(this._context,!0,e,this,t)}async evaluateHandle(e,t){return Du(this._context,!1,e,this,t)}async evaluateExpressionAndWaitForSignals(e,t,n,r){const i=await Bu(this._context,n,e,t,this,r);return await this._context.doSlowMo(),i}async getProperty(e){const t=await this.evaluateHandle(((e,t)=>{const n={__proto__:null};return n[t]=e[t],n}),e),n=(await t.getProperties()).get(e);return t.dispose(),n}async getProperties(){return this._objectId?this._context.getProperties(this._context,this._objectId):new Map}rawValue(){return this._value}async jsonValue(){if(!this._objectId)return this._value;const e=await this._context.utilityScript();return this._context.evaluateWithArguments("(utilityScript, ...args) => utilityScript.jsonValue(...args)",!0,e,[!0],[this._objectId])}asElement(){return null}dispose(){this._disposed||(this._disposed=!0,this._objectId&&this._context.releaseHandle(this._objectId).catch((e=>{})))}toString(){return this._preview}_setPreviewCallback(e){this._previewCallback=e}preview(){return this._preview}_setPreview(e){this._preview=e,this._previewCallback&&this._previewCallback(e)}}async function Du(e,t,n,...r){return Lu(e,t,String(n),"function"==typeof n,...r)}async function Lu(e,t,n,r,...i){const o=await e.utilityScript();n=Hu(n,r);const s=[],a=[],l=e=>(s.push(e),s.length-1);i=i.map((t=>(0,Iu.serializeAsCallArgument)(t,(t=>{if(t instanceof ju){if(!t._objectId)return{fallThrough:t._value};if(t._disposed)throw new Error("JSHandle is disposed!");const n=e.adoptIfNeeded(t);return null===n?{h:l(Promise.resolve(t))}:(a.push(n),{h:l(n)})}return{fallThrough:t}}))));const c=[];for(const t of await Promise.all(s)){if(t._context!==e)throw new Error("JSHandles can be evaluated only in the context they were created!");c.push(t._objectId)}const u=[r,t,n,i.length,...i];try{return await e.evaluateWithArguments("(utilityScript, ...args) => utilityScript.evaluate(...args)",t,o,u,c)}finally{a.map((e=>e.then((e=>e.dispose()))))}}async function Bu(e,t,n,r,...i){return await e.waitForSignalsCreatedBy((()=>Lu(e,t,n,r,...i)))}function Hu(e,t){if(e=e.trim(),t)try{new Function("("+e+")")}catch(t){e=e.startsWith("async ")?"async function "+e.substring("async ".length):"function "+e;try{new Function("("+e+")")}catch(e){throw new Error("Passed function is not well-serializable!")}}return/^(async)?\s*function(\s|\()/.test(e)&&(e="("+e+")"),e}Cu.JSHandle=ju;class qu extends Error{}Cu.JavaScriptErrorInEvaluate=qu;var Uu={};Object.defineProperty(Uu,"__esModule",{value:!0}),Uu.ProgressController=void 0;var Wu=Al,$u=Ci,zu=pu;async function Vu(e){try{await e()}catch(e){}}Uu.ProgressController=class{constructor(e,t){this._forceAbortPromise=new zu.ManualPromise,this._cleanups=[],this._logName="api",this._state="before",this._deadline=0,this._timeout=0,this._lastIntermediateResult=void 0,this.metadata=void 0,this.instrumentation=void 0,this.sdkObject=void 0,this.metadata=e,this.sdkObject=t,this.instrumentation=t.instrumentation,this._forceAbortPromise.catch((e=>null))}setLogName(e){this._logName=e}lastIntermediateResult(){return this._lastIntermediateResult}async run(e,t){t&&(this._timeout=t,this._deadline=t?(0,$u.monotonicTime)()+t:0),(0,$u.assert)("before"===this._state),this._state="running";const n={log:e=>{n.logEntry({message:e})},logEntry:e=>{if("message"in e){const t=e.message;"running"===this._state&&this.metadata.log.push(t),this.instrumentation.onCallLog(this.sdkObject,this.metadata,this._logName,t)}"intermediateResult"in e&&(this._lastIntermediateResult=e.intermediateResult)},timeUntilDeadline:()=>this._deadline?this._deadline-(0,$u.monotonicTime)():2147483647,isRunning:()=>"running"===this._state,cleanupWhenAborted:e=>{"running"===this._state?this._cleanups.push(e):Vu(e)},throwIfAborted:()=>{if("aborted"===this._state)throw new Gu},beforeInputAction:async e=>{await this.instrumentation.onBeforeInputAction(this.sdkObject,this.metadata,e)},metadata:this.metadata},r=new Wu.TimeoutError(`Timeout ${this._timeout}ms exceeded.`),i=setTimeout((()=>this._forceAbortPromise.reject(r)),n.timeUntilDeadline());try{const t=e(n),r=await Promise.race([t,this._forceAbortPromise]);return this._state="finished",r}catch(e){throw this._state="aborted",await Promise.all(this._cleanups.splice(0).map(Vu)),e}finally{clearTimeout(i)}}};class Gu extends Error{}Object.defineProperty(bu,"__esModule",{value:!0}),bu.NonRecoverableDOMError=bu.InjectedScriptPollHandler=bu.FrameExecutionContext=bu.ElementHandle=void 0,bu.assertDone=ad,bu.isNonRecoverableDOMError=function(e){return e instanceof nd},bu.kUnableToAdoptErrorMessage=void 0,bu.throwRetargetableDOMError=sd,bu.waitForSelectorTask=function(e,t,n,r){return i=>i.evaluateHandle(((e,{parsed:t,strict:n,state:r,omitReturnValue:i,root:o})=>{let s;return e.pollRaf((a=>{const l=e.querySelectorAll(t,o||document);let c=l[0];const u=!!c&&e.isVisible(c);if(s!==c)if(s=c,c){if(l.length>1){if(n)throw e.strictModeViolationError(t,l);a.log(`  selector resolved to ${l.length} elements. Proceeding with the first one.`)}a.log(`  selector resolved to ${u?"visible":"hidden"} ${e.previewNode(c)}`)}else a.log("  selector did not resolve to any element");const d=!!c;switch(i&&(c=void 0),r){case"attached":return d?c:a.continuePolling;case"detached":return d?a.continuePolling:void 0;case"visible":return u?c:a.continuePolling;case"hidden":return u?a.continuePolling:void 0}}))}),{parsed:e.parsed,strict:e.strict,state:t,omitReturnValue:n,root:r})};var Ku=td(Su),Ju=td(xu),Yu=ku,Xu=td(Cu),Qu=Uu,Zu=Ci;function ed(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(ed=function(e){return e?n:t})(e)}function td(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=ed(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}class nd extends Error{}bu.NonRecoverableDOMError=nd;class rd extends Xu.ExecutionContext{constructor(e,t,n){super(t,e),this.frame=void 0,this._injectedScriptPromise=void 0,this.world=void 0,this.frame=t,this.world=n}async waitForSignalsCreatedBy(e){return this.frame._page._frameManager.waitForSignalsCreatedBy(null,!1,e)}adoptIfNeeded(e){return e instanceof id&&e._context!==this?this.frame._page._delegate.adoptElementHandle(e,this):null}async evaluate(e,t){return Xu.evaluate(this,!0,e,t)}async evaluateHandle(e,t){return Xu.evaluate(this,!1,e,t)}async evaluateExpression(e,t,n){return Xu.evaluateExpression(this,!0,e,t,n)}async evaluateExpressionAndWaitForSignals(e,t,n){return await this.frame._page._frameManager.waitForSignalsCreatedBy(null,!1,(async()=>this.evaluateExpression(e,t,n)))}async evaluateExpressionHandleAndWaitForSignals(e,t,n){return await this.frame._page._frameManager.waitForSignalsCreatedBy(null,!1,(async()=>Xu.evaluateExpression(this,!1,e,t,n)))}createHandle(e){return this.frame._page._delegate.isElementHandle(e)?new id(this,e.objectId):super.createHandle(e)}injectedScript(){if(!this._injectedScriptPromise){const e=[];for(const[t,{source:n}]of this.frame._page.selectors._engines)e.push(`{ name: '${t}', engine: (${n}) }`);const t=`\n        (() => {\n        const module = {};\n        ${Ju.source}\n        return new module.exports(\n          ${(0,Zu.isUnderTest)()},\n          ${this.frame._page._delegate.rafCountForStablePosition()},\n          "${this.frame._page._browserContext._browser.options.name}",\n          ${(0,Zu.experimentalFeaturesEnabled)()},\n          [${e.join(",\n")}]\n        );\n        })();\n      `;this._injectedScriptPromise=this.rawEvaluateHandle(t).then((e=>new Xu.JSHandle(this,"object",void 0,e)))}return this._injectedScriptPromise}async doSlowMo(){return this.frame._page._doSlowMo()}}bu.FrameExecutionContext=rd;class id extends Xu.JSHandle{constructor(e,t){super(e,"node",void 0,t),this._page=void 0,this._frame=void 0,this._page=e.frame._page,this._frame=e.frame,this._initializePreview().catch((e=>{}))}async _initializePreview(){const e=await this._context.injectedScript();this._setPreview(await e.evaluate(((e,t)=>"JSHandle@"+e.previewNode(t)),this))}asElement(){return this}async evaluateInUtility(e,t){try{const n=await this._frame._utilityContext();return await n.evaluate(e,[await n.injectedScript(),this,t])}catch(e){if(Xu.isJavaScriptErrorInEvaluate(e)||(0,Yu.isSessionClosedError)(e))throw e;return"error:notconnected"}}async evaluateHandleInUtility(e,t){try{const n=await this._frame._utilityContext();return await n.evaluateHandle(e,[await n.injectedScript(),this,t])}catch(e){if(Xu.isJavaScriptErrorInEvaluate(e)||(0,Yu.isSessionClosedError)(e))throw e;return"error:notconnected"}}async evaluatePoll(e,t,n){try{const r=await this._frame._utilityContext(),i=await r.evaluateHandle(t,[await r.injectedScript(),this,n]),o=new od(e,i);return await o.finish()}catch(e){if(Xu.isJavaScriptErrorInEvaluate(e)||(0,Yu.isSessionClosedError)(e))throw e;return"error:notconnected"}}async ownerFrame(){const e=await this._page._delegate.getOwnerFrame(this);if(!e)return null;const t=this._page._frameManager.frame(e);if(t)return t;for(const t of this._page._browserContext.pages()){const n=t._frameManager.frame(e);if(n)return n}return null}async isIframeElement(){return this.evaluateInUtility((([e,t])=>t&&("IFRAME"===t.nodeName||"FRAME"===t.nodeName)),{})}async contentFrame(){return sd(await this.isIframeElement())?this._page._delegate.getContentFrame(this):null}async getAttribute(e){return sd(await this.evaluateInUtility((([e,t,n])=>{if(t.nodeType!==Node.ELEMENT_NODE)throw e.createStacklessError("Node is not an element");return{value:t.getAttribute(n)}}),e)).value}async inputValue(){return sd(await this.evaluateInUtility((([e,t])=>{const n=e.retarget(t,"follow-label");if(!n||"INPUT"!==n.nodeName&&"TEXTAREA"!==n.nodeName&&"SELECT"!==n.nodeName)throw e.createStacklessError("Node is not an <input>, <textarea> or <select> element");return{value:n.value}}),void 0)).value}async textContent(){return sd(await this.evaluateInUtility((([e,t])=>({value:t.textContent})),void 0)).value}async innerText(){return sd(await this.evaluateInUtility((([e,t])=>{if(t.nodeType!==Node.ELEMENT_NODE)throw e.createStacklessError("Node is not an element");if("http://www.w3.org/1999/xhtml"!==t.namespaceURI)throw e.createStacklessError("Node is not an HTMLElement");return{value:t.innerText}}),void 0)).value}async innerHTML(){return sd(await this.evaluateInUtility((([e,t])=>{if(t.nodeType!==Node.ELEMENT_NODE)throw e.createStacklessError("Node is not an element");return{value:t.innerHTML}}),void 0)).value}async dispatchEvent(e,t={}){const n=await this._frame._mainContext();await this._page._frameManager.waitForSignalsCreatedBy(null,!1,(async()=>n.evaluate((([e,t,{type:n,eventInit:r}])=>e.dispatchEvent(t,n,r)),[await n.injectedScript(),this,{type:e,eventInit:t}]))),await this._page._doSlowMo()}async _scrollRectIntoViewIfNeeded(e){return await this._page._delegate.scrollRectIntoViewIfNeeded(this,e)}async _waitAndScrollIntoViewIfNeeded(e){for(;e.isRunning();){sd(await this._waitForDisplayedAtStablePosition(e,!1,!1)),e.throwIfAborted();if("error:notvisible"!==sd(await this._scrollRectIntoViewIfNeeded()))return}}async scrollIntoViewIfNeeded(e,t={}){return new Qu.ProgressController(e,this).run((e=>this._waitAndScrollIntoViewIfNeeded(e)),this._page._timeoutSettings.timeout(t))}async _clickablePoint(){const[e,t]=await Promise.all([this._page._delegate.getContentQuads(this),this._page.mainFrame()._utilityContext().then((e=>e.evaluate((()=>({width:innerWidth,height:innerHeight})))))]);if(!e||!e.length)return"error:notvisible";const n=e.map((e=>(e=>e.map((e=>({x:Math.min(Math.max(e.x,0),t.width),y:Math.min(Math.max(e.y,0),t.height)}))))(e))).filter((e=>(e=>{let t=0;for(let n=0;n<e.length;++n){const r=e[n],i=e[(n+1)%e.length];t+=(r.x*i.y-i.x*r.y)/2}return Math.abs(t)})(e)>.99));if(!n.length)return"error:notinviewport";const r={x:0,y:0};for(const e of n[0])r.x+=e.x/4,r.y+=e.y/4;return function(e){const t=e.x-Math.floor(e.x);t>.49&&t<.51&&(e.x-=.02);const n=e.y-Math.floor(e.y);n>.49&&n<.51&&(e.y-=.02)}(r),r}async _offsetPoint(e){const[t,n]=await Promise.all([this.boundingBox(),this.evaluateInUtility((([e,t])=>e.getElementBorderWidth(t)),{}).catch((e=>{}))]);return t&&n?"error:notconnected"===n?n:{x:t.x+n.left+e.x,y:t.y+n.top+e.y}:"error:notvisible"}async _retryPointerAction(e,t,n,r,i){let o=0;const s=[0,20,100,100,500],a=[void 0,{block:"end",inline:"end"},{block:"center",inline:"center"},{block:"start",inline:"start"}];for(;e.isRunning();){if(o){e.log(`retrying ${t} action${i.trial?" (trial run)":""}, attempt #${o}`);const n=s[Math.min(o-1,s.length-1)];if(n){e.log(`  waiting ${n}ms`);const t=await this.evaluateInUtility((([e,t,n])=>new Promise((e=>setTimeout(e,n)))),n);if("error:notconnected"===t)return t}}else e.log(`attempting ${t} action${i.trial?" (trial run)":""}`);const l=a[o%a.length],c=await this._performPointerAction(e,t,n,r,l,i);if(++o,"error:notvisible"!==c)if("error:notinviewport"!==c){if("object"!=typeof c||!("hitTargetDescription"in c))return c;e.log(`  ${c.hitTargetDescription} intercepts pointer events`)}else{if(i.force)throw new nd("Element is outside of the viewport");e.log("  element is outside of the viewport")}else{if(i.force)throw new nd("Element is not visible");e.log("  element is not visible")}}return"done"}async _performPointerAction(e,t,n,r,i,o){const{force:s=!1,position:a}=o;o.__testHookBeforeStable&&await o.__testHookBeforeStable();const l=await this._waitForDisplayedAtStablePosition(e,s,n);if("done"!==l)return l;if(o.__testHookAfterStable&&await o.__testHookAfterStable(),e.log("  scrolling into view if needed"),e.throwIfAborted(),i){const e=await this.evaluateInUtility((([e,t,n])=>{1===t.nodeType&&t.scrollIntoView(n)}),i);if("error:notconnected"===e)return e}else{const e=await this._scrollRectIntoViewIfNeeded(a?{x:a.x,y:a.y,width:0,height:0}:void 0);if("done"!==e)return e}e.log("  done scrolling");const c=a?await this._offsetPoint(a):await this._clickablePoint();if("string"==typeof c)return c;const u=function(e){return{x:(100*e.x|0)/100,y:(100*e.y|0)/100}}(c);let d;if(e.metadata.point=u,await e.beforeInputAction(this),!o.force)if(o.__testHookBeforeHitTarget&&await o.__testHookBeforeHitTarget(),"move and up"===t){e.log(`  checking that element receives pointer events at (${u.x},${u.y})`);const n=await this._checkHitTargetAt(u);if("done"!==n)return n;if(e.log("  element does receive pointer events"),o.trial)return e.log(`  trial ${t} has finished`),"done"}else{const n="hover"===t||"tap"===t?t:"mouse",r=await this.evaluateHandleInUtility((([e,t,{actionType:n,trial:r}])=>e.setupHitTargetInterceptor(t,n,r)),{actionType:n,trial:!!o.trial});if("error:notconnected"===r)return r;if(!r._objectId)return r.rawValue();d=r,e.cleanupWhenAborted((()=>{d.evaluate((e=>e.stop())).catch((e=>{}))}))}const h=await this._page._frameManager.waitForSignalsCreatedBy(e,o.noWaitAfter,(async()=>{let n;if(o.__testHookBeforePointerAction&&await o.__testHookBeforePointerAction(),e.throwIfAborted(),o&&o.modifiers&&(n=await this._page.keyboard._ensureModifiers(o.modifiers)),e.log(`  performing ${t} action`),await r(u),n&&await this._page.keyboard._ensureModifiers(n),d){const e=d.evaluate((e=>e.stop())).catch((e=>"done"));if(!o.noWaitAfter){const t=await e;if("done"!==t)return t}}return e.log(`  ${o.trial?"trial ":""}${t} action done`),e.log("  waiting for scheduled navigations to finish"),o.__testHookAfterPointerAction&&await o.__testHookAfterPointerAction(),"done"}),"input");return"done"!==h?h:(e.log("  navigations have finished"),"done")}async hover(e,t){return new Qu.ProgressController(e,this).run((async e=>{sd(await this._hover(e,t))}),this._page._timeoutSettings.timeout(t))}_hover(e,t){return this._retryPointerAction(e,"hover",!1,(e=>this._page.mouse.move(e.x,e.y)),t)}async click(e,t={}){return new Qu.ProgressController(e,this).run((async e=>{sd(await this._click(e,t))}),this._page._timeoutSettings.timeout(t))}_click(e,t){return this._retryPointerAction(e,"click",!0,(e=>this._page.mouse.click(e.x,e.y,t)),t)}async dblclick(e,t){return new Qu.ProgressController(e,this).run((async e=>{sd(await this._dblclick(e,t))}),this._page._timeoutSettings.timeout(t))}_dblclick(e,t){return this._retryPointerAction(e,"dblclick",!0,(e=>this._page.mouse.dblclick(e.x,e.y,t)),t)}async tap(e,t={}){return new Qu.ProgressController(e,this).run((async e=>{sd(await this._tap(e,t))}),this._page._timeoutSettings.timeout(t))}_tap(e,t){return this._retryPointerAction(e,"tap",!0,(e=>this._page.touchscreen.tap(e.x,e.y)),t)}async selectOption(e,t,n,r){return new Qu.ProgressController(e,this).run((async e=>sd(await this._selectOption(e,t,n,r))),this._page._timeoutSettings.timeout(r))}async _selectOption(e,t,n,r){const i=[...t,...n];return await e.beforeInputAction(this),this._page._frameManager.waitForSignalsCreatedBy(e,r.noWaitAfter,(async()=>{e.throwIfAborted(),e.log("  selecting specified option(s)");const t=await this.evaluatePoll(e,(([e,t,{optionsToSelect:n,force:r}])=>e.waitForElementStatesAndPerformAction(t,["visible","enabled"],r,e.selectOptions.bind(e,n))),{optionsToSelect:i,force:r.force});return await this._page._doSlowMo(),t}))}async fill(e,t,n={}){return new Qu.ProgressController(e,this).run((async e=>{sd(await this._fill(e,t,n))}),this._page._timeoutSettings.timeout(n))}async _fill(e,t,n){return e.log(`elementHandle.fill("${t}")`),await e.beforeInputAction(this),this._page._frameManager.waitForSignalsCreatedBy(e,n.noWaitAfter,(async()=>{e.log("  waiting for element to be visible, enabled and editable");const r=await this.evaluatePoll(e,(([e,t,{value:n,force:r}])=>e.waitForElementStatesAndPerformAction(t,["visible","enabled","editable"],r,e.fill.bind(e,n))),{value:t,force:n.force});return e.throwIfAborted(),"error:notconnected"===r?r:(e.log("  element is visible, enabled and editable"),"needsinput"===r&&(e.throwIfAborted(),t?await this._page.keyboard.insertText(t):await this._page.keyboard.press("Delete")),"done")}),"input")}async selectText(e,t={}){return new Qu.ProgressController(e,this).run((async e=>{e.throwIfAborted();const n=await this.evaluatePoll(e,(([e,t,n])=>e.waitForElementStatesAndPerformAction(t,["visible"],n,e.selectText.bind(e))),t.force);sd(n)}),this._page._timeoutSettings.timeout(t))}async setInputFiles(e,t,n){return new Qu.ProgressController(e,this).run((async e=>{sd(await this._setInputFiles(e,t,n))}),this._page._timeoutSettings.timeout(n))}async _setInputFiles(e,t,n){const{files:r,localPaths:i}=t;if(r)for(const e of r)e.mimeType||(e.mimeType=Ku.getType(e.name)||"application/octet-stream");const o=r&&r.length>1||i&&i.length>1,s=await this.evaluateHandleInUtility((([e,t,n])=>{const r=e.retarget(t,"follow-label");if(r){if("INPUT"!==r.tagName)throw e.createStacklessError("Node is not an HTMLInputElement");if(n&&!r.multiple)throw e.createStacklessError("Non-multiple file input can only accept single file");return r}}),o);if("error:notconnected"===s||!s.asElement())return"error:notconnected";const a=s.asElement();return await e.beforeInputAction(this),await this._page._frameManager.waitForSignalsCreatedBy(e,n.noWaitAfter,(async()=>{e.throwIfAborted(),i?await this._page._delegate.setInputFilePaths(a,i):await this._page._delegate.setInputFiles(a,r)})),await this._page._doSlowMo(),"done"}async focus(e){const t=new Qu.ProgressController(e,this);await t.run((async e=>{const t=await this._focus(e);await this._page._doSlowMo(),sd(t)}),0)}async _focus(e,t){return e.throwIfAborted(),await this.evaluateInUtility((([e,t,n])=>e.focusNode(t,n)),t)}async type(e,t,n){return new Qu.ProgressController(e,this).run((async e=>{sd(await this._type(e,t,n))}),this._page._timeoutSettings.timeout(n))}async _type(e,t,n){return e.log(`elementHandle.type("${t}")`),await e.beforeInputAction(this),this._page._frameManager.waitForSignalsCreatedBy(e,n.noWaitAfter,(async()=>{const r=await this._focus(e,!0);return"done"!==r?r:(e.throwIfAborted(),await this._page.keyboard.type(t,n),"done")}),"input")}async press(e,t,n){return new Qu.ProgressController(e,this).run((async e=>{sd(await this._press(e,t,n))}),this._page._timeoutSettings.timeout(n))}async _press(e,t,n){return e.log(`elementHandle.press("${t}")`),await e.beforeInputAction(this),this._page._frameManager.waitForSignalsCreatedBy(e,n.noWaitAfter,(async()=>{const r=await this._focus(e,!0);return"done"!==r?r:(e.throwIfAborted(),await this._page.keyboard.press(t,n),"done")}),"input")}async check(e,t){return new Qu.ProgressController(e,this).run((async e=>{sd(await this._setChecked(e,!0,t))}),this._page._timeoutSettings.timeout(t))}async uncheck(e,t){return new Qu.ProgressController(e,this).run((async e=>{sd(await this._setChecked(e,!1,t))}),this._page._timeoutSettings.timeout(t))}async _setChecked(e,t,n){const r=async()=>{const e=await this.evaluateInUtility((([e,t])=>e.elementState(t,"checked")),{});return sd(e)};if(await r()===t)return"done";const i=await this._click(e,n);if("done"!==i)return i;if(n.trial)return"done";if(await r()!==t)throw new nd("Clicking the checkbox did not change its state");return"done"}async boundingBox(){return this._page._delegate.getBoundingBox(this)}async screenshot(e,t={}){return new Qu.ProgressController(e,this).run((e=>this._page._screenshotter.screenshotElement(e,this,t)),this._page._timeoutSettings.timeout(t))}async querySelector(e,t){const n=await this._frame.resolveFrameForSelectorNoWait(e,t,this);if(!n)return null;const{frame:r,info:i}=n;return this._page.selectors.query(r,i,this._frame===r?this:void 0)}async querySelectorAll(e){const t=await this._frame.resolveFrameForSelectorNoWait(e,{},this);if(!t)return[];const{frame:n,info:r}=t;return this._page.selectors._queryAll(n,r,this._frame===n?this:void 0,!0)}async evalOnSelectorAndWaitForSignals(e,t,n,r,i){const o=await this._frame.resolveFrameForSelectorNoWait(e,{strict:t},this),s=o?await this._page.selectors.query(o.frame,o.info,this._frame===o.frame?this:void 0):null;if(!s)throw new Error(`Error: failed to find element matching selector "${e}"`);const a=await s.evaluateExpressionAndWaitForSignals(n,r,!0,i);return s.dispose(),a}async evalOnSelectorAllAndWaitForSignals(e,t,n,r){const i=await this._frame.resolveFrameForSelectorNoWait(e,{},this);if(!i)throw new Error(`Error: failed to find frame for selector "${e}"`);const{frame:o,info:s}=i,a=await this._page.selectors._queryArrayInMainWorld(o,s,this._frame===o?this:void 0),l=await a.evaluateExpressionAndWaitForSignals(t,n,!0,r);return a.dispose(),l}async isVisible(){const e=await this.evaluateInUtility((([e,t])=>e.elementState(t,"visible")),{});return"error:notconnected"!==e&&e}async isHidden(){const e=await this.evaluateInUtility((([e,t])=>e.elementState(t,"hidden")),{});return sd(e)}async isEnabled(){const e=await this.evaluateInUtility((([e,t])=>e.elementState(t,"enabled")),{});return sd(e)}async isDisabled(){const e=await this.evaluateInUtility((([e,t])=>e.elementState(t,"disabled")),{});return sd(e)}async isEditable(){const e=await this.evaluateInUtility((([e,t])=>e.elementState(t,"editable")),{});return sd(e)}async isChecked(){const e=await this.evaluateInUtility((([e,t])=>e.elementState(t,"checked")),{});return sd(e)}async waitForElementState(e,t,n={}){return new Qu.ProgressController(e,this).run((async e=>{e.log(`  waiting for element to be ${t}`);const n=await this.evaluatePoll(e,(([e,t,n])=>e.waitForElementStatesAndPerformAction(t,[n],!1,(()=>"done"))),t);sd(n)}),this._page._timeoutSettings.timeout(n))}async waitForSelector(e,t,n={}){return this._frame.waitForSelector(e,t,n,this)}async _adoptTo(e){if(this._context!==e){const t=await this._page._delegate.adoptElementHandle(this,e);return this.dispose(),t}return this}async _waitForDisplayedAtStablePosition(e,t,n){n?e.log("  waiting for element to be visible, enabled and stable"):e.log("  waiting for element to be visible and stable");const r=await this.evaluatePoll(e,(([e,t,{waitForEnabled:n,force:r}])=>e.waitForElementStatesAndPerformAction(t,n?["visible","stable","enabled"]:["visible","stable"],r,(()=>"done"))),{waitForEnabled:n,force:t});return"error:notconnected"===r||(n?e.log("  element is visible, enabled and stable"):e.log("  element is visible and stable")),r}async _checkHitTargetAt(e){const t=await this.ownerFrame();if(t&&t.parentFrame()){const n=await t.frameElement(),r=await n.boundingBox();if(!r)return"error:notconnected";e={x:e.x-r.x,y:e.y-r.y}}return this.evaluateInUtility((([e,t,n])=>e.checkHitTargetAt(t,n)),e)}}bu.ElementHandle=id;class od{constructor(e,t){this._progress=void 0,this._poll=void 0,this._progress=e,this._poll=t,this._progress.cleanupWhenAborted((()=>this.cancel())),this._streamLogs()}async _streamLogs(){for(;this._poll&&this._progress.isRunning();){const e=await this._poll.evaluate((e=>e.takeNextLogs())).catch((e=>[]));if(!this._poll||!this._progress.isRunning())return;for(const t of e)this._progress.logEntry(t)}}async finishHandle(){try{const e=await this._poll.evaluateHandle((e=>e.run()));return await this._finishInternal(),e}finally{await this.cancel()}}async finish(){try{const e=await this._poll.evaluate((e=>e.run()));return await this._finishInternal(),e}finally{await this.cancel()}}async _finishInternal(){if(!this._poll)return;const e=await this._poll.evaluate((e=>e.takeLastLogs())).catch((e=>[]));for(const t of e)this._progress.logEntry(t)}async cancel(){if(!this._poll)return;const e=this._poll;this._poll=null,await e.evaluate((e=>e.cancel())).catch((e=>{})),e.dispose()}}function sd(e){if("error:notconnected"===e)throw new Error("Element is not attached to the DOM");return e}function ad(e){}bu.InjectedScriptPollHandler=od;bu.kUnableToAdoptErrorMessage="Unable to adopt element handle from a different document";var ld={};Object.defineProperty(ld,"__esModule",{value:!0}),ld.reducedMotions=ld.mediaTypes=ld.kLifecycleEvents=ld.forcedColors=ld.colorSchemes=void 0;const cd=new Set(["load","domcontentloaded","networkidle","commit"]);ld.kLifecycleEvents=cd;const ud=new Set(["screen","print"]);ld.mediaTypes=ud;const dd=new Set(["dark","light","no-preference"]);ld.colorSchemes=dd;const hd=new Set(["no-preference","reduce"]);ld.reducedMotions=hd;const pd=new Set(["active","none"]);ld.forcedColors=pd;var fd={},md={},gd={};!function(e){var t=function(e,t,n){return e>=t&&e<=n};function n(e){return t(e,48,57)}function r(e){return n(e)||t(e,65,70)||t(e,97,102)}function i(e){return t(e,65,90)}function o(e){return t(e,97,122)}function s(e){return i(e)||o(e)}function a(e){return e>=128}function l(e){return s(e)||a(e)||95==e}function c(e){return l(e)||n(e)||45==e}function u(e){return t(e,0,8)||11==e||t(e,14,31)||127==e}function d(e){return 10==e}function h(e){return d(e)||9==e||32==e}var p=1114111,f=function(e){this.message=e};function m(e){for(var n=[],r=0;r<e.length;r++){var i=e.charCodeAt(r);if(13==i&&10==e.charCodeAt(r+1)&&(i=10,r++),13!=i&&12!=i||(i=10),0==i&&(i=65533),t(i,55296,56319)&&t(e.charCodeAt(r+1),56320,57343)){var o=i-55296,s=e.charCodeAt(r+1)-56320;i=Math.pow(2,16)+o*Math.pow(2,10)+s,r++}n.push(i)}return n}function g(e){if(e<=65535)return String.fromCharCode(e);e-=Math.pow(2,16);var t=Math.floor(e/Math.pow(2,10))+55296,n=e%Math.pow(2,10)+56320;return String.fromCharCode(t)+String.fromCharCode(n)}function _(e){e=m(e);for(var t,i=-1,o=[],s=function(t){return t>=e.length?-1:e[t]},a=function(e){if(void 0===e&&(e=1),e>3)throw"Spec Error: no more than three codepoints of lookahead.";return s(i+e)},f=function(e){return void 0===e&&(e=1),t=s(i+=e),!0},_=function(){return i-=1,!0},w=function(e){return void 0===e&&(e=t),-1==e},T=function(){return console.log("Parse error at index "+i+", processing codepoint 0x"+t.toString(16)+"."),!0},U=function(){if(Q(),f(),h(t)){for(;h(a());)f();return new y}if(34==t)return te();if(35==t){if(c(a())||ie(a(1),a(2))){var e=new V;return se(a(1),a(2),a(3))&&(e.type="id"),e.value=ue(),e}return new q(t)}return 36==t?61==a()?(f(),new D):new q(t):39==t?te():40==t?new M:41==t?new F:42==t?61==a()?(f(),new L):new q(t):43==t?ce()?(_(),Z()):new q(t):44==t?new C:45==t?ce()?(_(),Z()):45==a(1)&&62==a(2)?(f(2),new x):ae()?(_(),ee()):new q(t):46==t?ce()?(_(),Z()):new q(t):58==t?new k:59==t?new E:60==t?33==a(1)&&45==a(2)&&45==a(3)?(f(3),new S):new q(t):64==t?se(a(1),a(2),a(3))?new z(ue()):new q(t):91==t?new A:92==t?oe()?(_(),ee()):(T(),new q(t)):93==t?new I:94==t?61==a()?(f(),new j):new q(t):123==t?new P:124==t?61==a()?(f(),new R):124==a()?(f(),new B):new q(t):125==t?new O:126==t?61==a()?(f(),new N):new q(t):n(t)?(_(),Z()):l(t)?(_(),ee()):w()?new H:new q(t)},Q=function(){for(;47==a(1)&&42==a(2);)for(f(2);;){if(f(),42==t&&47==a()){f();break}if(w())return void T()}},Z=function(){var e,t=de();return se(a(1),a(2),a(3))?((e=new X).value=t.value,e.repr=t.repr,e.type=t.type,e.unit=ue(),e):37==a()?(f(),(e=new Y).value=t.value,e.repr=t.repr,e):((e=new J).value=t.value,e.repr=t.repr,e.type=t.type,e)},ee=function(){var e=ue();if("url"==e.toLowerCase()&&40==a()){for(f();h(a(1))&&h(a(2));)f();return 34==a()||39==a()?new $(e):!h(a())||34!=a(2)&&39!=a(2)?ne():new $(e)}return 40==a()?(f(),new $(e)):new W(e)},te=function(e){void 0===e&&(e=t);for(var n="";f();){if(t==e||w())return new G(n);if(d(t))return T(),_(),new v;92==t?w(a())||(d(a())?f():n+=g(re())):n+=g(t)}},ne=function(){for(var e=new K("");h(a());)f();if(w(a()))return e;for(;f();){if(41==t||w())return e;if(h(t)){for(;h(a());)f();return 41==a()||w(a())?(f(),e):(pe(),new b)}if(34==t||39==t||40==t||u(t))return T(),pe(),new b;if(92==t){if(!oe())return T(),pe(),new b;e.value+=g(re())}else e.value+=g(t)}},re=function(){if(f(),r(t)){for(var e=[t],n=0;n<5&&r(a());n++)f(),e.push(t);h(a())&&f();var i=parseInt(e.map((function(e){return String.fromCharCode(e)})).join(""),16);return i>p&&(i=65533),i}return w()?65533:t},ie=function(e,t){return 92==e&&!d(t)},oe=function(){return ie(t,a())},se=function(e,t,n){return 45==e?l(t)||45==t||ie(t,n):!!l(e)||92==e&&ie(e,t)},ae=function(){return se(t,a(1),a(2))},le=function(e,t,r){return 43==e||45==e?!!n(t)||!(46!=t||!n(r)):46==e?!!n(t):!!n(e)},ce=function(){return le(t,a(1),a(2))},ue=function(){for(var e="";f();)if(c(t))e+=g(t);else{if(!oe())return _(),e;e+=g(re())}},de=function(){var e=[],r="integer";for(43!=a()&&45!=a()||(f(),e+=g(t));n(a());)f(),e+=g(t);if(46==a(1)&&n(a(2)))for(f(),e+=g(t),f(),e+=g(t),r="number";n(a());)f(),e+=g(t);var i=a(1),o=a(2),s=a(3);if(69!=i&&101!=i||!n(o)){if((69==i||101==i)&&(43==o||45==o)&&n(s))for(f(),e+=g(t),f(),e+=g(t),f(),e+=g(t),r="number";n(a());)f(),e+=g(t)}else for(f(),e+=g(t),f(),e+=g(t),r="number";n(a());)f(),e+=g(t);return{type:r,value:he(e),repr:e}},he=function(e){return+e},pe=function(){for(;f();){if(41==t||w())return;oe()&&re()}},fe=0;!w(a());)if(o.push(U()),++fe>2*e.length)return"I'm infinite-looping!";return o}function w(){throw"Abstract Base Class"}function v(){return this}function b(){return this}function y(){return this}function S(){return this}function x(){return this}function k(){return this}function E(){return this}function C(){return this}function T(){throw"Abstract Base Class"}function P(){return this.value="{",this.mirror="}",this}function O(){return this.value="}",this.mirror="{",this}function A(){return this.value="[",this.mirror="]",this}function I(){return this.value="]",this.mirror="[",this}function M(){return this.value="(",this.mirror=")",this}function F(){return this.value=")",this.mirror="(",this}function N(){return this}function R(){return this}function j(){return this}function D(){return this}function L(){return this}function B(){return this}function H(){return this}function q(e){return this.value=g(e),this}function U(){throw"Abstract Base Class"}function W(e){this.value=e}function $(e){this.value=e,this.mirror=")"}function z(e){this.value=e}function V(e){this.value=e,this.type="unrestricted"}function G(e){this.value=e}function K(e){this.value=e}function J(){this.value=null,this.type="integer",this.repr=""}function Y(){this.value=null,this.repr=""}function X(){this.value=null,this.type="integer",this.repr="",this.unit=""}function Q(e){for(var n="",r=(e=""+e).charCodeAt(0),i=0;i<e.length;i++){var o=e.charCodeAt(i);if(0==o)throw new f("Invalid character: the input contains U+0000.");t(o,1,31)||127==o||0==i&&t(o,48,57)||1==i&&t(o,48,57)&&45==r?n+="\\"+o.toString(16)+" ":o>=128||45==o||95==o||t(o,48,57)||t(o,65,90)||t(o,97,122)?n+=e[i]:n+="\\"+e[i]}return n}function Z(e){var n="";(e=""+e).charCodeAt(0);for(var r=0;r<e.length;r++){var i=e.charCodeAt(r);if(0==i)throw new f("Invalid character: the input contains U+0000.");i>=128||45==i||95==i||t(i,48,57)||t(i,65,90)||t(i,97,122)?n+=e[r]:n+="\\"+i.toString(16)+" "}return n}function ee(e){e=""+e;for(var n="",r=0;r<e.length;r++){var i=e.charCodeAt(r);if(0==i)throw new f("Invalid character: the input contains U+0000.");t(i,1,31)||127==i?n+="\\"+i.toString(16)+" ":n+=34==i||92==i?"\\"+e[r]:e[r]}return n}f.prototype=new Error,f.prototype.name="InvalidCharacterError",w.prototype.toJSON=function(){return{token:this.tokenType}},w.prototype.toString=function(){return this.tokenType},w.prototype.toSource=function(){return""+this},v.prototype=Object.create(w.prototype),v.prototype.tokenType="BADSTRING",b.prototype=Object.create(w.prototype),b.prototype.tokenType="BADURL",y.prototype=Object.create(w.prototype),y.prototype.tokenType="WHITESPACE",y.prototype.toString=function(){return"WS"},y.prototype.toSource=function(){return" "},S.prototype=Object.create(w.prototype),S.prototype.tokenType="CDO",S.prototype.toSource=function(){return"\x3c!--"},x.prototype=Object.create(w.prototype),x.prototype.tokenType="CDC",x.prototype.toSource=function(){return"--\x3e"},k.prototype=Object.create(w.prototype),k.prototype.tokenType=":",E.prototype=Object.create(w.prototype),E.prototype.tokenType=";",C.prototype=Object.create(w.prototype),C.prototype.tokenType=",",T.prototype=Object.create(w.prototype),P.prototype=Object.create(T.prototype),P.prototype.tokenType="{",O.prototype=Object.create(T.prototype),O.prototype.tokenType="}",A.prototype=Object.create(T.prototype),A.prototype.tokenType="[",I.prototype=Object.create(T.prototype),I.prototype.tokenType="]",M.prototype=Object.create(T.prototype),M.prototype.tokenType="(",F.prototype=Object.create(T.prototype),F.prototype.tokenType=")",N.prototype=Object.create(w.prototype),N.prototype.tokenType="~=",R.prototype=Object.create(w.prototype),R.prototype.tokenType="|=",j.prototype=Object.create(w.prototype),j.prototype.tokenType="^=",D.prototype=Object.create(w.prototype),D.prototype.tokenType="$=",L.prototype=Object.create(w.prototype),L.prototype.tokenType="*=",B.prototype=Object.create(w.prototype),B.prototype.tokenType="||",H.prototype=Object.create(w.prototype),H.prototype.tokenType="EOF",H.prototype.toSource=function(){return""},q.prototype=Object.create(w.prototype),q.prototype.tokenType="DELIM",q.prototype.toString=function(){return"DELIM("+this.value+")"},q.prototype.toJSON=function(){var e=this.constructor.prototype.constructor.prototype.toJSON.call(this);return e.value=this.value,e},q.prototype.toSource=function(){return"\\"==this.value?"\\\n":this.value},U.prototype=Object.create(w.prototype),U.prototype.ASCIIMatch=function(e){return this.value.toLowerCase()==e.toLowerCase()},U.prototype.toJSON=function(){var e=this.constructor.prototype.constructor.prototype.toJSON.call(this);return e.value=this.value,e},W.prototype=Object.create(U.prototype),W.prototype.tokenType="IDENT",W.prototype.toString=function(){return"IDENT("+this.value+")"},W.prototype.toSource=function(){return Q(this.value)},$.prototype=Object.create(U.prototype),$.prototype.tokenType="FUNCTION",$.prototype.toString=function(){return"FUNCTION("+this.value+")"},$.prototype.toSource=function(){return Q(this.value)+"("},z.prototype=Object.create(U.prototype),z.prototype.tokenType="AT-KEYWORD",z.prototype.toString=function(){return"AT("+this.value+")"},z.prototype.toSource=function(){return"@"+Q(this.value)},V.prototype=Object.create(U.prototype),V.prototype.tokenType="HASH",V.prototype.toString=function(){return"HASH("+this.value+")"},V.prototype.toJSON=function(){var e=this.constructor.prototype.constructor.prototype.toJSON.call(this);return e.value=this.value,e.type=this.type,e},V.prototype.toSource=function(){return"id"==this.type?"#"+Q(this.value):"#"+Z(this.value)},G.prototype=Object.create(U.prototype),G.prototype.tokenType="STRING",G.prototype.toString=function(){return'"'+ee(this.value)+'"'},K.prototype=Object.create(U.prototype),K.prototype.tokenType="URL",K.prototype.toString=function(){return"URL("+this.value+")"},K.prototype.toSource=function(){return'url("'+ee(this.value)+'")'},J.prototype=Object.create(w.prototype),J.prototype.tokenType="NUMBER",J.prototype.toString=function(){return"integer"==this.type?"INT("+this.value+")":"NUMBER("+this.value+")"},J.prototype.toJSON=function(){var e=this.constructor.prototype.constructor.prototype.toJSON.call(this);return e.value=this.value,e.type=this.type,e.repr=this.repr,e},J.prototype.toSource=function(){return this.repr},Y.prototype=Object.create(w.prototype),Y.prototype.tokenType="PERCENTAGE",Y.prototype.toString=function(){return"PERCENTAGE("+this.value+")"},Y.prototype.toJSON=function(){var e=this.constructor.prototype.constructor.prototype.toJSON.call(this);return e.value=this.value,e.repr=this.repr,e},Y.prototype.toSource=function(){return this.repr+"%"},X.prototype=Object.create(w.prototype),X.prototype.tokenType="DIMENSION",X.prototype.toString=function(){return"DIM("+this.value+","+this.unit+")"},X.prototype.toJSON=function(){var e=this.constructor.prototype.constructor.prototype.toJSON.call(this);return e.value=this.value,e.type=this.type,e.repr=this.repr,e.unit=this.unit,e},X.prototype.toSource=function(){var e=this.repr,n=Q(this.unit);return"e"!=n[0].toLowerCase()||"-"!=n[1]&&!t(n.charCodeAt(1),48,57)||(n="\\65 "+n.slice(1,n.length)),e+n},e.tokenize=_,e.IdentToken=W,e.FunctionToken=$,e.AtKeywordToken=z,e.HashToken=V,e.StringToken=G,e.BadStringToken=v,e.URLToken=K,e.BadURLToken=b,e.DelimToken=q,e.NumberToken=J,e.PercentageToken=Y,e.DimensionToken=X,e.IncludeMatchToken=N,e.DashMatchToken=R,e.PrefixMatchToken=j,e.SuffixMatchToken=D,e.SubstringMatchToken=L,e.ColumnToken=B,e.WhitespaceToken=y,e.CDOToken=S,e.CDCToken=x,e.ColonToken=k,e.SemicolonToken=E,e.CommaToken=C,e.OpenParenToken=M,e.CloseParenToken=F,e.OpenSquareToken=A,e.CloseSquareToken=I,e.OpenCurlyToken=P,e.CloseCurlyToken=O,e.EOFToken=H,e.CSSParserToken=w,e.GroupingToken=T}(gd),Object.defineProperty(md,"__esModule",{value:!0}),md.InvalidSelectorError=void 0,md.isInvalidSelectorError=function(e){return e instanceof bd},md.parseCSS=function(e,t){let n;try{n=wd.tokenize(e),n[n.length-1]instanceof wd.EOFToken||n.push(new wd.EOFToken)}catch(t){const n=t.message+` while parsing selector "${e}"`,r=(t.stack||"").indexOf(t.message);throw-1!==r&&(t.stack=t.stack.substring(0,r)+n+t.stack.substring(r+t.message.length)),t.message=n,t}const r=n.find((e=>e instanceof wd.AtKeywordToken||e instanceof wd.BadStringToken||e instanceof wd.BadURLToken||e instanceof wd.ColumnToken||e instanceof wd.CDOToken||e instanceof wd.CDCToken||e instanceof wd.SemicolonToken||e instanceof wd.OpenCurlyToken||e instanceof wd.CloseCurlyToken||e instanceof wd.URLToken||e instanceof wd.PercentageToken));if(r)throw new bd(`Unsupported token "${r.toSource()}" while parsing selector "${e}"`);let i=0;const o=new Set;function s(){return new bd(`Unexpected token "${n[i].toSource()}" while parsing selector "${e}"`)}function a(){for(;n[i]instanceof wd.WhitespaceToken;)i++}function l(e=i){return n[e]instanceof wd.IdentToken}function c(e=i){return n[e]instanceof wd.CommaToken}function u(e=i){return n[e]instanceof wd.CloseParenToken}function d(e=i){return n[e]instanceof wd.DelimToken&&"*"===n[e].value}function h(e=i){return n[e]instanceof wd.EOFToken}function p(e=i){return n[e]instanceof wd.DelimToken&&[">","+","~"].includes(n[e].value)}function f(e=i){return c(e)||u(e)||h(e)||p(e)||n[e]instanceof wd.WhitespaceToken}function m(){const e=[g()];for(;a(),c();)i++,e.push(g());return e}function g(){return a(),function(e=i){return n[e]instanceof wd.NumberToken}()||function(e=i){return n[e]instanceof wd.StringToken}()?n[i++].value:function(){const e={simples:[]};a(),p()?e.simples.push({selector:{functions:[{name:"scope",args:[]}]},combinator:""}):e.simples.push({selector:_(),combinator:""});for(;;){if(a(),p())e.simples[e.simples.length-1].combinator=n[i++].value,a();else if(f())break;e.simples.push({combinator:"",selector:_()})}return e}()}function _(){let e="";const r=[];for(;!f();)if(l()||d())e+=n[i++].toSource();else if(n[i]instanceof wd.HashToken)e+=n[i++].toSource();else if(n[i]instanceof wd.DelimToken&&"."===n[i].value){if(i++,!l())throw s();e+="."+n[i++].toSource()}else if(n[i]instanceof wd.ColonToken)if(i++,l())if(t.has(n[i].value.toLowerCase())){const e=n[i++].value.toLowerCase();r.push({name:e,args:[]}),o.add(e)}else e+=":"+n[i++].toSource();else{if(!(n[i]instanceof wd.FunctionToken))throw s();{const l=n[i++].value.toLowerCase();if(t.has(l)?(r.push({name:l,args:m()}),o.add(l)):e+=`:${l}(${w()})`,a(),!u())throw s();i++}}else{if(!(n[i]instanceof wd.OpenSquareToken))throw s();for(e+="[",i++;!(n[i]instanceof wd.CloseSquareToken||h());)e+=n[i++].toSource();if(!(n[i]instanceof wd.CloseSquareToken))throw s();e+="]",i++}if(!e&&!r.length)throw s();return{css:e||void 0,functions:r}}function w(){let e="";for(;!u()&&!h();)e+=n[i++].toSource();return e}const v=m();if(!h())throw new bd(`Error while parsing selector "${e}"`);if(v.some((e=>"object"!=typeof e||!("simples"in e))))throw new bd(`Error while parsing selector "${e}"`);return{selector:v,names:Array.from(o)}},md.serializeSelector=function e(t){return t.map((t=>"string"==typeof t?`"${t}"`:"number"==typeof t?String(t):t.simples.map((({selector:t,combinator:n})=>{let r=t.css||"";return r+=t.functions.map((t=>`:${t.name}(${e(t.args)})`)).join(""),n&&(r+=" "+n),r})).join(" "))).join(", ")};var _d,wd=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=vd(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(gd);function vd(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(vd=function(e){return e?n:t})(e)}class bd extends Error{}function yd(){if(_d)return vu;_d=1,Object.defineProperty(vu,"__esModule",{value:!0}),vu.FrameManager=vu.Frame=void 0;var e=g(bu),t=su,n=au,r=g(Cu),i=g(_u()),o=Uh(),s=g(ld),a=fx(),l=Uu,c=Ci,u=pu,d=Ka,h=Hl,p=ku,f=fd;function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}function g(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}vu.FrameManager=class{constructor(e){this._page=void 0,this._frames=new Map,this._mainFrame=void 0,this._consoleMessageTags=new Map,this._signalBarriers=new Set,this._webSockets=new Map,this._openedDialogs=new Set,this._page=e,this._mainFrame=void 0}dispose(){for(const e of this._frames.values())e._stopNetworkIdleTimer()}mainFrame(){return this._mainFrame}frames(){const e=[];return function t(n){e.push(n);for(const e of n.childFrames())t(e)}(this._mainFrame),e}frame(e){return this._frames.get(e)||null}frameAttached(e,t){const n=t?this._frames.get(t):null;if(n){(0,c.assert)(!this._frames.has(e));const t=new _(this._page,e,n);return this._frames.set(e,t),this._page.emit(o.Page.Events.FrameAttached,t),t}return this._mainFrame?(this._frames.delete(this._mainFrame._id),this._mainFrame._id=e):((0,c.assert)(!this._frames.has(e)),this._mainFrame=new _(this._page,e,n)),this._frames.set(e,this._mainFrame),this._mainFrame}async waitForSignalsCreatedBy(e,t,n,r){if(t)return n();const i=new v(e);this._signalBarriers.add(i),e&&e.cleanupWhenAborted((()=>this._signalBarriers.delete(i)));const o=await n();return"input"===r&&await this._page._delegate.inputActionEpilogue(),await i.waitFor(),this._signalBarriers.delete(i),await new Promise((0,c.makeWaitForNextTask)()),o}frameWillPotentiallyRequestNavigation(){for(const e of this._signalBarriers)e.retain()}frameDidPotentiallyRequestNavigation(){for(const e of this._signalBarriers)e.release()}frameRequestedNavigation(e,t){const n=this._frames.get(e);if(n){for(const e of this._signalBarriers)e.addFrameNavigation(n);n.pendingDocument()&&n.pendingDocument().documentId===t||n.setPendingDocument({documentId:t,request:void 0})}}frameCommittedNewDocumentNavigation(e,t,n,r,i){const o=this._frames.get(e);let s;this.removeChildFramesRecursively(o),this.clearWebSockets(o),o._url=t,o._name=n;const a=o.pendingDocument();a?(void 0===a.documentId&&(a.documentId=r),a.documentId===r?o._currentDocument=a:(s=a,o._currentDocument={documentId:r,request:void 0}),o.setPendingDocument(void 0)):o._currentDocument={documentId:r,request:void 0},o._onClearLifecycle();const l={url:t,name:n,newDocument:o._currentDocument};o.emit(_.Events.Navigation,l),i||(d.debugLogger.log("api",`  navigated to "${t}"`),this._page.frameNavigatedToNewDocument(o)),o.setPendingDocument(s)}frameCommittedSameDocumentNavigation(e,t){const n=this._frames.get(e);if(!n)return;n._url=t;const r={url:t,name:n._name};n.emit(_.Events.Navigation,r),d.debugLogger.log("api",`  navigated to "${t}"`)}frameAbortedNavigation(e,t,n){const r=this._frames.get(e);if(!r||!r.pendingDocument())return;if(void 0!==n&&r.pendingDocument().documentId!==n)return;const i={url:r._url,name:r._name,newDocument:r.pendingDocument(),error:new Error(t)};r.setPendingDocument(void 0),r.emit(_.Events.Navigation,i)}frameDetached(e){const t=this._frames.get(e);t&&this._removeFramesRecursively(t)}frameStoppedLoading(e){this.frameLifecycleEvent(e,"domcontentloaded"),this.frameLifecycleEvent(e,"load")}frameLifecycleEvent(e,t){const n=this._frames.get(e);n&&n._onLifecycleEvent(t)}requestStarted(e,t){const n=e.frame();this._inflightRequestStarted(e),e._documentId&&n.setPendingDocument({documentId:e._documentId,request:e}),e._isFavicon?t&&t.continue(e,{}):(this._page.emitOnContext(a.BrowserContext.Events.Request,e),t&&this._page._requestStarted(e,t))}requestReceivedResponse(e){e.request()._isFavicon||this._page.emitOnContext(a.BrowserContext.Events.Response,e)}reportRequestFinished(e,t){this._inflightRequestFinished(e),e._isFavicon||this._page.emitOnContext(a.BrowserContext.Events.RequestFinished,{request:e,response:t})}requestFailed(e,t){const n=e.frame();if(this._inflightRequestFinished(e),n.pendingDocument()&&n.pendingDocument().request===e){let r=e.failure().errorText;t&&(r+="; maybe frame was detached?"),this.frameAbortedNavigation(n._id,r,n.pendingDocument().documentId)}e._isFavicon||this._page.emitOnContext(a.BrowserContext.Events.RequestFailed,e)}dialogDidOpen(e){for(const e of this._frames.values())e._invalidateNonStallingEvaluations("JavaScript dialog interrupted evaluation");this._openedDialogs.add(e)}dialogWillClose(e){this._openedDialogs.delete(e)}removeChildFramesRecursively(e){for(const t of e.childFrames())this._removeFramesRecursively(t)}_removeFramesRecursively(e){this.removeChildFramesRecursively(e),e._onDetached(),this._frames.delete(e._id),this._page.isClosed()||this._page.emit(o.Page.Events.FrameDetached,e)}_inflightRequestFinished(e){const t=e.frame();e._isFavicon||t._inflightRequests.has(e)&&(t._inflightRequests.delete(e),0===t._inflightRequests.size&&t._startNetworkIdleTimer())}_inflightRequestStarted(e){const t=e.frame();e._isFavicon||(t._inflightRequests.add(e),1===t._inflightRequests.size&&t._stopNetworkIdleTimer())}interceptConsoleMessage(e){if("debug"!==e.type())return!1;const t=e.text(),n=this._consoleMessageTags.get(t);return!!n&&(this._consoleMessageTags.delete(t),n(),!0)}clearWebSockets(e){e.parentFrame()||this._webSockets.clear()}onWebSocketCreated(e,t){const n=new i.WebSocket(this._page,t);this._webSockets.set(e,n)}onWebSocketRequest(e){const t=this._webSockets.get(e);t&&t.markAsNotified()&&this._page.emit(o.Page.Events.WebSocket,t)}onWebSocketResponse(e,t,n){const r=this._webSockets.get(e);t<400||r&&r.error(`${n}: ${t}`)}onWebSocketFrameSent(e,t,n){const r=this._webSockets.get(e);r&&r.frameSent(t,n)}webSocketFrameReceived(e,t,n){const r=this._webSockets.get(e);r&&r.frameReceived(t,n)}webSocketClosed(e){const t=this._webSockets.get(e);t&&t.closed(),this._webSockets.delete(e)}webSocketError(e,t){const n=this._webSockets.get(e);n&&n.error(t)}};class _ extends h.SdkObject{constructor(e,t,n){super(e,"frame"),this._id=void 0,this._firedLifecycleEvents=new Set,this._subtreeLifecycleEvents=new Set,this._currentDocument=void 0,this._pendingDocument=void 0,this._page=void 0,this._parentFrame=void 0,this._url="",this._detached=!1,this._contextData=new Map,this._childFrames=new Set,this._name="",this._inflightRequests=new Set,this._networkIdleTimer=void 0,this._setContentCounter=0,this._detachedPromise=void 0,this._detachedCallback=()=>{},this._raceAgainstEvaluationStallingEventsPromises=new Set,this.attribution.frame=this,this._id=t,this._page=e,this._parentFrame=n,this._currentDocument={documentId:void 0,request:void 0},this._detachedPromise=new Promise((e=>this._detachedCallback=e)),this._contextData.set("main",{contextPromise:new u.ManualPromise,context:null,rerunnableTasks:new Set}),this._contextData.set("utility",{contextPromise:new u.ManualPromise,context:null,rerunnableTasks:new Set}),this._setContext("main",null),this._setContext("utility",null),this._parentFrame&&this._parentFrame._childFrames.add(this),this._firedLifecycleEvents.add("commit"),this._subtreeLifecycleEvents.add("commit")}isDetached(){return this._detached}_onLifecycleEvent(e){this._firedLifecycleEvents.has(e)||(this._firedLifecycleEvents.add(e),this._page.mainFrame()._recalculateLifecycle())}_onClearLifecycle(){this._firedLifecycleEvents.clear(),this._page.mainFrame()._recalculateLifecycle(),this._inflightRequests=new Set(Array.from(this._inflightRequests).filter((e=>e===this._currentDocument.request))),this._stopNetworkIdleTimer(),0===this._inflightRequests.size&&this._startNetworkIdleTimer(),this._onLifecycleEvent("commit")}setPendingDocument(e){this._pendingDocument=e,e&&this._invalidateNonStallingEvaluations("Navigation interrupted the evaluation")}pendingDocument(){return this._pendingDocument}_invalidateNonStallingEvaluations(e){if(!this._raceAgainstEvaluationStallingEventsPromises.size)return;const t=new Error(e);for(const e of this._raceAgainstEvaluationStallingEventsPromises)e.reject(t)}async raceAgainstEvaluationStallingEvents(e){if(this._pendingDocument)throw new Error("Frame is currently attempting a navigation");if(this._page._frameManager._openedDialogs.size)throw new Error("Open JavaScript dialog prevents evaluation");const t=new u.ManualPromise;this._raceAgainstEvaluationStallingEventsPromises.add(t);try{return await Promise.race([e(),t])}finally{this._raceAgainstEvaluationStallingEventsPromises.delete(t)}}nonStallingRawEvaluateInExistingMainContext(e){return this.raceAgainstEvaluationStallingEvents((()=>{const t=this._existingMainContext();if(!t)throw new Error("Frame does not yet have a main execution context");return t.rawEvaluateJSON(e)}))}nonStallingEvaluateInExistingContext(e,t,n){return this.raceAgainstEvaluationStallingEvents((()=>{var r;const i=null===(r=this._contextData.get(n))||void 0===r?void 0:r.context;if(!i)throw new Error("Frame does not yet have the execution context");return i.evaluateExpression(e,t)}))}_recalculateLifecycle(){const e=new Set(this._firedLifecycleEvents);for(const t of this._childFrames){t._recalculateLifecycle();for(const n of e)t._subtreeLifecycleEvents.has(n)||e.delete(n)}const t=this._page.mainFrame();for(const n of e)this._subtreeLifecycleEvents.has(n)||(this.emit(_.Events.AddLifecycle,n),this===t&&"about:blank"!==this._url&&d.debugLogger.log("api",`  "${n}" event fired`),this===t&&"load"===n&&this._page.emit(o.Page.Events.Load),this===t&&"domcontentloaded"===n&&this._page.emit(o.Page.Events.DOMContentLoaded));for(const t of this._subtreeLifecycleEvents)e.has(t)||this.emit(_.Events.RemoveLifecycle,t);this._subtreeLifecycleEvents=e}async raceNavigationAction(e){return Promise.race([this._page._disconnectedPromise.then((()=>{throw new Error("Navigation failed because page was closed!")})),this._page._crashedPromise.then((()=>{throw new Error("Navigation failed because page crashed!")})),this._detachedPromise.then((()=>{throw new Error("Navigating frame was detached!")})),e()])}async goto(e,t,n={}){const r=(0,c.constructURLBasedOnBaseURL)(this._page._browserContext._options.baseURL,t);return new l.ProgressController(e,this).run((e=>this._goto(e,r,n)),this._page._timeoutSettings.navigationTimeout(n))}async _goto(e,n,r){return this.raceNavigationAction((async()=>{const i=b("waitUntil",void 0===r.waitUntil?"load":r.waitUntil);e.log(`navigating to "${n}", waiting until "${i}"`);const o=(this._page._state.extraHTTPHeaders||[]).find((e=>"referer"===e.name.toLowerCase()));let s=o?o.value:void 0;if(void 0!==r.referer){if(void 0!==s&&s!==r.referer)throw new Error('"referer" is already specified as extra HTTP header');s=r.referer}n=t.helper.completeUserURL(n);const a=t.helper.waitForEvent(e,this,_.Events.Navigation,(e=>!e.newDocument)),l=await this._page._delegate.navigateFrame(this,n,s);let c;if(l.newDocumentId){if(a.dispose(),c=await t.helper.waitForEvent(e,this,_.Events.Navigation,(e=>e.newDocument&&(e.newDocument.documentId===l.newDocumentId||!e.error))).promise,c.newDocument.documentId!==l.newDocumentId)throw new Error("Navigation interrupted by another one");if(c.error)throw c.error}else c=await a.promise;this._subtreeLifecycleEvents.has(i)||await t.helper.waitForEvent(e,this,_.Events.AddLifecycle,(e=>e===i)).promise;const u=c.newDocument?c.newDocument.request:void 0,d=u?u._finalRequest().response():null;return await this._page._doSlowMo(),d}))}async _waitForNavigation(e,n){const r=b("waitUntil",void 0===n.waitUntil?"load":n.waitUntil);e.log(`waiting for navigation until "${r}"`);const i=await t.helper.waitForEvent(e,this,_.Events.Navigation,(t=>(t.error||e.log(`  navigated to "${this._url}"`),!0))).promise;if(i.error)throw i.error;this._subtreeLifecycleEvents.has(r)||await t.helper.waitForEvent(e,this,_.Events.AddLifecycle,(e=>e===r)).promise;const o=i.newDocument?i.newDocument.request:void 0;return o?o._finalRequest().response():null}async _waitForLoadState(e,n){const r=b("state",n);this._subtreeLifecycleEvents.has(r)||await t.helper.waitForEvent(e,this,_.Events.AddLifecycle,(e=>e===r)).promise}async frameElement(){return this._page._delegate.getFrameElement(this)}_context(e){return this._contextData.get(e).contextPromise.then((e=>{if(e instanceof r.ExecutionContext)return e;throw e}))}_mainContext(){return this._context("main")}_existingMainContext(){var e;return(null===(e=this._contextData.get("main"))||void 0===e?void 0:e.context)||null}_utilityContext(){return this._context("utility")}async evaluateExpressionHandleAndWaitForSignals(e,t,n,r="main"){const i=await this._context(r),o=await i.evaluateExpressionHandleAndWaitForSignals(e,t,n);return"main"===r&&await this._page._doSlowMo(),o}async evaluateExpression(e,t,n,r="main"){const i=await this._context(r),o=await i.evaluateExpression(e,t,n);return"main"===r&&await this._page._doSlowMo(),o}async evaluateExpressionAndWaitForSignals(e,t,n,r="main"){const i=await this._context(r),o=await i.evaluateExpressionAndWaitForSignals(e,t,n);return"main"===r&&await this._page._doSlowMo(),o}async querySelector(e,t){d.debugLogger.log("api",`    finding element using the selector "${e}"`);const n=await this.resolveFrameForSelectorNoWait(e,t);return n?this._page.selectors.query(n.frame,n.info):null}async waitForSelector(t,n,r,i){const o=new l.ProgressController(t,this);if(r.visibility)throw new Error("options.visibility is not supported, did you mean options.state?");if(r.waitFor&&"visible"!==r.waitFor)throw new Error("options.waitFor is not supported, did you mean options.state?");const{state:s="visible"}=r;if(!["attached","detached","visible","hidden"].includes(s))throw new Error("state: expected one of (attached|detached|visible|hidden)");return o.run((async t=>(t.log(`waiting for selector "${n}"${"attached"===s?"":" to be "+s}`),this.retryWithProgress(t,n,r,(async(n,o)=>{const{frame:a,info:l}=n,c=this===a?i:void 0,u=e.waitForSelectorTask(l,s,r.omitReturnValue,c),d=c?await a._runWaitForSelectorTaskOnce(t,(0,f.stringifySelector)(l.parsed),l.world,u):await a._scheduleRerunnableHandleTask(t,l.world,u);if(!d.asElement())return d.dispose(),null;r.__testHookBeforeAdoptNode&&await r.__testHookBeforeAdoptNode();const h=d.asElement();try{return await h._adoptTo(await a._mainContext())}catch(e){return o}}),i))),this._page._timeoutSettings.timeout(r))}async dispatchEvent(e,t,n,r={},i={}){await this._scheduleRerunnableTask(e,t,((e,t,n)=>{e.injectedScript.dispatchEvent(t,n.type,n.eventInit)}),{type:n,eventInit:r},{mainWorld:!0,...i}),await this._page._doSlowMo()}async evalOnSelectorAndWaitForSignals(e,t,n,r,i){const o=await this.resolveFrameForSelectorNoWait(e,{strict:t}),s=o?await this._page.selectors.query(o.frame,o.info):null;if(!s)throw new Error(`Error: failed to find element matching selector "${e}"`);const a=await s.evaluateExpressionAndWaitForSignals(n,r,!0,i);return s.dispose(),a}async evalOnSelectorAllAndWaitForSignals(e,t,n,r){const i=await this.resolveFrameForSelectorNoWait(e,{});if(!i)throw new Error(`Error: failed to find frame for selector "${e}"`);const o=await this._page.selectors._queryArrayInMainWorld(i.frame,i.info),s=await o.evaluateExpressionAndWaitForSignals(t,n,!0,r);return o.dispose(),s}async maskSelectors(e){const t=await this._utilityContext(),n=await t.injectedScript();await n.evaluate(((e,{parsed:t})=>{e.maskSelectors(t)}),{parsed:e})}async querySelectorAll(e){const t=await this.resolveFrameForSelectorNoWait(e,{});return t?this._page.selectors._queryAll(t.frame,t.info,void 0,!0):[]}async queryCount(e){const t=await this.resolveFrameForSelectorNoWait(e);if(!t)throw new Error(`Error: failed to find frame for selector "${e}"`);return await this._page.selectors._queryCount(t.frame,t.info)}async content(){try{const e=await this._utilityContext();return await e.evaluate((()=>{let e="";return document.doctype&&(e=(new XMLSerializer).serializeToString(document.doctype)),document.documentElement&&(e+=document.documentElement.outerHTML),e}))}catch(e){if(r.isJavaScriptErrorInEvaluate(e)||(0,p.isSessionClosedError)(e))throw e;throw new Error("Unable to retrieve content because the page is navigating and changing the content.")}}async setContent(e,t,n={}){return new l.ProgressController(e,this).run((e=>this.raceNavigationAction((async()=>{const r=void 0===n.waitUntil?"load":n.waitUntil;e.log(`setting frame content, waiting until "${r}"`);const i=`--playwright--set--content--${this._id}--${++this._setContentCounter}--`,o=await this._utilityContext(),s=new Promise(((t,n)=>{this._page._frameManager._consoleMessageTags.set(i,(()=>{this._onClearLifecycle(),this._waitForLoadState(e,r).then(t).catch(n)}))})),a=o.evaluate((({html:e,tag:t})=>{window.stop(),document.open(),console.debug(t),document.write(e),document.close()}),{html:t,tag:i});await Promise.all([a,s]),await this._page._doSlowMo()}))),this._page._timeoutSettings.navigationTimeout(n))}name(){return this._name||""}url(){return this._url}parentFrame(){return this._parentFrame}childFrames(){return Array.from(this._childFrames)}async addScriptTag(e){const{url:t=null,content:n=null,type:r=""}=e;if(!t&&!n)throw new Error("Provide an object with a `url`, `path` or `content` property");const i=await this._mainContext();return this._raceWithCSPError((async()=>{if(null!==t)return(await i.evaluateHandle(o,{url:t,type:r})).asElement();const e=(await i.evaluateHandle(s,{content:n,type:r})).asElement();return this._page._delegate.cspErrorsAsynchronousForInlineScipts&&await i.evaluate((()=>!0)),e}));async function o(e){const t=document.createElement("script");t.src=e.url,e.type&&(t.type=e.type);const n=new Promise(((e,n)=>{t.onload=e,t.onerror=e=>n("string"==typeof e?new Error(e):new Error(`Failed to load script at ${t.src}`))}));return document.head.appendChild(t),await n,t}function s(e){const t=document.createElement("script");t.type=e.type||"text/javascript",t.text=e.content;let n=null;if(t.onerror=e=>n=e,document.head.appendChild(t),n)throw n;return t}}async addStyleTag(e){const{url:t=null,content:n=null}=e;if(!t&&!n)throw new Error("Provide an object with a `url`, `path` or `content` property");const r=await this._mainContext();return this._raceWithCSPError((async()=>null!==t?(await r.evaluateHandle(i,t)).asElement():(await r.evaluateHandle(o,n)).asElement()));async function i(e){const t=document.createElement("link");t.rel="stylesheet",t.href=e;const n=new Promise(((e,n)=>{t.onload=e,t.onerror=n}));return document.head.appendChild(t),await n,t}async function o(e){const t=document.createElement("style");t.type="text/css",t.appendChild(document.createTextNode(e));const n=new Promise(((e,n)=>{t.onload=e,t.onerror=n}));return document.head.appendChild(t),await n,t}}async _raceWithCSPError(e){const t=[];let r,i,s;const a=e().then((e=>r=e)).catch((e=>i=e)),l=new Promise((e=>{t.push(n.eventsHelper.addEventListener(this._page,o.Page.Events.Console,(t=>{"error"===t.type()&&t.text().includes("Content Security Policy")&&(s=t,e())})))}));if(await Promise.race([a,l]),n.eventsHelper.removeEventListeners(t),s)throw new Error(s.text());if(i)throw i;return r}async retryWithProgress(t,n,i,o,s){const a=Symbol("continuePolling");for(;t.isRunning();){let c;if(i.omitAttached)c=await this.resolveFrameForSelectorNoWait(n,i,s);else if(c=await this._resolveFrameForSelector(t,n,i,s),!c){await new Promise((e=>setTimeout(e,100)));continue}try{const e=await o(c,a);if(e===a)continue;return e}catch(t){var l;if(r.isJavaScriptErrorInEvaluate(t)||(0,p.isSessionClosedError)(t))throw t;if(e.isNonRecoverableDOMError(t))throw t;if(this.isDetached())throw t;if(s&&s._context.frame===(null===(l=c)||void 0===l?void 0:l.frame))throw t;continue}}t.throwIfAborted()}async _retryWithProgressIfNotConnected(t,n,r,i){return this.retryWithProgress(t,n,{strict:r},(async(r,o)=>{const{frame:s,info:a}=r,l=e.waitForSelectorTask(a,"attached");t.log(`waiting for selector "${n}"`);const c=(await s._scheduleRerunnableHandleTask(t,a.world,l)).asElement();try{const e=await i(c);return"error:notconnected"===e?(t.log("element was detached from the DOM, retrying"),o):e}finally{null==c||c.dispose()}}))}async rafrafTimeoutScreenshotElementWithProgress(e,t,n,r){return await this._retryWithProgressIfNotConnected(e,t,!0,(async t=>(await t._frame.rafrafTimeout(n),await this._page._screenshotter.screenshotElement(e,t,r))))}async click(t,n,r){return new l.ProgressController(t,this).run((async t=>e.assertDone(await this._retryWithProgressIfNotConnected(t,n,r.strict,(e=>e._click(t,r))))),this._page._timeoutSettings.timeout(r))}async dblclick(t,n,r={}){return new l.ProgressController(t,this).run((async t=>e.assertDone(await this._retryWithProgressIfNotConnected(t,n,r.strict,(e=>e._dblclick(t,r))))),this._page._timeoutSettings.timeout(r))}async dragAndDrop(t,n,r,i={}){const o=new l.ProgressController(t,this);await o.run((async t=>{e.assertDone(await this._retryWithProgressIfNotConnected(t,n,i.strict,(async e=>e._retryPointerAction(t,"move and down",!1,(async e=>{await this._page.mouse.move(e.x,e.y),await this._page.mouse.down()}),{...i,position:i.sourcePosition,timeout:t.timeUntilDeadline()})))),e.assertDone(await this._retryWithProgressIfNotConnected(t,r,i.strict,(async e=>e._retryPointerAction(t,"move and up",!1,(async e=>{await this._page.mouse.move(e.x,e.y),await this._page.mouse.up()}),{...i,position:i.targetPosition,timeout:t.timeUntilDeadline()}))))}),this._page._timeoutSettings.timeout(i))}async tap(t,n,r){return new l.ProgressController(t,this).run((async t=>e.assertDone(await this._retryWithProgressIfNotConnected(t,n,r.strict,(e=>e._tap(t,r))))),this._page._timeoutSettings.timeout(r))}async fill(t,n,r,i){return new l.ProgressController(t,this).run((async t=>e.assertDone(await this._retryWithProgressIfNotConnected(t,n,i.strict,(e=>e._fill(t,r,i))))),this._page._timeoutSettings.timeout(i))}async focus(t,n,r={}){const i=new l.ProgressController(t,this);await i.run((async t=>{e.assertDone(await this._retryWithProgressIfNotConnected(t,n,r.strict,(e=>e._focus(t)))),await this._page._doSlowMo()}),this._page._timeoutSettings.timeout(r))}async textContent(e,t,n={}){return this._scheduleRerunnableTask(e,t,((e,t)=>t.textContent),void 0,n)}async innerText(e,t,n={}){return this._scheduleRerunnableTask(e,t,((e,t)=>{if("http://www.w3.org/1999/xhtml"!==t.namespaceURI)throw e.injectedScript.createStacklessError("Node is not an HTMLElement");return t.innerText}),void 0,n)}async innerHTML(e,t,n={}){return this._scheduleRerunnableTask(e,t,((e,t)=>t.innerHTML),void 0,n)}async getAttribute(e,t,n,r={}){return this._scheduleRerunnableTask(e,t,((e,t,n)=>t.getAttribute(n.name)),{name:n},r)}async inputValue(e,t,n={}){return this._scheduleRerunnableTask(e,t,((e,t)=>{const n=e.injectedScript.retarget(t,"follow-label");if(!n||"INPUT"!==n.nodeName&&"TEXTAREA"!==n.nodeName&&"SELECT"!==n.nodeName)throw e.injectedScript.createStacklessError("Node is not an <input>, <textarea> or <select> element");return n.value}),void 0,n)}async highlight(e){const t=await this.resolveFrameForSelectorNoWait(e);if(!t)return;const n=await t.frame._utilityContext(),r=await n.injectedScript();return await r.evaluate(((e,{parsed:t})=>e.highlight(t)),{parsed:t.info.parsed})}async hideHighlight(){return this.raceAgainstEvaluationStallingEvents((async()=>{const e=await this._utilityContext(),t=await e.injectedScript();return await t.evaluate((e=>e.hideHighlight()))}))}async _elementState(t,n,r,i={}){const o=await this._scheduleRerunnableTask(t,n,((e,t,n)=>e.injectedScript.elementState(t,n.state)),{state:r},i);return e.throwRetargetableDOMError(o)}async isVisible(e,t,n={}){return new l.ProgressController(e,this).run((async e=>{e.log(`  checking visibility of "${t}"`);const r=await this.resolveFrameForSelectorNoWait(t,n);if(!r)return!1;const i=await this._page.selectors.query(r.frame,r.info);return!!i&&await i.isVisible()}),this._page._timeoutSettings.timeout({}))}async isHidden(e,t,n={}){return!await this.isVisible(e,t,n)}async isDisabled(e,t,n={}){return this._elementState(e,t,"disabled",n)}async isEnabled(e,t,n={}){return this._elementState(e,t,"enabled",n)}async isEditable(e,t,n={}){return this._elementState(e,t,"editable",n)}async isChecked(e,t,n={}){return this._elementState(e,t,"checked",n)}async hover(t,n,r={}){return new l.ProgressController(t,this).run((async t=>e.assertDone(await this._retryWithProgressIfNotConnected(t,n,r.strict,(e=>e._hover(t,r))))),this._page._timeoutSettings.timeout(r))}async selectOption(e,t,n,r,i={}){return new l.ProgressController(e,this).run((async e=>await this._retryWithProgressIfNotConnected(e,t,i.strict,(t=>t._selectOption(e,n,r,i)))),this._page._timeoutSettings.timeout(i))}async setInputFiles(t,n,r,i={}){return new l.ProgressController(t,this).run((async t=>e.assertDone(await this._retryWithProgressIfNotConnected(t,n,i.strict,(e=>e._setInputFiles(t,r,i))))),this._page._timeoutSettings.timeout(i))}async type(t,n,r,i={}){return new l.ProgressController(t,this).run((async t=>e.assertDone(await this._retryWithProgressIfNotConnected(t,n,i.strict,(e=>e._type(t,r,i))))),this._page._timeoutSettings.timeout(i))}async press(t,n,r,i={}){return new l.ProgressController(t,this).run((async t=>e.assertDone(await this._retryWithProgressIfNotConnected(t,n,i.strict,(e=>e._press(t,r,i))))),this._page._timeoutSettings.timeout(i))}async check(t,n,r={}){return new l.ProgressController(t,this).run((async t=>e.assertDone(await this._retryWithProgressIfNotConnected(t,n,r.strict,(e=>e._setChecked(t,!0,r))))),this._page._timeoutSettings.timeout(r))}async uncheck(t,n,r={}){return new l.ProgressController(t,this).run((async t=>e.assertDone(await this._retryWithProgressIfNotConnected(t,n,r.strict,(e=>e._setChecked(t,!1,r))))),this._page._timeoutSettings.timeout(r))}async waitForTimeout(e,t){return new l.ProgressController(e,this).run((async()=>{await new Promise((e=>setTimeout(e,t)))}))}async expect(e,t,n){const i=new l.ProgressController(e,this),o="to.have.count"===n.expression||n.expression.endsWith(".array"),s="to.have.property"===n.expression,a=this._page._timeoutSettings.timeout(n);let c=!1;return n.isNot||"to.be.hidden"!==n.expression?n.isNot&&"to.be.visible"===n.expression?c=!0:n.isNot||"to.have.count"!==n.expression||0!==n.expectedNumber?(n.isNot&&"to.have.count"===n.expression&&0!==n.expectedNumber||!n.isNot&&n.expression.endsWith(".array")&&0===n.expectedText.length||n.isNot&&n.expression.endsWith(".array")&&n.expectedText.length>0)&&(c=!0):c=!0:c=!0,i.run((async r=>(r.log(`${e.apiName}${a?` with timeout ${a}ms`:""}`),await this._scheduleRerunnableTaskWithProgress(r,t,((e,t,n,r)=>{let i;if(n.isArray)i=e.injectedScript.expectArray(r,n);else{if(!t)return n.isNot||"to.be.hidden"!==n.expression?n.isNot&&"to.be.visible"===n.expression?{matches:!1}:e.continuePolling:{matches:!0};i=e.injectedScript.expectSingleElement(e,t,n)}return i.matches===n.isNot?(e.setIntermediateResult(i.received),Array.isArray(i.received)||e.log(`  unexpected value "${i.received}"`),e.continuePolling):i}),{...n,isArray:o},{strict:!0,querySelectorAll:o,mainWorld:s,omitAttached:c,logScale:!0,...n}))),a).catch((t=>{if(r.isJavaScriptErrorInEvaluate(t)||(0,f.isInvalidSelectorError)(t))throw t;return{received:i.lastIntermediateResult(),matches:n.isNot,log:e.log}}))}async _waitForFunctionExpression(e,t,n,i,o,s="main"){const a=new l.ProgressController(e,this);"number"==typeof o.pollingInterval&&(0,c.assert)(o.pollingInterval>0,"Cannot poll with non-positive interval: "+o.pollingInterval),t=r.normalizeEvaluationExpression(t,n);const u=e=>e.evaluateHandle(((e,{expression:t,isFunction:n,polling:r,arg:i})=>{const o=e=>{let r=self.eval(t);return!0===n?r=r(e):!1===n||"function"==typeof r&&(r=r(e)),r};return"number"!=typeof r?e.pollRaf((e=>o(i)||e.continuePolling)):e.pollInterval(r,(e=>o(i)||e.continuePolling))}),{expression:t,isFunction:n,polling:o.pollingInterval,arg:i});return a.run((e=>this._scheduleRerunnableHandleTask(e,s,u)),this._page._timeoutSettings.timeout(o))}async waitForFunctionValueInUtility(e,t){const n=`() => {\n\t      const result = (${t})();\n\t      if (!result)\n\t        return result;\n\t      return JSON.stringify(result);\n\t    }`,r=await this._waitForFunctionExpression((0,h.serverSideCallMetadata)(),n,!0,void 0,{timeout:e.timeUntilDeadline()},"utility");return JSON.parse(r.rawValue())}async title(){return(await this._utilityContext()).evaluate((()=>document.title))}async rafrafTimeout(e){if(0===e)return;const t=await this._utilityContext();await Promise.all([t.evaluate((()=>new Promise((e=>{requestAnimationFrame((()=>{requestAnimationFrame(e)}))})))),new Promise((t=>setTimeout(t,e)))])}_onDetached(){this._stopNetworkIdleTimer(),this._detached=!0,this._detachedCallback();const e=new Error("Frame was detached");for(const t of this._contextData.values()){t.context&&t.context.contextDestroyed(e),t.contextPromise.resolve(e);for(const n of t.rerunnableTasks)n.terminate(e)}this._parentFrame&&this._parentFrame._childFrames.delete(this),this._parentFrame=null}async _scheduleRerunnableTask(e,t,n,r,i={}){return new l.ProgressController(e,this).run((async e=>await this._scheduleRerunnableTaskWithProgress(e,t,n,r,i)),this._page._timeoutSettings.timeout(i))}async _scheduleRerunnableTaskWithProgress(e,t,n,r,i={}){const o=n.toString();return this.retryWithProgress(e,t,i,(async n=>{e.log(`waiting for selector "${t}"`);const{frame:s,info:a}=n||{frame:this,info:{parsed:{parts:[{name:"control",body:"return-empty",source:"control=return-empty"}]},world:"utility",strict:!!i.strict}};return await s._scheduleRerunnableTaskInFrame(e,a,o,r,i)}))}async _scheduleRerunnableTaskInFrame(e,t,n,r,i){e.throwIfAborted();const o=this._contextData.get(i.mainWorld?"main":t.world);{const s=new w(o,e,(o=>o.evaluateHandle(((e,{info:t,taskData:n,callbackText:r,querySelectorAll:i,logScale:o,omitAttached:s,snapshotName:a})=>{const l=e.eval(r),c=o?e.pollLogScale.bind(e):e.pollRaf.bind(e);let u=new Set;return c((r=>{let o,c=[];if(i?(c=e.querySelectorAll(t.parsed,document),o=c[0],r.logRepeating(`  selector resolved to ${c.length} element${1===c.length?"":"s"}`)):(o=e.querySelector(t.parsed,document,t.strict),c=o?[o]:[],o&&r.logRepeating(`  selector resolved to ${e.previewNode(o)}`)),!o&&!s)return r.continuePolling;if(a){const e=u;u=new Set(c);for(const t of e)u.has(t)||t.removeAttribute("__playwright_target__");for(const t of u)e.has(t)||t.setAttribute("__playwright_target__",a)}return l(r,o,n,c)}))}),{info:t,taskData:r,callbackText:n,querySelectorAll:i.querySelectorAll,logScale:i.logScale,omitAttached:i.omitAttached,snapshotName:e.metadata.afterSnapshot})),!0);return this._detached&&s.terminate(new Error("Frame got detached.")),o.context&&s.rerun(o.context),await s.promise}}_scheduleRerunnableHandleTask(e,t,n){const r=this._contextData.get(t),i=new w(r,e,n,!1);return this._detached&&i.terminate(new Error("waitForFunction failed: frame got detached.")),r.context&&i.rerun(r.context),i.handlePromise}_setContext(e,t){const n=this._contextData.get(e);if(n.context=t,t){n.contextPromise.resolve(t);for(const e of n.rerunnableTasks)e.rerun(t)}else n.contextPromise=new u.ManualPromise}_contextCreated(e,t){const n=this._contextData.get(e);n.context&&(n.context.contextDestroyed(new Error("Execution context was destroyed, most likely because of a navigation")),this._setContext(e,null)),this._setContext(e,t)}_contextDestroyed(e){if(!this._detached){e.contextDestroyed(new Error("Execution context was destroyed, most likely because of a navigation"));for(const[t,n]of this._contextData)n.context===e&&this._setContext(t,null)}}_startNetworkIdleTimer(){(0,c.assert)(!this._networkIdleTimer),this._firedLifecycleEvents.has("networkidle")||this._detached||(this._networkIdleTimer=setTimeout((()=>this._onLifecycleEvent("networkidle")),500))}_stopNetworkIdleTimer(){this._networkIdleTimer&&clearTimeout(this._networkIdleTimer),this._networkIdleTimer=void 0}async extendInjectedScript(e,t){const n=await this._context("main");return(await n.injectedScript()).evaluateHandle(((e,{source:t,arg:n})=>e.extend(t,n)),{source:e,arg:t})}async _resolveFrameForSelector(t,n,r,i){const o=[];t.cleanupWhenAborted((()=>{for(const e of o)e.dispose()}));let s=this;const a=(0,f.splitSelectorByFrame)(n);for(let n=0;n<a.length-1&&t.isRunning();++n){const o=this._page.parseSelector(a[n],r),l=e.waitForSelectorTask(o,"attached",!1,0===n?i:void 0);t.log(`  waiting for frame "${(0,f.stringifySelector)(a[n])}"`);const c=(0===n&&i?await s._runWaitForSelectorTaskOnce(t,(0,f.stringifySelector)(o.parsed),o.world,l):await s._scheduleRerunnableHandleTask(t,o.world,l)).asElement(),u=await c.isIframeElement();if("error:notconnected"===u)return null;if(!u)throw new Error(`Selector "${(0,f.stringifySelector)(o.parsed)}" resolved to ${c.preview()}, <iframe> was expected`);if(s=await c.contentFrame(),c.dispose(),!s)return null}return{frame:s,info:this._page.parseSelector(a[a.length-1],r)}}async resolveFrameForSelectorNoWait(e,t={},n){let r=this;const i=(0,f.splitSelectorByFrame)(e);for(let e=0;e<i.length-1;++e){const o=this._page.parseSelector(i[e],t),s=await this._page.selectors.query(r,o,0===e?n:void 0);if(!s)return null;if(r=await s.contentFrame(),s.dispose(),!r)throw new Error(`Selector "${(0,f.stringifySelector)(o.parsed)}" resolved to ${s.preview()}, <iframe> was expected`)}return{frame:r,info:this._page.parseSelector(i[i.length-1],t)}}async _runWaitForSelectorTaskOnce(t,n,r,i){const o=await this._context(r),s=await o.injectedScript();try{const n=new e.InjectedScriptPollHandler(t,await i(s)),r=await n.finishHandle();return t.cleanupWhenAborted((()=>r.dispose())),r}catch(e){throw new Error(`Error: frame navigated while waiting for selector "${n}"`)}}}vu.Frame=_,_.Events={Navigation:"navigation",AddLifecycle:"addlifecycle",RemoveLifecycle:"removelifecycle"};class w{constructor(e,t,n,r){this.promise=void 0,this.handlePromise=void 0,this._task=void 0,this._progress=void 0,this._returnByValue=void 0,this._contextData=void 0,this._task=n,this._progress=t,this._returnByValue=r,r?this.promise=new u.ManualPromise:this.handlePromise=new u.ManualPromise,this._contextData=e,this._contextData.rerunnableTasks.add(this)}terminate(e){this._reject(e)}_resolve(e){this.promise&&this.promise.resolve(e),this.handlePromise&&this.handlePromise.resolve(e)}_reject(e){this.promise&&this.promise.reject(e),this.handlePromise&&this.handlePromise.reject(e)}async rerun(t){try{const n=await t.injectedScript(),r=new e.InjectedScriptPollHandler(this._progress,await this._task(n)),i=this._returnByValue?await r.finish():await r.finishHandle();this._contextData.rerunnableTasks.delete(this),this._resolve(i)}catch(e){(r.isJavaScriptErrorInEvaluate(e)||(0,p.isSessionClosedError)(e))&&(this._contextData.rerunnableTasks.delete(this),this._reject(e))}}}class v{constructor(e){this._progress=void 0,this._protectCount=0,this._promise=new u.ManualPromise,this._progress=e,this.retain()}waitFor(){return this.release(),this._promise}async addFrameNavigation(e){if(e.parentFrame())return;this.retain();const n=t.helper.waitForEvent(null,e,_.Events.Navigation,(t=>(!t.error&&this._progress&&this._progress.log(`  navigated to "${e._url}"`),!0)));await Promise.race([e._page._disconnectedPromise,e._page._crashedPromise,e._detachedPromise,n.promise]).catch((e=>{})),n.dispose(),this.release()}retain(){++this._protectCount}release(){--this._protectCount,this._protectCount||this._promise.resolve()}}function b(e,t){if("networkidle0"===t&&(t="networkidle"),!s.kLifecycleEvents.has(t))throw new Error(`${e}: expected one of (load|domcontentloaded|networkidle|commit)`);return t}return vu}md.InvalidSelectorError=bd,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"InvalidSelectorError",{enumerable:!0,get:function(){return t.InvalidSelectorError}}),e.allEngineNames=function(e){const t=new Set,n=e=>{for(const i of e.parts)t.add(i.name),r.has(i.name)&&n(i.body)};return n(e),t},e.customCSSNames=void 0,Object.defineProperty(e,"isInvalidSelectorError",{enumerable:!0,get:function(){return t.isInvalidSelectorError}}),e.parseSelector=i,e.splitSelectorByFrame=function(e){const n=i(e),r=[];let o={parts:[]},s=0;for(let e=0;e<n.parts.length;++e){const i=n.parts[e];if("control"!==i.name||"enter-frame"!==i.body)n.capture===e&&(o.capture=e-s),o.parts.push(i);else{if(!o.parts.length)throw new t.InvalidSelectorError("Selector cannot start with entering frame, select the iframe first");r.push(o),o={parts:[]},s=e+1}}if(!o.parts.length)throw new t.InvalidSelectorError(`Selector cannot end with entering frame, while parsing selector ${e}`);if(r.push(o),"number"==typeof n.capture&&"number"!=typeof r[r.length-1].capture)throw new t.InvalidSelectorError("Can not capture the selector before diving into the frame. Only use * after the last frame has been selected");return r},e.stringifySelector=function(e){return"string"==typeof e?e:e.parts.map(((t,n)=>{const r="css"===t.name?"":t.name+"=";return`${n===e.capture?"*":""}${r}${t.source}`})).join(" >> ")};var t=md;const n=new Set(["not","is","where","has","scope","light","visible","text","text-matches","text-is","has-text","above","below","right-of","left-of","near","nth-match"]);e.customCSSNames=n;const r=new Set(["has"]);function i(e){const o=function(e){let n,r=0,i=0;const o={parts:[]},s=()=>{const n=e.substring(i,r).trim(),s=n.indexOf("=");let a,l;-1!==s&&n.substring(0,s).trim().match(/^[a-zA-Z_0-9-+:*]+$/)?(a=n.substring(0,s).trim(),l=n.substring(s+1)):n.length>1&&'"'===n[0]&&'"'===n[n.length-1]||n.length>1&&"'"===n[0]&&"'"===n[n.length-1]?(a="text",l=n):/^\(*\/\//.test(n)||n.startsWith("..")?(a="xpath",l=n):(a="css",l=n);let c=!1;if("*"===a[0]&&(c=!0,a=a.substring(1)),o.parts.push({name:a,body:l}),c){if(void 0!==o.capture)throw new t.InvalidSelectorError("Only one of the selectors can capture using * modifier");o.capture=o.parts.length-1}};if(!e.includes(">>"))return r=e.length,s(),o;const a=()=>{const t=e.substring(i,r).match(/^\s*text\s*=(.*)$/);return!!t&&!!t[1]};for(;r<e.length;){const t=e[r];"\\"===t&&r+1<e.length?r+=2:t===n?(n=void 0,r++):n||'"'!==t&&"'"!==t&&"`"!==t||a()?n||">"!==t||">"!==e[r+1]?r++:(s(),r+=2,i=r):(n=t,r++)}return s(),o}(e),s=o.parts.map((e=>{if("css"===e.name||"css:light"===e.name){"css:light"===e.name&&(e.body=":light("+e.body+")");return{name:"css",body:(0,t.parseCSS)(e.body,n).selector,source:e.body}}if(r.has(e.name)){let t;try{const n=JSON.parse(e.body);if("string"!=typeof n)throw new Error(`Malformed selector: ${e.name}=`+e.body);t=n}catch(t){throw new Error(`Malformed selector: ${e.name}=`+e.body)}const n={name:e.name,source:e.body,body:i(t)};if(n.body.parts.some((e=>"control"===e.name&&"enter-frame"===e.body)))throw new Error(`Frames are not allowed inside "${e.name}" selectors`);return n}return{...e,source:e.body}}));if(r.has(s[0].name))throw new Error(`"${s[0].name}" selector cannot be first`);return{capture:o.capture,parts:s}}}(fd);var Sd={},xd={};Object.defineProperty(xd,"__esModule",{value:!0}),xd.keypadLocation=xd.USKeyboardLayout=void 0;xd.keypadLocation=3;xd.USKeyboardLayout={Escape:{keyCode:27,key:"Escape"},F1:{keyCode:112,key:"F1"},F2:{keyCode:113,key:"F2"},F3:{keyCode:114,key:"F3"},F4:{keyCode:115,key:"F4"},F5:{keyCode:116,key:"F5"},F6:{keyCode:117,key:"F6"},F7:{keyCode:118,key:"F7"},F8:{keyCode:119,key:"F8"},F9:{keyCode:120,key:"F9"},F10:{keyCode:121,key:"F10"},F11:{keyCode:122,key:"F11"},F12:{keyCode:123,key:"F12"},Backquote:{keyCode:192,shiftKey:"~",key:"`"},Digit1:{keyCode:49,shiftKey:"!",key:"1"},Digit2:{keyCode:50,shiftKey:"@",key:"2"},Digit3:{keyCode:51,shiftKey:"#",key:"3"},Digit4:{keyCode:52,shiftKey:"$",key:"4"},Digit5:{keyCode:53,shiftKey:"%",key:"5"},Digit6:{keyCode:54,shiftKey:"^",key:"6"},Digit7:{keyCode:55,shiftKey:"&",key:"7"},Digit8:{keyCode:56,shiftKey:"*",key:"8"},Digit9:{keyCode:57,shiftKey:"(",key:"9"},Digit0:{keyCode:48,shiftKey:")",key:"0"},Minus:{keyCode:189,shiftKey:"_",key:"-"},Equal:{keyCode:187,shiftKey:"+",key:"="},Backslash:{keyCode:220,shiftKey:"|",key:"\\"},Backspace:{keyCode:8,key:"Backspace"},Tab:{keyCode:9,key:"Tab"},KeyQ:{keyCode:81,shiftKey:"Q",key:"q"},KeyW:{keyCode:87,shiftKey:"W",key:"w"},KeyE:{keyCode:69,shiftKey:"E",key:"e"},KeyR:{keyCode:82,shiftKey:"R",key:"r"},KeyT:{keyCode:84,shiftKey:"T",key:"t"},KeyY:{keyCode:89,shiftKey:"Y",key:"y"},KeyU:{keyCode:85,shiftKey:"U",key:"u"},KeyI:{keyCode:73,shiftKey:"I",key:"i"},KeyO:{keyCode:79,shiftKey:"O",key:"o"},KeyP:{keyCode:80,shiftKey:"P",key:"p"},BracketLeft:{keyCode:219,shiftKey:"{",key:"["},BracketRight:{keyCode:221,shiftKey:"}",key:"]"},CapsLock:{keyCode:20,key:"CapsLock"},KeyA:{keyCode:65,shiftKey:"A",key:"a"},KeyS:{keyCode:83,shiftKey:"S",key:"s"},KeyD:{keyCode:68,shiftKey:"D",key:"d"},KeyF:{keyCode:70,shiftKey:"F",key:"f"},KeyG:{keyCode:71,shiftKey:"G",key:"g"},KeyH:{keyCode:72,shiftKey:"H",key:"h"},KeyJ:{keyCode:74,shiftKey:"J",key:"j"},KeyK:{keyCode:75,shiftKey:"K",key:"k"},KeyL:{keyCode:76,shiftKey:"L",key:"l"},Semicolon:{keyCode:186,shiftKey:":",key:";"},Quote:{keyCode:222,shiftKey:'"',key:"'"},Enter:{keyCode:13,key:"Enter",text:"\r"},ShiftLeft:{keyCode:160,keyCodeWithoutLocation:16,key:"Shift",location:1},KeyZ:{keyCode:90,shiftKey:"Z",key:"z"},KeyX:{keyCode:88,shiftKey:"X",key:"x"},KeyC:{keyCode:67,shiftKey:"C",key:"c"},KeyV:{keyCode:86,shiftKey:"V",key:"v"},KeyB:{keyCode:66,shiftKey:"B",key:"b"},KeyN:{keyCode:78,shiftKey:"N",key:"n"},KeyM:{keyCode:77,shiftKey:"M",key:"m"},Comma:{keyCode:188,shiftKey:"<",key:","},Period:{keyCode:190,shiftKey:">",key:"."},Slash:{keyCode:191,shiftKey:"?",key:"/"},ShiftRight:{keyCode:161,keyCodeWithoutLocation:16,key:"Shift",location:2},ControlLeft:{keyCode:162,keyCodeWithoutLocation:17,key:"Control",location:1},MetaLeft:{keyCode:91,key:"Meta",location:1},AltLeft:{keyCode:164,keyCodeWithoutLocation:18,key:"Alt",location:1},Space:{keyCode:32,key:" "},AltRight:{keyCode:165,keyCodeWithoutLocation:18,key:"Alt",location:2},AltGraph:{keyCode:225,key:"AltGraph"},MetaRight:{keyCode:92,key:"Meta",location:2},ContextMenu:{keyCode:93,key:"ContextMenu"},ControlRight:{keyCode:163,keyCodeWithoutLocation:17,key:"Control",location:2},PrintScreen:{keyCode:44,key:"PrintScreen"},ScrollLock:{keyCode:145,key:"ScrollLock"},Pause:{keyCode:19,key:"Pause"},PageUp:{keyCode:33,key:"PageUp"},PageDown:{keyCode:34,key:"PageDown"},Insert:{keyCode:45,key:"Insert"},Delete:{keyCode:46,key:"Delete"},Home:{keyCode:36,key:"Home"},End:{keyCode:35,key:"End"},ArrowLeft:{keyCode:37,key:"ArrowLeft"},ArrowUp:{keyCode:38,key:"ArrowUp"},ArrowRight:{keyCode:39,key:"ArrowRight"},ArrowDown:{keyCode:40,key:"ArrowDown"},NumLock:{keyCode:144,key:"NumLock"},NumpadDivide:{keyCode:111,key:"/",location:3},NumpadMultiply:{keyCode:106,key:"*",location:3},NumpadSubtract:{keyCode:109,key:"-",location:3},Numpad7:{keyCode:36,shiftKeyCode:103,key:"Home",shiftKey:"7",location:3},Numpad8:{keyCode:38,shiftKeyCode:104,key:"ArrowUp",shiftKey:"8",location:3},Numpad9:{keyCode:33,shiftKeyCode:105,key:"PageUp",shiftKey:"9",location:3},Numpad4:{keyCode:37,shiftKeyCode:100,key:"ArrowLeft",shiftKey:"4",location:3},Numpad5:{keyCode:12,shiftKeyCode:101,key:"Clear",shiftKey:"5",location:3},Numpad6:{keyCode:39,shiftKeyCode:102,key:"ArrowRight",shiftKey:"6",location:3},NumpadAdd:{keyCode:107,key:"+",location:3},Numpad1:{keyCode:35,shiftKeyCode:97,key:"End",shiftKey:"1",location:3},Numpad2:{keyCode:40,shiftKeyCode:98,key:"ArrowDown",shiftKey:"2",location:3},Numpad3:{keyCode:34,shiftKeyCode:99,key:"PageDown",shiftKey:"3",location:3},Numpad0:{keyCode:45,shiftKeyCode:96,key:"Insert",shiftKey:"0",location:3},NumpadDecimal:{keyCode:46,shiftKeyCode:110,key:"\0",shiftKey:".",location:3},NumpadEnter:{keyCode:13,key:"Enter",text:"\r",location:3}},Object.defineProperty(Sd,"__esModule",{value:!0}),Sd.keypadLocation=Sd.Touchscreen=Sd.Mouse=Sd.Keyboard=void 0;var kd=Ci,Ed=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=Cd(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(xd);function Cd(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(Cd=function(e){return e?n:t})(e)}const Td=Ed.keypadLocation;Sd.keypadLocation=Td;const Pd=["Alt","Control","Meta","Shift"];Sd.Keyboard=class{constructor(e,t){this._pressedModifiers=new Set,this._pressedKeys=new Set,this._raw=void 0,this._page=void 0,this._raw=e,this._page=t}async down(e){const t=this._keyDescriptionForString(e),n=this._pressedKeys.has(t.code);this._pressedKeys.add(t.code),Pd.includes(t.key)&&this._pressedModifiers.add(t.key);const r=t.text;await this._raw.keydown(this._pressedModifiers,t.code,t.keyCode,t.keyCodeWithoutLocation,t.key,t.location,n,r),await this._page._doSlowMo()}_keyDescriptionForString(e){let t=Ad.get(e);(0,kd.assert)(t,`Unknown key: "${e}"`);return t=this._pressedModifiers.has("Shift")&&t.shifted?t.shifted:t,this._pressedModifiers.size>1||!this._pressedModifiers.has("Shift")&&1===this._pressedModifiers.size?{...t,text:""}:t}async up(e){const t=this._keyDescriptionForString(e);Pd.includes(t.key)&&this._pressedModifiers.delete(t.key),this._pressedKeys.delete(t.code),await this._raw.keyup(this._pressedModifiers,t.code,t.keyCode,t.keyCodeWithoutLocation,t.key,t.location),await this._page._doSlowMo()}async insertText(e){await this._raw.sendText(e),await this._page._doSlowMo()}async type(e,t){const n=t&&t.delay||void 0;for(const t of e)Ad.has(t)?await this.press(t,{delay:n}):(n&&await new Promise((e=>setTimeout(e,n))),await this.insertText(t))}async press(e,t={}){const n=function(e){const t=[];let n="";for(const r of e)"+"===r&&n?(t.push(n),n=""):n+=r;return t.push(n),t}(e),r=[];e=n[n.length-1];for(let e=0;e<n.length-1;++e)r.push(this.down(n[e]));r.push(this.down(e)),t.delay&&(await Promise.all(r),await new Promise((e=>setTimeout(e,t.delay)))),r.push(this.up(e));for(let e=n.length-2;e>=0;--e)r.push(this.up(n[e]));await Promise.all(r)}async _ensureModifiers(e){for(const t of e)if(!Pd.includes(t))throw new Error("Unknown modifier "+t);const t=Array.from(this._pressedModifiers),n=[];for(const t of Pd){const r=e.includes(t),i=this._pressedModifiers.has(t);r&&!i?n.push(this.down(t)):!r&&i&&n.push(this.up(t))}return await Promise.all(n),t}_modifiers(){return this._pressedModifiers}};Sd.Mouse=class{constructor(e,t){this._keyboard=void 0,this._x=0,this._y=0,this._lastButton="none",this._buttons=new Set,this._raw=void 0,this._page=void 0,this._raw=e,this._page=t,this._keyboard=this._page.keyboard}async move(e,t,n={}){const{steps:r=1}=n,i=this._x,o=this._y;this._x=e,this._y=t;for(let s=1;s<=r;s++){const a=i+s/r*(e-i),l=o+s/r*(t-o);await this._raw.move(a,l,this._lastButton,this._buttons,this._keyboard._modifiers(),!!n.forClick),await this._page._doSlowMo()}}async down(e={}){const{button:t="left",clickCount:n=1}=e;this._lastButton=t,this._buttons.add(t),await this._raw.down(this._x,this._y,this._lastButton,this._buttons,this._keyboard._modifiers(),n),await this._page._doSlowMo()}async up(e={}){const{button:t="left",clickCount:n=1}=e;this._lastButton="none",this._buttons.delete(t),await this._raw.up(this._x,this._y,t,this._buttons,this._keyboard._modifiers(),n),await this._page._doSlowMo()}async click(e,t,n={}){const{delay:r=null,clickCount:i=1}=n;if(r){this.move(e,t,{forClick:!0});for(let e=1;e<=i;++e)await this.down({...n,clickCount:e}),await new Promise((e=>setTimeout(e,r))),await this.up({...n,clickCount:e}),e<i&&await new Promise((e=>setTimeout(e,r)))}else{const r=[];r.push(this.move(e,t,{forClick:!0}));for(let e=1;e<=i;++e)r.push(this.down({...n,clickCount:e})),r.push(this.up({...n,clickCount:e}));await Promise.all(r)}}async dblclick(e,t,n={}){await this.click(e,t,{...n,clickCount:2})}async wheel(e,t){await this._raw.wheel(this._x,this._y,this._buttons,this._keyboard._modifiers(),e,t),await this._page._doSlowMo()}};const Od=new Map([["ShiftLeft",["Shift"]],["ControlLeft",["Control"]],["AltLeft",["Alt"]],["MetaLeft",["Meta"]],["Enter",["\n","\r"]]]),Ad=function(e){const t=new Map;for(const n in e){const r=e[n],i={key:r.key||"",keyCode:r.keyCode||0,keyCodeWithoutLocation:r.keyCodeWithoutLocation||r.keyCode||0,code:n,text:r.text||"",location:r.location||0};let o;if(1===r.key.length&&(i.text=i.key),r.shiftKey&&((0,kd.assert)(1===r.shiftKey.length),o={...i},o.key=r.shiftKey,o.text=r.shiftKey,r.shiftKeyCode&&(o.keyCode=r.shiftKeyCode)),t.set(n,{...i,shifted:o}),Od.has(n))for(const e of Od.get(n))t.set(e,i);r.location||(1===i.key.length&&t.set(i.key,i),o&&t.set(o.key,{...o,shifted:void 0}))}return t}(Ed.USKeyboardLayout);Sd.Touchscreen=class{constructor(e,t){this._raw=void 0,this._page=void 0,this._raw=e,this._page=t}async tap(e,t){if(!this._page._browserContext._options.hasTouch)throw new Error("hasTouch must be enabled on the browser context before using the touchscreen.");await this._raw.tap(e,t,this._page.keyboard._modifiers()),await this._page._doSlowMo()}};var Id={},Md={};Object.defineProperty(Md,"__esModule",{value:!0}),Md.MultiMap=void 0;Md.MultiMap=class{constructor(){this._map=void 0,this._map=new Map}set(e,t){let n=this._map.get(e);n||(n=[],this._map.set(e,n)),n.push(t)}get(e){return this._map.get(e)||[]}has(e){return this._map.has(e)}hasValue(e,t){const n=this._map.get(e);return!!n&&n.includes(t)}get size(){return this._map.size}keys(){return this._map.keys()}values(){const e=[];for(const t of this.keys())e.push(...this.get(t));return e}clear(){this._map.clear()}},Object.defineProperty(Id,"__esModule",{value:!0}),Id.Screenshotter=void 0;var Fd=su,Nd=Ci,Rd=Md;Id.Screenshotter=class{constructor(e){this._queue=new jd,this._page=void 0,this._page=e,this._queue=new jd}async _originalViewportSize(e){const t=this._page.viewportSize();let n=t;return n||(n=await this._page.mainFrame().waitForFunctionValueInUtility(e,(()=>({width:window.innerWidth,height:window.innerHeight})))),{viewportSize:n,originalViewportSize:t}}async _fullPageSize(e){return await this._page.mainFrame().waitForFunctionValueInUtility(e,(()=>document.body&&document.documentElement?{width:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.body.clientWidth,document.documentElement.clientWidth),height:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)}:null))}async screenshotPage(e,t){const n=Ld(t);return this._queue.postTask((async()=>{e.log("taking page screenshot");const{viewportSize:r}=await this._originalViewportSize(e);if(await this._preparePageForScreenshot(e,"initial"!==t.caret,"disabled"===t.animations,"ready"===t.fonts),e.throwIfAborted(),t.fullPage){const i=await this._fullPageSize(e);let o={x:0,y:0,width:i.width,height:i.height};const s=i.width<=r.width&&i.height<=r.height;t.clip&&(o=Dd(t.clip,o));const a=await this._screenshot(e,n,o,void 0,s,t);return e.throwIfAborted(),await this._restorePageAfterScreenshot(),a}const i=t.clip?Dd(t.clip,r):{x:0,y:0,...r},o=await this._screenshot(e,n,void 0,i,!0,t);return e.throwIfAborted(),await this._restorePageAfterScreenshot(),o}))}async screenshotElement(e,t,n){const r=Ld(n);return this._queue.postTask((async()=>{e.log("taking element screenshot");const{viewportSize:i}=await this._originalViewportSize(e);await this._preparePageForScreenshot(e,"initial"!==n.caret,"disabled"===n.animations,"ready"===n.fonts),e.throwIfAborted(),await t._waitAndScrollIntoViewIfNeeded(e),e.throwIfAborted();const o=await t.boundingBox();(0,Nd.assert)(o,"Node is either not visible or not an HTMLElement"),(0,Nd.assert)(0!==o.width,"Node has 0 width."),(0,Nd.assert)(0!==o.height,"Node has 0 height.");const s=o.width<=i.width&&o.height<=i.height;e.throwIfAborted();const a=await this._page.mainFrame().waitForFunctionValueInUtility(e,(()=>({x:window.scrollX,y:window.scrollY}))),l={...o};l.x+=a.x,l.y+=a.y;const c=await this._screenshot(e,r,Fd.helper.enclosingIntRect(l),void 0,s,n);return e.throwIfAborted(),await this._restorePageAfterScreenshot(),c}))}async _preparePageForScreenshot(e,t,n,r){n&&e.log("  disabled all CSS animations"),r&&e.log("  waiting for fonts to load..."),await Promise.all(this._page.frames().map((async e=>{await e.nonStallingEvaluateInExistingContext("("+async function(e,t,n){const r=document.createElement("style");e&&(r.textContent="\n            *:not(#playwright-aaaaaaaaaa.playwright-bbbbbbbbbbb.playwright-cccccccccc.playwright-dddddddddd.playwright-eeeeeeeee) {\n              caret-color: transparent !important;\n            }\n          ",document.documentElement.append(r));const i=new Set,o=[];if(t){const e=(t,n=[])=>{n.push(t);const r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT);do{const t=r.currentNode,i=t instanceof Element?t.shadowRoot:null;i&&e(i,n)}while(r.nextNode());return n},t=e=>{for(const t of e.getAnimations()){if(!t.effect||0===t.playbackRate||i.has(t))continue;const e=t.effect.getComputedTiming().endTime;if(Number.isFinite(e))try{t.finish()}catch(e){}else try{t.cancel(),i.add(t)}catch(e){}}};for(const n of e(document)){const e=t.bind(null,n);e(),n.addEventListener("transitionrun",e),n.addEventListener("animationstart",e),o.push((()=>{n.removeEventListener("transitionrun",e),n.removeEventListener("animationstart",e)}))}}window.__cleanupScreenshot=()=>{r.remove();for(const e of i)try{e.play()}catch(e){}for(const e of o)e();delete window.__cleanupScreenshot},n&&await document.fonts.ready}.toString()+`)(${t}, ${n}, ${r})`,!1,"utility").catch((()=>{}))}))),r&&e.log("  fonts in all frames are loaded"),e.cleanupWhenAborted((()=>this._restorePageAfterScreenshot()))}async _restorePageAfterScreenshot(){await Promise.all(this._page.frames().map((async e=>{e.nonStallingEvaluateInExistingContext("window.__cleanupScreenshot && window.__cleanupScreenshot()",!1,"utility").catch((()=>{}))})))}async _maskElements(e,t){const n=new Rd.MultiMap,r=async()=>{await Promise.all([...n.keys()].map((async e=>{await e.hideHighlight()})))};return t.mask&&t.mask.length?(await Promise.all((t.mask||[]).map((async({frame:e,selector:t})=>{const r=await e.resolveFrameForSelectorNoWait(t);r&&n.set(r.frame,r.info.parsed)}))),e.throwIfAborted(),await Promise.all([...n.keys()].map((async e=>{await e.maskSelectors(n.get(e))}))),e.cleanupWhenAborted(r),r):r}async _screenshot(e,t,n,r,i,o){o.__testHookBeforeScreenshot&&await o.__testHookBeforeScreenshot(),e.throwIfAborted();const s=o.omitBackground&&"png"===t;s&&(await this._page._delegate.setBackgroundColor({r:0,g:0,b:0,a:0}),e.cleanupWhenAborted((()=>this._page._delegate.setBackgroundColor()))),e.throwIfAborted();const a=await this._maskElements(e,o);e.throwIfAborted();const l=await this._page._delegate.takeScreenshot(e,t,n,r,o.quality,i,o.scale||"device");return e.throwIfAborted(),await a(),e.throwIfAborted(),s&&await this._page._delegate.setBackgroundColor(),e.throwIfAborted(),o.__testHookAfterScreenshot&&await o.__testHookAfterScreenshot(),l}};class jd{constructor(){this._chain=void 0,this._chain=Promise.resolve()}postTask(e){const t=this._chain.then(e);return this._chain=t.catch((()=>{})),t}}function Dd(e,t){const n={x:Math.max(0,Math.min(e.x,t.width)),y:Math.max(0,Math.min(e.y,t.height))},r=Math.max(0,Math.min(e.x+e.width,t.width)),i=Math.max(0,Math.min(e.y+e.height,t.height)),o={x:n.x,y:n.y,width:r-n.x,height:i-n.y};return(0,Nd.assert)(o.width&&o.height,"Clipped area is either empty or outside the resulting image"),o}function Ld(e){let t=null;return e.type&&((0,Nd.assert)("png"===e.type||"jpeg"===e.type,"Unknown options.type value: "+e.type),t=e.type),t||(t="png"),void 0!==e.quality&&((0,Nd.assert)("jpeg"===t,"options.quality is unsupported for the "+t+" screenshots"),(0,Nd.assert)("number"==typeof e.quality,"Expected options.quality to be a number but found "+typeof e.quality),(0,Nd.assert)(Number.isInteger(e.quality),"Expected options.quality to be an integer"),(0,Nd.assert)(e.quality>=0&&e.quality<=100,"Expected options.quality to be between 0 and 100 (inclusive), got "+e.quality)),e.clip&&((0,Nd.assert)("number"==typeof e.clip.x,"Expected options.clip.x to be a number but found "+typeof e.clip.x),(0,Nd.assert)("number"==typeof e.clip.y,"Expected options.clip.y to be a number but found "+typeof e.clip.y),(0,Nd.assert)("number"==typeof e.clip.width,"Expected options.clip.width to be a number but found "+typeof e.clip.width),(0,Nd.assert)("number"==typeof e.clip.height,"Expected options.clip.height to be a number but found "+typeof e.clip.height),(0,Nd.assert)(0!==e.clip.width,"Expected options.clip.width not to be 0."),(0,Nd.assert)(0!==e.clip.height,"Expected options.clip.height not to be 0.")),t}var Bd={};Object.defineProperty(Bd,"__esModule",{value:!0}),Bd.ConsoleMessage=void 0;var Hd=Hl;class qd extends Hd.SdkObject{constructor(e,t,n,r,i){super(e,"console-message"),this._type=void 0,this._text=void 0,this._args=void 0,this._location=void 0,this._type=t,this._text=n,this._args=r,this._location=i||{url:"",lineNumber:0,columnNumber:0}}type(){return this._type}text(){return void 0===this._text&&(this._text=this._args.map((e=>e.preview())).join(" ")),this._text}args(){return this._args}location(){return this._location}}Bd.ConsoleMessage=qd;var Ud={};Object.defineProperty(Ud,"__esModule",{value:!0}),Ud.Accessibility=void 0;function Wd(e,t,n){if(t.isInteresting(n)&&e.add(t),!t.isLeafNode()){n=n||t.isControl();for(const r of t.children())Wd(e,r,n)}}function $d(e,t){const n=[];for(const r of e.children())n.push(...$d(r,t));if(t&&!t.has(e))return n;const r=e.serialize();return n.length&&(r.children=n),[r]}Ud.Accessibility=class{constructor(e){this._getAXTree=void 0,this._getAXTree=e}async snapshot(e={}){const{interestingOnly:t=!0,root:n=null}=e,{tree:r,needle:i}=await this._getAXTree(n||void 0);if(!t)return n?i&&$d(i)[0]:$d(r)[0];const o=new Set;return Wd(o,r,!1),!n||i&&o.has(i)?$d(i||r,o)[0]:null}};var zd={};Object.defineProperty(zd,"__esModule",{value:!0}),zd.FileChooser=void 0;zd.FileChooser=class{constructor(e,t,n){this._page=void 0,this._elementHandle=void 0,this._isMultiple=void 0,this._page=e,this._elementHandle=t,this._isMultiple=n}element(){return this._elementHandle}isMultiple(){return this._isMultiple}page(){return this._page}};var Vd={},Gd={exports:{}},Kd={exports:{}},Jd={exports:{}};!function(e){var t={};e.exports=t;var n={reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],grey:[90,39],brightRed:[91,39],brightGreen:[92,39],brightYellow:[93,39],brightBlue:[94,39],brightMagenta:[95,39],brightCyan:[96,39],brightWhite:[97,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgGray:[100,49],bgGrey:[100,49],bgBrightRed:[101,49],bgBrightGreen:[102,49],bgBrightYellow:[103,49],bgBrightBlue:[104,49],bgBrightMagenta:[105,49],bgBrightCyan:[106,49],bgBrightWhite:[107,49],blackBG:[40,49],redBG:[41,49],greenBG:[42,49],yellowBG:[43,49],blueBG:[44,49],magentaBG:[45,49],cyanBG:[46,49],whiteBG:[47,49]};Object.keys(n).forEach((function(e){var r=n[e],i=t[e]=[];i.open="["+r[0]+"m",i.close="["+r[1]+"m"}))}(Jd);var Yd=E.default,Xd=function(e,t){var n=(t=t||process.argv).indexOf("--"),r=/^-{1,2}/.test(e)?"":"--",i=t.indexOf(r+e);return-1!==i&&(-1===n||i<n)},Qd=process.env,Zd=void 0;function eh(e){var t=function(e){if(!1===Zd)return 0;if(Xd("color=16m")||Xd("color=full")||Xd("color=truecolor"))return 3;if(Xd("color=256"))return 2;if(e&&!e.isTTY&&!0!==Zd)return 0;var t=Zd?1:0;if("win32"===process.platform){var n=Yd.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(n[0])>=10&&Number(n[2])>=10586?Number(n[2])>=14931?3:2:1}if("CI"in Qd)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some((function(e){return e in Qd}))||"codeship"===Qd.CI_NAME?1:t;if("TEAMCITY_VERSION"in Qd)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(Qd.TEAMCITY_VERSION)?1:0;if("TERM_PROGRAM"in Qd){var r=parseInt((Qd.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(Qd.TERM_PROGRAM){case"iTerm.app":return r>=3?3:2;case"Hyper":return 3;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(Qd.TERM)?2:/^screen|^xterm|^vt100|^rxvt|color|ansi|cygwin|linux/i.test(Qd.TERM)||"COLORTERM"in Qd?1:(Qd.TERM,t)}(e);return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(t)}Xd("no-color")||Xd("no-colors")||Xd("color=false")?Zd=!1:(Xd("color")||Xd("colors")||Xd("color=true")||Xd("color=always"))&&(Zd=!0),"FORCE_COLOR"in Qd&&(Zd=0===Qd.FORCE_COLOR.length||0!==parseInt(Qd.FORCE_COLOR,10));var th,nh=eh,rh=(eh(process.stdout),eh(process.stderr),{exports:{}});var ih,oh={exports:{}};var sh,ah={exports:{}};var lh,ch={exports:{}};var uh,dh={exports:{}};var hh,ph={exports:{}};!function(e){var t={};e.exports=t,t.themes={};var n=N.default,r=t.styles=Jd.exports,i=Object.defineProperties,o=new RegExp(/[\r\n]+/g);t.supportsColor=nh,void 0===t.enabled&&(t.enabled=!1!==t.supportsColor()),t.enable=function(){t.enabled=!0},t.disable=function(){t.enabled=!1},t.stripColors=t.strip=function(e){return(""+e).replace(/\x1B\[\d+m/g,"")},t.stylize=function(e,n){if(!t.enabled)return e+"";var i=r[n];return!i&&n in t?t[n](e):i.open+e+i.close};var s=/[|\\{}()[\]^$+*?.]/g;function a(e){var t=function e(){return d.apply(e,arguments)};return t._styles=e,t.__proto__=u,t}var l,c=(l={},r.grey=r.gray,Object.keys(r).forEach((function(e){r[e].closeRe=new RegExp(function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(s,"\\$&")}(r[e].close),"g"),l[e]={get:function(){return a(this._styles.concat(e))}}})),l),u=i((function(){}),c);function d(){var e=Array.prototype.slice.call(arguments),i=e.map((function(e){return null!=e&&e.constructor===String?e:n.inspect(e)})).join(" ");if(!t.enabled||!i)return i;for(var s=-1!=i.indexOf("\n"),a=this._styles,l=a.length;l--;){var c=r[a[l]];i=c.open+i.replace(c.closeRe,c.open)+c.close,s&&(i=i.replace(o,(function(e){return c.close+e+c.open})))}return i}t.setTheme=function(e){if("string"!=typeof e)for(var n in e)!function(n){t[n]=function(r){if("object"==typeof e[n]){var i=r;for(var o in e[n])i=t[e[n][o]](i);return i}return t[e[n]](r)}}(n);else console.log("colors.setTheme now only accepts an object, not a string.  If you are trying to set a theme from a file, it is now your (the caller's) responsibility to require the file.  The old syntax looked like colors.setTheme(__dirname + '/../themes/generic-logging.js'); The new syntax looks like colors.setTheme(require(__dirname + '/../themes/generic-logging.js'));")};var h=function(e,t){var n=t.split("");return(n=n.map(e)).join("")};for(var p in t.trap=th?rh.exports:(th=1,rh.exports=function(e,t){var n="";e=(e=e||"Run the trap, drop the bass").split("");var r={a:["@","","","","","",""],b:["","","","","",""],c:["","",""],d:["","","","","",""],e:["","","","","","","",""],f:[""],g:[""],h:["","","","","",""],i:[""],j:[""],k:["","","",""],l:[""],m:["","","","","",""],n:["","","","","",""],o:["","","","","","","","",""],p:["",""],q:[""],r:["","","","","",""],s:["","","",""],t:["","",""],u:["",""],v:[""],w:["","","",""],x:["","","",""],y:["","",""],z:["",""]};return e.forEach((function(e){e=e.toLowerCase();var t=r[e]||[" "],i=Math.floor(Math.random()*t.length);n+=void 0!==r[e]?r[e][i]:e})),n}),t.zalgo=ih?oh.exports:(ih=1,oh.exports=function(e,t){e=e||"   he is here   ";var n={up:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],down:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],mid:["","","","","","","","","","","","","","","","","","","","",""," "]},r=[].concat(n.up,n.down,n.mid);function i(e){return Math.floor(Math.random()*e)}function o(e){var t=!1;return r.filter((function(n){t=n===e})),t}return function(e,t){var r,s,a="";for(s in(t=t||{}).up=void 0===t.up||t.up,t.mid=void 0===t.mid||t.mid,t.down=void 0===t.down||t.down,t.size=void 0!==t.size?t.size:"maxi",e=e.split(""))if(!o(s)){switch(a+=e[s],r={up:0,down:0,mid:0},t.size){case"mini":r.up=i(8),r.mid=i(2),r.down=i(8);break;case"maxi":r.up=i(16)+3,r.mid=i(4)+1,r.down=i(64)+3;break;default:r.up=i(8)+1,r.mid=i(6)/2,r.down=i(8)+1}var l=["up","mid","down"];for(var c in l)for(var u=l[c],d=0;d<=r[u];d++)t[u]&&(a+=n[u][i(n[u].length)])}return a}(e,t)}),t.maps={},t.maps.america=(sh?ah.exports:(sh=1,ah.exports=function(e){return function(t,n,r){if(" "===t)return t;switch(n%3){case 0:return e.red(t);case 1:return e.white(t);case 2:return e.blue(t)}}}))(t),t.maps.zebra=(lh?ch.exports:(lh=1,ch.exports=function(e){return function(t,n,r){return n%2==0?t:e.inverse(t)}}))(t),t.maps.rainbow=(uh?dh.exports:(uh=1,dh.exports=function(e){var t=["red","yellow","green","blue","magenta"];return function(n,r,i){return" "===n?n:e[t[r++%t.length]](n)}}))(t),t.maps.random=(hh?ph.exports:(hh=1,ph.exports=function(e){var t=["underline","inverse","grey","yellow","red","green","blue","white","cyan","magenta","brightYellow","brightRed","brightGreen","brightBlue","brightWhite","brightCyan","brightMagenta"];return function(n,r,i){return" "===n?n:e[t[Math.round(Math.random()*(t.length-2))]](n)}}))(t),t.maps)!function(e){t[e]=function(n){return h(t.maps[e],n)}}(p);i(t,function(){var e={};return Object.keys(c).forEach((function(t){e[t]={get:function(){return a([t])}}})),e}())}(Kd),Gd.exports=Kd.exports;var fh={exports:{}};!function(e){function t(e){var t,n,r,i,o,s=Math.floor,a=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(65535),h=new Array(65535),p=new Array(64),f=new Array(64),m=[],g=0,_=7,w=new Array(64),v=new Array(64),b=new Array(64),y=new Array(256),S=new Array(2048),x=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],k=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],C=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],T=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],O=[0,1,2,3,4,5,6,7,8,9,10,11],A=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],I=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function M(e,t){for(var n=0,r=0,i=new Array,o=1;o<=16;o++){for(var s=1;s<=e[o];s++)i[t[r]]=[],i[t[r]][0]=n,i[t[r]][1]=o,r++,n++;n*=2}return i}function F(e){for(var t=e[0],n=e[1]-1;n>=0;)t&1<<n&&(g|=1<<_),n--,--_<0&&(255==g?(N(255),N(0)):N(g),_=7,g=0)}function N(e){m.push(e)}function R(e){N(e>>8&255),N(255&e)}function j(e,t,n,r,i){for(var o,s=i[0],a=i[240],l=function(e,t){var n,r,i,o,s,a,l,c,u,d,h=0;for(u=0;u<8;++u){n=e[h],r=e[h+1],i=e[h+2],o=e[h+3],s=e[h+4],a=e[h+5],l=e[h+6];var f=n+(c=e[h+7]),m=n-c,g=r+l,_=r-l,w=i+a,v=i-a,b=o+s,y=o-s,S=f+b,x=f-b,k=g+w,E=g-w;e[h]=S+k,e[h+4]=S-k;var C=.707106781*(E+x);e[h+2]=x+C,e[h+6]=x-C;var T=.382683433*((S=y+v)-(E=_+m)),P=.5411961*S+T,O=1.306562965*E+T,A=.707106781*(k=v+_),I=m+A,M=m-A;e[h+5]=M+P,e[h+3]=M-P,e[h+1]=I+O,e[h+7]=I-O,h+=8}for(h=0,u=0;u<8;++u){n=e[h],r=e[h+8],i=e[h+16],o=e[h+24],s=e[h+32],a=e[h+40],l=e[h+48];var F=n+(c=e[h+56]),N=n-c,R=r+l,j=r-l,D=i+a,L=i-a,B=o+s,H=o-s,q=F+B,U=F-B,W=R+D,$=R-D;e[h]=q+W,e[h+32]=q-W;var z=.707106781*($+U);e[h+16]=U+z,e[h+48]=U-z;var V=.382683433*((q=H+L)-($=j+N)),G=.5411961*q+V,K=1.306562965*$+V,J=.707106781*(W=L+j),Y=N+J,X=N-J;e[h+40]=X+G,e[h+24]=X-G,e[h+8]=Y+K,e[h+56]=Y-K,h++}for(u=0;u<64;++u)d=e[u]*t[u],p[u]=d>0?d+.5|0:d-.5|0;return p}(e,t),c=0;c<64;++c)f[x[c]]=l[c];var u=f[0]-n;n=f[0],0==u?F(r[0]):(F(r[h[o=32767+u]]),F(d[o]));for(var m=63;m>0&&0==f[m];m--);if(0==m)return F(s),n;for(var g,_=1;_<=m;){for(var w=_;0==f[_]&&_<=m;++_);var v=_-w;if(v>=16){g=v>>4;for(var b=1;b<=g;++b)F(a);v&=15}o=32767+f[_],F(i[(v<<4)+h[o]]),F(d[o]),_++}return 63!=m&&F(s),n}function D(e){if(e<=0&&(e=1),e>100&&(e=100),o!=e){(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++){var r=s((t[n]*e+50)/100);r<1?r=1:r>255&&(r=255),a[x[n]]=r}for(var i=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],o=0;o<64;o++){var d=s((i[o]*e+50)/100);d<1?d=1:d>255&&(d=255),l[x[o]]=d}for(var h=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],p=0,f=0;f<8;f++)for(var m=0;m<8;m++)c[p]=1/(a[x[p]]*h[f]*h[m]*8),u[p]=1/(l[x[p]]*h[f]*h[m]*8),p++})(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),o=e}}this.encode=function(e,o){(new Date).getTime(),o&&D(o),m=new Array,g=0,_=7,R(65496),R(65504),R(16),N(74),N(70),N(73),N(70),N(0),N(1),N(1),N(0),R(1),R(1),N(0),N(0),function(e){if(e){R(65505),69===e[0]&&120===e[1]&&105===e[2]&&102===e[3]?R(e.length+2):(R(e.length+5+2),N(69),N(120),N(105),N(102),N(0));for(var t=0;t<e.length;t++)N(e[t])}}(e.exifBuffer),function(){R(65499),R(132),N(0);for(var e=0;e<64;e++)N(a[e]);N(1);for(var t=0;t<64;t++)N(l[t])}(),function(e,t){R(65472),R(17),N(8),R(t),R(e),N(3),N(1),N(17),N(0),N(2),N(17),N(1),N(3),N(17),N(1)}(e.width,e.height),function(){R(65476),R(418),N(0);for(var e=0;e<16;e++)N(k[e+1]);for(var t=0;t<=11;t++)N(E[t]);N(16);for(var n=0;n<16;n++)N(C[n+1]);for(var r=0;r<=161;r++)N(T[r]);N(1);for(var i=0;i<16;i++)N(P[i+1]);for(var o=0;o<=11;o++)N(O[o]);N(17);for(var s=0;s<16;s++)N(A[s+1]);for(var a=0;a<=161;a++)N(I[a])}(),R(65498),R(12),N(3),N(1),N(0),N(2),N(17),N(3),N(17),N(0),N(63),N(0);var s=0,d=0,h=0;g=0,_=7,this.encode.displayName="_encode_";for(var p,f,y,x,M,L,B,H,q,U=e.data,W=e.width,$=e.height,z=4*W,V=0;V<$;){for(p=0;p<z;){for(L=M=z*V+p,B=-1,H=0,q=0;q<64;q++)L=M+(H=q>>3)*z+(B=4*(7&q)),V+H>=$&&(L-=z*(V+1+H-$)),p+B>=z&&(L-=p+B-z+4),f=U[L++],y=U[L++],x=U[L++],w[q]=(S[f]+S[y+256>>0]+S[x+512>>0]>>16)-128,v[q]=(S[f+768>>0]+S[y+1024>>0]+S[x+1280>>0]>>16)-128,b[q]=(S[f+1280>>0]+S[y+1536>>0]+S[x+1792>>0]>>16)-128;s=j(w,c,s,t,r),d=j(v,u,d,n,i),h=j(b,u,h,n,i),p+=32}V+=8}if(_>=0){var G=[];G[1]=_+1,G[0]=(1<<_+1)-1,F(G)}return R(65497),Buffer.from(m)},(new Date).getTime(),e||(e=50),function(){for(var e=String.fromCharCode,t=0;t<256;t++)y[t]=e(t)}(),t=M(k,E),n=M(P,O),r=M(C,T),i=M(A,I),function(){for(var e=1,t=2,n=1;n<=15;n++){for(var r=e;r<t;r++)h[32767+r]=n,d[32767+r]=[],d[32767+r][1]=n,d[32767+r][0]=r;for(var i=-(t-1);i<=-e;i++)h[32767+i]=n,d[32767+i]=[],d[32767+i][1]=n,d[32767+i][0]=t-1+i;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)S[e]=19595*e,S[e+256>>0]=38470*e,S[e+512>>0]=7471*e+32768,S[e+768>>0]=-11059*e,S[e+1024>>0]=-21709*e,S[e+1280>>0]=32768*e+8421375,S[e+1536>>0]=-27439*e,S[e+1792>>0]=-5329*e}(),D(e),(new Date).getTime()}fh.exports=function(e,n){void 0===n&&(n=50);return{data:new t(n).encode(e,n),width:e.width,height:e.height}}}();var mh={exports:{}};!function(e){var t=function(){var e=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),t=4017,n=799,r=3406,i=2276,o=1567,s=3784,a=5793,l=2896;function c(){}function u(e,t){for(var n,r,i=0,o=[],s=16;s>0&&!e[s-1];)s--;o.push({children:[],index:0});var a,l=o[0];for(n=0;n<s;n++){for(r=0;r<e[n];r++){for((l=o.pop()).children[l.index]=t[i];l.index>0;){if(0===o.length)throw new Error("Could not recreate Huffman Table");l=o.pop()}for(l.index++,o.push(l);o.length<=n;)o.push(a={children:[],index:0}),l.children[l.index]=a.children,l=a;i++}n+1<s&&(o.push(a={children:[],index:0}),l.children[l.index]=a.children,l=a)}return o[0].children}function d(t,n,r,i,o,s,a,l,c,u){r.precision,r.samplesPerLine,r.scanLines;var d=r.mcusPerLine,h=r.progressive;r.maxH,r.maxV;var p=n,f=0,m=0;function g(){if(m>0)return m--,f>>m&1;if(255==(f=t[n++])){var e=t[n++];if(e)throw new Error("unexpected marker: "+(f<<8|e).toString(16))}return m=7,f>>>7}function _(e){for(var t,n=e;null!==(t=g());){if("number"==typeof(n=n[t]))return n;if("object"!=typeof n)throw new Error("invalid huffman sequence")}return null}function w(e){for(var t=0;e>0;){var n=g();if(null===n)return;t=t<<1|n,e--}return t}function v(e){var t=w(e);return t>=1<<e-1?t:t+(-1<<e)+1}var b=0;var y,S=0;function x(e,t,n,r,i){var o=n%d,s=(n/d|0)*e.v+r,a=o*e.h+i;void 0===e.blocks[s]&&u.tolerantDecoding||t(e,e.blocks[s][a])}function k(e,t,n){var r=n/e.blocksPerLine|0,i=n%e.blocksPerLine;void 0===e.blocks[r]&&u.tolerantDecoding||t(e,e.blocks[r][i])}var E,C,T,P,O,A,I=i.length;A=h?0===s?0===l?function(e,t){var n=_(e.huffmanTableDC),r=0===n?0:v(n)<<c;t[0]=e.pred+=r}:function(e,t){t[0]|=g()<<c}:0===l?function(t,n){if(b>0)b--;else for(var r=s,i=a;r<=i;){var o=_(t.huffmanTableAC),l=15&o,u=o>>4;if(0!==l)n[e[r+=u]]=v(l)*(1<<c),r++;else{if(u<15){b=w(u)+(1<<u)-1;break}r+=16}}}:function(t,n){for(var r=s,i=a,o=0;r<=i;){var l=e[r],u=n[l]<0?-1:1;switch(S){case 0:var d=_(t.huffmanTableAC),h=15&d;if(o=d>>4,0===h)o<15?(b=w(o)+(1<<o),S=4):(o=16,S=1);else{if(1!==h)throw new Error("invalid ACn encoding");y=v(h),S=o?2:3}continue;case 1:case 2:n[l]?n[l]+=(g()<<c)*u:0==--o&&(S=2==S?3:0);break;case 3:n[l]?n[l]+=(g()<<c)*u:(n[l]=y<<c,S=0);break;case 4:n[l]&&(n[l]+=(g()<<c)*u)}r++}4===S&&0==--b&&(S=0)}:function(t,n){var r=_(t.huffmanTableDC),i=0===r?0:v(r);n[0]=t.pred+=i;for(var o=1;o<64;){var s=_(t.huffmanTableAC),a=15&s,l=s>>4;if(0!==a)n[e[o+=l]]=v(a),o++;else{if(l<15)break;o+=16}}};var M,F,N,R,j=0;for(F=1==I?i[0].blocksPerLine*i[0].blocksPerColumn:d*r.mcusPerColumn,o||(o=F);j<F;){for(C=0;C<I;C++)i[C].pred=0;if(b=0,1==I)for(E=i[0],O=0;O<o;O++)k(E,A,j),j++;else for(O=0;O<o;O++){for(C=0;C<I;C++)for(N=(E=i[C]).h,R=E.v,T=0;T<R;T++)for(P=0;P<N;P++)x(E,A,j,T,P);if(++j===F)break}if(j===F)do{if(255===t[n]&&0!==t[n+1])break;n+=1}while(n<t.length-2);if(m=0,(M=t[n]<<8|t[n+1])<65280)throw new Error("marker was not found");if(!(M>=65488&&M<=65495))break;n+=2}return n-p}function h(e,c){var u,d,h=[],p=c.blocksPerLine,f=c.blocksPerColumn,m=p<<3,_=new Int32Array(64),w=new Uint8Array(64);function v(e,u,d){var h,p,f,m,g,_,w,v,b,y,S=c.quantizationTable,x=d;for(y=0;y<64;y++)x[y]=e[y]*S[y];for(y=0;y<8;++y){var k=8*y;0!=x[1+k]||0!=x[2+k]||0!=x[3+k]||0!=x[4+k]||0!=x[5+k]||0!=x[6+k]||0!=x[7+k]?(h=a*x[0+k]+128>>8,p=a*x[4+k]+128>>8,f=x[2+k],m=x[6+k],g=l*(x[1+k]-x[7+k])+128>>8,v=l*(x[1+k]+x[7+k])+128>>8,_=x[3+k]<<4,w=x[5+k]<<4,b=h-p+1>>1,h=h+p+1>>1,p=b,b=f*s+m*o+128>>8,f=f*o-m*s+128>>8,m=b,b=g-w+1>>1,g=g+w+1>>1,w=b,b=v+_+1>>1,_=v-_+1>>1,v=b,b=h-m+1>>1,h=h+m+1>>1,m=b,b=p-f+1>>1,p=p+f+1>>1,f=b,b=g*i+v*r+2048>>12,g=g*r-v*i+2048>>12,v=b,b=_*n+w*t+2048>>12,_=_*t-w*n+2048>>12,w=b,x[0+k]=h+v,x[7+k]=h-v,x[1+k]=p+w,x[6+k]=p-w,x[2+k]=f+_,x[5+k]=f-_,x[3+k]=m+g,x[4+k]=m-g):(b=a*x[0+k]+512>>10,x[0+k]=b,x[1+k]=b,x[2+k]=b,x[3+k]=b,x[4+k]=b,x[5+k]=b,x[6+k]=b,x[7+k]=b)}for(y=0;y<8;++y){var E=y;0!=x[8+E]||0!=x[16+E]||0!=x[24+E]||0!=x[32+E]||0!=x[40+E]||0!=x[48+E]||0!=x[56+E]?(h=a*x[0+E]+2048>>12,p=a*x[32+E]+2048>>12,f=x[16+E],m=x[48+E],g=l*(x[8+E]-x[56+E])+2048>>12,v=l*(x[8+E]+x[56+E])+2048>>12,_=x[24+E],w=x[40+E],b=h-p+1>>1,h=h+p+1>>1,p=b,b=f*s+m*o+2048>>12,f=f*o-m*s+2048>>12,m=b,b=g-w+1>>1,g=g+w+1>>1,w=b,b=v+_+1>>1,_=v-_+1>>1,v=b,b=h-m+1>>1,h=h+m+1>>1,m=b,b=p-f+1>>1,p=p+f+1>>1,f=b,b=g*i+v*r+2048>>12,g=g*r-v*i+2048>>12,v=b,b=_*n+w*t+2048>>12,_=_*t-w*n+2048>>12,w=b,x[0+E]=h+v,x[56+E]=h-v,x[8+E]=p+w,x[48+E]=p-w,x[16+E]=f+_,x[40+E]=f-_,x[24+E]=m+g,x[32+E]=m-g):(b=a*d[y+0]+8192>>14,x[0+E]=b,x[8+E]=b,x[16+E]=b,x[24+E]=b,x[32+E]=b,x[40+E]=b,x[48+E]=b,x[56+E]=b)}for(y=0;y<64;++y){var C=128+(x[y]+8>>4);u[y]=C<0?0:C>255?255:C}}g(m*f*8);for(var b=0;b<f;b++){var y=b<<3;for(u=0;u<8;u++)h.push(new Uint8Array(m));for(var S=0;S<p;S++){v(c.blocks[b][S],w,_);var x=0,k=S<<3;for(d=0;d<8;d++){var E=h[y+d];for(u=0;u<8;u++)E[k+u]=w[x++]}}}return h}function p(e){return e<0?0:e>255?255:e}c.prototype={load:function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onload=function(){var e=new Uint8Array(t.response||t.mozResponseArrayBuffer);this.parse(e),this.onload&&this.onload()}.bind(this),t.send(null)},parse:function(t){var n=1e3*this.opts.maxResolutionInMP*1e3,r=0;function i(){var e=t[r]<<8|t[r+1];return r+=2,e}function o(e){var t,n,r=0,i=0;for(n in e.components)e.components.hasOwnProperty(n)&&(r<(t=e.components[n]).h&&(r=t.h),i<t.v&&(i=t.v));var o=Math.ceil(e.samplesPerLine/8/r),s=Math.ceil(e.scanLines/8/i);for(n in e.components)if(e.components.hasOwnProperty(n)){t=e.components[n];var a=Math.ceil(Math.ceil(e.samplesPerLine/8)*t.h/r),l=Math.ceil(Math.ceil(e.scanLines/8)*t.v/i),c=o*t.h,u=s*t.v,d=[];g(256*(u*c));for(var h=0;h<u;h++){for(var p=[],f=0;f<c;f++)p.push(new Int32Array(64));d.push(p)}t.blocksPerLine=a,t.blocksPerColumn=l,t.blocks=d}e.maxH=r,e.maxV=i,e.mcusPerLine=o,e.mcusPerColumn=s}t.length;var s,a,l,c,p=null,f=null,m=[],_=[],w=[],v=[],b=i(),y=-1;if(this.comments=[],65496!=b)throw new Error("SOI not found");for(b=i();65497!=b;){switch(b){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var S=(l=void 0,c=void 0,l=i(),c=t.subarray(r,r+l-2),r+=c.length,c);if(65534===b){var x=String.fromCharCode.apply(null,S);this.comments.push(x)}65504===b&&74===S[0]&&70===S[1]&&73===S[2]&&70===S[3]&&0===S[4]&&(p={version:{major:S[5],minor:S[6]},densityUnits:S[7],xDensity:S[8]<<8|S[9],yDensity:S[10]<<8|S[11],thumbWidth:S[12],thumbHeight:S[13],thumbData:S.subarray(14,14+3*S[12]*S[13])}),65505===b&&69===S[0]&&120===S[1]&&105===S[2]&&102===S[3]&&0===S[4]&&(this.exifBuffer=S.subarray(5,S.length)),65518===b&&65===S[0]&&100===S[1]&&111===S[2]&&98===S[3]&&101===S[4]&&0===S[5]&&(f={version:S[6],flags0:S[7]<<8|S[8],flags1:S[9]<<8|S[10],transformCode:S[11]});break;case 65499:for(var k=i()+r-2;r<k;){var E=t[r++];g(256);var C=new Int32Array(64);if(E>>4==0)for(K=0;K<64;K++){C[e[K]]=t[r++]}else{if(E>>4!=1)throw new Error("DQT: invalid table spec");for(K=0;K<64;K++){C[e[K]]=i()}}m[15&E]=C}break;case 65472:case 65473:case 65474:i(),(s={}).extended=65473===b,s.progressive=65474===b,s.precision=t[r++],s.scanLines=i(),s.samplesPerLine=i(),s.components={},s.componentsOrder=[];var T=s.scanLines*s.samplesPerLine;if(T>n){var P=Math.ceil((T-n)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${P}MP`)}var O,A=t[r++];for(V=0;V<A;V++){O=t[r];var I=t[r+1]>>4,M=15&t[r+1],F=t[r+2];s.componentsOrder.push(O),s.components[O]={h:I,v:M,quantizationIdx:F},r+=3}o(s),_.push(s);break;case 65476:var N=i();for(V=2;V<N;){var R=t[r++],j=new Uint8Array(16),D=0;for(K=0;K<16;K++,r++)D+=j[K]=t[r];g(16+D);var L=new Uint8Array(D);for(K=0;K<D;K++,r++)L[K]=t[r];V+=17+D,(R>>4==0?v:w)[15&R]=u(j,L)}break;case 65501:i(),a=i();break;case 65500:i(),i();break;case 65498:i();var B=t[r++],H=[];for(V=0;V<B;V++){J=s.components[t[r++]];var q=t[r++];J.huffmanTableDC=v[q>>4],J.huffmanTableAC=w[15&q],H.push(J)}var U=t[r++],W=t[r++],$=t[r++],z=d(t,r,s,H,a,U,W,$>>4,15&$,this.opts);r+=z;break;case 65535:255!==t[r]&&r--;break;default:if(255==t[r-3]&&t[r-2]>=192&&t[r-2]<=254){r-=3;break}if(224===b||225==b){if(-1!==y)throw new Error(`first unknown JPEG marker at offset ${y.toString(16)}, second unknown JPEG marker ${b.toString(16)} at offset ${(r-1).toString(16)}`);y=r-1;const e=i();if(255===t[r+e-2]){r+=e-2;break}}throw new Error("unknown JPEG marker "+b.toString(16))}b=i()}if(1!=_.length)throw new Error("only single frame JPEGs supported");for(var V=0;V<_.length;V++){var G=_[V].components;for(var K in G)G[K].quantizationTable=m[G[K].quantizationIdx],delete G[K].quantizationIdx}this.width=s.samplesPerLine,this.height=s.scanLines,this.jfif=p,this.adobe=f,this.components=[];for(V=0;V<s.componentsOrder.length;V++){var J=s.components[s.componentsOrder[V]];this.components.push({lines:h(0,J),scaleX:J.h/s.maxH,scaleY:J.v/s.maxV})}},getData:function(e,t){var n,r,i,o,s,a,l,c,u,d,h,f,m,_,w,v,b,y,S,x,k,E=this.width/e,C=this.height/t,T=0,P=e*t*this.components.length;g(P);var O=new Uint8Array(P);switch(this.components.length){case 1:for(n=this.components[0],d=0;d<t;d++)for(s=n.lines[0|d*n.scaleY*C],u=0;u<e;u++)h=s[0|u*n.scaleX*E],O[T++]=h;break;case 2:for(n=this.components[0],r=this.components[1],d=0;d<t;d++)for(s=n.lines[0|d*n.scaleY*C],a=r.lines[0|d*r.scaleY*C],u=0;u<e;u++)h=s[0|u*n.scaleX*E],O[T++]=h,h=a[0|u*r.scaleX*E],O[T++]=h;break;case 3:for(k=!0,this.adobe&&this.adobe.transformCode?k=!0:void 0!==this.opts.colorTransform&&(k=!!this.opts.colorTransform),n=this.components[0],r=this.components[1],i=this.components[2],d=0;d<t;d++)for(s=n.lines[0|d*n.scaleY*C],a=r.lines[0|d*r.scaleY*C],l=i.lines[0|d*i.scaleY*C],u=0;u<e;u++)k?(h=s[0|u*n.scaleX*E],f=a[0|u*r.scaleX*E],y=p(h+1.402*((m=l[0|u*i.scaleX*E])-128)),S=p(h-.3441363*(f-128)-.71413636*(m-128)),x=p(h+1.772*(f-128))):(y=s[0|u*n.scaleX*E],S=a[0|u*r.scaleX*E],x=l[0|u*i.scaleX*E]),O[T++]=y,O[T++]=S,O[T++]=x;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(k=!1,this.adobe&&this.adobe.transformCode?k=!0:void 0!==this.opts.colorTransform&&(k=!!this.opts.colorTransform),n=this.components[0],r=this.components[1],i=this.components[2],o=this.components[3],d=0;d<t;d++)for(s=n.lines[0|d*n.scaleY*C],a=r.lines[0|d*r.scaleY*C],l=i.lines[0|d*i.scaleY*C],c=o.lines[0|d*o.scaleY*C],u=0;u<e;u++)k?(h=s[0|u*n.scaleX*E],f=a[0|u*r.scaleX*E],m=l[0|u*i.scaleX*E],_=c[0|u*o.scaleX*E],w=255-p(h+1.402*(m-128)),v=255-p(h-.3441363*(f-128)-.71413636*(m-128)),b=255-p(h+1.772*(f-128))):(w=s[0|u*n.scaleX*E],v=a[0|u*r.scaleX*E],b=l[0|u*i.scaleX*E],_=c[0|u*o.scaleX*E]),O[T++]=255-w,O[T++]=255-v,O[T++]=255-b,O[T++]=255-_;break;default:throw new Error("Unsupported color mode")}return O},copyToImageData:function(e,t){var n,r,i,o,s,a,l,c,u,d=e.width,h=e.height,f=e.data,m=this.getData(d,h),g=0,_=0;switch(this.components.length){case 1:for(r=0;r<h;r++)for(n=0;n<d;n++)i=m[g++],f[_++]=i,f[_++]=i,f[_++]=i,t&&(f[_++]=255);break;case 3:for(r=0;r<h;r++)for(n=0;n<d;n++)l=m[g++],c=m[g++],u=m[g++],f[_++]=l,f[_++]=c,f[_++]=u,t&&(f[_++]=255);break;case 4:for(r=0;r<h;r++)for(n=0;n<d;n++)s=m[g++],a=m[g++],i=m[g++],l=255-p(s*(1-(o=m[g++])/255)+o),c=255-p(a*(1-o/255)+o),u=255-p(i*(1-o/255)+o),f[_++]=l,f[_++]=c,f[_++]=u,t&&(f[_++]=255);break;default:throw new Error("Unsupported color mode")}}};var f=0,m=0;function g(e=0){var t=f+e;if(t>m){var n=Math.ceil((t-m)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${n}MB`)}f=t}return c.resetMaxMemoryUsage=function(e){f=0,m=e},c.getBytesAllocated=function(){return f},c.requestMemoryAllocation=g,c}();e.exports=function(e,n={}){var r={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...n},i=new Uint8Array(e),o=new t;o.opts=r,t.resetMaxMemoryUsage(1024*r.maxMemoryUsageInMB*1024),o.parse(i);var s=r.formatAsRGBA?4:3,a=o.width*o.height*s;try{t.requestMemoryAllocation(a);var l={width:o.width,height:o.height,exifBuffer:o.exifBuffer,data:r.useTArray?new Uint8Array(a):Buffer.alloc(a)};o.comments.length>0&&(l.comments=o.comments)}catch(e){throw e instanceof RangeError?new Error("Could not allocate enough memory for the image. Required: "+a):e}return o.copyToImageData(l,r.formatAsRGBA),l}}(mh);var gh={encode:fh.exports,decode:mh.exports},_h=function(e,t,n,r,i,o){if(!vh(e)||!vh(t)||n&&!vh(n))throw new Error("Image data: Uint8Array, Uint8ClampedArray or Buffer expected.");if(e.length!==t.length||n&&n.length!==e.length)throw new Error("Image sizes do not match.");if(e.length!==r*i*4)throw new Error("Image data size does not match width/height.");o=Object.assign({},wh,o);const s=r*i,a=new Uint32Array(e.buffer,e.byteOffset,s),l=new Uint32Array(t.buffer,t.byteOffset,s);let c=!0;for(let e=0;e<s;e++)if(a[e]!==l[e]){c=!1;break}if(c){if(n&&!o.diffMask)for(let t=0;t<s;t++)Ph(e,4*t,o.alpha,n);return 0}const u=35215*o.threshold*o.threshold;let d=0;for(let s=0;s<i;s++)for(let a=0;a<r;a++){const l=4*(s*r+a),c=Sh(e,t,l,l);Math.abs(c)>u?o.includeAA||!bh(e,a,s,r,i,t)&&!bh(t,a,s,r,i,e)?(n&&Th(n,l,...c<0&&o.diffColorAlt||o.diffColor),d++):n&&!o.diffMask&&Th(n,l,...o.aaColor):n&&(o.diffMask||Ph(e,l,o.alpha,n))}return d};const wh={threshold:.1,includeAA:!1,alpha:.1,aaColor:[255,255,0],diffColor:[255,0,0],diffColorAlt:null,diffMask:!1};function vh(e){return ArrayBuffer.isView(e)&&1===e.constructor.BYTES_PER_ELEMENT}function bh(e,t,n,r,i,o){const s=Math.max(t-1,0),a=Math.max(n-1,0),l=Math.min(t+1,r-1),c=Math.min(n+1,i-1),u=4*(n*r+t);let d,h,p,f,m=t===s||t===l||n===a||n===c?1:0,g=0,_=0;for(let i=s;i<=l;i++)for(let o=a;o<=c;o++){if(i===t&&o===n)continue;const s=Sh(e,e,u,4*(o*r+i),!0);if(0===s){if(m++,m>2)return!1}else s<g?(g=s,d=i,h=o):s>_&&(_=s,p=i,f=o)}return 0!==g&&0!==_&&(yh(e,d,h,r,i)&&yh(o,d,h,r,i)||yh(e,p,f,r,i)&&yh(o,p,f,r,i))}function yh(e,t,n,r,i){const o=Math.max(t-1,0),s=Math.max(n-1,0),a=Math.min(t+1,r-1),l=Math.min(n+1,i-1),c=4*(n*r+t);let u=t===o||t===a||n===s||n===l?1:0;for(let i=o;i<=a;i++)for(let o=s;o<=l;o++){if(i===t&&o===n)continue;const s=4*(o*r+i);if(e[c]===e[s]&&e[c+1]===e[s+1]&&e[c+2]===e[s+2]&&e[c+3]===e[s+3]&&u++,u>2)return!0}return!1}function Sh(e,t,n,r,i){let o=e[n+0],s=e[n+1],a=e[n+2],l=e[n+3],c=t[r+0],u=t[r+1],d=t[r+2],h=t[r+3];if(l===h&&o===c&&s===u&&a===d)return 0;l<255&&(l/=255,o=Ch(o,l),s=Ch(s,l),a=Ch(a,l)),h<255&&(h/=255,c=Ch(c,h),u=Ch(u,h),d=Ch(d,h));const p=xh(o,s,a),f=xh(c,u,d),m=p-f;if(i)return m;const g=kh(o,s,a)-kh(c,u,d),_=Eh(o,s,a)-Eh(c,u,d),w=.5053*m*m+.299*g*g+.1957*_*_;return p>f?-w:w}function xh(e,t,n){return.29889531*e+.58662247*t+.11448223*n}function kh(e,t,n){return.59597799*e-.2741761*t-.32180189*n}function Eh(e,t,n){return.21147017*e-.52261711*t+.31114694*n}function Ch(e,t){return 255+(e-255)*t}function Th(e,t,n,r,i){e[t+0]=n,e[t+1]=r,e[t+2]=i,e[t+3]=255}function Ph(e,t,n,r){const i=Ch(xh(e[t+0],e[t+1],e[t+2]),n*e[t+3]/255);Th(r,t,i,i,i)}var Oh=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32};(Oh.Diff=function(e,t){this[0]=e,this[1]=t}).prototype.length=2,Oh.Diff.prototype.toString=function(){return this[0]+","+this[1]},Oh.prototype.diff_main=function(e,t,n,r){void 0===r&&(r=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var i=r;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[new Oh.Diff(0,e)]:[];void 0===n&&(n=!0);var o=n,s=this.diff_commonPrefix(e,t),a=e.substring(0,s);e=e.substring(s),t=t.substring(s),s=this.diff_commonSuffix(e,t);var l=e.substring(e.length-s);e=e.substring(0,e.length-s),t=t.substring(0,t.length-s);var c=this.diff_compute_(e,t,o,i);return a&&c.unshift(new Oh.Diff(0,a)),l&&c.push(new Oh.Diff(0,l)),this.diff_cleanupMerge(c),c},Oh.prototype.diff_compute_=function(e,t,n,r){var i;if(!e)return[new Oh.Diff(1,t)];if(!t)return[new Oh.Diff(-1,e)];var o=e.length>t.length?e:t,s=e.length>t.length?t:e,a=o.indexOf(s);if(-1!=a)return i=[new Oh.Diff(1,o.substring(0,a)),new Oh.Diff(0,s),new Oh.Diff(1,o.substring(a+s.length))],e.length>t.length&&(i[0][0]=i[2][0]=-1),i;if(1==s.length)return[new Oh.Diff(-1,e),new Oh.Diff(1,t)];var l=this.diff_halfMatch_(e,t);if(l){var c=l[0],u=l[1],d=l[2],h=l[3],p=l[4],f=this.diff_main(c,d,n,r),m=this.diff_main(u,h,n,r);return f.concat([new Oh.Diff(0,p)],m)}return n&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,r):this.diff_bisect_(e,t,r)},Oh.prototype.diff_lineMode_=function(e,t,n){var r=this.diff_linesToChars_(e,t);e=r.chars1,t=r.chars2;var i=r.lineArray,o=this.diff_main(e,t,!1,n);this.diff_charsToLines_(o,i),this.diff_cleanupSemantic(o),o.push(new Oh.Diff(0,""));for(var s=0,a=0,l=0,c="",u="";s<o.length;){switch(o[s][0]){case 1:l++,u+=o[s][1];break;case-1:a++,c+=o[s][1];break;case 0:if(a>=1&&l>=1){o.splice(s-a-l,a+l),s=s-a-l;for(var d=this.diff_main(c,u,!1,n),h=d.length-1;h>=0;h--)o.splice(s,0,d[h]);s+=d.length}l=0,a=0,c="",u=""}s++}return o.pop(),o},Oh.prototype.diff_bisect_=function(e,t,n){for(var r=e.length,i=t.length,o=Math.ceil((r+i)/2),s=o,a=2*o,l=new Array(a),c=new Array(a),u=0;u<a;u++)l[u]=-1,c[u]=-1;l[s+1]=0,c[s+1]=0;for(var d=r-i,h=d%2!=0,p=0,f=0,m=0,g=0,_=0;_<o&&!((new Date).getTime()>n);_++){for(var w=-_+p;w<=_-f;w+=2){for(var v=s+w,b=(E=w==-_||w!=_&&l[v-1]<l[v+1]?l[v+1]:l[v-1]+1)-w;E<r&&b<i&&e.charAt(E)==t.charAt(b);)E++,b++;if(l[v]=E,E>r)f+=2;else if(b>i)p+=2;else if(h){if((x=s+d-w)>=0&&x<a&&-1!=c[x])if(E>=(S=r-c[x]))return this.diff_bisectSplit_(e,t,E,b,n)}}for(var y=-_+m;y<=_-g;y+=2){for(var S,x=s+y,k=(S=y==-_||y!=_&&c[x-1]<c[x+1]?c[x+1]:c[x-1]+1)-y;S<r&&k<i&&e.charAt(r-S-1)==t.charAt(i-k-1);)S++,k++;if(c[x]=S,S>r)g+=2;else if(k>i)m+=2;else if(!h){if((v=s+d-y)>=0&&v<a&&-1!=l[v]){var E;b=s+(E=l[v])-v;if(E>=(S=r-S))return this.diff_bisectSplit_(e,t,E,b,n)}}}}return[new Oh.Diff(-1,e),new Oh.Diff(1,t)]},Oh.prototype.diff_bisectSplit_=function(e,t,n,r,i){var o=e.substring(0,n),s=t.substring(0,r),a=e.substring(n),l=t.substring(r),c=this.diff_main(o,s,!1,i),u=this.diff_main(a,l,!1,i);return c.concat(u)},Oh.prototype.diff_linesToChars_=function(e,t){var n=[],r={};function i(e){for(var t="",i=0,s=-1,a=n.length;s<e.length-1;){-1==(s=e.indexOf("\n",i))&&(s=e.length-1);var l=e.substring(i,s+1);(r.hasOwnProperty?r.hasOwnProperty(l):void 0!==r[l])?t+=String.fromCharCode(r[l]):(a==o&&(l=e.substring(i),s=e.length),t+=String.fromCharCode(a),r[l]=a,n[a++]=l),i=s+1}return t}n[0]="";var o=4e4,s=i(e);return o=65535,{chars1:s,chars2:i(t),lineArray:n}},Oh.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var r=e[n][1],i=[],o=0;o<r.length;o++)i[o]=t[r.charCodeAt(o)];e[n][1]=i.join("")}},Oh.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(o,i)==t.substring(o,i)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return i},Oh.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(e.length-i,e.length-o)==t.substring(t.length-i,t.length-o)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return i},Oh.prototype.diff_commonOverlap_=function(e,t){var n=e.length,r=t.length;if(0==n||0==r)return 0;n>r?e=e.substring(n-r):n<r&&(t=t.substring(0,n));var i=Math.min(n,r);if(e==t)return i;for(var o=0,s=1;;){var a=e.substring(i-s),l=t.indexOf(a);if(-1==l)return o;s+=l,0!=l&&e.substring(i-s)!=t.substring(0,s)||(o=s,s++)}},Oh.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var n=e.length>t.length?e:t,r=e.length>t.length?t:e;if(n.length<4||2*r.length<n.length)return null;var i=this;function o(e,t,n){for(var r,o,s,a,l=e.substring(n,n+Math.floor(e.length/4)),c=-1,u="";-1!=(c=t.indexOf(l,c+1));){var d=i.diff_commonPrefix(e.substring(n),t.substring(c)),h=i.diff_commonSuffix(e.substring(0,n),t.substring(0,c));u.length<h+d&&(u=t.substring(c-h,c)+t.substring(c,c+d),r=e.substring(0,n-h),o=e.substring(n+d),s=t.substring(0,c-h),a=t.substring(c+d))}return 2*u.length>=e.length?[r,o,s,a,u]:null}var s,a,l,c,u,d=o(n,r,Math.ceil(n.length/4)),h=o(n,r,Math.ceil(n.length/2));return d||h?(s=h?d&&d[4].length>h[4].length?d:h:d,e.length>t.length?(a=s[0],l=s[1],c=s[2],u=s[3]):(c=s[0],u=s[1],a=s[2],l=s[3]),[a,l,c,u,s[4]]):null},Oh.prototype.diff_cleanupSemantic=function(e){for(var t=!1,n=[],r=0,i=null,o=0,s=0,a=0,l=0,c=0;o<e.length;)0==e[o][0]?(n[r++]=o,s=l,a=c,l=0,c=0,i=e[o][1]):(1==e[o][0]?l+=e[o][1].length:c+=e[o][1].length,i&&i.length<=Math.max(s,a)&&i.length<=Math.max(l,c)&&(e.splice(n[r-1],0,new Oh.Diff(-1,i)),e[n[r-1]+1][0]=1,r--,o=--r>0?n[r-1]:-1,s=0,a=0,l=0,c=0,i=null,t=!0)),o++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),o=1;o<e.length;){if(-1==e[o-1][0]&&1==e[o][0]){var u=e[o-1][1],d=e[o][1],h=this.diff_commonOverlap_(u,d),p=this.diff_commonOverlap_(d,u);h>=p?(h>=u.length/2||h>=d.length/2)&&(e.splice(o,0,new Oh.Diff(0,d.substring(0,h))),e[o-1][1]=u.substring(0,u.length-h),e[o+1][1]=d.substring(h),o++):(p>=u.length/2||p>=d.length/2)&&(e.splice(o,0,new Oh.Diff(0,u.substring(0,p))),e[o-1][0]=1,e[o-1][1]=d.substring(0,d.length-p),e[o+1][0]=-1,e[o+1][1]=u.substring(p),o++),o++}o++}},Oh.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var n=e.charAt(e.length-1),r=t.charAt(0),i=n.match(Oh.nonAlphaNumericRegex_),o=r.match(Oh.nonAlphaNumericRegex_),s=i&&n.match(Oh.whitespaceRegex_),a=o&&r.match(Oh.whitespaceRegex_),l=s&&n.match(Oh.linebreakRegex_),c=a&&r.match(Oh.linebreakRegex_),u=l&&e.match(Oh.blanklineEndRegex_),d=c&&t.match(Oh.blanklineStartRegex_);return u||d?5:l||c?4:i&&!s&&a?3:s||a?2:i||o?1:0}for(var n=1;n<e.length-1;){if(0==e[n-1][0]&&0==e[n+1][0]){var r=e[n-1][1],i=e[n][1],o=e[n+1][1],s=this.diff_commonSuffix(r,i);if(s){var a=i.substring(i.length-s);r=r.substring(0,r.length-s),i=a+i.substring(0,i.length-s),o=a+o}for(var l=r,c=i,u=o,d=t(r,i)+t(i,o);i.charAt(0)===o.charAt(0);){r+=i.charAt(0),i=i.substring(1)+o.charAt(0),o=o.substring(1);var h=t(r,i)+t(i,o);h>=d&&(d=h,l=r,c=i,u=o)}e[n-1][1]!=l&&(l?e[n-1][1]=l:(e.splice(n-1,1),n--),e[n][1]=c,u?e[n+1][1]=u:(e.splice(n+1,1),n--))}n++}},Oh.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,Oh.whitespaceRegex_=/\s/,Oh.linebreakRegex_=/[\r\n]/,Oh.blanklineEndRegex_=/\n\r?\n$/,Oh.blanklineStartRegex_=/^\r?\n\r?\n/,Oh.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,n=[],r=0,i=null,o=0,s=!1,a=!1,l=!1,c=!1;o<e.length;)0==e[o][0]?(e[o][1].length<this.Diff_EditCost&&(l||c)?(n[r++]=o,s=l,a=c,i=e[o][1]):(r=0,i=null),l=c=!1):(-1==e[o][0]?c=!0:l=!0,i&&(s&&a&&l&&c||i.length<this.Diff_EditCost/2&&s+a+l+c==3)&&(e.splice(n[r-1],0,new Oh.Diff(-1,i)),e[n[r-1]+1][0]=1,r--,i=null,s&&a?(l=c=!0,r=0):(o=--r>0?n[r-1]:-1,l=c=!1),t=!0)),o++;t&&this.diff_cleanupMerge(e)},Oh.prototype.diff_cleanupMerge=function(e){e.push(new Oh.Diff(0,""));for(var t,n=0,r=0,i=0,o="",s="";n<e.length;)switch(e[n][0]){case 1:i++,s+=e[n][1],n++;break;case-1:r++,o+=e[n][1],n++;break;case 0:r+i>1?(0!==r&&0!==i&&(0!==(t=this.diff_commonPrefix(s,o))&&(n-r-i>0&&0==e[n-r-i-1][0]?e[n-r-i-1][1]+=s.substring(0,t):(e.splice(0,0,new Oh.Diff(0,s.substring(0,t))),n++),s=s.substring(t),o=o.substring(t)),0!==(t=this.diff_commonSuffix(s,o))&&(e[n][1]=s.substring(s.length-t)+e[n][1],s=s.substring(0,s.length-t),o=o.substring(0,o.length-t))),n-=r+i,e.splice(n,r+i),o.length&&(e.splice(n,0,new Oh.Diff(-1,o)),n++),s.length&&(e.splice(n,0,new Oh.Diff(1,s)),n++),n++):0!==n&&0==e[n-1][0]?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,i=0,r=0,o="",s=""}""===e[e.length-1][1]&&e.pop();var a=!1;for(n=1;n<e.length-1;)0==e[n-1][0]&&0==e[n+1][0]&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),a=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),a=!0)),n++;a&&this.diff_cleanupMerge(e)},Oh.prototype.diff_xIndex=function(e,t){var n,r=0,i=0,o=0,s=0;for(n=0;n<e.length&&(1!==e[n][0]&&(r+=e[n][1].length),-1!==e[n][0]&&(i+=e[n][1].length),!(r>t));n++)o=r,s=i;return e.length!=n&&-1===e[n][0]?s:s+(t-o)},Oh.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,r=/</g,i=/>/g,o=/\n/g,s=0;s<e.length;s++){var a=e[s][0],l=e[s][1].replace(n,"&amp;").replace(r,"&lt;").replace(i,"&gt;").replace(o,"&para;<br>");switch(a){case 1:t[s]='<ins style="background:#e6ffe6;">'+l+"</ins>";break;case-1:t[s]='<del style="background:#ffe6e6;">'+l+"</del>";break;case 0:t[s]="<span>"+l+"</span>"}}return t.join("")},Oh.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},Oh.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)-1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},Oh.prototype.diff_levenshtein=function(e){for(var t=0,n=0,r=0,i=0;i<e.length;i++){var o=e[i][0],s=e[i][1];switch(o){case 1:n+=s.length;break;case-1:r+=s.length;break;case 0:t+=Math.max(n,r),n=0,r=0}}return t+=Math.max(n,r)},Oh.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case 1:t[n]="+"+encodeURI(e[n][1]);break;case-1:t[n]="-"+e[n][1].length;break;case 0:t[n]="="+e[n][1].length}return t.join("\t").replace(/%20/g," ")},Oh.prototype.diff_fromDelta=function(e,t){for(var n=[],r=0,i=0,o=t.split(/\t/g),s=0;s<o.length;s++){var a=o[s].substring(1);switch(o[s].charAt(0)){case"+":try{n[r++]=new Oh.Diff(1,decodeURI(a))}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+a)}break;case"-":case"=":var l=parseInt(a,10);if(isNaN(l)||l<0)throw new Error("Invalid number in diff_fromDelta: "+a);var c=e.substring(i,i+=l);"="==o[s].charAt(0)?n[r++]=new Oh.Diff(0,c):n[r++]=new Oh.Diff(-1,c);break;default:if(o[s])throw new Error("Invalid diff operation in diff_fromDelta: "+o[s])}}if(i!=e.length)throw new Error("Delta length ("+i+") does not equal source text length ("+e.length+").");return n},Oh.prototype.match_main=function(e,t,n){if(null==e||null==t||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,e.length)),e==t?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},Oh.prototype.match_bitap_=function(e,t,n){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var r=this.match_alphabet_(t),i=this;function o(e,r){var o=e/t.length,s=Math.abs(n-r);return i.Match_Distance?o+s/i.Match_Distance:s?1:o}var s=this.Match_Threshold,a=e.indexOf(t,n);-1!=a&&(s=Math.min(o(0,a),s),-1!=(a=e.lastIndexOf(t,n+t.length))&&(s=Math.min(o(0,a),s)));var l,c,u=1<<t.length-1;a=-1;for(var d,h=t.length+e.length,p=0;p<t.length;p++){for(l=0,c=h;l<c;)o(p,n+c)<=s?l=c:h=c,c=Math.floor((h-l)/2+l);h=c;var f=Math.max(1,n-c+1),m=Math.min(n+c,e.length)+t.length,g=Array(m+2);g[m+1]=(1<<p)-1;for(var _=m;_>=f;_--){var w=r[e.charAt(_-1)];if(g[_]=0===p?(g[_+1]<<1|1)&w:(g[_+1]<<1|1)&w|(d[_+1]|d[_])<<1|1|d[_+1],g[_]&u){var v=o(p,_-1);if(v<=s){if(s=v,!((a=_-1)>n))break;f=Math.max(1,2*n-a)}}}if(o(p+1,n)>s)break;d=g}return a},Oh.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},Oh.prototype.patch_addContext_=function(e,t){if(0!=t.length){if(null===e.start2)throw Error("patch not initialized");for(var n=t.substring(e.start2,e.start2+e.length1),r=0;t.indexOf(n)!=t.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)r+=this.Patch_Margin,n=t.substring(e.start2-r,e.start2+e.length1+r);r+=this.Patch_Margin;var i=t.substring(e.start2-r,e.start2);i&&e.diffs.unshift(new Oh.Diff(0,i));var o=t.substring(e.start2+e.length1,e.start2+e.length1+r);o&&e.diffs.push(new Oh.Diff(0,o)),e.start1-=i.length,e.start2-=i.length,e.length1+=i.length+o.length,e.length2+=i.length+o.length}},Oh.prototype.patch_make=function(e,t,n){var r,i;if("string"==typeof e&&"string"==typeof t&&void 0===n)r=e,(i=this.diff_main(r,t,!0)).length>2&&(this.diff_cleanupSemantic(i),this.diff_cleanupEfficiency(i));else if(e&&"object"==typeof e&&void 0===t&&void 0===n)i=e,r=this.diff_text1(i);else if("string"==typeof e&&t&&"object"==typeof t&&void 0===n)r=e,i=t;else{if("string"!=typeof e||"string"!=typeof t||!n||"object"!=typeof n)throw new Error("Unknown call format to patch_make.");r=e,i=n}if(0===i.length)return[];for(var o=[],s=new Oh.patch_obj,a=0,l=0,c=0,u=r,d=r,h=0;h<i.length;h++){var p=i[h][0],f=i[h][1];switch(a||0===p||(s.start1=l,s.start2=c),p){case 1:s.diffs[a++]=i[h],s.length2+=f.length,d=d.substring(0,c)+f+d.substring(c);break;case-1:s.length1+=f.length,s.diffs[a++]=i[h],d=d.substring(0,c)+d.substring(c+f.length);break;case 0:f.length<=2*this.Patch_Margin&&a&&i.length!=h+1?(s.diffs[a++]=i[h],s.length1+=f.length,s.length2+=f.length):f.length>=2*this.Patch_Margin&&a&&(this.patch_addContext_(s,u),o.push(s),s=new Oh.patch_obj,a=0,u=d,l=c)}1!==p&&(l+=f.length),-1!==p&&(c+=f.length)}return a&&(this.patch_addContext_(s,u),o.push(s)),o},Oh.prototype.patch_deepCopy=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=new Oh.patch_obj;i.diffs=[];for(var o=0;o<r.diffs.length;o++)i.diffs[o]=new Oh.Diff(r.diffs[o][0],r.diffs[o][1]);i.start1=r.start1,i.start2=r.start2,i.length1=r.length1,i.length2=r.length2,t[n]=i}return t},Oh.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var r=0,i=[],o=0;o<e.length;o++){var s,a,l=e[o].start2+r,c=this.diff_text1(e[o].diffs),u=-1;if(c.length>this.Match_MaxBits?-1!=(s=this.match_main(t,c.substring(0,this.Match_MaxBits),l))&&(-1==(u=this.match_main(t,c.substring(c.length-this.Match_MaxBits),l+c.length-this.Match_MaxBits))||s>=u)&&(s=-1):s=this.match_main(t,c,l),-1==s)i[o]=!1,r-=e[o].length2-e[o].length1;else if(i[o]=!0,r=s-l,c==(a=-1==u?t.substring(s,s+c.length):t.substring(s,u+this.Match_MaxBits)))t=t.substring(0,s)+this.diff_text2(e[o].diffs)+t.substring(s+c.length);else{var d=this.diff_main(c,a,!1);if(c.length>this.Match_MaxBits&&this.diff_levenshtein(d)/c.length>this.Patch_DeleteThreshold)i[o]=!1;else{this.diff_cleanupSemanticLossless(d);for(var h,p=0,f=0;f<e[o].diffs.length;f++){var m=e[o].diffs[f];0!==m[0]&&(h=this.diff_xIndex(d,p)),1===m[0]?t=t.substring(0,s+h)+m[1]+t.substring(s+h):-1===m[0]&&(t=t.substring(0,s+h)+t.substring(s+this.diff_xIndex(d,p+m[1].length))),-1!==m[0]&&(p+=m[1].length)}}}}return[t=t.substring(n.length,t.length-n.length),i]},Oh.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,n="",r=1;r<=t;r++)n+=String.fromCharCode(r);for(r=0;r<e.length;r++)e[r].start1+=t,e[r].start2+=t;var i=e[0],o=i.diffs;if(0==o.length||0!=o[0][0])o.unshift(new Oh.Diff(0,n)),i.start1-=t,i.start2-=t,i.length1+=t,i.length2+=t;else if(t>o[0][1].length){var s=t-o[0][1].length;o[0][1]=n.substring(o[0][1].length)+o[0][1],i.start1-=s,i.start2-=s,i.length1+=s,i.length2+=s}if(0==(o=(i=e[e.length-1]).diffs).length||0!=o[o.length-1][0])o.push(new Oh.Diff(0,n)),i.length1+=t,i.length2+=t;else if(t>o[o.length-1][1].length){s=t-o[o.length-1][1].length;o[o.length-1][1]+=n.substring(0,s),i.length1+=s,i.length2+=s}return n},Oh.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=t)){var r=e[n];e.splice(n--,1);for(var i=r.start1,o=r.start2,s="";0!==r.diffs.length;){var a=new Oh.patch_obj,l=!0;for(a.start1=i-s.length,a.start2=o-s.length,""!==s&&(a.length1=a.length2=s.length,a.diffs.push(new Oh.Diff(0,s)));0!==r.diffs.length&&a.length1<t-this.Patch_Margin;){var c=r.diffs[0][0],u=r.diffs[0][1];1===c?(a.length2+=u.length,o+=u.length,a.diffs.push(r.diffs.shift()),l=!1):-1===c&&1==a.diffs.length&&0==a.diffs[0][0]&&u.length>2*t?(a.length1+=u.length,i+=u.length,l=!1,a.diffs.push(new Oh.Diff(c,u)),r.diffs.shift()):(u=u.substring(0,t-a.length1-this.Patch_Margin),a.length1+=u.length,i+=u.length,0===c?(a.length2+=u.length,o+=u.length):l=!1,a.diffs.push(new Oh.Diff(c,u)),u==r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(u.length))}s=(s=this.diff_text2(a.diffs)).substring(s.length-this.Patch_Margin);var d=this.diff_text1(r.diffs).substring(0,this.Patch_Margin);""!==d&&(a.length1+=d.length,a.length2+=d.length,0!==a.diffs.length&&0===a.diffs[a.diffs.length-1][0]?a.diffs[a.diffs.length-1][1]+=d:a.diffs.push(new Oh.Diff(0,d))),l||e.splice(++n,0,a)}}},Oh.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},Oh.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var n=e.split("\n"),r=0,i=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;r<n.length;){var o=n[r].match(i);if(!o)throw new Error("Invalid patch string: "+n[r]);var s=new Oh.patch_obj;for(t.push(s),s.start1=parseInt(o[1],10),""===o[2]?(s.start1--,s.length1=1):"0"==o[2]?s.length1=0:(s.start1--,s.length1=parseInt(o[2],10)),s.start2=parseInt(o[3],10),""===o[4]?(s.start2--,s.length2=1):"0"==o[4]?s.length2=0:(s.start2--,s.length2=parseInt(o[4],10)),r++;r<n.length;){var a=n[r].charAt(0);try{var l=decodeURI(n[r].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+l)}if("-"==a)s.diffs.push(new Oh.Diff(-1,l));else if("+"==a)s.diffs.push(new Oh.Diff(1,l));else if(" "==a)s.diffs.push(new Oh.Diff(0,l));else{if("@"==a)break;if(""!==a)throw new Error('Invalid patch mode "'+a+'" in: '+l)}r++}}return t},(Oh.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],n=0;n<this.diffs.length;n++){switch(this.diffs[n][0]){case 1:e="+";break;case-1:e="-";break;case 0:e=" "}t[n+1]=e+encodeURI(this.diffs[n][1])+"\n"}return t.join("").replace(/%20/g," ")};var Ah={diff_match_patch:Oh,DIFF_INSERT:1,DIFF_DELETE:-1,DIFF_EQUAL:0};Object.defineProperty(Vd,"__esModule",{value:!0}),Vd.getComparator=function(e){return"image/png"===e?Lh.bind(null,"image/png"):"image/jpeg"===e?Lh.bind(null,"image/jpeg"):"text/plain"===e?Bh:Dh};var Ih=Rh(Gd.exports),Mh=Rh(gh),Fh=Rh(_h),Nh=Ah;function Rh(e){return e&&e.__esModule?e:{default:e}}const{PNG:jh}=kt(require.resolve("pngjs",{paths:[require.resolve("pixelmatch")]}));function Dh(e,t){return"string"==typeof e?Bh(e,t):e&&e instanceof Buffer?Buffer.compare(e,t)?{errorMessage:"Buffers differ"}:null:{errorMessage:"Actual result should be a Buffer or a string."}}function Lh(e,t,n,r={}){var i,o;if(!(t&&t instanceof Buffer))return{errorMessage:"Actual result should be a Buffer."};const s="image/png"===e?jh.sync.read(t):Mh.default.decode(t),a="image/png"===e?jh.sync.read(n):Mh.default.decode(n);if(a.width!==s.width||a.height!==s.height)return{errorMessage:`Expected an image ${a.width}px by ${a.height}px, received ${s.width}px by ${s.height}px. `};const l=new jh({width:a.width,height:a.height}),c=(0,Fh.default)(a.data,s.data,l.data,a.width,a.height,{threshold:null!==(i=r.threshold)&&void 0!==i?i:.2}),u=r.maxDiffPixels,d=void 0!==r.maxDiffPixelRatio?a.width*a.height*r.maxDiffPixelRatio:void 0;let h;h=void 0!==u&&void 0!==d?Math.min(u,d):null!==(o=null!=u?u:d)&&void 0!==o?o:0;const p=Math.ceil(c/(a.width*a.height)*100)/100;return c>h?{errorMessage:`${c} pixels (ratio ${p.toFixed(2)} of all image pixels) are different`,diff:jh.sync.write(l)}:null}function Bh(e,t){if("string"!=typeof e)return{errorMessage:"Actual result should be a string"};const n=t.toString("utf-8");if(n===e)return null;const r=new Nh.diff_match_patch,i=r.diff_main(n,e);return r.diff_cleanupSemantic(i),{errorMessage:Hh(i)}}function Hh(e){const t=[];for(let n=0;n<e.length;n++){const r=e[n][0],i=e[n][1];switch(r){case Nh.DIFF_INSERT:t[n]=Ih.default.green(i);break;case Nh.DIFF_DELETE:t[n]=Ih.default.reset(Ih.default.strikethrough(Ih.default.red(i)));break;case Nh.DIFF_EQUAL:t[n]=i}}return t.join("")}var qh;function Uh(){if(qh)return wu;qh=1,Object.defineProperty(wu,"__esModule",{value:!0}),wu.Worker=wu.PageBinding=wu.Page=void 0;var e=w(yd()),t=w(Sd),n=w(Cu),r=w(_u()),i=Id,o=ru,s=fx(),a=Bd,l=w(Ud),c=zd,u=Uu,d=Ci,h=pu,p=Ka,f=Vd,m=Hl,g=fd;function _(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_=function(e){return e?n:t})(e)}function w(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}class v extends m.SdkObject{constructor(n,r){super(r,"page"),this._closedState="open",this._closedPromise=new h.ManualPromise,this._disconnected=!1,this._initialized=!1,this._disconnectedPromise=new h.ManualPromise,this._crashedPromise=new h.ManualPromise,this._browserContext=void 0,this.keyboard=void 0,this.mouse=void 0,this.touchscreen=void 0,this._timeoutSettings=void 0,this._delegate=void 0,this._state=void 0,this._pageBindings=new Map,this.initScripts=[],this._screenshotter=void 0,this._frameManager=void 0,this.accessibility=void 0,this._workers=new Map,this.pdf=void 0,this.coverage=void 0,this._clientRequestInterceptor=void 0,this._serverRequestInterceptor=void 0,this._ownedContext=void 0,this.selectors=void 0,this._pageIsError=void 0,this._video=null,this._opener=void 0,this._frameThrottler=new x(10,200),this._isServerSideOnly=!1,this.attribution.page=this,this._delegate=n,this._browserContext=r,this._state={emulatedSize:r._options.viewport?{viewport:r._options.viewport,screen:r._options.screen||r._options.viewport}:null,mediaType:null,colorScheme:void 0!==r._options.colorScheme?r._options.colorScheme:"light",reducedMotion:void 0!==r._options.reducedMotion?r._options.reducedMotion:"no-preference",forcedColors:void 0!==r._options.forcedColors?r._options.forcedColors:"none",extraHTTPHeaders:null},this.accessibility=new l.Accessibility(n.getAccessibilityTree.bind(n)),this.keyboard=new t.Keyboard(n.rawKeyboard,this),this.mouse=new t.Mouse(n.rawMouse,this),this.touchscreen=new t.Touchscreen(n.rawTouchscreen,this),this._timeoutSettings=new o.TimeoutSettings(r._timeoutSettings),this._screenshotter=new i.Screenshotter(this),this._frameManager=new e.FrameManager(this),n.pdf&&(this.pdf=n.pdf.bind(n)),this.coverage=n.coverage?n.coverage():null,this.selectors=r.selectors(),this.instrumentation.onPageOpen(this)}async initOpener(e){if(!e)return;const t=await e.pageOrError();t instanceof v&&!t.isClosed()&&(this._opener=t)}reportAsNew(e){if(e){if(this._browserContext.isClosingOrClosed())return;this._setIsError(e)}this._initialized=!0,this.emitOnContext(s.BrowserContext.Events.Page,this),this.isClosed()&&this.emit(v.Events.Close)}initializedOrUndefined(){return this._initialized?this:void 0}emitOnContext(e,...t){this._isServerSideOnly||this._browserContext.emit(e,...t)}async _doSlowMo(){const e=this._browserContext._browser.options.slowMo;e&&await new Promise((t=>setTimeout(t,e)))}_didClose(){this.instrumentation.onPageClose(this),this._frameManager.dispose(),this._frameThrottler.setEnabled(!1),(0,d.assert)("closed"!==this._closedState,"Page closed twice"),this._closedState="closed",this.emit(v.Events.Close),this._closedPromise.resolve()}_didCrash(){this.instrumentation.onPageClose(this),this._frameManager.dispose(),this._frameThrottler.setEnabled(!1),this.emit(v.Events.Crash),this._crashedPromise.resolve(new Error("Page crashed"))}_didDisconnect(){this.instrumentation.onPageClose(this),this._frameManager.dispose(),this._frameThrottler.setEnabled(!1),(0,d.assert)(!this._disconnected,"Page disconnected twice"),this._disconnected=!0,this._disconnectedPromise.resolve(new Error("Page closed"))}async _onFileChooserOpened(e){let t;try{t=await e.evaluate((e=>!!e.multiple))}catch(e){return}if(!this.listenerCount(v.Events.FileChooser))return void e.dispose();const n=new c.FileChooser(this,e,t);this.emit(v.Events.FileChooser,n)}context(){return this._browserContext}opener(){return this._opener}mainFrame(){return this._frameManager.mainFrame()}frames(){return this._frameManager.frames()}setDefaultNavigationTimeout(e){this._timeoutSettings.setDefaultNavigationTimeout(e)}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e)}async exposeBinding(e,t,n){if(this._pageBindings.has(e))throw new Error(`Function "${e}" has been already registered`);if(this._browserContext._pageBindings.has(e))throw new Error(`Function "${e}" has been already registered in the browser context`);const r=new y(e,n,t);this._pageBindings.set(e,r),await this._delegate.exposeBinding(r)}async removeExposedBindings(){this._pageBindings.clear(),await this._delegate.removeExposedBindings()}setExtraHTTPHeaders(e){return this._state.extraHTTPHeaders=e,this._delegate.updateExtraHTTPHeaders()}async _onBindingCalled(e,t){this._disconnected||"closed"===this._closedState||await y.dispatch(this,e,t)}_addConsoleMessage(e,t,n,r){const i=new a.ConsoleMessage(this,e,r,t,n);this._frameManager.interceptConsoleMessage(i)||!this.listenerCount(v.Events.Console)?t.forEach((e=>e.dispose())):this.emit(v.Events.Console,i)}async reload(e,t){return new u.ProgressController(e,this).run((e=>this.mainFrame().raceNavigationAction((async()=>{const[n]=await Promise.all([this.mainFrame()._waitForNavigation(e,t),this._delegate.reload()]);return await this._doSlowMo(),n}))),this._timeoutSettings.navigationTimeout(t))}async goBack(e,t){return new u.ProgressController(e,this).run((e=>this.mainFrame().raceNavigationAction((async()=>{let n;const r=this.mainFrame()._waitForNavigation(e,t).catch((e=>(n=e,null)));if(!await this._delegate.goBack())return null;const i=await r;if(n)throw n;return await this._doSlowMo(),i}))),this._timeoutSettings.navigationTimeout(t))}async goForward(e,t){return new u.ProgressController(e,this).run((e=>this.mainFrame().raceNavigationAction((async()=>{let n;const r=this.mainFrame()._waitForNavigation(e,t).catch((e=>(n=e,null)));if(!await this._delegate.goForward())return null;const i=await r;if(n)throw n;return await this._doSlowMo(),i}))),this._timeoutSettings.navigationTimeout(t))}async emulateMedia(e){void 0!==e.media&&(this._state.mediaType=e.media),void 0!==e.colorScheme&&(this._state.colorScheme=e.colorScheme),void 0!==e.reducedMotion&&(this._state.reducedMotion=e.reducedMotion),void 0!==e.forcedColors&&(this._state.forcedColors=e.forcedColors),await this._delegate.updateEmulateMedia(),await this._doSlowMo()}async setViewportSize(e){this._state.emulatedSize={viewport:{...e},screen:{...e}},await this._delegate.setEmulatedSize(this._state.emulatedSize),await this._doSlowMo()}viewportSize(){var e;return(null===(e=this._state.emulatedSize)||void 0===e?void 0:e.viewport)||null}async bringToFront(){await this._delegate.bringToFront()}async addInitScript(e){this.initScripts.push(e),await this._delegate.addInitScript(e)}async removeInitScripts(){this.initScripts.splice(0,this.initScripts.length),await this._delegate.removeInitScripts()}_needsRequestInterception(){return!!this._clientRequestInterceptor||!!this._serverRequestInterceptor||!!this._browserContext._requestInterceptor}async setClientRequestInterceptor(e){this._clientRequestInterceptor=e,await this._delegate.updateRequestInterception()}async _setServerRequestInterceptor(e){this._serverRequestInterceptor=e,await this._delegate.updateRequestInterception()}_requestStarted(e,t){const n=new r.Route(e,t);this._serverRequestInterceptor?this._serverRequestInterceptor(n,e):this._clientRequestInterceptor?this._clientRequestInterceptor(n,e):this._browserContext._requestInterceptor?this._browserContext._requestInterceptor(n,e):n.continue()}async expectScreenshot(e,t={}){const r=t.locator,i=r?async(e,n)=>await r.frame.rafrafTimeoutScreenshotElementWithProgress(e,r.selector,n,t.screenshotOptions||{}):async(e,n)=>(await this.mainFrame().rafrafTimeout(n),await this._screenshotter.screenshotPage(e,t.screenshotOptions||{})),o=(0,f.getComparator)("image/png"),s=new u.ProgressController(e,this);if(!t.expected&&t.isNot)return{errorMessage:'"not" matcher requires expected result'};let a;const l=(e,n,r)=>{const i=e&&n?o(e,n,t.comparatorOptions):void 0;return void 0!==i&&!!i==!!t.isNot||(i&&(a={errorMessage:i.errorMessage,diff:i.diff,actual:e,previous:r}),!1)},c=this._timeoutSettings.timeout(t);return s.run((async n=>{let r,o;const s=[0,100,250,500];n.log(`${e.apiName}${c?` with timeout ${c}ms`:""}`),t.expected?n.log("  verifying given screenshot expectation"):n.log("  generating new stable screenshot expectation");let u=!0;for(;;){var d;if(n.throwIfAborted(),this.isClosed())throw new Error("The page has closed");const e=null!==(d=s.shift())&&void 0!==d?d:1e3;if(e&&n.log(`waiting ${e}ms before taking screenshot`),o=r,r=await i(n,e).catch((e=>{n.log("failed to take screenshot - "+e.message)})),!r)continue;const c=t.expected&&u?t.expected:o;if(l(r,c,o))break;a&&n.log(a.errorMessage),u=!1}if(u||n.log("captured a stable screenshot"),!t.expected)return{actual:r};if(u)return n.log("screenshot matched expectation"),{};if(l(r,t.expected,o))return n.log("screenshot matched expectation"),{};throw new Error(a.errorMessage)}),c).catch((t=>{var r,i;if(n.isJavaScriptErrorInEvaluate(t)||(0,g.isInvalidSelectorError)(t))throw t;return{log:t.message?[...e.log,t.message]:e.log,...a,errorMessage:null!==(r=null===(i=a)||void 0===i?void 0:i.errorMessage)&&void 0!==r?r:t.message}}))}async screenshot(e,t={}){return new u.ProgressController(e,this).run((e=>this._screenshotter.screenshotPage(e,t)),this._timeoutSettings.timeout(t))}async close(e,t){if("closed"===this._closedState)return;const n=!!t&&!!t.runBeforeUnload;"closing"!==this._closedState&&(this._closedState="closing",(0,d.assert)(!this._disconnected,"Target closed"),await this._delegate.closePage(n).catch((e=>p.debugLogger.log("error",e)))),n||await this._closedPromise,this._ownedContext&&await this._ownedContext.close(e)}_setIsError(e){this._pageIsError=e,this._frameManager.mainFrame()||this._frameManager.frameAttached("<dummy>",null)}isClosed(){return"closed"===this._closedState}_addWorker(e,t){this._workers.set(e,t),this.emit(v.Events.Worker,t)}_removeWorker(e){const t=this._workers.get(e);t&&(t.didClose(),this._workers.delete(e))}_clearWorkers(){for(const[e,t]of this._workers)t.didClose(),this._workers.delete(e)}async setFileChooserIntercepted(e){await this._delegate.setFileChooserIntercepted(e)}frameNavigatedToNewDocument(e){this.emit(v.Events.InternalFrameNavigatedToNewDocument,e);const t=e.url();if(!t.startsWith("http"))return;const n=r.parsedURL(t);n&&this._browserContext.addVisitedOrigin(n.origin)}allBindings(){return[...this._browserContext._pageBindings.values(),...this._pageBindings.values()]}getBinding(e){return this._pageBindings.get(e)||this._browserContext._pageBindings.get(e)}setScreencastOptions(e){this._delegate.setScreencastOptions(e).catch((e=>p.debugLogger.log("error",e))),this._frameThrottler.setEnabled(!!e)}throttleScreencastFrameAck(e){this._frameThrottler.ack(e)}temporarlyDisableTracingScreencastThrottling(){this._frameThrottler.recharge()}firePageError(e){this.emit(v.Events.PageError,e)}parseSelector(e,t){const n="boolean"==typeof(null==t?void 0:t.strict)?t.strict:!!this.context()._options.strictSelectors;return this.selectors.parseSelector(e,n)}async hideHighlight(){await Promise.all(this.frames().map((e=>e.hideHighlight().catch((()=>{})))))}markAsServerSideOnly(){this._isServerSideOnly=!0}}wu.Page=v,v.Events={Close:"close",Crash:"crash",Console:"console",Dialog:"dialog",Download:"download",FileChooser:"filechooser",DOMContentLoaded:"domcontentloaded",PageError:"pageerror",FrameAttached:"frameattached",FrameDetached:"framedetached",InternalFrameNavigatedToNewDocument:"internalframenavigatedtonewdocument",Load:"load",ScreencastFrame:"screencastframe",Video:"video",WebSocket:"websocket",Worker:"worker"};class b extends m.SdkObject{constructor(e,t){super(e,"worker"),this._url=void 0,this._executionContextPromise=void 0,this._executionContextCallback=void 0,this._existingExecutionContext=null,this._url=t,this._executionContextCallback=()=>{},this._executionContextPromise=new Promise((e=>this._executionContextCallback=e))}_createExecutionContext(e){this._existingExecutionContext=new n.ExecutionContext(this,e),this._executionContextCallback(this._existingExecutionContext)}url(){return this._url}didClose(){this._existingExecutionContext&&this._existingExecutionContext.contextDestroyed(new Error("Worker was closed")),this.emit(b.Events.Close,this)}async evaluateExpression(e,t,r){return n.evaluateExpression(await this._executionContextPromise,!0,e,t,r)}async evaluateExpressionHandle(e,t,r){return n.evaluateExpression(await this._executionContextPromise,!1,e,t,r)}}wu.Worker=b,b.Events={Close:"close"};class y{constructor(e,t,n){this.name=void 0,this.playwrightFunction=void 0,this.source=void 0,this.needsHandle=void 0,this.name=e,this.playwrightFunction=t,this.source=`(${S.toString()})(${JSON.stringify(e)}, ${n})`,this.needsHandle=n}static async dispatch(e,t,n){const{name:r,seq:i,args:o}=JSON.parse(t);try{(0,d.assert)(n.world);const t=e.getBinding(r);let s;if(t.needsHandle){const o=await n.evaluateHandle((function(e){const t=globalThis[e.name].handles.get(e.seq);return globalThis[e.name].handles.delete(e.seq),t}),{name:r,seq:i}).catch((e=>null));s=await t.playwrightFunction({frame:n.frame,page:e,context:e._browserContext},o)}else s=await t.playwrightFunction({frame:n.frame,page:e,context:e._browserContext},...o);n.evaluate((function(e){globalThis[e.name].callbacks.get(e.seq).resolve(e.result),globalThis[e.name].callbacks.delete(e.seq)}),{name:r,seq:i,result:s}).catch((e=>p.debugLogger.log("error",e)))}catch(e){(0,d.isError)(e)?n.evaluate((function(e){const t=new Error(e.message);t.stack=e.stack,globalThis[e.name].callbacks.get(e.seq).reject(t),globalThis[e.name].callbacks.delete(e.seq)}),{name:r,seq:i,message:e.message,stack:e.stack}).catch((e=>p.debugLogger.log("error",e))):n.evaluate((function(e){globalThis[e.name].callbacks.get(e.seq).reject(e.error),globalThis[e.name].callbacks.delete(e.seq)}),{name:r,seq:i,error:e}).catch((e=>p.debugLogger.log("error",e)))}}}function S(e,t){const n=globalThis[e];n.__installed||(globalThis[e]=(...r)=>{const i=globalThis[e];if(t&&r.slice(1).some((e=>void 0!==e)))throw new Error(`exposeBindingHandle supports a single argument, ${r.length} received`);let o=i.callbacks;o||(o=new Map,i.callbacks=o);const s=(i.lastSeq||0)+1;i.lastSeq=s;let a=i.handles;a||(a=new Map,i.handles=a);const l=new Promise(((e,t)=>o.set(s,{resolve:e,reject:t})));return t?(a.set(s,r[0]),n(JSON.stringify({name:e,seq:s}))):n(JSON.stringify({name:e,seq:s,args:r})),l},globalThis[e].__installed=!0)}wu.PageBinding=y;class x{constructor(e,t){this._acks=[],this._interval=void 0,this._nonThrottledFrames=void 0,this._budget=void 0,this._intervalId=void 0,this._nonThrottledFrames=e,this._budget=e,this._interval=t}setEnabled(e){e?(this._intervalId&&clearInterval(this._intervalId),this._intervalId=setInterval((()=>this._tick()),this._interval)):this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0)}recharge(){for(const e of this._acks)e();this._acks=[],this._budget=this._nonThrottledFrames}ack(e){this._intervalId?--this._budget>0?e():this._acks.push(e):e()}_tick(){var e;null===(e=this._acks.shift())||void 0===e||e()}}return wu}var Wh={},$h={};Object.defineProperty($h,"__esModule",{value:!0}),$h.pausesBeforeInputActions=$h.commandsWithTracingSnapshots=void 0;const zh=new Set(["EventTarget.waitForEventInfo","BrowserContext.waitForEventInfo","Page.waitForEventInfo","WebSocket.waitForEventInfo","ElectronApplication.waitForEventInfo","AndroidDevice.waitForEventInfo","Page.goBack","Page.goForward","Page.reload","Page.expectScreenshot","Page.screenshot","Page.setViewportSize","Page.keyboardDown","Page.keyboardUp","Page.keyboardInsertText","Page.keyboardType","Page.keyboardPress","Page.mouseMove","Page.mouseDown","Page.mouseUp","Page.mouseClick","Page.mouseWheel","Page.touchscreenTap","Frame.evalOnSelector","Frame.evalOnSelectorAll","Frame.addScriptTag","Frame.addStyleTag","Frame.check","Frame.click","Frame.dragAndDrop","Frame.dblclick","Frame.dispatchEvent","Frame.evaluateExpression","Frame.evaluateExpressionHandle","Frame.fill","Frame.focus","Frame.getAttribute","Frame.goto","Frame.hover","Frame.innerHTML","Frame.innerText","Frame.inputValue","Frame.isChecked","Frame.isDisabled","Frame.isEnabled","Frame.isHidden","Frame.isVisible","Frame.isEditable","Frame.press","Frame.selectOption","Frame.setContent","Frame.setInputFiles","Frame.setInputFilePaths","Frame.tap","Frame.textContent","Frame.type","Frame.uncheck","Frame.waitForTimeout","Frame.waitForFunction","Frame.waitForSelector","Frame.expect","JSHandle.evaluateExpression","ElementHandle.evaluateExpression","JSHandle.evaluateExpressionHandle","ElementHandle.evaluateExpressionHandle","ElementHandle.evalOnSelector","ElementHandle.evalOnSelectorAll","ElementHandle.check","ElementHandle.click","ElementHandle.dblclick","ElementHandle.dispatchEvent","ElementHandle.fill","ElementHandle.hover","ElementHandle.innerHTML","ElementHandle.innerText","ElementHandle.inputValue","ElementHandle.isChecked","ElementHandle.isDisabled","ElementHandle.isEditable","ElementHandle.isEnabled","ElementHandle.isHidden","ElementHandle.isVisible","ElementHandle.press","ElementHandle.screenshot","ElementHandle.scrollIntoViewIfNeeded","ElementHandle.selectOption","ElementHandle.selectText","ElementHandle.setInputFiles","ElementHandle.setInputFilePaths","ElementHandle.tap","ElementHandle.textContent","ElementHandle.type","ElementHandle.uncheck","ElementHandle.waitForElementState","ElementHandle.waitForSelector"]);$h.commandsWithTracingSnapshots=zh;const Vh=new Set(["Frame.check","Frame.click","Frame.dragAndDrop","Frame.dblclick","Frame.fill","Frame.hover","Frame.press","Frame.selectOption","Frame.setInputFiles","Frame.setInputFilePaths","Frame.tap","Frame.type","Frame.uncheck","ElementHandle.check","ElementHandle.click","ElementHandle.dblclick","ElementHandle.fill","ElementHandle.hover","ElementHandle.press","ElementHandle.selectOption","ElementHandle.setInputFiles","ElementHandle.setInputFilePaths","ElementHandle.tap","ElementHandle.type","ElementHandle.uncheck"]);$h.pausesBeforeInputActions=Vh,Object.defineProperty(Wh,"__esModule",{value:!0}),Wh.Debugger=void 0;var Gh=M.default,Kh=Ci,Jh=$h;const Yh=Symbol("Debugger");class Xh extends Gh.EventEmitter{constructor(e){super(),this._pauseOnNextStatement=!1,this._pausedCallsMetadata=new Map,this._enabled=void 0,this._context=void 0,this._muted=!1,this._context=e,this._context[Yh]=this,this._enabled="inspector"===(0,Kh.debugMode)(),this._enabled&&this.pauseOnNextStatement()}static lookup(e){if(e)return e[Yh]}async setMuted(e){this._muted=e}async onBeforeCall(e,t){this._muted||(function(e,t){var n;return!!(null!==(n=e.attribution.browser)&&void 0!==n&&n.options.headful||(0,Kh.isUnderTest)())&&"pause"===t.method}(e,t)||this._pauseOnNextStatement&&function(e){if("close"===e.method)return!0;if("waitForSelector"===e.method||"waitForEventInfo"===e.method)return!1;const t=e.type+"."+e.method;return Jh.commandsWithTracingSnapshots.has(t)&&!Jh.pausesBeforeInputActions.has(e.type+"."+e.method)}(t))&&await this.pause(e,t)}async onBeforeInputAction(e,t){this._muted||this._enabled&&this._pauseOnNextStatement&&await this.pause(e,t)}async pause(e,t){if(this._muted)return;this._enabled=!0,t.pauseStartTime=(0,Kh.monotonicTime)();const n=new Promise((n=>{this._pausedCallsMetadata.set(t,{resolve:n,sdkObject:e})}));return this.emit(Xh.Events.PausedStateChanged),n}resume(e){this._pauseOnNextStatement=e;const t=(0,Kh.monotonicTime)();for(const[e,{resolve:n}]of this._pausedCallsMetadata)e.pauseEndTime=t,n();this._pausedCallsMetadata.clear(),this.emit(Xh.Events.PausedStateChanged)}pauseOnNextStatement(){this._pauseOnNextStatement=!0}isPaused(e){return e?this._pausedCallsMetadata.has(e):!!this._pausedCallsMetadata.size}pausedDetails(){const e=[];for(const[t,{sdkObject:n}]of this._pausedCallsMetadata)e.push({metadata:t,sdkObject:n});return e}}Wh.Debugger=Xh,Xh.Events={PausedStateChanged:"pausedstatechanged"};var Qh={},Zh={},ep=C.default,tp=B.default.Transform,np=B.default.PassThrough,rp=$.default,ip=N.default,op=M.default.EventEmitter,sp=ca;function ap(){this.outputStream=new np,this.entries=[],this.outputStreamCursor=0,this.ended=!1,this.allDone=!1,this.forceZip64Eocd=!1}Zh.ZipFile=ap,Zh.dateToDosDateTime=Ep,ip.inherits(ap,op),ap.prototype.addFile=function(e,t,n){var r=this;t=mp(t,!1),null==n&&(n={});var i=new _p(t,!1,n);r.entries.push(i),ep.stat(e,(function(t,o){return t?r.emit("error",t):o.isFile()?(i.uncompressedSize=o.size,null==n.mtime&&i.setLastModDate(o.mtime),null==n.mode&&i.setFileAttributesMode(o.mode),i.setFileDataPumpFunction((function(){var t=ep.createReadStream(e);i.state=_p.FILE_DATA_IN_PROGRESS,t.on("error",(function(e){r.emit("error",e)})),up(r,i,t)})),void dp(r)):r.emit("error",new Error("not a file: "+e))}))},ap.prototype.addReadStream=function(e,t,n){var r=this;null==n&&(n={});var i=new _p(t=mp(t,!1),!1,n);r.entries.push(i),i.setFileDataPumpFunction((function(){i.state=_p.FILE_DATA_IN_PROGRESS,up(r,i,e)})),dp(r)},ap.prototype.addBuffer=function(e,t,n){var r=this;if(t=mp(t,!1),e.length>1073741823)throw new Error("buffer too large: "+e.length+" > 1073741823");if(null==n&&(n={}),null!=n.size)throw new Error("options.size not allowed");var i=new _p(t,!1,n);function o(e){i.compressedSize=e.length,i.setFileDataPumpFunction((function(){cp(r,e),cp(r,i.getDataDescriptor()),i.state=_p.FILE_DATA_DONE,setImmediate((function(){dp(r)}))})),dp(r)}i.uncompressedSize=e.length,i.crc32=sp.unsigned(e),i.crcAndFileSizeKnown=!0,r.entries.push(i),i.compress?rp.deflateRaw(e,(function(e,t){o(t)})):o(e)},ap.prototype.addEmptyDirectory=function(e,t){var n=this;if(e=mp(e,!0),null==t&&(t={}),null!=t.size)throw new Error("options.size not allowed");if(null!=t.compress)throw new Error("options.compress not allowed");var r=new _p(e,!0,t);n.entries.push(r),r.setFileDataPumpFunction((function(){cp(n,r.getDataDescriptor()),r.state=_p.FILE_DATA_DONE,dp(n)})),dp(n)};var lp=Mp([80,75,5,6]);function cp(e,t){e.outputStream.write(t),e.outputStreamCursor+=t.length}function up(e,t,n){var r=new Pp,i=new Tp,o=t.compress?new rp.DeflateRaw:new np,s=new Tp;n.pipe(r).pipe(i).pipe(o).pipe(s).pipe(e.outputStream,{end:!1}),s.on("end",(function(){if(t.crc32=r.crc32,null==t.uncompressedSize)t.uncompressedSize=i.byteCount;else if(t.uncompressedSize!==i.byteCount)return e.emit("error",new Error("file data stream has unexpected number of bytes"));t.compressedSize=s.byteCount,e.outputStreamCursor+=t.compressedSize,cp(e,t.getDataDescriptor()),t.state=_p.FILE_DATA_DONE,dp(e)}))}function dp(e){if(!e.allDone){if(e.ended&&null!=e.finalSizeCallback){var t=function(e){for(var t=0,n=0,r=0;r<e.entries.length;r++){var i=e.entries[r];if(i.compress)return-1;if(i.state>=_p.READY_TO_PUMP_FILE_DATA){if(null==i.uncompressedSize)return-1}else if(null==i.uncompressedSize)return null;i.relativeOffsetOfLocalHeader=t;var o=i.useZip64Format();t+=wp+i.utf8FileName.length,t+=i.uncompressedSize,i.crcAndFileSizeKnown||(t+=o?Sp:yp),n+=xp+i.utf8FileName.length+i.fileComment.length,o&&(n+=kp)}var s=0;(e.forceZip64Eocd||e.entries.length>=65535||n>=65535||t>=4294967295)&&(s+=hp+pp);return s+=fp+e.comment.length,t+n+s}(e);null!=t&&(e.finalSizeCallback(t),e.finalSizeCallback=null)}var n=function(){for(var t=0;t<e.entries.length;t++){var n=e.entries[t];if(n.state<_p.FILE_DATA_DONE)return n}return null}();if(null!=n){if(n.state<_p.READY_TO_PUMP_FILE_DATA)return;if(n.state===_p.FILE_DATA_IN_PROGRESS)return;n.relativeOffsetOfLocalHeader=e.outputStreamCursor;var r=n.getLocalFileHeader();cp(e,r),n.doFileDataPump()}else e.ended&&(e.offsetOfStartOfCentralDirectory=e.outputStreamCursor,e.entries.forEach((function(t){var n=t.getCentralDirectoryRecord();cp(e,n)})),cp(e,function(e,t){var n=!1,r=e.entries.length;(e.forceZip64Eocd||e.entries.length>=65535)&&(r=65535,n=!0);var i=e.outputStreamCursor-e.offsetOfStartOfCentralDirectory,o=i;(e.forceZip64Eocd||i>=4294967295)&&(o=4294967295,n=!0);var s=e.offsetOfStartOfCentralDirectory;(e.forceZip64Eocd||e.offsetOfStartOfCentralDirectory>=4294967295)&&(s=4294967295,n=!0);if(t)return n?hp+pp+fp:fp;var a=Ip(fp+e.comment.length);if(a.writeUInt32LE(101010256,0),a.writeUInt16LE(0,4),a.writeUInt16LE(0,6),a.writeUInt16LE(r,8),a.writeUInt16LE(r,10),a.writeUInt32LE(o,12),a.writeUInt32LE(s,16),a.writeUInt16LE(e.comment.length,20),e.comment.copy(a,22),!n)return a;var l=Ip(hp);l.writeUInt32LE(101075792,0),Cp(l,hp-12,4),l.writeUInt16LE(bp,12),l.writeUInt16LE(vp,14),l.writeUInt32LE(0,16),l.writeUInt32LE(0,20),Cp(l,e.entries.length,24),Cp(l,e.entries.length,32),Cp(l,i,40),Cp(l,e.offsetOfStartOfCentralDirectory,48);var c=Ip(pp);return c.writeUInt32LE(117853008,0),c.writeUInt32LE(0,4),Cp(c,e.outputStreamCursor,8),c.writeUInt32LE(1,16),Buffer.concat([l,c,a])}(e)),e.outputStream.end(),e.allDone=!0)}}ap.prototype.end=function(e,t){if("function"==typeof e&&(t=e,e=null),null==e&&(e={}),!this.ended){if(this.ended=!0,this.finalSizeCallback=t,this.forceZip64Eocd=!!e.forceZip64Format,e.comment){if("string"==typeof e.comment?this.comment=function(e){if(/^[\x20-\x7e]*$/.test(e))return Mp(e,"utf-8");if(null==Ap){Ap={};for(var t=0;t<Op.length;t++)Ap[Op[t]]=t}var n=Ip(e.length);for(t=0;t<e.length;t++){var r=Ap[e[t]];if(null==r)throw new Error("character not encodable in CP437: "+JSON.stringify(e[t]));n[t]=r}return n}(e.comment):this.comment=e.comment,this.comment.length>65535)throw new Error("comment is too large");if(Fp(this.comment,lp))throw new Error("comment contains end of central directory record signature")}else this.comment=gp;dp(this)}};var hp=56,pp=20,fp=22;function mp(e,t){if(""===e)throw new Error("empty metadataPath");if(e=e.replace(/\\/g,"/"),/^[a-zA-Z]:/.test(e)||/^\//.test(e))throw new Error("absolute path: "+e);if(-1!==e.split("/").indexOf(".."))throw new Error("invalid relative path: "+e);var n=/\/$/.test(e);if(t)n||(e+="/");else if(n)throw new Error("file path cannot end with '/': "+e);return e}var gp=Ip(0);function _p(e,t,n){if(this.utf8FileName=Mp(e),this.utf8FileName.length>65535)throw new Error("utf8 file name too long. "+utf8FileName.length+" > 65535");if(this.isDirectory=t,this.state=_p.WAITING_FOR_METADATA,this.setLastModDate(null!=n.mtime?n.mtime:new Date),null!=n.mode?this.setFileAttributesMode(n.mode):this.setFileAttributesMode(t?16893:33204),t?(this.crcAndFileSizeKnown=!0,this.crc32=0,this.uncompressedSize=0,this.compressedSize=0):(this.crcAndFileSizeKnown=!1,this.crc32=null,this.uncompressedSize=null,this.compressedSize=null,null!=n.size&&(this.uncompressedSize=n.size)),t?this.compress=!1:(this.compress=!0,null!=n.compress&&(this.compress=!!n.compress)),this.forceZip64Format=!!n.forceZip64Format,n.fileComment){if("string"==typeof n.fileComment?this.fileComment=Mp(n.fileComment,"utf-8"):this.fileComment=n.fileComment,this.fileComment.length>65535)throw new Error("fileComment is too large")}else this.fileComment=gp}_p.WAITING_FOR_METADATA=0,_p.READY_TO_PUMP_FILE_DATA=1,_p.FILE_DATA_IN_PROGRESS=2,_p.FILE_DATA_DONE=3,_p.prototype.setLastModDate=function(e){var t=Ep(e);this.lastModFileTime=t.time,this.lastModFileDate=t.date},_p.prototype.setFileAttributesMode=function(e){if((65535&e)!==e)throw new Error("invalid mode. expected: 0 <= "+e+" <= 65535");this.externalFileAttributes=e<<16>>>0},_p.prototype.setFileDataPumpFunction=function(e){this.doFileDataPump=e,this.state=_p.READY_TO_PUMP_FILE_DATA},_p.prototype.useZip64Format=function(){return this.forceZip64Format||null!=this.uncompressedSize&&this.uncompressedSize>4294967294||null!=this.compressedSize&&this.compressedSize>4294967294||null!=this.relativeOffsetOfLocalHeader&&this.relativeOffsetOfLocalHeader>4294967294};var wp=30,vp=45,bp=831;_p.prototype.getLocalFileHeader=function(){var e=0,t=0,n=0;this.crcAndFileSizeKnown&&(e=this.crc32,t=this.compressedSize,n=this.uncompressedSize);var r=Ip(wp),i=2048;return this.crcAndFileSizeKnown||(i|=8),r.writeUInt32LE(67324752,0),r.writeUInt16LE(20,4),r.writeUInt16LE(i,6),r.writeUInt16LE(this.getCompressionMethod(),8),r.writeUInt16LE(this.lastModFileTime,10),r.writeUInt16LE(this.lastModFileDate,12),r.writeUInt32LE(e,14),r.writeUInt32LE(t,18),r.writeUInt32LE(n,22),r.writeUInt16LE(this.utf8FileName.length,26),r.writeUInt16LE(0,28),Buffer.concat([r,this.utf8FileName])};var yp=16,Sp=24;_p.prototype.getDataDescriptor=function(){return this.crcAndFileSizeKnown?gp:this.useZip64Format()?((e=Ip(Sp)).writeUInt32LE(134695760,0),e.writeUInt32LE(this.crc32,4),Cp(e,this.compressedSize,8),Cp(e,this.uncompressedSize,16),e):((e=Ip(yp)).writeUInt32LE(134695760,0),e.writeUInt32LE(this.crc32,4),e.writeUInt32LE(this.compressedSize,8),e.writeUInt32LE(this.uncompressedSize,12),e);var e};var xp=46,kp=28;function Ep(e){var t=0;t|=31&e.getDate(),t|=(e.getMonth()+1&15)<<5,t|=(e.getFullYear()-1980&127)<<9;var n=0;return n|=Math.floor(e.getSeconds()/2),n|=(63&e.getMinutes())<<5,{date:t,time:n|=(31&e.getHours())<<11}}function Cp(e,t,n){var r=Math.floor(t/4294967296),i=t%4294967296;e.writeUInt32LE(i,n),e.writeUInt32LE(r,n+4)}function Tp(e){tp.call(this,e),this.byteCount=0}function Pp(e){tp.call(this,e),this.crc32=0}_p.prototype.getCentralDirectoryRecord=function(){var e=Ip(xp),t=2048;this.crcAndFileSizeKnown||(t|=8);var n,r,i=this.compressedSize,o=this.uncompressedSize,s=this.relativeOffsetOfLocalHeader;return this.useZip64Format()?(i=4294967295,o=4294967295,s=4294967295,n=vp,(r=Ip(kp)).writeUInt16LE(1,0),r.writeUInt16LE(kp-4,2),Cp(r,this.uncompressedSize,4),Cp(r,this.compressedSize,12),Cp(r,this.relativeOffsetOfLocalHeader,20)):(n=20,r=gp),e.writeUInt32LE(33639248,0),e.writeUInt16LE(bp,4),e.writeUInt16LE(n,6),e.writeUInt16LE(t,8),e.writeUInt16LE(this.getCompressionMethod(),10),e.writeUInt16LE(this.lastModFileTime,12),e.writeUInt16LE(this.lastModFileDate,14),e.writeUInt32LE(this.crc32,16),e.writeUInt32LE(i,20),e.writeUInt32LE(o,24),e.writeUInt16LE(this.utf8FileName.length,28),e.writeUInt16LE(r.length,30),e.writeUInt16LE(this.fileComment.length,32),e.writeUInt16LE(0,34),e.writeUInt16LE(0,36),e.writeUInt32LE(this.externalFileAttributes,38),e.writeUInt32LE(s,42),Buffer.concat([e,this.utf8FileName,r,this.fileComment])},_p.prototype.getCompressionMethod=function(){return this.compress?8:0},ip.inherits(Tp,tp),Tp.prototype._transform=function(e,t,n){this.byteCount+=e.length,n(null,e)},ip.inherits(Pp,tp),Pp.prototype._transform=function(e,t,n){this.crc32=sp.unsigned(e,this.crc32),n(null,e)};var Op="\0 !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~";if(256!==Op.length)throw new Error("assertion failure");var Ap=null;function Ip(e){Ip=function(e){return Buffer.allocUnsafe(e)};try{return Ip(e)}catch(t){return Ip=function(e){return new Buffer(e)},Ip(e)}}function Mp(e,t){Mp=function(e,t){return Buffer.from(e,t)};try{return Mp(e,t)}catch(n){return Mp=function(e,t){return new Buffer(e,t)},Mp(e,t)}}function Fp(e,t){Fp=function(e,t){return e.includes(t)};try{return Fp(e,t)}catch(n){return Fp=function(e,t){for(var n=0;n<=e.length-t.length;n++)for(var r=0;;r++){if(r===t.length)return!0;if(e[n+r]!==t[r])break}return!1},Fp(e,t)}}var Np={};Object.defineProperty(Np,"__esModule",{value:!0}),Np.Artifact=void 0;var Rp=function(e){return e&&e.__esModule?e:{default:e}}(C.default),jp=Ci,Dp=pu,Lp=Hl;class Bp extends Lp.SdkObject{constructor(e,t,n,r){super(e,"artifact"),this._localPath=void 0,this._unaccessibleErrorMessage=void 0,this._cancelCallback=void 0,this._finishedPromise=new Dp.ManualPromise,this._saveCallbacks=[],this._finished=!1,this._deleted=!1,this._failureError=null,this._localPath=t,this._unaccessibleErrorMessage=n,this._cancelCallback=r}finishedPromise(){return this._finishedPromise}localPath(){return this._localPath}async localPathAfterFinished(){if(this._unaccessibleErrorMessage)throw new Error(this._unaccessibleErrorMessage);return await this._finishedPromise,this._failureError?null:this._localPath}saveAs(e){if(this._unaccessibleErrorMessage)throw new Error(this._unaccessibleErrorMessage);if(this._deleted)throw new Error("File already deleted. Save before deleting.");if(this._failureError)throw new Error("File not found on disk. Check download.failure() for details.");this._finished?e(this._localPath).catch((e=>{})):this._saveCallbacks.push(e)}async failureError(){return this._unaccessibleErrorMessage?this._unaccessibleErrorMessage:(await this._finishedPromise,this._failureError)}async cancel(){return(0,jp.assert)(void 0!==this._cancelCallback),this._cancelCallback()}async delete(){if(this._unaccessibleErrorMessage)return;const e=await this.localPathAfterFinished();this._deleted||(this._deleted=!0,e&&await Rp.default.promises.unlink(e).catch((e=>{})))}async deleteOnContextClose(){this._deleted||(this._deleted=!0,this._unaccessibleErrorMessage||await Rp.default.promises.unlink(this._localPath).catch((e=>{})),await this.reportFinished("File deleted upon browser context closure."))}async reportFinished(e){if(!this._finished){if(this._finished=!0,this._failureError=e||null,e)for(const t of this._saveCallbacks)await t("",e);else for(const e of this._saveCallbacks)await e(this._localPath);this._saveCallbacks=[],this._finishedPromise.resolve()}}}Np.Artifact=Bp;var Hp,qp={};function Up(){if(Hp)return qp;Hp=1,Object.defineProperty(qp,"__esModule",{value:!0}),qp.HarTracer=void 0;var e=fx(),t=xx(),n=su,r=d(_u()),i=Uh(),o=Ci,s=au,a=d(Su),l=pu,c=gi;function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}function d(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}const h="HTTP/1.1";function p(e,t,n,r){return{_requestref:n,_frameref:r,_monotonicTime:(0,o.monotonicTime)(),startedDateTime:new Date,time:-1,request:{method:e,url:t.toString(),httpVersion:h,cookies:[],headers:[],queryString:[...t.searchParams].map((e=>({name:e[0],value:e[1]}))),headersSize:-1,bodySize:0},response:{status:-1,statusText:"",httpVersion:h,cookies:[],headers:[],content:{size:-1,mimeType:"x-unknown"},headersSize:-1,bodySize:-1,redirectURL:"",_transferSize:-1},cache:{beforeRequest:null,afterRequest:null},timings:{send:-1,wait:-1,receive:-1}}}function f(e,t){const n=e.postDataBuffer();if(!n)return;return m(n,e.headerValue("content-type"),t)}function m(e,t,n){var r;if(!e)return;null!==(r=t)&&void 0!==r||(t="application/octet-stream");const i={mimeType:t,text:"",params:[]};if("embedded"===n&&"application/octet-stream"!==t&&(i.text=e.toString()),"application/x-www-form-urlencoded"===t){const t=new URLSearchParams(e.toString());for(const[e,n]of t.entries())i.params.push({name:e,value:n})}return i}function g(e){const t={name:"",value:""};let n=!0;for(const r of e.split(/; */)){const e=r.indexOf("="),i=-1!==e?r.substr(0,e).trim():r.trim(),o=-1!==e?r.substr(e+1,r.length).trim():"";n?(n=!1,t.name=i,t.value=o):("Domain"===i&&(t.domain=o),"Expires"===i&&(t.expires=new Date(o)),"HttpOnly"===i&&(t.httpOnly=!0),"Max-Age"===i&&(t.expires=new Date(Date.now()+1e3*+o)),"Path"===i&&(t.path=o),"SameSite"===i&&(t.sameSite=o),"Secure"===i&&(t.secure=!0))}return t}return qp.HarTracer=class{constructor(e,t,n){this._context=void 0,this._barrierPromises=new Set,this._delegate=void 0,this._options=void 0,this._pageEntries=new Map,this._eventListeners=[],this._started=!1,this._entrySymbol=void 0,this._context=e,this._delegate=t,this._options=n,this._entrySymbol=Symbol("requestHarEntry")}start(){if(this._started)return;this._started=!0;const n=this._context instanceof t.APIRequestContext?this._context:this._context.fetchRequest;this._eventListeners=[s.eventsHelper.addEventListener(n,t.APIRequestContext.Events.Request,(e=>this._onAPIRequest(e))),s.eventsHelper.addEventListener(n,t.APIRequestContext.Events.RequestFinished,(e=>this._onAPIRequestFinished(e)))],this._context instanceof e.BrowserContext&&this._eventListeners.push(s.eventsHelper.addEventListener(this._context,e.BrowserContext.Events.Page,(e=>this._ensurePageEntry(e))),s.eventsHelper.addEventListener(this._context,e.BrowserContext.Events.Request,(e=>this._onRequest(e))),s.eventsHelper.addEventListener(this._context,e.BrowserContext.Events.RequestFinished,(({request:e,response:t})=>this._onRequestFinished(e,t).catch((()=>{})))),s.eventsHelper.addEventListener(this._context,e.BrowserContext.Events.RequestFailed,(e=>this._onRequestFailed(e))),s.eventsHelper.addEventListener(this._context,e.BrowserContext.Events.Response,(e=>this._onResponse(e))))}_entryForRequest(e){return e[this._entrySymbol]}_ensurePageEntry(e){let t=this._pageEntries.get(e);return t||(e.on(i.Page.Events.DOMContentLoaded,(()=>this._onDOMContentLoaded(e))),e.on(i.Page.Events.Load,(()=>this._onLoad(e))),t={startedDateTime:new Date,id:e.guid,title:"",pageTimings:{onContentLoad:-1,onLoad:-1}},this._pageEntries.set(e,t)),t}_onDOMContentLoaded(e){const t=this._ensurePageEntry(e),n=e.mainFrame().evaluateExpression(String((()=>({title:document.title,domContentLoaded:performance.timing.domContentLoadedEventStart}))),!0,void 0,"utility").then((e=>{t.title=e.title,t.pageTimings.onContentLoad=e.domContentLoaded})).catch((()=>{}));this._addBarrier(e,n)}_onLoad(e){const t=this._ensurePageEntry(e),n=e.mainFrame().evaluateExpression(String((()=>({title:document.title,loaded:performance.timing.loadEventStart}))),!0,void 0,"utility").then((e=>{t.title=e.title,t.pageTimings.onLoad=e.loaded})).catch((()=>{}));this._addBarrier(e,n)}_addBarrier(e,t){if(!this._options.waitForContentOnStop)return;const n=Promise.race([new Promise((t=>e.on("close",(()=>{this._barrierPromises.delete(n),t()})))),t]);this._barrierPromises.add(n),n.then((()=>this._barrierPromises.delete(n)))}_onAPIRequest(e){var t;const n=p(e.method,e.url,"","");n.request.cookies=e.cookies,n.request.headers=Object.entries(e.headers).map((([e,t])=>({name:e,value:t}))),n.request.postData=m(e.postData||null,e.headers["content-type"],this._options.content),n.request.bodySize=(null===(t=e.postData)||void 0===t?void 0:t.length)||0,e[this._entrySymbol]=n,this._started&&this._delegate.onEntryStarted(n)}_onAPIRequestFinished(e){const t=this._entryForRequest(e.requestEvent);if(!t)return;t.response.status=e.statusCode,t.response.statusText=e.statusMessage,t.response.httpVersion=e.httpVersion,t.response.redirectURL=e.headers.location||"";for(let n=0;n<e.rawHeaders.length;n+=2)t.response.headers.push({name:e.rawHeaders[n],value:e.rawHeaders[n+1]});t.response.cookies=e.cookies.map((e=>({...e,expires:-1===e.expires?void 0:new Date(e.expires)})));const n=t.response.content,r=e.headers["content-type"];r&&(n.mimeType=r),this._storeResponseContent(e.body,n),this._started&&this._delegate.onEntryFinished(t)}_onRequest(e){const t=e.frame()._page,n=r.parsedURL(e.url());if(!n)return;const i=this._ensurePageEntry(t),o=p(e.method(),n,e.guid,e.frame().guid);if(o.pageref=i.id,o.request.postData=f(e,this._options.content),o.request.bodySize=e.bodySize(),e.redirectedFrom()){const t=this._entryForRequest(e.redirectedFrom());t&&(t.response.redirectURL=e.url())}e[this._entrySymbol]=o,this._started&&this._delegate.onEntryStarted(o)}async _onRequestFinished(e,t){if(!t)return;const n=e.frame()._page,r=this._entryForRequest(e);if(!r)return;const i=t.httpVersion();r.request.httpVersion=i,r.response.httpVersion=i;const s={_encodedBodySize:-1,_decodedBodySize:-1,barrier:new l.ManualPromise,_check:function(){-1!==this._encodedBodySize&&-1!==this._decodedBodySize&&(r.response.content.compression=Math.max(0,this._decodedBodySize-this._encodedBodySize),this.barrier.resolve())},setEncodedBodySize:function(e){this._encodedBodySize=e,this._check()},setDecodedBodySize:function(e){this._decodedBodySize=e,this._check()}};this._addBarrier(n,s.barrier);const c=t.body().then((t=>{if(this._options.skipScripts&&"script"===e.resourceType())return void s.setDecodedBodySize(0);const n=r.response.content;s.setDecodedBodySize(t.length),this._storeResponseContent(t,n)})).catch((()=>{s.setDecodedBodySize(0)})).then((()=>{const e=t.request().postDataBuffer();e&&r.request.postData&&"sha1"===this._options.content&&(r.request.postData._sha1=(0,o.calculateSha1)(e)+"."+(a.getExtension(r.request.postData.mimeType)||"dat"),this._started&&this._delegate.onContentBlob(r.request.postData._sha1,e)),this._started&&this._delegate.onEntryFinished(r)}));this._addBarrier(n,c),this._addBarrier(n,t.sizes().then((e=>{r.response.bodySize=e.responseBodySize,r.response.headersSize=e.responseHeadersSize,r.response._transferSize=t.request().responseSize.transferSize||e.responseHeadersSize+e.responseBodySize,r.request.headersSize=e.requestHeadersSize,s.setEncodedBodySize(e.responseBodySize)})))}async _onRequestFailed(e){const t=this._entryForRequest(e);t&&(null!==e._failureText&&(t.response._failureText=e._failureText),this._started&&this._delegate.onEntryFinished(t))}_storeResponseContent(e,t){e?(t.size=e.length,"embedded"===this._options.content?(t.text=e.toString("base64"),t.encoding="base64"):"sha1"===this._options.content&&(t._sha1=(0,o.calculateSha1)(e)+"."+(a.getExtension(t.mimeType)||"dat"),this._started&&this._delegate.onContentBlob(t._sha1,e))):t.size=0}_onResponse(e){const t=e.frame()._page,r=this._ensurePageEntry(t),i=this._entryForRequest(e.request());if(!i)return;const o=e.request();i.request.postData=f(o,this._options.content),i.response={status:e.status(),statusText:e.statusText(),httpVersion:e.httpVersion(),cookies:[],headers:[],content:{size:-1,mimeType:"x-unknown"},headersSize:-1,bodySize:-1,redirectURL:"",_transferSize:-1};const s=e.timing();r.startedDateTime.valueOf()>s.startTime&&(r.startedDateTime=new Date(s.startTime));const a=-1!==s.domainLookupEnd?n.helper.millisToRoundishMillis(s.domainLookupEnd-s.domainLookupStart):-1,l=-1!==s.connectEnd?n.helper.millisToRoundishMillis(s.connectEnd-s.connectStart):-1,c=-1!==s.connectEnd?n.helper.millisToRoundishMillis(s.connectEnd-s.secureConnectionStart):-1,u=-1!==s.responseStart?n.helper.millisToRoundishMillis(s.responseStart-s.requestStart):-1,d=-1!==e.request()._responseEndTiming?n.helper.millisToRoundishMillis(e.request()._responseEndTiming-s.responseStart):-1;i.timings={dns:a,connect:l,ssl:c,send:0,wait:u,receive:d},i.time=[a,l,c,u,d].reduce(((e,t)=>t>0?t+e:e),0),this._addBarrier(t,e.serverAddr().then((e=>{null!=e&&e.ipAddress&&(i.serverIPAddress=e.ipAddress),null!=e&&e.port&&(i._serverPort=e.port)}))),this._addBarrier(t,e.securityDetails().then((e=>{e&&(i._securityDetails=e)}))),this._addBarrier(t,o.rawRequestHeaders().then((e=>{for(const t of e.filter((e=>"cookie"===e.name.toLowerCase())))i.request.cookies.push(...t.value.split(";").map(g));i.request.headers=e}))),this._addBarrier(t,e.rawResponseHeaders().then((e=>{for(const t of e.filter((e=>"set-cookie"===e.name.toLowerCase())))i.response.cookies.push(g(t.value));i.response.headers=e;const t=e.find((e=>"content-type"===e.name.toLowerCase()));t&&(i.response.content.mimeType=t.value)})))}async flush(){await Promise.all(this._barrierPromises)}stop(){this._started=!1,s.eventsHelper.removeEventListeners(this._eventListeners),this._barrierPromises.clear();const t=this._context instanceof e.BrowserContext?this._context:void 0,n={version:"1.2",creator:{name:"Playwright",version:(0,c.getPlaywrightVersion)()},browser:{name:(null==t?void 0:t._browser.options.name)||"",version:(null==t?void 0:t._browser.version())||""},pages:Array.from(this._pageEntries.values()),entries:[]};for(const e of n.pages)e.pageTimings.onContentLoad>=0?e.pageTimings.onContentLoad-=e.startedDateTime.valueOf():e.pageTimings.onContentLoad=-1,e.pageTimings.onLoad>=0?e.pageTimings.onLoad-=e.startedDateTime.valueOf():e.pageTimings.onLoad=-1;return this._pageEntries.clear(),n}},qp}var Wp={};Object.defineProperty(Wp,"__esModule",{value:!0}),Wp.VERSION=void 0;Wp.VERSION=3;var $p,zp,Vp={},Gp={};function Kp(){if(zp)return Qh;zp=1,Object.defineProperty(Qh,"__esModule",{value:!0}),Qh.Tracing=void 0,Qh.shouldCaptureSnapshot=y;var e=_(C.default),t=_(E.default),n=_(T.default),r=_(Zh),i=$h,o=pu,s=au,a=Ci,l=Ri,c=Np,u=fx(),d=bu,h=Hl,p=Uh(),f=Up(),m=Wp,g=function(){if($p)return Vp;$p=1,Object.defineProperty(Vp,"__esModule",{value:!0}),Vp.Snapshotter=void 0;var e=fx(),t=Uh(),n=au,r=Ka,i=Gp,o=Ci,s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(Su);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}return Vp.Snapshotter=class{constructor(e,t){this._context=void 0,this._delegate=void 0,this._eventListeners=[],this._snapshotStreamer=void 0,this._initialized=!1,this._started=!1,this._context=e,this._delegate=t;const n=(0,o.createGuid)();this._snapshotStreamer="__playwright_snapshot_streamer_"+n}started(){return this._started}async start(){this._started=!0,this._initialized||(this._initialized=!0,await this._initialize()),await this.reset()}async reset(){this._started&&await this._runInAllFrames(`window["${this._snapshotStreamer}"].reset()`)}async stop(){this._started=!1}async _initialize(){for(const e of this._context.pages())this._onPage(e);this._eventListeners=[n.eventsHelper.addEventListener(this._context,e.BrowserContext.Events.Page,this._onPage.bind(this))];const t=`(${i.frameSnapshotStreamer})("${this._snapshotStreamer}")`;await this._context.addInitScript(t),await this._runInAllFrames(t)}async _runInAllFrames(e){const t=[];for(const e of this._context.pages())t.push(...e.frames());await Promise.all(t.map((t=>t.nonStallingRawEvaluateInExistingMainContext(e).catch((e=>r.debugLogger.log("error",e))))))}dispose(){n.eventsHelper.removeEventListeners(this._eventListeners)}async captureSnapshot(e,t,n){const i=`window["${this._snapshotStreamer}"].captureSnapshot(${JSON.stringify(t)})`;null==n||n.callFunctionNoReply(((e,t)=>{e.setAttribute("__playwright_target__",t)}),t);const a=e.frames().map((async n=>{const a=await n.nonStallingRawEvaluateInExistingMainContext(i).catch((e=>r.debugLogger.log("error",e)));if(!a||!this._started)return;const l={snapshotName:t,pageId:e.guid,frameId:n.guid,frameUrl:a.url,doctype:a.doctype,html:a.html,viewport:a.viewport,timestamp:(0,o.monotonicTime)(),collectionTime:a.collectionTime,resourceOverrides:[],isMainFrame:e.mainFrame()===n};for(const{url:e,content:t,contentType:n}of a.resourceOverrides)if("string"==typeof t){const r=Buffer.from(t),i=(0,o.calculateSha1)(r)+"."+(s.getExtension(n)||"dat");this._delegate.onSnapshotterBlob({sha1:i,buffer:r}),l.resourceOverrides.push({url:e,sha1:i})}else l.resourceOverrides.push({url:e,ref:t});this._delegate.onFrameSnapshot(l)}));await Promise.all(a)}_onPage(e){for(const t of e.frames())this._annotateFrameHierarchy(t);this._eventListeners.push(n.eventsHelper.addEventListener(e,t.Page.Events.FrameAttached,(e=>this._annotateFrameHierarchy(e))))}async _annotateFrameHierarchy(e){try{const t=await e.frameElement(),n=e.parentFrame();if(!n)return;const r=await n._mainContext();await(null==r?void 0:r.evaluate((({snapshotStreamer:e,frameElement:t,frameId:n})=>{window[e].markIframe(t,n)}),{snapshotStreamer:this._snapshotStreamer,frameElement:t,frameId:e.guid})),t.dispose()}catch(e){}}},Vp}();function _(e){return e&&e.__esModule?e:{default:e}}const w={width:800,height:600,quality:90};class v extends h.SdkObject{constructor(e,t){super(e,"Tracing"),this._writeChain=Promise.resolve(),this._snapshotter=void 0,this._harTracer=void 0,this._screencastListeners=[],this._pendingCalls=new Map,this._context=void 0,this._state=void 0,this._isStopping=!1,this._precreatedTracesDir=void 0,this._tracesTmpDir=void 0,this._allResources=new Set,this._contextCreatedEvent=void 0,this._context=e,this._precreatedTracesDir=t,this._harTracer=new f.HarTracer(e,this,{content:"sha1",waitForContentOnStop:!1,skipScripts:!0}),this._contextCreatedEvent={version:m.VERSION,type:"context-options",browserName:"",options:{},platform:process.platform,wallTime:0},e instanceof u.BrowserContext&&(this._snapshotter=new g.Snapshotter(e,this),(0,a.assert)(t,"tracesDir must be specified for BrowserContext"),this._contextCreatedEvent.browserName=e._browser.options.name,this._contextCreatedEvent.options=e._options)}async start(t){if(this._isStopping)throw new Error("Cannot start tracing while stopping");if(this._state){const e=this._state.options;if(e.name!==t.name||!e.screenshots!=!t.screenshots||!e.snapshots!=!t.snapshots)throw new Error("Tracing has been already started with different options");return}const r=t.name||(0,a.createGuid)();this._state={options:t,traceName:r,traceFile:"",networkFile:"",tracesDir:"",resourcesDir:"",filesCount:0,traceSha1s:new Set,networkSha1s:new Set,sources:new Set,recording:!1};const i=this._state;i.tracesDir=await this._createTracesDirIfNeeded(),i.resourcesDir=n.default.join(i.tracesDir,"resources"),i.traceFile=n.default.join(i.tracesDir,r+".trace"),i.networkFile=n.default.join(i.tracesDir,r+".network"),this._writeChain=e.default.promises.mkdir(i.resourcesDir,{recursive:!0}).then((()=>e.default.promises.writeFile(i.networkFile,""))),t.snapshots&&this._harTracer.start()}async startChunk(t={}){var r;if(this._state&&this._state.recording&&await this.stopChunk({mode:"doNotSave"}),!this._state)throw new Error("Must start tracing before starting a new chunk");if(this._isStopping)throw new Error("Cannot start a trace chunk while stopping");const i=this._state,o=i.filesCount?`-${i.filesCount}`:"";i.filesCount++,i.traceFile=n.default.join(i.tracesDir,`${i.traceName}${o}.trace`),i.recording=!0,this._appendTraceOperation((async()=>{await(0,l.mkdirIfNeeded)(i.traceFile),await e.default.promises.appendFile(i.traceFile,JSON.stringify({...this._contextCreatedEvent,title:t.title,wallTime:Date.now()})+"\n")})),this._context.instrumentation.addListener(this,this._context),i.options.screenshots&&this._startScreencast(),i.options.snapshots&&await(null===(r=this._snapshotter)||void 0===r?void 0:r.start())}_startScreencast(){if(this._context instanceof u.BrowserContext){for(const e of this._context.pages())this._startScreencastInPage(e);this._screencastListeners.push(s.eventsHelper.addEventListener(this._context,u.BrowserContext.Events.Page,this._startScreencastInPage.bind(this)))}}_stopScreencast(){if(s.eventsHelper.removeEventListeners(this._screencastListeners),this._context instanceof u.BrowserContext)for(const e of this._context.pages())e.setScreencastOptions(null)}async stop(){if(this._state){if(this._isStopping)throw new Error("Tracing is already stopping");if(this._state.recording)throw new Error("Must stop trace file before stopping tracing");this._harTracer.stop(),await this._writeChain,this._state=void 0}}async deleteTmpTracesDir(){this._tracesTmpDir&&await(0,l.removeFolders)([this._tracesTmpDir])}async _createTracesDirIfNeeded(){return this._precreatedTracesDir?this._precreatedTracesDir:(this._tracesTmpDir=await e.default.promises.mkdtemp(n.default.join(t.default.tmpdir(),"playwright-tracing-")),this._tracesTmpDir)}async flush(){var e;null===(e=this._snapshotter)||void 0===e||e.dispose(),await this._writeChain}async dispose(){var e;null===(e=this._snapshotter)||void 0===e||e.dispose(),this.emit(v.Events.Dispose)}async stopChunk(t){var r,i;if(this._isStopping)throw new Error("Tracing is already stopping");if(this._isStopping=!0,!this._state||!this._state.recording){if(this._isStopping=!1,"doNotSave"!==t.mode)throw new Error("Must start tracing before stopping");return{artifact:null,sourceEntries:[]}}const o=this._state;this._context.instrumentation.removeListener(this),null!==(r=this._state)&&void 0!==r&&r.options.screenshots&&this._stopScreencast();for(const{sdkObject:e,metadata:t,beforeSnapshot:n,actionSnapshot:r,afterSnapshot:i}of this._pendingCalls.values()){await Promise.all([n,r,i]);let o=t;i||(o={...t,error:{error:{name:"Error",message:"Action was interrupted"}}}),await this.onAfterCall(e,o)}return o.options.snapshots&&await(null===(i=this._snapshotter)||void 0===i?void 0:i.stop()),await this._appendTraceOperation((async()=>{if("doNotSave"===t.mode)return{artifact:null,sourceEntries:void 0};const r=n.default.join(o.networkFile,"..",(0,a.createGuid)());await e.default.promises.copyFile(o.networkFile,r);const i=[];i.push({name:"trace.trace",value:o.traceFile}),i.push({name:"trace.network",value:r});for(const e of new Set([...o.traceSha1s,...o.networkSha1s]))i.push({name:n.default.join("resources",e),value:n.default.join(o.resourcesDir,e)});let s;if(o.sources.size){s=[];for(const n of o.sources){const r={name:"resources/src@"+(0,a.calculateSha1)(n)+".txt",value:n};"compressTraceAndSources"===t.mode?e.default.existsSync(r.value)&&i.push(r):s.push(r)}}return{artifact:await this._exportZip(i,o).catch((()=>null)),sourceEntries:s}})).finally((()=>{o.traceSha1s=new Set,o.sources=new Set,this._isStopping=!1,o.recording=!1}))||{artifact:null,sourceEntries:void 0}}async _exportZip(t,n){const i=new r.default.ZipFile,s=new o.ManualPromise;i.on("error",(e=>s.reject(e)));for(const e of t)i.addFile(e.value,e.name);i.end();const a=n.traceFile+".zip";return i.outputStream.pipe(e.default.createWriteStream(a)).on("close",(()=>{const e=new c.Artifact(this._context,a);e.reportFinished(),s.resolve(e)})),s}async _captureSnapshot(e,t,n,r){if(!this._snapshotter)return;if(!t.attribution.page)return;if(!this._snapshotter.started())return;if(!y(n))return;const i=`${e}@${n.id}`;n.snapshots.push({title:e,snapshotName:i}),!r&&t instanceof d.ElementHandle&&(r=t),await this._snapshotter.captureSnapshot(t.attribution.page,i,r).catch((()=>{}))}async onBeforeCall(e,t){var n,r;null===(n=e.attribution.page)||void 0===n||n.temporarlyDisableTracingScreencastThrottling(),t.afterSnapshot=`after@${t.id}`;const i=this._captureSnapshot("before",e,t);if(this._pendingCalls.set(t.id,{sdkObject:e,metadata:t,beforeSnapshot:i}),null!==(r=this._state)&&void 0!==r&&r.options.sources)for(const e of t.stack||[])this._state.sources.add(e.file);await i}async onBeforeInputAction(e,t,n){var r;null===(r=e.attribution.page)||void 0===r||r.temporarlyDisableTracingScreencastThrottling();const i=this._captureSnapshot("action",e,t,n);this._pendingCalls.get(t.id).actionSnapshot=i,await i}async onAfterCall(e,t){var n;null===(n=e.attribution.page)||void 0===n||n.temporarlyDisableTracingScreencastThrottling();const r=this._pendingCalls.get(t.id);if(!r||r.afterSnapshot)return;if(!e.attribution.context)return void this._pendingCalls.delete(t.id);r.afterSnapshot=this._captureSnapshot("after",e,t),await r.afterSnapshot;const i={type:"action",metadata:t};this._appendTraceEvent(i),this._pendingCalls.delete(t.id)}onEvent(e,t){if(!e.attribution.context)return;const n={type:"event",metadata:t};this._appendTraceEvent(n)}onEntryStarted(e){}onEntryFinished(t){const n={type:"resource-snapshot",snapshot:t};this._appendTraceOperation((async()=>{b(n,this._state.networkSha1s),await e.default.promises.appendFile(this._state.networkFile,JSON.stringify(n)+"\n")}))}onContentBlob(e,t){this._appendResource(e,t)}onSnapshotterBlob(e){this._appendResource(e.sha1,e.buffer)}onFrameSnapshot(e){this._appendTraceEvent({type:"frame-snapshot",snapshot:e})}_startScreencastInPage(e){e.setScreencastOptions(w);const t=e.guid;let n=0;this._screencastListeners.push(s.eventsHelper.addEventListener(e,p.Page.Events.ScreencastFrame,(r=>{const i=String(++n).padStart(10,"0"),o=`${t}-${i}.jpeg`,s={type:"screencast-frame",pageId:e.guid,sha1:o,width:r.width,height:r.height,timestamp:(0,a.monotonicTime)()};this._appendResource(o,r.buffer),this._appendTraceEvent(s)})))}_appendTraceEvent(t){this._appendTraceOperation((async()=>{b(t,this._state.traceSha1s),await e.default.promises.appendFile(this._state.traceFile,JSON.stringify(t)+"\n")}))}_appendResource(t,r){if(this._allResources.has(t))return;this._allResources.add(t);const i=n.default.join(this._state.resourcesDir,t);this._appendTraceOperation((async()=>{try{await e.default.promises.access(i)}catch(t){await e.default.promises.writeFile(i,r).catch((()=>{}))}}))}async _appendTraceOperation(e){let t,n;if(this._writeChain=this._writeChain.then((async()=>{if(!(this._context instanceof u.BrowserContext)||this._context._browser.isConnected())try{n=await e()}catch(e){t=e}})),await this._writeChain,t)throw t;return n}}function b(e,t){if(Array.isArray(e))e.forEach((e=>b(e,t)));else if("object"!=typeof e);else for(const n in e){if("sha1"===n||"_sha1"===n||n.endsWith("Sha1")){const r=e[n];r&&t.add(r)}b(e[n],t)}}function y(e){return i.commandsWithTracingSnapshots.has(e.type+"."+e.method)}return Qh.Tracing=v,v.Events={Dispose:"dispose"},Qh}Object.defineProperty(Gp,"__esModule",{value:!0}),Gp.frameSnapshotStreamer=function(e){if(window[e])return;const t="__playwright_value_",n="__playwright_checked_",r="__playwright_selected_",i="__playwright_scroll_top_",o="__playwright_scroll_left_",s=Symbol("__playwright_snapshot_frameid_"),a=Symbol("__playwright_snapshot_cache_"),l=Symbol("__playwright_end_of_list_");function c(e){return e[a]||(e[a]={}),e[a]}function u(e){try{const t=new URL(e);return t.hash="",t.toString()}catch(t){return e}}window[e]=new class{constructor(){this._removeNoScript=!0,this._lastSnapshotNumber=0,this._staleStyleSheets=new Set,this._readingStyleSheet=!1,this._fakeBase=void 0,this._observer=void 0,this._interceptNativeMethod(window.CSSStyleSheet.prototype,"insertRule",(e=>this._invalidateStyleSheet(e))),this._interceptNativeMethod(window.CSSStyleSheet.prototype,"deleteRule",(e=>this._invalidateStyleSheet(e))),this._interceptNativeMethod(window.CSSStyleSheet.prototype,"addRule",(e=>this._invalidateStyleSheet(e))),this._interceptNativeMethod(window.CSSStyleSheet.prototype,"removeRule",(e=>this._invalidateStyleSheet(e))),this._interceptNativeGetter(window.CSSStyleSheet.prototype,"rules",(e=>this._invalidateStyleSheet(e))),this._interceptNativeGetter(window.CSSStyleSheet.prototype,"cssRules",(e=>this._invalidateStyleSheet(e))),this._interceptNativeMethod(window.CSSStyleSheet.prototype,"replaceSync",(e=>this._invalidateStyleSheet(e))),this._interceptNativeAsyncMethod(window.CSSStyleSheet.prototype,"replace",(e=>this._invalidateStyleSheet(e))),this._fakeBase=document.createElement("base"),this._observer=new MutationObserver((e=>this._handleMutations(e))),this._observer.observe(document,{attributes:!0,subtree:!0})}_interceptNativeMethod(e,t,n){const r=e[t];r&&(e[t]=function(...e){const t=r.call(this,...e);return n(this,t),t})}_interceptNativeAsyncMethod(e,t,n){const r=e[t];r&&(e[t]=async function(...e){const t=await r.call(this,...e);return n(this,t),t})}_interceptNativeGetter(e,t,n){const r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(e,t,{...r,get:function(){const e=r.get.call(this);return n(this,e),e}})}_handleMutations(e){for(const t of e)c(t.target).attributesCached=void 0}_invalidateStyleSheet(e){this._readingStyleSheet||this._staleStyleSheets.add(e)}_updateStyleElementStyleSheetTextIfNeeded(e,t){const n=c(e);if(this._staleStyleSheets.has(e)||t&&void 0===n.cssText){this._staleStyleSheets.delete(e);try{n.cssText=this._getSheetText(e)}catch(e){n.cssText=""}}return n.cssText}_updateLinkStyleSheetTextIfNeeded(e,t){const n=c(e);if(this._staleStyleSheets.has(e)){this._staleStyleSheets.delete(e);try{return n.cssText=this._getSheetText(e),n.cssRef=t,n.cssText}catch(e){}}return void 0===n.cssRef?void 0:t-n.cssRef}markIframe(e,t){e[s]=t}reset(){this._staleStyleSheets.clear();const e=t=>{if(function(e){delete e[a]}(t),t.nodeType===Node.ELEMENT_NODE){const n=t;n.shadowRoot&&e(n.shadowRoot)}for(let n=t.firstChild;n;n=n.nextSibling)e(n)};e(document.documentElement),e(this._fakeBase)}__sanitizeMetaAttribute(e,t,n){if("charset"===e)return"utf-8";if("content-type"!==n.toLowerCase()||"content"!==e)return t;const[r,...i]=t.split(";");if("text/html"!==r||i.length<=0)return t;const o=i.findIndex((e=>e.trim().startsWith("charset=")));return o>-1&&(i[o]="charset=utf-8"),`${r}; ${i.join("; ")}`}_sanitizeUrl(e){return e.startsWith("javascript:")?"":e}_sanitizeSrcSet(e){return e.split(",").map((e=>{const t=(e=e.trim()).lastIndexOf(" ");return-1===t?this._sanitizeUrl(e):this._sanitizeUrl(e.substring(0,t).trim())+e.substring(t)})).join(", ")}_resolveUrl(e,t){if(""===t)return"";try{return new URL(t,e).href}catch(e){return t}}_getSheetBase(e){let t=e;for(;t.parentStyleSheet;)t=t.parentStyleSheet;return t.ownerNode?t.ownerNode.baseURI:document.baseURI}_getSheetText(e){this._readingStyleSheet=!0;try{const t=[];for(const n of e.cssRules)t.push(n.cssText);return t.join("\n")}finally{this._readingStyleSheet=!1}}captureSnapshot(){const e=performance.now(),a=++this._lastSnapshotNumber;let d=0,h=0,p=0;this._handleMutations(this._observer.takeRecords());const f=e=>{const u=e.nodeType,g=u===Node.DOCUMENT_FRAGMENT_NODE?"template":e.nodeName;if(u!==Node.ELEMENT_NODE&&u!==Node.DOCUMENT_FRAGMENT_NODE&&u!==Node.TEXT_NODE)return;if("SCRIPT"===g)return;if("LINK"===g&&u===Node.ELEMENT_NODE){var _;const t=null===(_=e.getAttribute("rel"))||void 0===_?void 0:_.toLowerCase();if("preload"===t||"prefetch"===t)return}if(this._removeNoScript&&"NOSCRIPT"===g)return;if("META"===g&&"content-security-policy"===e.httpEquiv.toLowerCase())return;if(("IFRAME"===g||"FRAME"===g)&&p)return;const w=c(e),v=[];let b=!!w.cached,y=0;const S=e=>{b=b&&w.cached[v.length]===e,v.push(e)},x=e=>(w.attributesCached=!0,b?{equals:!0,n:[[a-w.ref[0],w.ref[1]]]}:(d+=y,w.ref=[a,d++],w.cached=v,{equals:!1,n:e}));if(u===Node.TEXT_NODE){const t=e.nodeValue||"";return S(t),x(t)}if("STYLE"===g){const t=e.sheet;let n;return t&&(n=this._updateStyleElementStyleSheetTextIfNeeded(t)),n=n||e.textContent||"",S(n),y++,x([g,{},n])}const k={},E=[g,k],C=e=>{const t=f(e);t&&(E.push(t.n),S(e),b=b&&t.equals)},T=e=>{const t=m(e);t&&(E.push(t.n),S(e),b=b&&t.equals)};if(u===Node.DOCUMENT_FRAGMENT_NODE&&(k.__playwright_shadow_root_="open"),u===Node.ELEMENT_NODE){const s=e;if("INPUT"===g||"TEXTAREA"===g){const e=s.value;S(t),S(e),k[t]=e}if("INPUT"===g&&["checkbox","radio"].includes(s.type)){const e=s.checked?"true":"false";S(n),S(e),k[n]=e}if("OPTION"===g){const e=s.selected?"true":"false";S(r),S(e),k[r]=e}s.scrollTop&&(S(i),S(s.scrollTop),k[i]=""+s.scrollTop),s.scrollLeft&&(S(o),S(s.scrollLeft),k[o]=""+s.scrollLeft),s.shadowRoot&&(++h,C(s.shadowRoot),--h)}"HEAD"===g&&(++p,this._fakeBase.setAttribute("href",document.baseURI),C(this._fakeBase));for(let t=e.firstChild;t;t=t.nextSibling)C(t);"HEAD"===g&&--p,S(l);let P=null;if(e.ownerDocument.documentElement===e?P=e.ownerDocument:e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&(P=e),P){for(const e of P.adoptedStyleSheets||[])T(e);S(l)}if("IFRAME"===g||"FRAME"===g){const t=e[s],n="src",r=t?`/snapshot/${t}`:"";S(n),S(r),k[n]=r}if(b&&w.attributesCached&&!h)return x(E);if(u===Node.ELEMENT_NODE){const t=e;for(let n=0;n<t.attributes.length;n++){const r=t.attributes[n].name;if("LINK"===g&&"integrity"===r)continue;if("IFRAME"===g&&("src"===r||"sandbox"===r))continue;if("FRAME"===g&&"src"===r)continue;let i=t.attributes[n].value;"META"===g?i=this.__sanitizeMetaAttribute(r,i,e.httpEquiv):"src"===r&&"IMG"===g?i=this._sanitizeUrl(i):"srcset"===r&&"IMG"===g||"srcset"===r&&"SOURCE"===g?i=this._sanitizeSrcSet(i):"href"===r&&"LINK"===g?i=this._sanitizeUrl(i):r.startsWith("on")&&(i=""),S(r),S(i),k[r]=i}S(l)}return 2!==E.length||Object.keys(k).length||E.pop(),x(E)},m=e=>{const t=c(e),n=t.cssText,r=this._updateStyleElementStyleSheetTextIfNeeded(e,!0);return r===n?{equals:!0,n:[[a-t.ref[0],t.ref[1]]]}:(t.ref=[a,d++],{equals:!1,n:["template",{__playwright_style_sheet_:r}]})};let g;if(document.documentElement){const{n:e}=f(document.documentElement);g=e}else g=["html"];const _={html:g,doctype:document.doctype?document.doctype.name:void 0,resourceOverrides:[],viewport:{width:window.innerWidth,height:window.innerHeight},url:location.href,timestamp:e,collectionTime:0};for(const e of this._staleStyleSheets){if(null===e.href)continue;const t=this._updateLinkStyleSheetTextIfNeeded(e,a);if(void 0===t)continue;const n=this._getSheetBase(e),r=u(this._resolveUrl(n,e.href));_.resourceOverrides.push({url:r,content:t,contentType:"text/css"})}return _.collectionTime=performance.now()-_.timestamp,_}}};var Jp,Yp={};var Xp={},Qp={};Object.defineProperty(Qp,"__esModule",{value:!0}),Qp.CodeGenerator=void 0;var Zp=M.default;class ef extends Zp.EventEmitter{constructor(e,t,n,r,i,o){super(),this._currentAction=null,this._lastAction=null,this._actions=[],this._enabled=void 0,this._options=void 0,n={headless:!1,...n},r={...r},this._enabled=t,this._options={browserName:e,generateHeaders:t,launchOptions:n,contextOptions:r,deviceName:i,saveStorage:o},this.restart()}restart(){this._currentAction=null,this._lastAction=null,this._actions=[],this.emit("change")}setEnabled(e){this._enabled=e}addAction(e){this._enabled&&(this.willPerformAction(e),this.didPerformAction(e))}willPerformAction(e){this._enabled&&(this._currentAction=e)}performedActionFailed(e){this._enabled&&this._currentAction===e&&(this._currentAction=null)}didPerformAction(e){if(!this._enabled)return;const t=e.action;let n=!1;if(this._lastAction&&this._lastAction.frame.pageAlias===e.frame.pageAlias){const e=this._lastAction.action;if(this._lastAction&&"fill"===t.name&&"fill"===e.name&&t.selector===e.selector&&(n=!0),e&&"click"===t.name&&"click"===e.name&&t.selector===e.selector&&t.clickCount>e.clickCount&&(n=!0),e&&"navigate"===t.name&&"navigate"===e.name&&t.url===e.url)return void(this._currentAction=null);!e||"check"!==t.name&&"uncheck"!==t.name||"click"!==e.name||t.selector===e.selector&&(n=!0)}this._lastAction=e,this._currentAction=null,n&&this._actions.pop(),this._actions.push(e),this.emit("change")}commitLastAction(){if(!this._enabled)return;const e=this._lastAction;e&&(e.committed=!0)}signal(e,t,n){if(this._enabled)if(this._currentAction)this._currentAction.action.signals.push(n);else{if(this._lastAction&&!this._lastAction.committed){const e=this._lastAction.action.signals;if("navigation"===n.name&&e.length&&"download"===e[e.length-1].name)return;return"download"===n.name&&e.length&&"navigation"===e[e.length-1].name&&(e.length=e.length-1),n.isAsync=!0,this._lastAction.action.signals.push(n),void this.emit("change")}"navigation"===n.name&&this.addAction({frame:{pageAlias:e,isMainFrame:t._page.mainFrame()===t,url:t.url()},committed:!0,action:{name:"navigate",url:t.url(),signals:[]}})}}generateText(e){const t=[];this._options.generateHeaders&&t.push(e.generateHeader(this._options));for(const n of this._actions){const r=e.generateAction(n);r&&t.push(r)}return this._options.generateHeaders&&t.push(e.generateFooter(this._options.saveStorage)),t.join("\n")}}Qp.CodeGenerator=ef;var tf={};function nf(e){const t=[];return 1&e&&t.push("Alt"),2&e&&t.push("Control"),4&e&&t.push("Meta"),8&e&&t.push("Shift"),t}Object.defineProperty(tf,"__esModule",{value:!0}),tf.toClickOptions=function(e){let t="click";2===e.clickCount&&(t="dblclick");const n=nf(e.modifiers),r={};"left"!==e.button&&(r.button=e.button);n.length&&(r.modifiers=n);e.clickCount>2&&(r.clickCount=e.clickCount);e.position&&(r.position=e.position);return{method:t,options:r}},tf.toModifiers=nf;var rf={},of={};Object.defineProperty(of,"__esModule",{value:!0}),of.sanitizeDeviceOptions=function(e,t){const n={};for(const r in t)JSON.stringify(e[r])!==JSON.stringify(t[r])&&(n[r]=t[r]);return n},of.toSignalMap=function(e){let t,n,r,i,o;for(const s of e.signals)"navigation"===s.name&&s.isAsync?t=s:"navigation"!==s.name||s.isAsync?"popup"===s.name?r=s:"download"===s.name?i=s:"dialog"===s.name&&(o=s):n=s;return{waitForNavigation:t,assertNavigation:n,popup:r,download:i,dialog:o}};var sf={};Object.defineProperty(sf,"__esModule",{value:!0}),sf.actionTitle=function(e){switch(e.name){case"openPage":return"Open new page";case"closePage":return"Close page";case"check":return`Check ${e.selector}`;case"uncheck":return`Uncheck ${e.selector}`;case"click":return 1===e.clickCount?`Click ${e.selector}`:2===e.clickCount?`Double click ${e.selector}`:3===e.clickCount?`Triple click ${e.selector}`:`${e.clickCount} click`;case"fill":return`Fill ${e.selector}`;case"setInputFiles":return 0===e.files.length?"Clear selected files":`Upload ${e.files.join(", ")}`;case"navigate":return`Go to ${e.url}`;case"press":return`Press ${e.key}`+(e.modifiers?" with modifiers":"");case"select":return`Select ${e.options.join(", ")}`}};var af,lf={exports:{}},cf={"Blackberry PlayBook":{userAgent:"Mozilla/5.0 (PlayBook; U; RIM Tablet OS 2.1.0; en-US) AppleWebKit/536.2+ (KHTML like Gecko) Version/15.4 Safari/536.2+",viewport:{width:600,height:1024},deviceScaleFactor:1,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Blackberry PlayBook landscape":{userAgent:"Mozilla/5.0 (PlayBook; U; RIM Tablet OS 2.1.0; en-US) AppleWebKit/536.2+ (KHTML like Gecko) Version/15.4 Safari/536.2+",viewport:{width:1024,height:600},deviceScaleFactor:1,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"BlackBerry Z30":{userAgent:"Mozilla/5.0 (BB10; Touch) AppleWebKit/537.10+ (KHTML, like Gecko) Version/15.4 Mobile Safari/537.10+",viewport:{width:360,height:640},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"BlackBerry Z30 landscape":{userAgent:"Mozilla/5.0 (BB10; Touch) AppleWebKit/537.10+ (KHTML, like Gecko) Version/15.4 Mobile Safari/537.10+",viewport:{width:640,height:360},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Galaxy Note 3":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.3; en-us; SM-N900T Build/JSS15J) AppleWebKit/534.30 (KHTML, like Gecko) Version/15.4 Mobile Safari/534.30",viewport:{width:360,height:640},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Galaxy Note 3 landscape":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.3; en-us; SM-N900T Build/JSS15J) AppleWebKit/534.30 (KHTML, like Gecko) Version/15.4 Mobile Safari/534.30",viewport:{width:640,height:360},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Galaxy Note II":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.1; en-us; GT-N7100 Build/JRO03C) AppleWebKit/534.30 (KHTML, like Gecko) Version/15.4 Mobile Safari/534.30",viewport:{width:360,height:640},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Galaxy Note II landscape":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.1; en-us; GT-N7100 Build/JRO03C) AppleWebKit/534.30 (KHTML, like Gecko) Version/15.4 Mobile Safari/534.30",viewport:{width:640,height:360},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Galaxy S III":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.0; en-us; GT-I9300 Build/IMM76D) AppleWebKit/534.30 (KHTML, like Gecko) Version/15.4 Mobile Safari/534.30",viewport:{width:360,height:640},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Galaxy S III landscape":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.0; en-us; GT-I9300 Build/IMM76D) AppleWebKit/534.30 (KHTML, like Gecko) Version/15.4 Mobile Safari/534.30",viewport:{width:640,height:360},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Galaxy S5":{userAgent:"Mozilla/5.0 (Linux; Android 5.0; SM-G900P Build/LRX21T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:360,height:640},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Galaxy S5 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 5.0; SM-G900P Build/LRX21T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:640,height:360},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Galaxy S8":{userAgent:"Mozilla/5.0 (Linux; Android 7.0; SM-G950U Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:360,height:740},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Galaxy S8 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 7.0; SM-G950U Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:740,height:360},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Galaxy S9+":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; SM-G965U Build/R16NW) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:320,height:658},deviceScaleFactor:4.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Galaxy S9+ landscape":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; SM-G965U Build/R16NW) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:658,height:320},deviceScaleFactor:4.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Galaxy Tab S4":{userAgent:"Mozilla/5.0 (Linux; Android 8.1.0; SM-T837A) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Safari/537.36",viewport:{width:712,height:1138},deviceScaleFactor:2.25,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Galaxy Tab S4 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 8.1.0; SM-T837A) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Safari/537.36",viewport:{width:1138,height:712},deviceScaleFactor:2.25,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"iPad (gen 6)":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:768,height:1024},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad (gen 6) landscape":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:1024,height:768},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad (gen 7)":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:810,height:1080},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad (gen 7) landscape":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:1080,height:810},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad Mini":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:768,height:1024},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad Mini landscape":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:1024,height:768},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad Pro 11":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:834,height:1194},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad Pro 11 landscape":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:1194,height:834},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 6":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/15.4 Mobile/15A372 Safari/604.1",viewport:{width:375,height:667},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 6 landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/15.4 Mobile/15A372 Safari/604.1",viewport:{width:667,height:375},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 6 Plus":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/15.4 Mobile/15A372 Safari/604.1",viewport:{width:414,height:736},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 6 Plus landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/15.4 Mobile/15A372 Safari/604.1",viewport:{width:736,height:414},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 7":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/15.4 Mobile/15A372 Safari/604.1",viewport:{width:375,height:667},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 7 landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/15.4 Mobile/15A372 Safari/604.1",viewport:{width:667,height:375},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 7 Plus":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/15.4 Mobile/15A372 Safari/604.1",viewport:{width:414,height:736},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 7 Plus landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/15.4 Mobile/15A372 Safari/604.1",viewport:{width:736,height:414},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 8":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/15.4 Mobile/15A372 Safari/604.1",viewport:{width:375,height:667},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 8 landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/15.4 Mobile/15A372 Safari/604.1",viewport:{width:667,height:375},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 8 Plus":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/15.4 Mobile/15A372 Safari/604.1",viewport:{width:414,height:736},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 8 Plus landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/15.4 Mobile/15A372 Safari/604.1",viewport:{width:736,height:414},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone SE":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/15.4 Mobile/14E304 Safari/602.1",viewport:{width:320,height:568},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone SE landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/15.4 Mobile/14E304 Safari/602.1",viewport:{width:568,height:320},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone X":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/15.4 Mobile/15A372 Safari/604.1",viewport:{width:375,height:812},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone X landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/15.4 Mobile/15A372 Safari/604.1",viewport:{width:812,height:375},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone XR":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:414,height:896},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone XR landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",viewport:{width:896,height:414},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 11":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:414,height:896},viewport:{width:414,height:715},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 11 landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:414,height:896},viewport:{width:800,height:364},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 11 Pro":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:375,height:812},viewport:{width:375,height:635},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 11 Pro landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:375,height:812},viewport:{width:724,height:325},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 11 Pro Max":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:414,height:896},viewport:{width:414,height:715},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 11 Pro Max landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:414,height:896},viewport:{width:808,height:364},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:390,height:664},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12 landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:750,height:340},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12 Pro":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:390,height:664},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12 Pro landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:750,height:340},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12 Pro Max":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:428,height:926},viewport:{width:428,height:746},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12 Pro Max landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:428,height:926},viewport:{width:832,height:378},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12 Mini":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:375,height:812},viewport:{width:375,height:629},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12 Mini landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:375,height:812},viewport:{width:712,height:325},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:390,height:664},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13 landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:750,height:342},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13 Pro":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:390,height:664},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13 Pro landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:750,height:342},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13 Pro Max":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:428,height:926},viewport:{width:428,height:746},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13 Pro Max landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:428,height:926},viewport:{width:832,height:380},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13 Mini":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:375,height:812},viewport:{width:375,height:629},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13 Mini landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Mobile/15E148 Safari/604.1",screen:{width:375,height:812},viewport:{width:712,height:327},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"JioPhone 2":{userAgent:"Mozilla/5.0 (Mobile; LYF/F300B/LYF-F300B-001-01-15-130718-i;Android; rv:98.0.2) Gecko/48.0 Firefox/98.0.2 KAIOS/2.5",viewport:{width:240,height:320},deviceScaleFactor:1,isMobile:!0,hasTouch:!0,defaultBrowserType:"firefox"},"JioPhone 2 landscape":{userAgent:"Mozilla/5.0 (Mobile; LYF/F300B/LYF-F300B-001-01-15-130718-i;Android; rv:98.0.2) Gecko/48.0 Firefox/98.0.2 KAIOS/2.5",viewport:{width:320,height:240},deviceScaleFactor:1,isMobile:!0,hasTouch:!0,defaultBrowserType:"firefox"},"Kindle Fire HDX":{userAgent:"Mozilla/5.0 (Linux; U; en-us; KFAPWI Build/JDQ39) AppleWebKit/535.19 (KHTML, like Gecko) Silk/3.13 Safari/535.19 Silk-Accelerated=true",viewport:{width:800,height:1280},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Kindle Fire HDX landscape":{userAgent:"Mozilla/5.0 (Linux; U; en-us; KFAPWI Build/JDQ39) AppleWebKit/535.19 (KHTML, like Gecko) Silk/3.13 Safari/535.19 Silk-Accelerated=true",viewport:{width:1280,height:800},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"LG Optimus L70":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.4.2; en-us; LGMS323 Build/KOT49I.MS32310c) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:384,height:640},deviceScaleFactor:1.25,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"LG Optimus L70 landscape":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.4.2; en-us; LGMS323 Build/KOT49I.MS32310c) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:640,height:384},deviceScaleFactor:1.25,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Microsoft Lumia 550":{userAgent:"Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; Lumia 550) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36 Edge/14.14263",viewport:{width:640,height:360},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Microsoft Lumia 550 landscape":{userAgent:"Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; Lumia 550) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36 Edge/14.14263",viewport:{width:360,height:640},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Microsoft Lumia 950":{userAgent:"Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; Lumia 950) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36 Edge/14.14263",viewport:{width:360,height:640},deviceScaleFactor:4,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Microsoft Lumia 950 landscape":{userAgent:"Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; Lumia 950) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36 Edge/14.14263",viewport:{width:640,height:360},deviceScaleFactor:4,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 10":{userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 10 Build/MOB31T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Safari/537.36",viewport:{width:800,height:1280},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 10 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 10 Build/MOB31T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Safari/537.36",viewport:{width:1280,height:800},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 4":{userAgent:"Mozilla/5.0 (Linux; Android 4.4.2; Nexus 4 Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:384,height:640},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 4 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 4.4.2; Nexus 4 Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:640,height:384},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 5":{userAgent:"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:360,height:640},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 5 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:640,height:360},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 5X":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 5X Build/OPR4.170623.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:412,height:732},deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 5X landscape":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 5X Build/OPR4.170623.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:732,height:412},deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 6":{userAgent:"Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F26U) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:412,height:732},deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 6 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F26U) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:732,height:412},deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 6P":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 6P Build/OPP3.170518.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:412,height:732},deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 6P landscape":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 6P Build/OPP3.170518.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:732,height:412},deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 7":{userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 7 Build/MOB30X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Safari/537.36",viewport:{width:600,height:960},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 7 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 7 Build/MOB30X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Safari/537.36",viewport:{width:960,height:600},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nokia Lumia 520":{userAgent:"Mozilla/5.0 (compatible; MSIE 10.0; Windows Phone 8.0; Trident/6.0; IEMobile/10.0; ARM; Touch; NOKIA; Lumia 520)",viewport:{width:320,height:533},deviceScaleFactor:1.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nokia Lumia 520 landscape":{userAgent:"Mozilla/5.0 (compatible; MSIE 10.0; Windows Phone 8.0; Trident/6.0; IEMobile/10.0; ARM; Touch; NOKIA; Lumia 520)",viewport:{width:533,height:320},deviceScaleFactor:1.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nokia N9":{userAgent:"Mozilla/5.0 (MeeGo; NokiaN9) AppleWebKit/534.13 (KHTML, like Gecko) NokiaBrowser/8.5.0 Mobile Safari/534.13",viewport:{width:480,height:854},deviceScaleFactor:1,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Nokia N9 landscape":{userAgent:"Mozilla/5.0 (MeeGo; NokiaN9) AppleWebKit/534.13 (KHTML, like Gecko) NokiaBrowser/8.5.0 Mobile Safari/534.13",viewport:{width:854,height:480},deviceScaleFactor:1,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Pixel 2":{userAgent:"Mozilla/5.0 (Linux; Android 8.0; Pixel 2 Build/OPD3.170816.012) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:411,height:731},deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 2 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 8.0; Pixel 2 Build/OPD3.170816.012) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:731,height:411},deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 2 XL":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Pixel 2 XL Build/OPD1.170816.004) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:411,height:823},deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 2 XL landscape":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Pixel 2 XL Build/OPD1.170816.004) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:823,height:411},deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 3":{userAgent:"Mozilla/5.0 (Linux; Android 9; Pixel 3 Build/PQ1A.181105.017.A1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:393,height:786},deviceScaleFactor:2.75,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 3 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 9; Pixel 3 Build/PQ1A.181105.017.A1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:786,height:393},deviceScaleFactor:2.75,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 4":{userAgent:"Mozilla/5.0 (Linux; Android 10; Pixel 4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:353,height:745},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 4 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 10; Pixel 4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:745,height:353},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 4a (5G)":{userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 4a (5G)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",screen:{width:412,height:892},viewport:{width:412,height:765},deviceScaleFactor:2.63,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 4a (5G) landscape":{userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 4a (5G)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",screen:{height:892,width:412},viewport:{width:840,height:312},deviceScaleFactor:2.63,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 5":{userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",screen:{width:393,height:851},viewport:{width:393,height:727},deviceScaleFactor:2.75,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 5 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",screen:{width:851,height:393},viewport:{width:802,height:293},deviceScaleFactor:2.75,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Moto G4":{userAgent:"Mozilla/5.0 (Linux; Android 7.0; Moto G (4)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:360,height:640},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Moto G4 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 7.0; Moto G (4)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Mobile Safari/537.36",viewport:{width:640,height:360},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Desktop Chrome HiDPI":{userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Safari/537.36",screen:{width:1792,height:1120},viewport:{width:1280,height:720},deviceScaleFactor:2,isMobile:!1,hasTouch:!1,defaultBrowserType:"chromium"},"Desktop Edge HiDPI":{userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Safari/537.36 Edg/101.0.4951.15",screen:{width:1792,height:1120},viewport:{width:1280,height:720},deviceScaleFactor:2,isMobile:!1,hasTouch:!1,defaultBrowserType:"chromium"},"Desktop Firefox HiDPI":{userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:98.0.2) Gecko/20100101 Firefox/98.0.2",screen:{width:1792,height:1120},viewport:{width:1280,height:720},deviceScaleFactor:2,isMobile:!1,hasTouch:!1,defaultBrowserType:"firefox"},"Desktop Safari":{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Safari/605.1.15",screen:{width:1792,height:1120},viewport:{width:1280,height:720},deviceScaleFactor:2,isMobile:!1,hasTouch:!1,defaultBrowserType:"webkit"},"Desktop Chrome":{userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Safari/537.36",screen:{width:1920,height:1080},viewport:{width:1280,height:720},deviceScaleFactor:1,isMobile:!1,hasTouch:!1,defaultBrowserType:"chromium"},"Desktop Edge":{userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.15 Safari/537.36 Edg/101.0.4951.15",screen:{width:1920,height:1080},viewport:{width:1280,height:720},deviceScaleFactor:1,isMobile:!1,hasTouch:!1,defaultBrowserType:"chromium"},"Desktop Firefox":{userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:98.0.2) Gecko/20100101 Firefox/98.0.2",screen:{width:1920,height:1080},viewport:{width:1280,height:720},deviceScaleFactor:1,isMobile:!1,hasTouch:!1,defaultBrowserType:"firefox"}};function uf(){return af?lf.exports:(af=1,lf.exports=cf)}var df={},hf={};Object.defineProperty(hf,"__esModule",{value:!0}),hf.escapeWithQuotes=function(e,t="'"){const n=JSON.stringify(e),r=n.substring(1,n.length-1).replace(/\\"/g,'"');if("'"===t)return t+r.replace(/[']/g,"\\'")+t;if('"'===t)return t+r.replace(/["]/g,'\\"')+t;if("`"===t)return t+r.replace(/[`]/g,"`")+t;throw new Error("Invalid escape char")},Object.defineProperty(df,"__esModule",{value:!0}),df.JavaScriptLanguageGenerator=df.JavaScriptFormatter=void 0;var pf=of,ff=sf,mf=tf,gf=function(e){return e&&e.__esModule?e:{default:e}}(uf()),_f=hf;function wf(e,t="locator"){const n=e.match(/(.*)\s+>>\s+nth=(\d+)$/);return n?0==+n[2]?`${t}(${xf(n[1])}).first()`:`${t}(${xf(n[1])}).nth(${n[2]})`:`${t}(${xf(e)})`}function vf(e,t="  "){if("string"==typeof e)return xf(e);if(Array.isArray(e))return`[${e.map((e=>vf(e))).join(", ")}]`;if("object"==typeof e){const n=Object.keys(e);if(!n.length)return"{}";const r=[];for(const t of n)r.push(`${t}: ${vf(e[t])}`);return`{\n${t}${r.join(`,\n${t}`)}\n}`}return String(e)}function bf(e,t="  "){const n=vf(e,t);return"{}"===n?"":n}function yf(e,t){const n=t&&gf.default[t];if(!n)return bf(e);let r=bf((0,pf.sanitizeDeviceOptions)(n,e));r||(r="{\n}");const i=r.split("\n");return i.splice(1,0,`...devices[${xf(t)}],`),i.join("\n")}df.JavaScriptLanguageGenerator=class{constructor(e){this.id=void 0,this.fileName=void 0,this.highlighter="javascript",this._isTest=void 0,this.id=e?"test":"javascript",this.fileName=e?"Playwright Test":"JavaScript",this._isTest=e}generateAction(e){const t=e.action;if(this._isTest&&("openPage"===t.name||"closePage"===t.name))return"";const n=e.frame.pageAlias,r=new Sf(2);if(r.newLine(),r.add("// "+(0,ff.actionTitle)(t)),"openPage"===t.name)return r.add(`const ${n} = await context.newPage();`),t.url&&"about:blank"!==t.url&&"chrome://newtab/"!==t.url&&r.add(`await ${n}.goto(${xf(t.url)});`),r.format();let i;if(e.frame.isMainFrame)i=n;else if(e.frame.selectorsChain&&"navigate"!==t.name){i=`${n}${e.frame.selectorsChain.map((e=>"."+wf(e,"frameLocator"))).join("")}`}else i=e.frame.name?`${n}.frame(${vf({name:e.frame.name})})`:`${n}.frame(${vf({url:e.frame.url})})`;const o=(0,pf.toSignalMap)(t);o.dialog&&r.add(`  ${n}.once('dialog', dialog => {\n    console.log(\`Dialog message: \${dialog.message()}\`);\n    dialog.dismiss().catch(() => {});\n  });`);const s=o.waitForNavigation||o.popup||o.download;if(s){let e="";o.popup?e=`const [${o.popup.popupAlias}] = `:o.download&&(e="const [download] = "),r.add(`${e}await Promise.all([`)}o.popup&&r.add(`${n}.waitForEvent('popup'),`),o.waitForNavigation&&r.add(`${n}.waitForNavigation(/*{ url: ${xf(o.waitForNavigation.url)} }*/),`),o.download&&r.add(`${n}.waitForEvent('download'),`);const a=o.popup||o.waitForNavigation||o.download?"":"await ",l=this._generateActionCall(t),c=o.waitForNavigation||s?"":";";return r.add(`${a}${i}.${l}${c}`),s?r.add("]);"):o.assertNavigation&&(this._isTest?r.add(`  await expect(${n}).toHaveURL(${xf(o.assertNavigation.url)});`):r.add(`  // assert.equal(${n}.url(), ${xf(o.assertNavigation.url)});`)),r.format()}_generateActionCall(e){switch(e.name){case"openPage":throw Error("Not reached");case"closePage":return"close()";case"click":{let r="click";2===e.clickCount&&(r="dblclick");const i=(0,mf.toModifiers)(e.modifiers),o={};"left"!==e.button&&(o.button=e.button),i.length&&(o.modifiers=i),e.clickCount>2&&(o.clickCount=e.clickCount),e.position&&(o.position=e.position);const s=(t=o,n=!1,Object.keys(t).length?(n?", ":"")+vf(t):"");return wf(e.selector)+`.${r}(${s})`}case"check":return wf(e.selector)+".check()";case"uncheck":return wf(e.selector)+".uncheck()";case"fill":return wf(e.selector)+`.fill(${xf(e.text)})`;case"setInputFiles":return wf(e.selector)+`.setInputFiles(${vf(1===e.files.length?e.files[0]:e.files)})`;case"press":{const t=[...(0,mf.toModifiers)(e.modifiers),e.key].join("+");return wf(e.selector)+`.press(${xf(t)})`}case"navigate":return`goto(${xf(e.url)})`;case"select":return wf(e.selector)+`.selectOption(${vf(e.options.length>1?e.options:e.options[0])})`}var t,n}generateHeader(e){return this._isTest?this.generateTestHeader(e):this.generateStandaloneHeader(e)}generateFooter(e){return this._isTest?this.generateTestFooter(e):this.generateStandaloneFooter(e)}generateTestHeader(e){const t=new Sf,n=yf(e.contextOptions,e.deviceName);return t.add(`\n      import { test, expect${e.deviceName?", devices":""} } from '@playwright/test';\n${n?"\ntest.use("+n+");\n":""}\n      test('test', async ({ page }) => {`),t.format()}generateTestFooter(e){return"\n});"}generateStandaloneHeader(e){const t=new Sf;return t.add(`\n      const { ${e.browserName}${e.deviceName?", devices":""} } = require('playwright');\n\n      (async () => {\n        const browser = await ${e.browserName}.launch(${bf(e.launchOptions)});\n        const context = await browser.newContext(${yf(e.contextOptions,e.deviceName)});`),t.format()}generateStandaloneFooter(e){return`\n  // ---------------------${e?`\n  await context.storageState({ path: ${xf(e)} });`:""}\n  await context.close();\n  await browser.close();\n})();`}};class Sf{constructor(e=0){this._baseIndent=void 0,this._baseOffset=void 0,this._lines=[],this._baseIndent=" ".repeat(2),this._baseOffset=" ".repeat(e)}prepend(e){this._lines=e.trim().split("\n").map((e=>e.trim())).concat(this._lines)}add(e){this._lines.push(...e.trim().split("\n").map((e=>e.trim())))}newLine(){this._lines.push("")}format(){let e="",t="";return this._lines.map((n=>{if(""===n)return n;(n.startsWith("}")||n.startsWith("]"))&&(e=e.substring(this._baseIndent.length));const r=/^(for|while|if|try).*\(.*\)$/.test(t)?this._baseIndent:"";t=n;const i=n.startsWith(".set");return((n=e+r+(i?this._baseIndent:"")+n).endsWith("{")||n.endsWith("["))&&(e+=this._baseIndent),this._baseOffset+n})).join("\n")}}function xf(e){return(0,_f.escapeWithQuotes)(e,"'")}df.JavaScriptFormatter=Sf,Object.defineProperty(rf,"__esModule",{value:!0}),rf.JavaLanguageGenerator=void 0;var kf=of,Ef=sf,Cf=tf,Tf=function(e){return e&&e.__esModule?e:{default:e}}(uf()),Pf=df,Of=hf;function Af(e){return(0,Of.escapeWithQuotes)(e,'"')}function If(e,t="locator"){const n=e.match(/(.*)\s+>>\s+nth=(\d+)$/);return n?0==+n[2]?`${t}(${Af(n[1])}).first()`:`${t}(${Af(n[1])}).nth(${n[2]})`:`${t}(${Af(e)})`}rf.JavaLanguageGenerator=class{constructor(){this.id="java",this.fileName="Java",this.highlighter="java"}generateAction(e){const t=e.action,n=e.frame.pageAlias,r=new Pf.JavaScriptFormatter(6);if(r.newLine(),r.add("// "+(0,Ef.actionTitle)(t)),"openPage"===t.name)return r.add(`Page ${n} = context.newPage();`),t.url&&"about:blank"!==t.url&&"chrome://newtab/"!==t.url&&r.add(`${n}.navigate(${Af(t.url)});`),r.format();let i;if(e.frame.isMainFrame)i=n;else if(e.frame.selectorsChain&&"navigate"!==t.name){i=`${n}${e.frame.selectorsChain.map((e=>"."+If(e,"frameLocator"))).join("")}`}else i=e.frame.name?`${n}.frame(${Af(e.frame.name)})`:`${n}.frameByUrl(${Af(e.frame.url)})`;const o=(0,kf.toSignalMap)(t);o.dialog&&r.add(`  ${n}.onceDialog(dialog -> {\n        System.out.println(String.format("Dialog message: %s", dialog.message()));\n        dialog.dismiss();\n      });`);let s=`${i}.${this._generateActionCall(t)};`;return o.popup&&(s=`Page ${o.popup.popupAlias} = ${n}.waitForPopup(() -> {\n        ${s}\n      });`),o.download&&(s=`Download download = ${n}.waitForDownload(() -> {\n        ${s}\n      });`),o.waitForNavigation&&(s=`\n      // ${n}.waitForNavigation(new Page.WaitForNavigationOptions().setUrl(${Af(o.waitForNavigation.url)}), () ->\n      ${n}.waitForNavigation(() -> {\n        ${s}\n      });`),r.add(s),o.assertNavigation&&r.add(`// assertThat(${n}).hasURL(${Af(o.assertNavigation.url)});`),r.format()}_generateActionCall(e){switch(e.name){case"openPage":throw Error("Not reached");case"closePage":return"close()";case"click":{let t="click";2===e.clickCount&&(t="dblclick");const n=(0,Cf.toModifiers)(e.modifiers),r={};"left"!==e.button&&(r.button=e.button),n.length&&(r.modifiers=n),e.clickCount>2&&(r.clickCount=e.clickCount),e.position&&(r.position=e.position);const i=function(e){const t=[];e.button&&t.push(`  .setButton(MouseButton.${e.button.toUpperCase()})`);e.modifiers&&t.push(`  .setModifiers(Arrays.asList(${e.modifiers.map((e=>`KeyboardModifier.${e.toUpperCase()}`)).join(", ")}))`);e.clickCount&&t.push(`  .setClickCount(${e.clickCount})`);e.position&&t.push(`  .setPosition(${e.position.x}, ${e.position.y})`);return t.length?(t.unshift("new Locator.ClickOptions()"),t.join("\n")):""}(r);return If(e.selector)+`.${t}(${i})`}case"check":return If(e.selector)+".check()";case"uncheck":return If(e.selector)+".uncheck()";case"fill":return If(e.selector)+`.fill(${Af(e.text)})`;case"setInputFiles":return If(e.selector)+`.setInputFiles(${function(e){if(Array.isArray(e))return 0===e.length?"new Path[0]":`new Path[] {${e.map((e=>"Paths.get("+Af(e)+")")).join(", ")}}`;return`Paths.get(${Af(e)})`}(1===e.files.length?e.files[0]:e.files)})`;case"press":{const t=[...(0,Cf.toModifiers)(e.modifiers),e.key].join("+");return If(e.selector)+`.press(${Af(t)})`}case"navigate":return`navigate(${Af(e.url)})`;case"select":return If(e.selector)+`.selectOption(${function(e){if(Array.isArray(e))return 0===e.length?"new String[0]":`new String[] {${e.map((e=>Af(e))).join(", ")}}`;return Af(e)}(e.options.length>1?e.options:e.options[0])})`}}generateHeader(e){const t=new Pf.JavaScriptFormatter;return t.add(`\n    import com.microsoft.playwright.*;\n    import com.microsoft.playwright.options.*;\n    import static com.microsoft.playwright.assertions.PlaywrightAssertions.assertThat;\n    import java.util.*;\n\n    public class Example {\n      public static void main(String[] args) {\n        try (Playwright playwright = Playwright.create()) {\n          Browser browser = playwright.${e.browserName}().launch(${function(e){const t=[];if(!Object.keys(e).length)return"";t.push("new BrowserType.LaunchOptions()"),"boolean"==typeof e.headless&&t.push("  .setHeadless(false)");e.channel&&t.push(`  .setChannel(${Af(e.channel)})`);return t.join("\n")}(e.launchOptions)});\n          BrowserContext context = browser.newContext(${function(e,t){const n=[];if(!Object.keys(e).length&&!t)return"";const r={...t?Tf.default[t]:{},...e};n.push("new Browser.NewContextOptions()"),r.acceptDownloads&&n.push("  .setAcceptDownloads(true)");r.bypassCSP&&n.push("  .setBypassCSP(true)");r.colorScheme&&n.push(`  .setColorScheme(ColorScheme.${r.colorScheme.toUpperCase()})`);r.deviceScaleFactor&&n.push(`  .setDeviceScaleFactor(${r.deviceScaleFactor})`);r.geolocation&&n.push(`  .setGeolocation(${r.geolocation.latitude}, ${r.geolocation.longitude})`);r.hasTouch&&n.push(`  .setHasTouch(${r.hasTouch})`);r.isMobile&&n.push(`  .setIsMobile(${r.isMobile})`);r.locale&&n.push(`  .setLocale(${Af(r.locale)})`);r.proxy&&n.push(`  .setProxy(new Proxy(${Af(r.proxy.server)}))`);r.storageState&&n.push(`  .setStorageStatePath(Paths.get(${Af(r.storageState)}))`);r.timezoneId&&n.push(`  .setTimezoneId(${Af(r.timezoneId)})`);r.userAgent&&n.push(`  .setUserAgent(${Af(r.userAgent)})`);r.viewport&&n.push(`  .setViewportSize(${r.viewport.width}, ${r.viewport.height})`);return n.join("\n")}(e.contextOptions,e.deviceName)});`),t.format()}generateFooter(e){return`${e?`\n      context.storageState(new BrowserContext.StorageStateOptions().setPath(${Af(e)}));\n`:""}    }\n  }\n}`}};var Mf={};Object.defineProperty(Mf,"__esModule",{value:!0}),Mf.CSharpLanguageGenerator=void 0;var Ff=of,Nf=sf,Rf=tf,jf=hf,Df=function(e){return e&&e.__esModule?e:{default:e}}(uf());function Lf(e,t="    ",n=""){if("string"==typeof e)return["permissions","colorScheme","modifiers","button"].includes(n)?`${Bf(n)}.${qf(e)}`:Wf(e);if(Array.isArray(e))return`new[] { ${e.map((e=>Lf(e,t,n))).join(", ")} }`;if("object"==typeof e){const r=Object.keys(e);if(!r.length)return n?`new ${Bf(n)}`:"";const i=[];for(const n of r){const r=Hf(n);i.push(`${r} = ${Lf(e[n],t,n)},`)}return n?`new ${Bf(n)}\n{\n${t}${i.join(`\n${t}`)}\n${t}}`:`{\n${t}${i.join(`\n${t}`)}\n${t}}`}return"latitude"===n||"longitude"===n?String(e)+"m":String(e)}function Bf(e){switch(e){case"viewport":return"ViewportSize";case"proxy":return"ProxySettings";case"permissions":return"ContextPermission";case"modifiers":return"KeyboardModifier";case"button":return"MouseButton";default:return qf(e)}}function Hf(e){switch(e){case"storageState":return"StorageStatePath";case"viewport":return"ViewportSize";default:return qf(e)}}function qf(e){return e[0].toUpperCase()+e.slice(1)}Mf.CSharpLanguageGenerator=class{constructor(){this.id="csharp",this.fileName="C#",this.highlighter="csharp"}generateAction(e){const t=e.action,n=e.frame.pageAlias,r=new Uf(8);if(r.newLine(),r.add("// "+(0,Nf.actionTitle)(t)),"openPage"===t.name)return r.add(`var ${n} = await context.NewPageAsync();`),t.url&&"about:blank"!==t.url&&"chrome://newtab/"!==t.url&&r.add(`await ${n}.GotoAsync(${Wf(t.url)});`),r.format();let i;if(e.frame.isMainFrame)i=n;else if(e.frame.selectorsChain&&"navigate"!==t.name){i=`${n}${e.frame.selectorsChain.map((e=>"."+$f(e,"FrameLocator"))).join("")}`}else i=e.frame.name?`${n}.Frame(${Wf(e.frame.name)})`:`${n}.FrameByUrl(${Wf(e.frame.url)})`;const o=(0,Ff.toSignalMap)(t);o.dialog&&r.add(`    void ${n}_Dialog${o.dialog.dialogAlias}_EventHandler(object sender, IDialog dialog)\n      {\n          Console.WriteLine($"Dialog message: {dialog.Message}");\n          dialog.DismissAsync();\n          ${n}.Dialog -= ${n}_Dialog${o.dialog.dialogAlias}_EventHandler;\n      }\n      ${n}.Dialog += ${n}_Dialog${o.dialog.dialogAlias}_EventHandler;`);const s=[],a=this._generateActionCall(t,e.frame.isMainFrame);o.waitForNavigation?(s.push(`await ${n}.RunAndWaitForNavigationAsync(async () =>`),s.push("{"),s.push(`    await ${i}.${a};`),s.push(`}/*, new ${e.frame.isMainFrame?"Page":"Frame"}WaitForNavigationOptions`),s.push("{"),s.push(`    UrlString = ${Wf(o.waitForNavigation.url)}`),s.push("}*/);")):s.push(`await ${i}.${a};`),o.download&&(s.unshift(`var download${o.download.downloadAlias} = await ${n}.RunAndWaitForDownloadAsync(async () =>\n{`),s.push("});")),o.popup&&(s.unshift(`var ${o.popup.popupAlias} = await ${n}.RunAndWaitForPopupAsync(async () =>\n{`),s.push("});"));for(const e of s)r.add(e);return o.assertNavigation&&r.add(`  // Assert.AreEqual(${Wf(o.assertNavigation.url)}, ${n}.Url);`),r.format()}_generateActionCall(e,t){switch(e.name){case"openPage":throw Error("Not reached");case"closePage":return"CloseAsync()";case"click":{let t="Click";2===e.clickCount&&(t="DblClick");const n=(0,Rf.toModifiers)(e.modifiers),r={};if("left"!==e.button&&(r.button=e.button),n.length&&(r.modifiers=n),e.clickCount>2&&(r.clickCount=e.clickCount),e.position&&(r.position=e.position),!Object.entries(r).length)return $f(e.selector)+`.${t}Async()`;const i=Lf(r,"    ","Locator"+t+"Options");return $f(e.selector)+`.${t}Async(${i})`}case"check":return $f(e.selector)+".CheckAsync()";case"uncheck":return $f(e.selector)+".UncheckAsync()";case"fill":return $f(e.selector)+`.FillAsync(${Wf(e.text)})`;case"setInputFiles":return $f(e.selector)+`.SetInputFilesAsync(${Lf(e.files)})`;case"press":{const t=[...(0,Rf.toModifiers)(e.modifiers),e.key].join("+");return $f(e.selector)+`.PressAsync(${Wf(t)})`}case"navigate":return`GotoAsync(${Wf(e.url)})`;case"select":return $f(e.selector)+`.SelectOptionAsync(${Lf(e.options)})`}}generateHeader(e){const t=new Uf(0);return t.add(`\n      using Microsoft.Playwright;\n      using System;\n      using System.Threading.Tasks;\n\n      class Program\n      {\n          public static async Task Main()\n          {\n              using var playwright = await Playwright.CreateAsync();\n              await using var browser = await playwright.${qf(e.browserName)}.LaunchAsync(${Lf(e.launchOptions,"    ","BrowserTypeLaunchOptions")});\n              var context = await browser.NewContextAsync(${function(e,t){const n=t&&Df.default[t];if(!n)return Object.entries(e).length?Lf(e,"    ","BrowserNewContextOptions"):"";return e=(0,Ff.sanitizeDeviceOptions)(n,e),Object.entries(e).length?Lf(e,"    ",`BrowserNewContextOptions(playwright.Devices[${Wf(t)}])`):`playwright.Devices[${Wf(t)}]`}(e.contextOptions,e.deviceName)});`),t.format()}generateFooter(e){return`${e?`\n        await context.StorageStateAsync(new BrowserContextStorageStateOptions\n        {\n            Path = ${Wf(e)}\n        });\n`:""}    }\n}\n`}};class Uf{constructor(e=0){this._baseIndent=void 0,this._baseOffset=void 0,this._lines=[],this._baseIndent=" ".repeat(4),this._baseOffset=" ".repeat(e)}prepend(e){this._lines=e.trim().split("\n").map((e=>e.trim())).concat(this._lines)}add(e){this._lines.push(...e.trim().split("\n").map((e=>e.trim())))}newLine(){this._lines.push("")}format(){let e="",t="";return this._lines.map((n=>{if(""===n)return n;(n.startsWith("}")||n.startsWith("]")||n.includes("});")||");"===n)&&(e=e.substring(this._baseIndent.length));const r=/^(for|while|if).*\(.*\)$/.test(t)?this._baseIndent:"";return t=n,((n=e+r+n).endsWith("{")||n.endsWith("[")||n.endsWith("("))&&(e+=this._baseIndent),n.endsWith("));")&&(e=e.substring(this._baseIndent.length)),this._baseOffset+n})).join("\n")}}function Wf(e){return(0,jf.escapeWithQuotes)(e,'"')}function $f(e,t="Locator"){const n=e.match(/(.*)\s+>>\s+nth=(\d+)$/);return n?0==+n[2]?`${t}(${Wf(n[1])}).First`:`${t}(${Wf(n[1])}).Nth(${n[2]})`:`${t}(${Wf(e)})`}var zf={};Object.defineProperty(zf,"__esModule",{value:!0}),zf.PythonLanguageGenerator=void 0;var Vf=of,Gf=sf,Kf=tf,Jf=hf,Yf=function(e){return e&&e.__esModule?e:{default:e}}(uf());function Xf(e){return!1===e?"False":!0===e?"True":void 0===e?"None":Array.isArray(e)?`[${e.map(Xf).join(", ")}]`:"string"==typeof e?tm(e):"object"==typeof e?JSON.stringify(e):String(e)}function Qf(e,t){const n=Object.keys(e);return n.length?(t?", ":"")+n.map((t=>`${function(e){return e.replace(/((?<=[a-z0-9])[A-Z]|(?!^)[A-Z](?=[a-z]))/g,"_$1").toLowerCase()}(t)}=${Xf(e[t])}`)).join(", "):""}function Zf(e,t){const n=t&&Yf.default[t];return n?`**playwright.devices[${tm(t)}]`+Qf((0,Vf.sanitizeDeviceOptions)(n,e),!0):Qf(e,!1)}zf.PythonLanguageGenerator=class{constructor(e){this.id="python",this.fileName="Python",this.highlighter="python",this._awaitPrefix=void 0,this._asyncPrefix=void 0,this._isAsync=void 0,this.id=e?"python-async":"python",this.fileName=e?"Python Async":"Python",this._isAsync=e,this._awaitPrefix=e?"await ":"",this._asyncPrefix=e?"async ":""}generateAction(e){const t=e.action,n=e.frame.pageAlias,r=new em(4);if(r.newLine(),r.add("# "+(0,Gf.actionTitle)(t)),"openPage"===t.name)return r.add(`${n} = ${this._awaitPrefix}context.new_page()`),t.url&&"about:blank"!==t.url&&"chrome://newtab/"!==t.url&&r.add(`${this._awaitPrefix}${n}.goto(${tm(t.url)})`),r.format();let i;if(e.frame.isMainFrame)i=n;else if(e.frame.selectorsChain&&"navigate"!==t.name){i=`${n}${e.frame.selectorsChain.map((e=>"."+nm(e,"frame_locator"))).join("")}`}else i=e.frame.name?`${n}.frame(${Qf({name:e.frame.name},!1)})`:`${n}.frame(${Qf({url:e.frame.url},!1)})`;const o=(0,Vf.toSignalMap)(t);o.dialog&&r.add(`  ${n}.once("dialog", lambda dialog: dialog.dismiss())`);const s=this._generateActionCall(t);let a=`${this._awaitPrefix}${i}.${s}`;return o.popup&&(a=`${this._asyncPrefix}with ${n}.expect_popup() as popup_info {\n        ${a}\n      }\n      ${o.popup.popupAlias} = ${this._awaitPrefix}popup_info.value`),o.download&&(a=`${this._asyncPrefix}with ${n}.expect_download() as download_info {\n        ${a}\n      }\n      download = ${this._awaitPrefix}download_info.value`),o.waitForNavigation&&(a=`\n      # ${this._asyncPrefix}with ${n}.expect_navigation(url=${tm(o.waitForNavigation.url)}):\n      ${this._asyncPrefix}with ${n}.expect_navigation() {\n        ${a}\n      }`),r.add(a),o.assertNavigation&&r.add(`  # ${this._awaitPrefix}expect(${n}).to_have_url(${tm(o.assertNavigation.url)})`),r.format()}_generateActionCall(e){switch(e.name){case"openPage":throw Error("Not reached");case"closePage":return"close()";case"click":{let t="click";2===e.clickCount&&(t="dblclick");const n=(0,Kf.toModifiers)(e.modifiers),r={};"left"!==e.button&&(r.button=e.button),n.length&&(r.modifiers=n),e.clickCount>2&&(r.clickCount=e.clickCount),e.position&&(r.position=e.position);const i=Qf(r,!1);return nm(e.selector)+`.${t}(${i})`}case"check":return nm(e.selector)+".check()";case"uncheck":return nm(e.selector)+".uncheck()";case"fill":return nm(e.selector)+`.fill(${tm(e.text)})`;case"setInputFiles":return nm(e.selector)+`.set_input_files(${Xf(1===e.files.length?e.files[0]:e.files)})`;case"press":{const t=[...(0,Kf.toModifiers)(e.modifiers),e.key].join("+");return nm(e.selector)+`.press(${tm(t)})`}case"navigate":return`goto(${tm(e.url)})`;case"select":return nm(e.selector)+`.select_option(${Xf(1===e.options.length?e.options[0]:e.options)})`}}generateHeader(e){const t=new em;return this._isAsync?t.add(`\nimport asyncio\n\nfrom playwright.async_api import Playwright, async_playwright, expect\n\n\nasync def run(playwright: Playwright) -> None {\n    browser = await playwright.${e.browserName}.launch(${Qf(e.launchOptions,!1)})\n    context = await browser.new_context(${Zf(e.contextOptions,e.deviceName)})`):t.add(`\nfrom playwright.sync_api import Playwright, sync_playwright, expect\n\n\ndef run(playwright: Playwright) -> None {\n    browser = playwright.${e.browserName}.launch(${Qf(e.launchOptions,!1)})\n    context = browser.new_context(${Zf(e.contextOptions,e.deviceName)})`),t.format()}generateFooter(e){if(this._isAsync){return`\n    # ---------------------${e?`\n    await context.storage_state(path=${tm(e)})`:""}\n    await context.close()\n    await browser.close()\n\n\nasync def main() -> None:\n    async with async_playwright() as playwright:\n        await run(playwright)\n\n\nasyncio.run(main())\n`}return`\n    # ---------------------${e?`\n    context.storage_state(path=${tm(e)})`:""}\n    context.close()\n    browser.close()\n\n\nwith sync_playwright() as playwright:\n    run(playwright)\n`}};class em{constructor(e=0){this._baseIndent=void 0,this._baseOffset=void 0,this._lines=[],this._baseIndent=" ".repeat(4),this._baseOffset=" ".repeat(e)}prepend(e){this._lines=e.trim().split("\n").map((e=>e.trim())).concat(this._lines)}add(e){this._lines.push(...e.trim().split("\n").map((e=>e.trim())))}newLine(){this._lines.push("")}format(){let e="";const t=[];return this._lines.forEach((n=>""===n?t.push(n):"}"!==n?((n=e+n).endsWith("{")&&(e+=this._baseIndent,n=n.substring(0,n.length-1).trimEnd()+":"),t.push(this._baseOffset+n)):void(e=e.substring(this._baseIndent.length)))),t.join("\n")}}function tm(e){return(0,Jf.escapeWithQuotes)(e,'"')}function nm(e,t="locator"){const n=e.match(/(.*)\s+>>\s+nth=(\d+)$/);return n?0==+n[2]?`${t}(${tm(n[1])}).first`:`${t}(${tm(n[1])}).nth(${n[2]})`:`${t}(${tm(e)})`}var rm={};Object.defineProperty(rm,"__esModule",{value:!0}),rm.source=void 0;rm.source='var __create = Object.create;\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __getProtoOf = Object.getPrototypeOf;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __commonJS = (cb, mod) => function __require() {\n  return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === "object" || typeof from === "function") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target, mod));\n\n// packages/playwright-core/src/server/isomorphic/cssTokenizer.js\nvar require_cssTokenizer = __commonJS({\n  "packages/playwright-core/src/server/isomorphic/cssTokenizer.js"(exports2) {\n    (function(root, factory) {\n      if (typeof define === "function" && define.amd) {\n        define(["exports"], factory);\n      } else if (typeof exports2 !== "undefined") {\n        factory(exports2);\n      } else {\n        factory(root);\n      }\n    })(exports2, function(exports3) {\n      var between = function(num, first, last) {\n        return num >= first && num <= last;\n      };\n      function digit(code) {\n        return between(code, 48, 57);\n      }\n      function hexdigit(code) {\n        return digit(code) || between(code, 65, 70) || between(code, 97, 102);\n      }\n      function uppercaseletter(code) {\n        return between(code, 65, 90);\n      }\n      function lowercaseletter(code) {\n        return between(code, 97, 122);\n      }\n      function letter(code) {\n        return uppercaseletter(code) || lowercaseletter(code);\n      }\n      function nonascii(code) {\n        return code >= 128;\n      }\n      function namestartchar(code) {\n        return letter(code) || nonascii(code) || code == 95;\n      }\n      function namechar(code) {\n        return namestartchar(code) || digit(code) || code == 45;\n      }\n      function nonprintable(code) {\n        return between(code, 0, 8) || code == 11 || between(code, 14, 31) || code == 127;\n      }\n      function newline(code) {\n        return code == 10;\n      }\n      function whitespace(code) {\n        return newline(code) || code == 9 || code == 32;\n      }\n      function badescape(code) {\n        return newline(code) || isNaN(code);\n      }\n      var maximumallowedcodepoint = 1114111;\n      var InvalidCharacterError = function(message) {\n        this.message = message;\n      };\n      InvalidCharacterError.prototype = new Error();\n      InvalidCharacterError.prototype.name = "InvalidCharacterError";\n      function preprocess(str) {\n        var codepoints = [];\n        for (var i = 0; i < str.length; i++) {\n          var code = str.charCodeAt(i);\n          if (code == 13 && str.charCodeAt(i + 1) == 10) {\n            code = 10;\n            i++;\n          }\n          if (code == 13 || code == 12)\n            code = 10;\n          if (code == 0)\n            code = 65533;\n          if (between(code, 55296, 56319) && between(str.charCodeAt(i + 1), 56320, 57343)) {\n            var lead = code - 55296;\n            var trail = str.charCodeAt(i + 1) - 56320;\n            code = Math.pow(2, 16) + lead * Math.pow(2, 10) + trail;\n            i++;\n          }\n          codepoints.push(code);\n        }\n        return codepoints;\n      }\n      function stringFromCode(code) {\n        if (code <= 65535)\n          return String.fromCharCode(code);\n        code -= Math.pow(2, 16);\n        var lead = Math.floor(code / Math.pow(2, 10)) + 55296;\n        var trail = code % Math.pow(2, 10) + 56320;\n        return String.fromCharCode(lead) + String.fromCharCode(trail);\n      }\n      function tokenize2(str) {\n        str = preprocess(str);\n        var i = -1;\n        var tokens = [];\n        var code;\n        var line = 0;\n        var column = 0;\n        var lastLineLength = 0;\n        var incrLineno = function() {\n          line += 1;\n          lastLineLength = column;\n          column = 0;\n        };\n        var locStart = { line, column };\n        var codepoint = function(i2) {\n          if (i2 >= str.length) {\n            return -1;\n          }\n          return str[i2];\n        };\n        var next = function(num) {\n          if (num === void 0)\n            num = 1;\n          if (num > 3)\n            throw "Spec Error: no more than three codepoints of lookahead.";\n          return codepoint(i + num);\n        };\n        var consume = function(num) {\n          if (num === void 0)\n            num = 1;\n          i += num;\n          code = codepoint(i);\n          if (newline(code))\n            incrLineno();\n          else\n            column += num;\n          return true;\n        };\n        var reconsume = function() {\n          i -= 1;\n          if (newline(code)) {\n            line -= 1;\n            column = lastLineLength;\n          } else {\n            column -= 1;\n          }\n          locStart.line = line;\n          locStart.column = column;\n          return true;\n        };\n        var eof = function(codepoint2) {\n          if (codepoint2 === void 0)\n            codepoint2 = code;\n          return codepoint2 == -1;\n        };\n        var donothing = function() {\n        };\n        var parseerror = function() {\n          console.log("Parse error at index " + i + ", processing codepoint 0x" + code.toString(16) + ".");\n          return true;\n        };\n        var consumeAToken = function() {\n          consumeComments();\n          consume();\n          if (whitespace(code)) {\n            while (whitespace(next()))\n              consume();\n            return new WhitespaceToken2();\n          } else if (code == 34)\n            return consumeAStringToken();\n          else if (code == 35) {\n            if (namechar(next()) || areAValidEscape(next(1), next(2))) {\n              var token = new HashToken2();\n              if (wouldStartAnIdentifier(next(1), next(2), next(3)))\n                token.type = "id";\n              token.value = consumeAName();\n              return token;\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 36) {\n            if (next() == 61) {\n              consume();\n              return new SuffixMatchToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 39)\n            return consumeAStringToken();\n          else if (code == 40)\n            return new OpenParenToken();\n          else if (code == 41)\n            return new CloseParenToken2();\n          else if (code == 42) {\n            if (next() == 61) {\n              consume();\n              return new SubstringMatchToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 43) {\n            if (startsWithANumber()) {\n              reconsume();\n              return consumeANumericToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 44)\n            return new CommaToken2();\n          else if (code == 45) {\n            if (startsWithANumber()) {\n              reconsume();\n              return consumeANumericToken();\n            } else if (next(1) == 45 && next(2) == 62) {\n              consume(2);\n              return new CDCToken2();\n            } else if (startsWithAnIdentifier()) {\n              reconsume();\n              return consumeAnIdentlikeToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 46) {\n            if (startsWithANumber()) {\n              reconsume();\n              return consumeANumericToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 58)\n            return new ColonToken2();\n          else if (code == 59)\n            return new SemicolonToken2();\n          else if (code == 60) {\n            if (next(1) == 33 && next(2) == 45 && next(3) == 45) {\n              consume(3);\n              return new CDOToken2();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 64) {\n            if (wouldStartAnIdentifier(next(1), next(2), next(3))) {\n              return new AtKeywordToken2(consumeAName());\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 91)\n            return new OpenSquareToken2();\n          else if (code == 92) {\n            if (startsWithAValidEscape()) {\n              reconsume();\n              return consumeAnIdentlikeToken();\n            } else {\n              parseerror();\n              return new DelimToken2(code);\n            }\n          } else if (code == 93)\n            return new CloseSquareToken2();\n          else if (code == 94) {\n            if (next() == 61) {\n              consume();\n              return new PrefixMatchToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 123)\n            return new OpenCurlyToken2();\n          else if (code == 124) {\n            if (next() == 61) {\n              consume();\n              return new DashMatchToken();\n            } else if (next() == 124) {\n              consume();\n              return new ColumnToken2();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 125)\n            return new CloseCurlyToken2();\n          else if (code == 126) {\n            if (next() == 61) {\n              consume();\n              return new IncludeMatchToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (digit(code)) {\n            reconsume();\n            return consumeANumericToken();\n          } else if (namestartchar(code)) {\n            reconsume();\n            return consumeAnIdentlikeToken();\n          } else if (eof())\n            return new EOFToken2();\n          else\n            return new DelimToken2(code);\n        };\n        var consumeComments = function() {\n          while (next(1) == 47 && next(2) == 42) {\n            consume(2);\n            while (true) {\n              consume();\n              if (code == 42 && next() == 47) {\n                consume();\n                break;\n              } else if (eof()) {\n                parseerror();\n                return;\n              }\n            }\n          }\n        };\n        var consumeANumericToken = function() {\n          var num = consumeANumber();\n          if (wouldStartAnIdentifier(next(1), next(2), next(3))) {\n            var token = new DimensionToken();\n            token.value = num.value;\n            token.repr = num.repr;\n            token.type = num.type;\n            token.unit = consumeAName();\n            return token;\n          } else if (next() == 37) {\n            consume();\n            var token = new PercentageToken2();\n            token.value = num.value;\n            token.repr = num.repr;\n            return token;\n          } else {\n            var token = new NumberToken2();\n            token.value = num.value;\n            token.repr = num.repr;\n            token.type = num.type;\n            return token;\n          }\n        };\n        var consumeAnIdentlikeToken = function() {\n          var str2 = consumeAName();\n          if (str2.toLowerCase() == "url" && next() == 40) {\n            consume();\n            while (whitespace(next(1)) && whitespace(next(2)))\n              consume();\n            if (next() == 34 || next() == 39) {\n              return new FunctionToken2(str2);\n            } else if (whitespace(next()) && (next(2) == 34 || next(2) == 39)) {\n              return new FunctionToken2(str2);\n            } else {\n              return consumeAURLToken();\n            }\n          } else if (next() == 40) {\n            consume();\n            return new FunctionToken2(str2);\n          } else {\n            return new IdentToken2(str2);\n          }\n        };\n        var consumeAStringToken = function(endingCodePoint) {\n          if (endingCodePoint === void 0)\n            endingCodePoint = code;\n          var string = "";\n          while (consume()) {\n            if (code == endingCodePoint || eof()) {\n              return new StringToken2(string);\n            } else if (newline(code)) {\n              parseerror();\n              reconsume();\n              return new BadStringToken2();\n            } else if (code == 92) {\n              if (eof(next())) {\n                donothing();\n              } else if (newline(next())) {\n                consume();\n              } else {\n                string += stringFromCode(consumeEscape());\n              }\n            } else {\n              string += stringFromCode(code);\n            }\n          }\n        };\n        var consumeAURLToken = function() {\n          var token = new URLToken2("");\n          while (whitespace(next()))\n            consume();\n          if (eof(next()))\n            return token;\n          while (consume()) {\n            if (code == 41 || eof()) {\n              return token;\n            } else if (whitespace(code)) {\n              while (whitespace(next()))\n                consume();\n              if (next() == 41 || eof(next())) {\n                consume();\n                return token;\n              } else {\n                consumeTheRemnantsOfABadURL();\n                return new BadURLToken2();\n              }\n            } else if (code == 34 || code == 39 || code == 40 || nonprintable(code)) {\n              parseerror();\n              consumeTheRemnantsOfABadURL();\n              return new BadURLToken2();\n            } else if (code == 92) {\n              if (startsWithAValidEscape()) {\n                token.value += stringFromCode(consumeEscape());\n              } else {\n                parseerror();\n                consumeTheRemnantsOfABadURL();\n                return new BadURLToken2();\n              }\n            } else {\n              token.value += stringFromCode(code);\n            }\n          }\n        };\n        var consumeEscape = function() {\n          consume();\n          if (hexdigit(code)) {\n            var digits = [code];\n            for (var total = 0; total < 5; total++) {\n              if (hexdigit(next())) {\n                consume();\n                digits.push(code);\n              } else {\n                break;\n              }\n            }\n            if (whitespace(next()))\n              consume();\n            var value = parseInt(digits.map(function(x) {\n              return String.fromCharCode(x);\n            }).join(""), 16);\n            if (value > maximumallowedcodepoint)\n              value = 65533;\n            return value;\n          } else if (eof()) {\n            return 65533;\n          } else {\n            return code;\n          }\n        };\n        var areAValidEscape = function(c1, c2) {\n          if (c1 != 92)\n            return false;\n          if (newline(c2))\n            return false;\n          return true;\n        };\n        var startsWithAValidEscape = function() {\n          return areAValidEscape(code, next());\n        };\n        var wouldStartAnIdentifier = function(c1, c2, c3) {\n          if (c1 == 45) {\n            return namestartchar(c2) || c2 == 45 || areAValidEscape(c2, c3);\n          } else if (namestartchar(c1)) {\n            return true;\n          } else if (c1 == 92) {\n            return areAValidEscape(c1, c2);\n          } else {\n            return false;\n          }\n        };\n        var startsWithAnIdentifier = function() {\n          return wouldStartAnIdentifier(code, next(1), next(2));\n        };\n        var wouldStartANumber = function(c1, c2, c3) {\n          if (c1 == 43 || c1 == 45) {\n            if (digit(c2))\n              return true;\n            if (c2 == 46 && digit(c3))\n              return true;\n            return false;\n          } else if (c1 == 46) {\n            if (digit(c2))\n              return true;\n            return false;\n          } else if (digit(c1)) {\n            return true;\n          } else {\n            return false;\n          }\n        };\n        var startsWithANumber = function() {\n          return wouldStartANumber(code, next(1), next(2));\n        };\n        var consumeAName = function() {\n          var result = "";\n          while (consume()) {\n            if (namechar(code)) {\n              result += stringFromCode(code);\n            } else if (startsWithAValidEscape()) {\n              result += stringFromCode(consumeEscape());\n            } else {\n              reconsume();\n              return result;\n            }\n          }\n        };\n        var consumeANumber = function() {\n          var repr = [];\n          var type = "integer";\n          if (next() == 43 || next() == 45) {\n            consume();\n            repr += stringFromCode(code);\n          }\n          while (digit(next())) {\n            consume();\n            repr += stringFromCode(code);\n          }\n          if (next(1) == 46 && digit(next(2))) {\n            consume();\n            repr += stringFromCode(code);\n            consume();\n            repr += stringFromCode(code);\n            type = "number";\n            while (digit(next())) {\n              consume();\n              repr += stringFromCode(code);\n            }\n          }\n          var c1 = next(1), c2 = next(2), c3 = next(3);\n          if ((c1 == 69 || c1 == 101) && digit(c2)) {\n            consume();\n            repr += stringFromCode(code);\n            consume();\n            repr += stringFromCode(code);\n            type = "number";\n            while (digit(next())) {\n              consume();\n              repr += stringFromCode(code);\n            }\n          } else if ((c1 == 69 || c1 == 101) && (c2 == 43 || c2 == 45) && digit(c3)) {\n            consume();\n            repr += stringFromCode(code);\n            consume();\n            repr += stringFromCode(code);\n            consume();\n            repr += stringFromCode(code);\n            type = "number";\n            while (digit(next())) {\n              consume();\n              repr += stringFromCode(code);\n            }\n          }\n          var value = convertAStringToANumber(repr);\n          return { type, value, repr };\n        };\n        var convertAStringToANumber = function(string) {\n          return +string;\n        };\n        var consumeTheRemnantsOfABadURL = function() {\n          while (consume()) {\n            if (code == 41 || eof()) {\n              return;\n            } else if (startsWithAValidEscape()) {\n              consumeEscape();\n              donothing();\n            } else {\n              donothing();\n            }\n          }\n        };\n        var iterationCount = 0;\n        while (!eof(next())) {\n          tokens.push(consumeAToken());\n          iterationCount++;\n          if (iterationCount > str.length * 2)\n            return "I\'m infinite-looping!";\n        }\n        return tokens;\n      }\n      function CSSParserToken() {\n        throw "Abstract Base Class";\n      }\n      CSSParserToken.prototype.toJSON = function() {\n        return { token: this.tokenType };\n      };\n      CSSParserToken.prototype.toString = function() {\n        return this.tokenType;\n      };\n      CSSParserToken.prototype.toSource = function() {\n        return "" + this;\n      };\n      function BadStringToken2() {\n        return this;\n      }\n      BadStringToken2.prototype = Object.create(CSSParserToken.prototype);\n      BadStringToken2.prototype.tokenType = "BADSTRING";\n      function BadURLToken2() {\n        return this;\n      }\n      BadURLToken2.prototype = Object.create(CSSParserToken.prototype);\n      BadURLToken2.prototype.tokenType = "BADURL";\n      function WhitespaceToken2() {\n        return this;\n      }\n      WhitespaceToken2.prototype = Object.create(CSSParserToken.prototype);\n      WhitespaceToken2.prototype.tokenType = "WHITESPACE";\n      WhitespaceToken2.prototype.toString = function() {\n        return "WS";\n      };\n      WhitespaceToken2.prototype.toSource = function() {\n        return " ";\n      };\n      function CDOToken2() {\n        return this;\n      }\n      CDOToken2.prototype = Object.create(CSSParserToken.prototype);\n      CDOToken2.prototype.tokenType = "CDO";\n      CDOToken2.prototype.toSource = function() {\n        return "\x3c!--";\n      };\n      function CDCToken2() {\n        return this;\n      }\n      CDCToken2.prototype = Object.create(CSSParserToken.prototype);\n      CDCToken2.prototype.tokenType = "CDC";\n      CDCToken2.prototype.toSource = function() {\n        return "--\x3e";\n      };\n      function ColonToken2() {\n        return this;\n      }\n      ColonToken2.prototype = Object.create(CSSParserToken.prototype);\n      ColonToken2.prototype.tokenType = ":";\n      function SemicolonToken2() {\n        return this;\n      }\n      SemicolonToken2.prototype = Object.create(CSSParserToken.prototype);\n      SemicolonToken2.prototype.tokenType = ";";\n      function CommaToken2() {\n        return this;\n      }\n      CommaToken2.prototype = Object.create(CSSParserToken.prototype);\n      CommaToken2.prototype.tokenType = ",";\n      function GroupingToken() {\n        throw "Abstract Base Class";\n      }\n      GroupingToken.prototype = Object.create(CSSParserToken.prototype);\n      function OpenCurlyToken2() {\n        this.value = "{";\n        this.mirror = "}";\n        return this;\n      }\n      OpenCurlyToken2.prototype = Object.create(GroupingToken.prototype);\n      OpenCurlyToken2.prototype.tokenType = "{";\n      function CloseCurlyToken2() {\n        this.value = "}";\n        this.mirror = "{";\n        return this;\n      }\n      CloseCurlyToken2.prototype = Object.create(GroupingToken.prototype);\n      CloseCurlyToken2.prototype.tokenType = "}";\n      function OpenSquareToken2() {\n        this.value = "[";\n        this.mirror = "]";\n        return this;\n      }\n      OpenSquareToken2.prototype = Object.create(GroupingToken.prototype);\n      OpenSquareToken2.prototype.tokenType = "[";\n      function CloseSquareToken2() {\n        this.value = "]";\n        this.mirror = "[";\n        return this;\n      }\n      CloseSquareToken2.prototype = Object.create(GroupingToken.prototype);\n      CloseSquareToken2.prototype.tokenType = "]";\n      function OpenParenToken() {\n        this.value = "(";\n        this.mirror = ")";\n        return this;\n      }\n      OpenParenToken.prototype = Object.create(GroupingToken.prototype);\n      OpenParenToken.prototype.tokenType = "(";\n      function CloseParenToken2() {\n        this.value = ")";\n        this.mirror = "(";\n        return this;\n      }\n      CloseParenToken2.prototype = Object.create(GroupingToken.prototype);\n      CloseParenToken2.prototype.tokenType = ")";\n      function IncludeMatchToken() {\n        return this;\n      }\n      IncludeMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      IncludeMatchToken.prototype.tokenType = "~=";\n      function DashMatchToken() {\n        return this;\n      }\n      DashMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      DashMatchToken.prototype.tokenType = "|=";\n      function PrefixMatchToken() {\n        return this;\n      }\n      PrefixMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      PrefixMatchToken.prototype.tokenType = "^=";\n      function SuffixMatchToken() {\n        return this;\n      }\n      SuffixMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      SuffixMatchToken.prototype.tokenType = "$=";\n      function SubstringMatchToken() {\n        return this;\n      }\n      SubstringMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      SubstringMatchToken.prototype.tokenType = "*=";\n      function ColumnToken2() {\n        return this;\n      }\n      ColumnToken2.prototype = Object.create(CSSParserToken.prototype);\n      ColumnToken2.prototype.tokenType = "||";\n      function EOFToken2() {\n        return this;\n      }\n      EOFToken2.prototype = Object.create(CSSParserToken.prototype);\n      EOFToken2.prototype.tokenType = "EOF";\n      EOFToken2.prototype.toSource = function() {\n        return "";\n      };\n      function DelimToken2(code) {\n        this.value = stringFromCode(code);\n        return this;\n      }\n      DelimToken2.prototype = Object.create(CSSParserToken.prototype);\n      DelimToken2.prototype.tokenType = "DELIM";\n      DelimToken2.prototype.toString = function() {\n        return "DELIM(" + this.value + ")";\n      };\n      DelimToken2.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        return json;\n      };\n      DelimToken2.prototype.toSource = function() {\n        if (this.value == "\\\\")\n          return "\\\\\\n";\n        else\n          return this.value;\n      };\n      function StringValuedToken() {\n        throw "Abstract Base Class";\n      }\n      StringValuedToken.prototype = Object.create(CSSParserToken.prototype);\n      StringValuedToken.prototype.ASCIIMatch = function(str) {\n        return this.value.toLowerCase() == str.toLowerCase();\n      };\n      StringValuedToken.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        return json;\n      };\n      function IdentToken2(val) {\n        this.value = val;\n      }\n      IdentToken2.prototype = Object.create(StringValuedToken.prototype);\n      IdentToken2.prototype.tokenType = "IDENT";\n      IdentToken2.prototype.toString = function() {\n        return "IDENT(" + this.value + ")";\n      };\n      IdentToken2.prototype.toSource = function() {\n        return escapeIdent(this.value);\n      };\n      function FunctionToken2(val) {\n        this.value = val;\n        this.mirror = ")";\n      }\n      FunctionToken2.prototype = Object.create(StringValuedToken.prototype);\n      FunctionToken2.prototype.tokenType = "FUNCTION";\n      FunctionToken2.prototype.toString = function() {\n        return "FUNCTION(" + this.value + ")";\n      };\n      FunctionToken2.prototype.toSource = function() {\n        return escapeIdent(this.value) + "(";\n      };\n      function AtKeywordToken2(val) {\n        this.value = val;\n      }\n      AtKeywordToken2.prototype = Object.create(StringValuedToken.prototype);\n      AtKeywordToken2.prototype.tokenType = "AT-KEYWORD";\n      AtKeywordToken2.prototype.toString = function() {\n        return "AT(" + this.value + ")";\n      };\n      AtKeywordToken2.prototype.toSource = function() {\n        return "@" + escapeIdent(this.value);\n      };\n      function HashToken2(val) {\n        this.value = val;\n        this.type = "unrestricted";\n      }\n      HashToken2.prototype = Object.create(StringValuedToken.prototype);\n      HashToken2.prototype.tokenType = "HASH";\n      HashToken2.prototype.toString = function() {\n        return "HASH(" + this.value + ")";\n      };\n      HashToken2.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        json.type = this.type;\n        return json;\n      };\n      HashToken2.prototype.toSource = function() {\n        if (this.type == "id") {\n          return "#" + escapeIdent(this.value);\n        } else {\n          return "#" + escapeHash(this.value);\n        }\n      };\n      function StringToken2(val) {\n        this.value = val;\n      }\n      StringToken2.prototype = Object.create(StringValuedToken.prototype);\n      StringToken2.prototype.tokenType = "STRING";\n      StringToken2.prototype.toString = function() {\n        return \'"\' + escapeString(this.value) + \'"\';\n      };\n      function URLToken2(val) {\n        this.value = val;\n      }\n      URLToken2.prototype = Object.create(StringValuedToken.prototype);\n      URLToken2.prototype.tokenType = "URL";\n      URLToken2.prototype.toString = function() {\n        return "URL(" + this.value + ")";\n      };\n      URLToken2.prototype.toSource = function() {\n        return \'url("\' + escapeString(this.value) + \'")\';\n      };\n      function NumberToken2() {\n        this.value = null;\n        this.type = "integer";\n        this.repr = "";\n      }\n      NumberToken2.prototype = Object.create(CSSParserToken.prototype);\n      NumberToken2.prototype.tokenType = "NUMBER";\n      NumberToken2.prototype.toString = function() {\n        if (this.type == "integer")\n          return "INT(" + this.value + ")";\n        return "NUMBER(" + this.value + ")";\n      };\n      NumberToken2.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        json.type = this.type;\n        json.repr = this.repr;\n        return json;\n      };\n      NumberToken2.prototype.toSource = function() {\n        return this.repr;\n      };\n      function PercentageToken2() {\n        this.value = null;\n        this.repr = "";\n      }\n      PercentageToken2.prototype = Object.create(CSSParserToken.prototype);\n      PercentageToken2.prototype.tokenType = "PERCENTAGE";\n      PercentageToken2.prototype.toString = function() {\n        return "PERCENTAGE(" + this.value + ")";\n      };\n      PercentageToken2.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        json.repr = this.repr;\n        return json;\n      };\n      PercentageToken2.prototype.toSource = function() {\n        return this.repr + "%";\n      };\n      function DimensionToken() {\n        this.value = null;\n        this.type = "integer";\n        this.repr = "";\n        this.unit = "";\n      }\n      DimensionToken.prototype = Object.create(CSSParserToken.prototype);\n      DimensionToken.prototype.tokenType = "DIMENSION";\n      DimensionToken.prototype.toString = function() {\n        return "DIM(" + this.value + "," + this.unit + ")";\n      };\n      DimensionToken.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        json.type = this.type;\n        json.repr = this.repr;\n        json.unit = this.unit;\n        return json;\n      };\n      DimensionToken.prototype.toSource = function() {\n        var source = this.repr;\n        var unit = escapeIdent(this.unit);\n        if (unit[0].toLowerCase() == "e" && (unit[1] == "-" || between(unit.charCodeAt(1), 48, 57))) {\n          unit = "\\\\65 " + unit.slice(1, unit.length);\n        }\n        return source + unit;\n      };\n      function escapeIdent(string) {\n        string = "" + string;\n        var result = "";\n        var firstcode = string.charCodeAt(0);\n        for (var i = 0; i < string.length; i++) {\n          var code = string.charCodeAt(i);\n          if (code == 0) {\n            throw new InvalidCharacterError("Invalid character: the input contains U+0000.");\n          }\n          if (between(code, 1, 31) || code == 127 || i == 0 && between(code, 48, 57) || i == 1 && between(code, 48, 57) && firstcode == 45) {\n            result += "\\\\" + code.toString(16) + " ";\n          } else if (code >= 128 || code == 45 || code == 95 || between(code, 48, 57) || between(code, 65, 90) || between(code, 97, 122)) {\n            result += string[i];\n          } else {\n            result += "\\\\" + string[i];\n          }\n        }\n        return result;\n      }\n      function escapeHash(string) {\n        string = "" + string;\n        var result = "";\n        var firstcode = string.charCodeAt(0);\n        for (var i = 0; i < string.length; i++) {\n          var code = string.charCodeAt(i);\n          if (code == 0) {\n            throw new InvalidCharacterError("Invalid character: the input contains U+0000.");\n          }\n          if (code >= 128 || code == 45 || code == 95 || between(code, 48, 57) || between(code, 65, 90) || between(code, 97, 122)) {\n            result += string[i];\n          } else {\n            result += "\\\\" + code.toString(16) + " ";\n          }\n        }\n        return result;\n      }\n      function escapeString(string) {\n        string = "" + string;\n        var result = "";\n        for (var i = 0; i < string.length; i++) {\n          var code = string.charCodeAt(i);\n          if (code == 0) {\n            throw new InvalidCharacterError("Invalid character: the input contains U+0000.");\n          }\n          if (between(code, 1, 31) || code == 127) {\n            result += "\\\\" + code.toString(16) + " ";\n          } else if (code == 34 || code == 92) {\n            result += "\\\\" + string[i];\n          } else {\n            result += string[i];\n          }\n        }\n        return result;\n      }\n      exports3.tokenize = tokenize2;\n      exports3.IdentToken = IdentToken2;\n      exports3.FunctionToken = FunctionToken2;\n      exports3.AtKeywordToken = AtKeywordToken2;\n      exports3.HashToken = HashToken2;\n      exports3.StringToken = StringToken2;\n      exports3.BadStringToken = BadStringToken2;\n      exports3.URLToken = URLToken2;\n      exports3.BadURLToken = BadURLToken2;\n      exports3.DelimToken = DelimToken2;\n      exports3.NumberToken = NumberToken2;\n      exports3.PercentageToken = PercentageToken2;\n      exports3.DimensionToken = DimensionToken;\n      exports3.IncludeMatchToken = IncludeMatchToken;\n      exports3.DashMatchToken = DashMatchToken;\n      exports3.PrefixMatchToken = PrefixMatchToken;\n      exports3.SuffixMatchToken = SuffixMatchToken;\n      exports3.SubstringMatchToken = SubstringMatchToken;\n      exports3.ColumnToken = ColumnToken2;\n      exports3.WhitespaceToken = WhitespaceToken2;\n      exports3.CDOToken = CDOToken2;\n      exports3.CDCToken = CDCToken2;\n      exports3.ColonToken = ColonToken2;\n      exports3.SemicolonToken = SemicolonToken2;\n      exports3.CommaToken = CommaToken2;\n      exports3.OpenParenToken = OpenParenToken;\n      exports3.CloseParenToken = CloseParenToken2;\n      exports3.OpenSquareToken = OpenSquareToken2;\n      exports3.CloseSquareToken = CloseSquareToken2;\n      exports3.OpenCurlyToken = OpenCurlyToken2;\n      exports3.CloseCurlyToken = CloseCurlyToken2;\n      exports3.EOFToken = EOFToken2;\n      exports3.CSSParserToken = CSSParserToken;\n      exports3.GroupingToken = GroupingToken;\n    });\n  }\n});\n\n// packages/playwright-core/src/server/isomorphic/cssParser.ts\nvar css = __toESM(require_cssTokenizer());\n\n// packages/playwright-core/src/server/injected/selectorEvaluator.ts\nfunction shouldSkipForTextMatching(element) {\n  return element.nodeName === "SCRIPT" || element.nodeName === "STYLE" || document.head && document.head.contains(element);\n}\nfunction elementText(evaluator, root) {\n  let value = evaluator._cacheText.get(root);\n  if (value === void 0) {\n    value = { full: "", immediate: [] };\n    if (!shouldSkipForTextMatching(root)) {\n      let currentImmediate = "";\n      if (root instanceof HTMLInputElement && (root.type === "submit" || root.type === "button")) {\n        value = { full: root.value, immediate: [root.value] };\n      } else {\n        for (let child = root.firstChild; child; child = child.nextSibling) {\n          if (child.nodeType === Node.TEXT_NODE) {\n            value.full += child.nodeValue || "";\n            currentImmediate += child.nodeValue || "";\n          } else {\n            if (currentImmediate)\n              value.immediate.push(currentImmediate);\n            currentImmediate = "";\n            if (child.nodeType === Node.ELEMENT_NODE)\n              value.full += elementText(evaluator, child).full;\n          }\n        }\n        if (currentImmediate)\n          value.immediate.push(currentImmediate);\n        if (root.shadowRoot)\n          value.full += elementText(evaluator, root.shadowRoot).full;\n      }\n    }\n    evaluator._cacheText.set(root, value);\n  }\n  return value;\n}\n\n// packages/playwright-core/src/server/injected/selectorGenerator.ts\nvar cacheAllowText = /* @__PURE__ */ new Map();\nvar cacheDisallowText = /* @__PURE__ */ new Map();\nvar kNthScore = 1e3;\nfunction querySelector(injectedScript, selector, ownerDocument) {\n  try {\n    const parsedSelector = injectedScript.parseSelector(selector);\n    return {\n      selector,\n      elements: injectedScript.querySelectorAll(parsedSelector, ownerDocument)\n    };\n  } catch (e) {\n    return {\n      selector,\n      elements: []\n    };\n  }\n}\nfunction generateSelector(injectedScript, targetElement, strict) {\n  injectedScript._evaluator.begin();\n  try {\n    targetElement = targetElement.closest("button,select,input,[role=button],[role=checkbox],[role=radio]") || targetElement;\n    const targetTokens = generateSelectorFor(injectedScript, targetElement, strict);\n    const bestTokens = targetTokens || cssFallback(injectedScript, targetElement, strict);\n    const selector = joinTokens(bestTokens);\n    const parsedSelector = injectedScript.parseSelector(selector);\n    return {\n      selector,\n      elements: injectedScript.querySelectorAll(parsedSelector, targetElement.ownerDocument)\n    };\n  } finally {\n    cacheAllowText.clear();\n    cacheDisallowText.clear();\n    injectedScript._evaluator.end();\n  }\n}\nfunction filterRegexTokens(textCandidates) {\n  return textCandidates.filter((c) => c[0].selector[0] !== "/");\n}\nfunction generateSelectorFor(injectedScript, targetElement, strict) {\n  if (targetElement.ownerDocument.documentElement === targetElement)\n    return [{ engine: "css", selector: "html", score: 1 }];\n  const calculate = (element, allowText) => {\n    const allowNthMatch = element === targetElement;\n    let textCandidates = allowText ? buildTextCandidates(injectedScript, element, element === targetElement).map((token) => [token]) : [];\n    if (element !== targetElement) {\n      textCandidates = filterRegexTokens(textCandidates);\n    }\n    const noTextCandidates = buildCandidates(injectedScript, element).map((token) => [token]);\n    let result = chooseFirstSelector(injectedScript, targetElement.ownerDocument, element, [...textCandidates, ...noTextCandidates], allowNthMatch, strict);\n    textCandidates = filterRegexTokens(textCandidates);\n    const checkWithText = (textCandidatesToUse) => {\n      const allowParentText = allowText && !textCandidatesToUse.length;\n      const candidates = [...textCandidatesToUse, ...noTextCandidates].filter((c) => {\n        if (!result)\n          return true;\n        return combineScores(c) < combineScores(result);\n      });\n      let bestPossibleInParent = candidates[0];\n      if (!bestPossibleInParent)\n        return;\n      for (let parent = parentElementOrShadowHost(element); parent; parent = parentElementOrShadowHost(parent)) {\n        const parentTokens = calculateCached(parent, allowParentText);\n        if (!parentTokens)\n          continue;\n        if (result && combineScores([...parentTokens, ...bestPossibleInParent]) >= combineScores(result))\n          continue;\n        bestPossibleInParent = chooseFirstSelector(injectedScript, parent, element, candidates, allowNthMatch, strict);\n        if (!bestPossibleInParent)\n          return;\n        const combined = [...parentTokens, ...bestPossibleInParent];\n        if (!result || combineScores(combined) < combineScores(result))\n          result = combined;\n      }\n    };\n    checkWithText(textCandidates);\n    if (element === targetElement && textCandidates.length)\n      checkWithText([]);\n    return result;\n  };\n  const calculateCached = (element, allowText) => {\n    const cache = allowText ? cacheAllowText : cacheDisallowText;\n    let value = cache.get(element);\n    if (value === void 0) {\n      value = calculate(element, allowText);\n      cache.set(element, value);\n    }\n    return value;\n  };\n  return calculateCached(targetElement, true);\n}\nfunction buildCandidates(injectedScript, element) {\n  const candidates = [];\n  for (const attribute of ["data-testid", "data-test-id", "data-test"]) {\n    if (element.getAttribute(attribute))\n      candidates.push({ engine: "css", selector: `[${attribute}=${quoteAttributeValue(element.getAttribute(attribute))}]`, score: 1 });\n  }\n  if (element.nodeName === "INPUT") {\n    const input = element;\n    if (input.placeholder)\n      candidates.push({ engine: "css", selector: `[placeholder=${quoteAttributeValue(input.placeholder)}]`, score: 10 });\n  }\n  if (element.getAttribute("aria-label"))\n    candidates.push({ engine: "css", selector: `[aria-label=${quoteAttributeValue(element.getAttribute("aria-label"))}]`, score: 10 });\n  if (element.getAttribute("alt") && ["APPLET", "AREA", "IMG", "INPUT"].includes(element.nodeName))\n    candidates.push({ engine: "css", selector: `${cssEscape(element.nodeName.toLowerCase())}[alt=${quoteAttributeValue(element.getAttribute("alt"))}]`, score: 10 });\n  if (element.getAttribute("role"))\n    candidates.push({ engine: "css", selector: `${cssEscape(element.nodeName.toLowerCase())}[role=${quoteAttributeValue(element.getAttribute("role"))}]`, score: 50 });\n  if (element.getAttribute("name") && ["BUTTON", "FORM", "FIELDSET", "IFRAME", "INPUT", "KEYGEN", "OBJECT", "OUTPUT", "SELECT", "TEXTAREA", "MAP", "META", "PARAM"].includes(element.nodeName))\n    candidates.push({ engine: "css", selector: `${cssEscape(element.nodeName.toLowerCase())}[name=${quoteAttributeValue(element.getAttribute("name"))}]`, score: 50 });\n  if (["INPUT", "TEXTAREA"].includes(element.nodeName) && element.getAttribute("type") !== "hidden") {\n    if (element.getAttribute("type"))\n      candidates.push({ engine: "css", selector: `${cssEscape(element.nodeName.toLowerCase())}[type=${quoteAttributeValue(element.getAttribute("type"))}]`, score: 50 });\n  }\n  if (["INPUT", "TEXTAREA", "SELECT"].includes(element.nodeName))\n    candidates.push({ engine: "css", selector: cssEscape(element.nodeName.toLowerCase()), score: 50 });\n  const idAttr = element.getAttribute("id");\n  if (idAttr && !isGuidLike(idAttr))\n    candidates.push({ engine: "css", selector: makeSelectorForId(idAttr), score: 100 });\n  candidates.push({ engine: "css", selector: cssEscape(element.nodeName.toLowerCase()), score: 200 });\n  return candidates;\n}\nfunction buildTextCandidates(injectedScript, element, allowHasText) {\n  if (element.nodeName === "SELECT")\n    return [];\n  const text = elementText(injectedScript._evaluator, element).full.trim().replace(/\\s+/g, " ").substring(0, 80);\n  if (!text)\n    return [];\n  const candidates = [];\n  let escaped = text;\n  if (text.includes(\'"\') || text.includes(">>") || text[0] === "/")\n    escaped = `/.*${escapeForRegex(text)}.*/`;\n  candidates.push({ engine: "text", selector: escaped, score: 10 });\n  if (allowHasText && escaped === text) {\n    let prefix = element.nodeName.toLowerCase();\n    if (element.hasAttribute("role"))\n      prefix += `[role=${quoteAttributeValue(element.getAttribute("role"))}]`;\n    candidates.push({ engine: "css", selector: `${prefix}:has-text("${text}")`, score: 30 });\n  }\n  return candidates;\n}\nfunction parentElementOrShadowHost(element) {\n  if (element.parentElement)\n    return element.parentElement;\n  if (!element.parentNode)\n    return null;\n  if (element.parentNode.nodeType === Node.DOCUMENT_FRAGMENT_NODE && element.parentNode.host)\n    return element.parentNode.host;\n  return null;\n}\nfunction makeSelectorForId(id) {\n  return /^[a-zA-Z][a-zA-Z0-9\\-\\_]+$/.test(id) ? "#" + id : `[id="${cssEscape(id)}"]`;\n}\nfunction cssFallback(injectedScript, targetElement, strict) {\n  const kFallbackScore = 1e7;\n  const root = targetElement.ownerDocument;\n  const tokens = [];\n  function uniqueCSSSelector(prefix) {\n    const path = tokens.slice();\n    if (prefix)\n      path.unshift(prefix);\n    const selector = path.join(" ");\n    const parsedSelector = injectedScript.parseSelector(selector);\n    const node = injectedScript.querySelector(parsedSelector, targetElement.ownerDocument, false);\n    return node === targetElement ? selector : void 0;\n  }\n  function makeStrict(selector) {\n    const token = { engine: "css", selector, score: kFallbackScore };\n    if (!strict)\n      return [token];\n    const parsedSelector = injectedScript.parseSelector(selector);\n    const elements = injectedScript.querySelectorAll(parsedSelector, targetElement.ownerDocument);\n    if (elements.length === 1)\n      return [token];\n    const nth = { engine: "nth", selector: String(elements.indexOf(targetElement)), score: kNthScore };\n    return [token, nth];\n  }\n  for (let element = targetElement; element && element !== root; element = parentElementOrShadowHost(element)) {\n    const nodeName = element.nodeName.toLowerCase();\n    let bestTokenForLevel = "";\n    if (element.id) {\n      const token = makeSelectorForId(element.id);\n      const selector = uniqueCSSSelector(token);\n      if (selector)\n        return makeStrict(selector);\n      bestTokenForLevel = token;\n    }\n    const parent = element.parentNode;\n    const classes = [...element.classList];\n    for (let i = 0; i < classes.length; ++i) {\n      const token = "." + classes.slice(0, i + 1).join(".");\n      const selector = uniqueCSSSelector(token);\n      if (selector)\n        return makeStrict(selector);\n      if (!bestTokenForLevel && parent) {\n        const sameClassSiblings = parent.querySelectorAll(token);\n        if (sameClassSiblings.length === 1)\n          bestTokenForLevel = token;\n      }\n    }\n    if (parent) {\n      const siblings = [...parent.children];\n      const sameTagSiblings = siblings.filter((sibling) => sibling.nodeName.toLowerCase() === nodeName);\n      const token = sameTagSiblings.indexOf(element) === 0 ? cssEscape(nodeName) : `${cssEscape(nodeName)}:nth-child(${1 + siblings.indexOf(element)})`;\n      const selector = uniqueCSSSelector(token);\n      if (selector)\n        return makeStrict(selector);\n      if (!bestTokenForLevel)\n        bestTokenForLevel = token;\n    } else if (!bestTokenForLevel) {\n      bestTokenForLevel = nodeName;\n    }\n    tokens.unshift(bestTokenForLevel);\n  }\n  return makeStrict(uniqueCSSSelector());\n}\nfunction escapeForRegex(text) {\n  return text.replace(/[.*+?^>${}()|[\\]\\\\]/g, "\\\\$&");\n}\nfunction quoteAttributeValue(text) {\n  return `"${cssEscape(text).replace(/\\\\ /g, " ")}"`;\n}\nfunction joinTokens(tokens) {\n  const parts = [];\n  let lastEngine = "";\n  for (const { engine, selector } of tokens) {\n    if (parts.length && (lastEngine !== "css" || engine !== "css" || selector.startsWith(":nth-match(")))\n      parts.push(">>");\n    lastEngine = engine;\n    if (engine === "css")\n      parts.push(selector);\n    else\n      parts.push(`${engine}=${selector}`);\n  }\n  return parts.join(" ");\n}\nfunction combineScores(tokens) {\n  let score = 0;\n  for (let i = 0; i < tokens.length; i++)\n    score += tokens[i].score * (tokens.length - i);\n  return score;\n}\nfunction chooseFirstSelector(injectedScript, scope, targetElement, selectors, allowNthMatch, strict) {\n  const joined = selectors.map((tokens) => ({ tokens, score: combineScores(tokens) }));\n  joined.sort((a, b) => a.score - b.score);\n  let bestWithIndex = null;\n  for (const { tokens } of joined) {\n    const parsedSelector = injectedScript.parseSelector(joinTokens(tokens));\n    const result = injectedScript.querySelectorAll(parsedSelector, scope);\n    const isStrictEnough = !strict || result.length === 1;\n    const index = result.indexOf(targetElement);\n    if (index === 0 && isStrictEnough) {\n      return tokens;\n    }\n    if (!allowNthMatch || bestWithIndex || index === -1 || result.length > 5)\n      continue;\n    const nth = { engine: "nth", selector: String(index), score: kNthScore };\n    bestWithIndex = [...tokens, nth];\n  }\n  return bestWithIndex;\n}\nfunction isGuidLike(id) {\n  let lastCharacterType;\n  let transitionCount = 0;\n  for (let i = 0; i < id.length; ++i) {\n    const c = id[i];\n    let characterType;\n    if (c === "-" || c === "_")\n      continue;\n    if (c >= "a" && c <= "z")\n      characterType = "lower";\n    else if (c >= "A" && c <= "Z")\n      characterType = "upper";\n    else if (c >= "0" && c <= "9")\n      characterType = "digit";\n    else\n      characterType = "other";\n    if (characterType === "lower" && lastCharacterType === "upper") {\n      lastCharacterType = characterType;\n      continue;\n    }\n    if (lastCharacterType && lastCharacterType !== characterType)\n      ++transitionCount;\n    lastCharacterType = characterType;\n  }\n  return transitionCount >= id.length / 4;\n}\nfunction cssEscape(s) {\n  let result = "";\n  for (let i = 0; i < s.length; i++)\n    result += cssEscapeOne(s, i);\n  return result;\n}\nfunction cssEscapeOne(s, i) {\n  const c = s.charCodeAt(i);\n  if (c === 0)\n    return "\\uFFFD";\n  if (c >= 1 && c <= 31 || c >= 48 && c <= 57 && (i === 0 || i === 1 && s.charCodeAt(0) === 45))\n    return "\\\\" + c.toString(16) + " ";\n  if (i === 0 && c === 45 && s.length === 1)\n    return "\\\\" + s.charAt(i);\n  if (c >= 128 || c === 45 || c === 95 || c >= 48 && c <= 57 || c >= 65 && c <= 90 || c >= 97 && c <= 122)\n    return s.charAt(i);\n  return "\\\\" + s.charAt(i);\n}\n\n// packages/playwright-core/src/server/injected/highlight.ts\nvar Highlight = class {\n  constructor(isUnderTest) {\n    this._highlightElements = [];\n    this._isUnderTest = isUnderTest;\n    this._outerGlassPaneElement = document.createElement("x-pw-glass");\n    this._outerGlassPaneElement.style.position = "fixed";\n    this._outerGlassPaneElement.style.top = "0";\n    this._outerGlassPaneElement.style.right = "0";\n    this._outerGlassPaneElement.style.bottom = "0";\n    this._outerGlassPaneElement.style.left = "0";\n    this._outerGlassPaneElement.style.zIndex = "2147483647";\n    this._outerGlassPaneElement.style.pointerEvents = "none";\n    this._outerGlassPaneElement.style.display = "flex";\n    this._tooltipElement = document.createElement("x-pw-tooltip");\n    this._actionPointElement = document.createElement("x-pw-action-point");\n    this._actionPointElement.setAttribute("hidden", "true");\n    this._innerGlassPaneElement = document.createElement("x-pw-glass-inner");\n    this._innerGlassPaneElement.style.flex = "auto";\n    this._innerGlassPaneElement.appendChild(this._tooltipElement);\n    this._glassPaneShadow = this._outerGlassPaneElement.attachShadow({ mode: isUnderTest ? "open" : "closed" });\n    this._glassPaneShadow.appendChild(this._innerGlassPaneElement);\n    this._glassPaneShadow.appendChild(this._actionPointElement);\n    const styleElement = document.createElement("style");\n    styleElement.textContent = `\n        x-pw-tooltip {\n          align-items: center;\n          backdrop-filter: blur(5px);\n          background-color: rgba(0, 0, 0, 0.7);\n          border-radius: 2px;\n          box-shadow: rgba(0, 0, 0, 0.1) 0px 3.6px 3.7px,\n                      rgba(0, 0, 0, 0.15) 0px 12.1px 12.3px,\n                      rgba(0, 0, 0, 0.1) 0px -2px 4px,\n                      rgba(0, 0, 0, 0.15) 0px -12.1px 24px,\n                      rgba(0, 0, 0, 0.25) 0px 54px 55px;\n          color: rgb(204, 204, 204);\n          display: none;\n          font-family: \'Dank Mono\', \'Operator Mono\', Inconsolata, \'Fira Mono\',\n                      \'SF Mono\', Monaco, \'Droid Sans Mono\', \'Source Code Pro\', monospace;\n          font-size: 12.8px;\n          font-weight: normal;\n          left: 0;\n          line-height: 1.5;\n          max-width: 600px;\n          padding: 3.2px 5.12px 3.2px;\n          position: absolute;\n          top: 0;\n        }\n        x-pw-action-point {\n          position: absolute;\n          width: 20px;\n          height: 20px;\n          background: red;\n          border-radius: 10px;\n          pointer-events: none;\n          margin: -10px 0 0 -10px;\n          z-index: 2;\n        }\n        *[hidden] {\n          display: none !important;\n        }\n    `;\n    this._glassPaneShadow.appendChild(styleElement);\n  }\n  install() {\n    document.documentElement.appendChild(this._outerGlassPaneElement);\n  }\n  uninstall() {\n    this._outerGlassPaneElement.remove();\n  }\n  isInstalled() {\n    return this._outerGlassPaneElement.parentElement === document.documentElement && !this._outerGlassPaneElement.nextElementSibling;\n  }\n  showActionPoint(x, y) {\n    this._actionPointElement.style.top = y + "px";\n    this._actionPointElement.style.left = x + "px";\n    this._actionPointElement.hidden = false;\n    if (this._isUnderTest)\n      console.error("Action point for test: " + JSON.stringify({ x, y }));\n  }\n  hideActionPoint() {\n    this._actionPointElement.hidden = true;\n  }\n  updateHighlight(elements, selector, isRecording) {\n    this._tooltipElement.textContent = selector;\n    this._tooltipElement.style.top = "0";\n    this._tooltipElement.style.left = "0";\n    this._tooltipElement.style.display = "flex";\n    const boxes = elements.map((e) => e.getBoundingClientRect());\n    const tooltipWidth = this._tooltipElement.offsetWidth;\n    const tooltipHeight = this._tooltipElement.offsetHeight;\n    const totalWidth = this._innerGlassPaneElement.offsetWidth;\n    const totalHeight = this._innerGlassPaneElement.offsetHeight;\n    if (boxes.length) {\n      const primaryBox = boxes[0];\n      let anchorLeft = primaryBox.left;\n      if (anchorLeft + tooltipWidth > totalWidth - 5)\n        anchorLeft = totalWidth - tooltipWidth - 5;\n      let anchorTop = primaryBox.bottom + 5;\n      if (anchorTop + tooltipHeight > totalHeight - 5) {\n        if (primaryBox.top > tooltipHeight + 5) {\n          anchorTop = primaryBox.top - tooltipHeight - 5;\n        } else {\n          anchorTop = totalHeight - 5 - tooltipHeight;\n        }\n      }\n      this._tooltipElement.style.top = anchorTop + "px";\n      this._tooltipElement.style.left = anchorLeft + "px";\n    } else {\n      this._tooltipElement.style.display = "none";\n    }\n    const pool = this._highlightElements;\n    this._highlightElements = [];\n    for (const box of boxes) {\n      const highlightElement = pool.length ? pool.shift() : this._createHighlightElement();\n      const color = isRecording ? "#dc6f6f7f" : "#6fa8dc7f";\n      highlightElement.style.backgroundColor = this._highlightElements.length ? "#f6b26b7f" : color;\n      highlightElement.style.left = box.x + "px";\n      highlightElement.style.top = box.y + "px";\n      highlightElement.style.width = box.width + "px";\n      highlightElement.style.height = box.height + "px";\n      highlightElement.style.display = "block";\n      this._highlightElements.push(highlightElement);\n      if (this._isUnderTest)\n        console.error("Highlight box for test: " + JSON.stringify({ x: box.x, y: box.y, width: box.width, height: box.height }));\n    }\n    for (const highlightElement of pool) {\n      highlightElement.style.display = "none";\n      this._highlightElements.push(highlightElement);\n    }\n  }\n  maskElements(elements) {\n    const boxes = elements.map((e) => e.getBoundingClientRect());\n    const pool = this._highlightElements;\n    this._highlightElements = [];\n    for (const box of boxes) {\n      const highlightElement = pool.length ? pool.shift() : this._createHighlightElement();\n      highlightElement.style.backgroundColor = "#F0F";\n      highlightElement.style.left = box.x + "px";\n      highlightElement.style.top = box.y + "px";\n      highlightElement.style.width = box.width + "px";\n      highlightElement.style.height = box.height + "px";\n      highlightElement.style.display = "block";\n      this._highlightElements.push(highlightElement);\n    }\n    for (const highlightElement of pool) {\n      highlightElement.style.display = "none";\n      this._highlightElements.push(highlightElement);\n    }\n  }\n  _createHighlightElement() {\n    const highlightElement = document.createElement("x-pw-highlight");\n    highlightElement.style.position = "absolute";\n    highlightElement.style.top = "0";\n    highlightElement.style.left = "0";\n    highlightElement.style.width = "0";\n    highlightElement.style.height = "0";\n    highlightElement.style.boxSizing = "border-box";\n    this._glassPaneShadow.appendChild(highlightElement);\n    return highlightElement;\n  }\n};\n\n// packages/playwright-core/src/server/injected/recorder.ts\nvar Recorder = class {\n  constructor(injectedScript) {\n    this._performingAction = false;\n    this._listeners = [];\n    this._hoveredModel = null;\n    this._hoveredElement = null;\n    this._activeModel = null;\n    this._expectProgrammaticKeyUp = false;\n    this._mode = "none";\n    this._injectedScript = injectedScript;\n    this._highlight = new Highlight(injectedScript.isUnderTest);\n    this._refreshListenersIfNeeded();\n    injectedScript.onGlobalListenersRemoved.add(() => this._refreshListenersIfNeeded());\n    globalThis._playwrightRefreshOverlay = () => {\n      this._pollRecorderMode().catch((e) => console.log(e));\n    };\n    globalThis._playwrightRefreshOverlay();\n    if (injectedScript.isUnderTest)\n      console.error("Recorder script ready for test");\n  }\n  _refreshListenersIfNeeded() {\n    if (this._highlight.isInstalled())\n      return;\n    removeEventListeners(this._listeners);\n    this._listeners = [\n      addEventListener(document, "click", (event) => this._onClick(event), true),\n      addEventListener(document, "auxclick", (event) => this._onClick(event), true),\n      addEventListener(document, "input", (event) => this._onInput(event), true),\n      addEventListener(document, "keydown", (event) => this._onKeyDown(event), true),\n      addEventListener(document, "keyup", (event) => this._onKeyUp(event), true),\n      addEventListener(document, "mousedown", (event) => this._onMouseDown(event), true),\n      addEventListener(document, "mouseup", (event) => this._onMouseUp(event), true),\n      addEventListener(document, "mousemove", (event) => this._onMouseMove(event), true),\n      addEventListener(document, "mouseleave", (event) => this._onMouseLeave(event), true),\n      addEventListener(document, "focus", () => this._onFocus(), true),\n      addEventListener(document, "scroll", () => {\n        this._hoveredModel = null;\n        this._highlight.hideActionPoint();\n        this._updateHighlight();\n      }, true)\n    ];\n    this._highlight.install();\n  }\n  async _pollRecorderMode() {\n    var _a;\n    const pollPeriod = 1e3;\n    if (this._pollRecorderModeTimer)\n      clearTimeout(this._pollRecorderModeTimer);\n    const state = await globalThis._playwrightRecorderState().catch((e) => null);\n    if (!state) {\n      this._pollRecorderModeTimer = setTimeout(() => this._pollRecorderMode(), pollPeriod);\n      return;\n    }\n    const { mode, actionPoint, actionSelector } = state;\n    if (mode !== this._mode) {\n      this._mode = mode;\n      this._clearHighlight();\n    }\n    if (actionPoint && this._actionPoint && actionPoint.x === this._actionPoint.x && actionPoint.y === this._actionPoint.y) {\n    } else if (!actionPoint && !this._actionPoint) {\n    } else {\n      if (actionPoint)\n        this._highlight.showActionPoint(actionPoint.x, actionPoint.y);\n      else\n        this._highlight.hideActionPoint();\n      this._actionPoint = actionPoint;\n    }\n    if (this._actionSelector && !((_a = this._hoveredModel) == null ? void 0 : _a.elements.length))\n      this._actionSelector = void 0;\n    if (actionSelector !== this._actionSelector) {\n      this._hoveredModel = actionSelector ? querySelector(this._injectedScript, actionSelector, document) : null;\n      this._updateHighlight();\n      this._actionSelector = actionSelector;\n    }\n    this._pollRecorderModeTimer = setTimeout(() => this._pollRecorderMode(), pollPeriod);\n  }\n  _clearHighlight() {\n    this._hoveredModel = null;\n    this._activeModel = null;\n    this._updateHighlight();\n  }\n  _actionInProgress(event) {\n    if (this._performingAction)\n      return true;\n    consumeEvent(event);\n    return false;\n  }\n  _consumedDueToNoModel(event, model) {\n    if (model)\n      return false;\n    consumeEvent(event);\n    return true;\n  }\n  _consumedDueWrongTarget(event) {\n    if (this._activeModel && this._activeModel.elements[0] === this._deepEventTarget(event))\n      return false;\n    consumeEvent(event);\n    return true;\n  }\n  _onClick(event) {\n    if (this._mode === "inspecting")\n      globalThis._playwrightRecorderSetSelector(this._hoveredModel ? this._hoveredModel.selector : "");\n    if (this._shouldIgnoreMouseEvent(event))\n      return;\n    if (this._actionInProgress(event))\n      return;\n    if (this._consumedDueToNoModel(event, this._hoveredModel))\n      return;\n    const checkbox = asCheckbox(this._deepEventTarget(event));\n    if (checkbox) {\n      this._performAction({\n        name: checkbox.checked ? "check" : "uncheck",\n        selector: this._hoveredModel.selector,\n        signals: []\n      });\n      return;\n    }\n    this._performAction({\n      name: "click",\n      selector: this._hoveredModel.selector,\n      position: positionForEvent(event),\n      signals: [],\n      button: buttonForEvent(event),\n      modifiers: modifiersForEvent(event),\n      clickCount: event.detail\n    });\n  }\n  _shouldIgnoreMouseEvent(event) {\n    const target = this._deepEventTarget(event);\n    if (this._mode === "none")\n      return true;\n    if (this._mode === "inspecting") {\n      consumeEvent(event);\n      return true;\n    }\n    const nodeName = target.nodeName;\n    if (nodeName === "SELECT")\n      return true;\n    if (nodeName === "INPUT" && ["date"].includes(target.type))\n      return true;\n    return false;\n  }\n  _onMouseDown(event) {\n    if (this._shouldIgnoreMouseEvent(event))\n      return;\n    if (!this._performingAction)\n      consumeEvent(event);\n    this._activeModel = this._hoveredModel;\n  }\n  _onMouseUp(event) {\n    if (this._shouldIgnoreMouseEvent(event))\n      return;\n    if (!this._performingAction)\n      consumeEvent(event);\n  }\n  _onMouseMove(event) {\n    if (this._mode === "none")\n      return;\n    const target = this._deepEventTarget(event);\n    if (this._hoveredElement === target)\n      return;\n    this._hoveredElement = target;\n    this._updateModelForHoveredElement();\n  }\n  _onMouseLeave(event) {\n    if (this._deepEventTarget(event).nodeType === Node.DOCUMENT_NODE) {\n      this._hoveredElement = null;\n      this._updateModelForHoveredElement();\n    }\n  }\n  _onFocus() {\n    const activeElement = this._deepActiveElement(document);\n    const result = activeElement ? generateSelector(this._injectedScript, activeElement, true) : null;\n    this._activeModel = result && result.selector ? result : null;\n    if (this._injectedScript.isUnderTest)\n      console.error("Highlight updated for test: " + (result ? result.selector : null));\n  }\n  _updateModelForHoveredElement() {\n    if (!this._hoveredElement) {\n      this._hoveredModel = null;\n      this._updateHighlight();\n      return;\n    }\n    const hoveredElement = this._hoveredElement;\n    const { selector, elements } = generateSelector(this._injectedScript, hoveredElement, true);\n    if (this._hoveredModel && this._hoveredModel.selector === selector || this._hoveredElement !== hoveredElement)\n      return;\n    this._hoveredModel = selector ? { selector, elements } : null;\n    this._updateHighlight();\n    if (this._injectedScript.isUnderTest)\n      console.error("Highlight updated for test: " + selector);\n  }\n  _updateHighlight() {\n    const elements = this._hoveredModel ? this._hoveredModel.elements : [];\n    const selector = this._hoveredModel ? this._hoveredModel.selector : "";\n    this._highlight.updateHighlight(elements, selector, this._mode === "recording");\n  }\n  _onInput(event) {\n    if (this._mode !== "recording")\n      return true;\n    const target = this._deepEventTarget(event);\n    if (["INPUT", "TEXTAREA"].includes(target.nodeName)) {\n      const inputElement = target;\n      const elementType = (inputElement.type || "").toLowerCase();\n      if (["checkbox", "radio"].includes(elementType)) {\n        return;\n      }\n      if (elementType === "file") {\n        globalThis._playwrightRecorderRecordAction({\n          name: "setInputFiles",\n          selector: this._activeModel.selector,\n          signals: [],\n          files: [...inputElement.files || []].map((file) => file.name)\n        });\n        return;\n      }\n      if (this._consumedDueWrongTarget(event))\n        return;\n      globalThis._playwrightRecorderRecordAction({\n        name: "fill",\n        selector: this._activeModel.selector,\n        signals: [],\n        text: inputElement.value\n      });\n    }\n    if (target.nodeName === "SELECT") {\n      const selectElement = target;\n      if (this._actionInProgress(event))\n        return;\n      this._performAction({\n        name: "select",\n        selector: this._hoveredModel.selector,\n        options: [...selectElement.selectedOptions].map((option) => option.value),\n        signals: []\n      });\n    }\n  }\n  _shouldGenerateKeyPressFor(event) {\n    if (["Backspace", "Delete", "AltGraph"].includes(event.key))\n      return false;\n    if (event.key === "@" && event.code === "KeyL")\n      return false;\n    if (navigator.platform.includes("Mac")) {\n      if (event.key === "v" && event.metaKey)\n        return false;\n    } else {\n      if (event.key === "v" && event.ctrlKey)\n        return false;\n      if (event.key === "Insert" && event.shiftKey)\n        return false;\n    }\n    if (["Shift", "Control", "Meta", "Alt"].includes(event.key))\n      return false;\n    const hasModifier = event.ctrlKey || event.altKey || event.metaKey;\n    if (event.key.length === 1 && !hasModifier)\n      return !!asCheckbox(this._deepEventTarget(event));\n    return true;\n  }\n  _onKeyDown(event) {\n    if (this._mode === "inspecting") {\n      consumeEvent(event);\n      return;\n    }\n    if (this._mode !== "recording")\n      return;\n    if (!this._shouldGenerateKeyPressFor(event))\n      return;\n    if (this._actionInProgress(event)) {\n      this._expectProgrammaticKeyUp = true;\n      return;\n    }\n    if (this._consumedDueWrongTarget(event))\n      return;\n    if (event.key === " ") {\n      const checkbox = asCheckbox(this._deepEventTarget(event));\n      if (checkbox) {\n        this._performAction({\n          name: checkbox.checked ? "uncheck" : "check",\n          selector: this._activeModel.selector,\n          signals: []\n        });\n        return;\n      }\n    }\n    this._performAction({\n      name: "press",\n      selector: this._activeModel.selector,\n      signals: [],\n      key: event.key,\n      modifiers: modifiersForEvent(event)\n    });\n  }\n  _onKeyUp(event) {\n    if (this._mode === "none")\n      return;\n    if (!this._shouldGenerateKeyPressFor(event))\n      return;\n    if (!this._expectProgrammaticKeyUp) {\n      consumeEvent(event);\n      return;\n    }\n    this._expectProgrammaticKeyUp = false;\n  }\n  async _performAction(action) {\n    this._clearHighlight();\n    this._performingAction = true;\n    await globalThis._playwrightRecorderPerformAction(action).catch(() => {\n    });\n    this._performingAction = false;\n    this._updateModelForHoveredElement();\n    this._onFocus();\n    if (this._injectedScript.isUnderTest) {\n      console.error("Action performed for test: " + JSON.stringify({\n        hovered: this._hoveredModel ? this._hoveredModel.selector : null,\n        active: this._activeModel ? this._activeModel.selector : null\n      }));\n    }\n  }\n  _deepEventTarget(event) {\n    return event.composedPath()[0];\n  }\n  _deepActiveElement(document2) {\n    let activeElement = document2.activeElement;\n    while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\n      activeElement = activeElement.shadowRoot.activeElement;\n    return activeElement;\n  }\n};\nfunction modifiersForEvent(event) {\n  return (event.altKey ? 1 : 0) | (event.ctrlKey ? 2 : 0) | (event.metaKey ? 4 : 0) | (event.shiftKey ? 8 : 0);\n}\nfunction buttonForEvent(event) {\n  switch (event.which) {\n    case 1:\n      return "left";\n    case 2:\n      return "middle";\n    case 3:\n      return "right";\n  }\n  return "left";\n}\nfunction positionForEvent(event) {\n  const targetElement = event.target;\n  if (targetElement.nodeName !== "CANVAS")\n    return;\n  return {\n    x: event.offsetX,\n    y: event.offsetY\n  };\n}\nfunction consumeEvent(e) {\n  e.preventDefault();\n  e.stopPropagation();\n  e.stopImmediatePropagation();\n}\nfunction asCheckbox(node) {\n  if (!node || node.nodeName !== "INPUT")\n    return null;\n  const inputElement = node;\n  return ["checkbox", "radio"].includes(inputElement.type) ? inputElement : null;\n}\nfunction addEventListener(target, eventName, listener, useCapture) {\n  target.addEventListener(eventName, listener, useCapture);\n  const remove = () => {\n    target.removeEventListener(eventName, listener, useCapture);\n  };\n  return remove;\n}\nfunction removeEventListeners(listeners) {\n  for (const listener of listeners)\n    listener();\n  listeners.splice(0, listeners.length);\n}\nmodule.exports = Recorder;\n';var im={};Object.defineProperty(im,"__esModule",{value:!0}),im.source=void 0;im.source='var __create = Object.create;\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __getProtoOf = Object.getPrototypeOf;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __commonJS = (cb, mod) => function __require() {\n  return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === "object" || typeof from === "function") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target, mod));\n\n// packages/playwright-core/src/server/isomorphic/cssTokenizer.js\nvar require_cssTokenizer = __commonJS({\n  "packages/playwright-core/src/server/isomorphic/cssTokenizer.js"(exports2) {\n    (function(root, factory) {\n      if (typeof define === "function" && define.amd) {\n        define(["exports"], factory);\n      } else if (typeof exports2 !== "undefined") {\n        factory(exports2);\n      } else {\n        factory(root);\n      }\n    })(exports2, function(exports3) {\n      var between = function(num, first, last) {\n        return num >= first && num <= last;\n      };\n      function digit(code) {\n        return between(code, 48, 57);\n      }\n      function hexdigit(code) {\n        return digit(code) || between(code, 65, 70) || between(code, 97, 102);\n      }\n      function uppercaseletter(code) {\n        return between(code, 65, 90);\n      }\n      function lowercaseletter(code) {\n        return between(code, 97, 122);\n      }\n      function letter(code) {\n        return uppercaseletter(code) || lowercaseletter(code);\n      }\n      function nonascii(code) {\n        return code >= 128;\n      }\n      function namestartchar(code) {\n        return letter(code) || nonascii(code) || code == 95;\n      }\n      function namechar(code) {\n        return namestartchar(code) || digit(code) || code == 45;\n      }\n      function nonprintable(code) {\n        return between(code, 0, 8) || code == 11 || between(code, 14, 31) || code == 127;\n      }\n      function newline(code) {\n        return code == 10;\n      }\n      function whitespace(code) {\n        return newline(code) || code == 9 || code == 32;\n      }\n      function badescape(code) {\n        return newline(code) || isNaN(code);\n      }\n      var maximumallowedcodepoint = 1114111;\n      var InvalidCharacterError = function(message) {\n        this.message = message;\n      };\n      InvalidCharacterError.prototype = new Error();\n      InvalidCharacterError.prototype.name = "InvalidCharacterError";\n      function preprocess(str) {\n        var codepoints = [];\n        for (var i = 0; i < str.length; i++) {\n          var code = str.charCodeAt(i);\n          if (code == 13 && str.charCodeAt(i + 1) == 10) {\n            code = 10;\n            i++;\n          }\n          if (code == 13 || code == 12)\n            code = 10;\n          if (code == 0)\n            code = 65533;\n          if (between(code, 55296, 56319) && between(str.charCodeAt(i + 1), 56320, 57343)) {\n            var lead = code - 55296;\n            var trail = str.charCodeAt(i + 1) - 56320;\n            code = Math.pow(2, 16) + lead * Math.pow(2, 10) + trail;\n            i++;\n          }\n          codepoints.push(code);\n        }\n        return codepoints;\n      }\n      function stringFromCode(code) {\n        if (code <= 65535)\n          return String.fromCharCode(code);\n        code -= Math.pow(2, 16);\n        var lead = Math.floor(code / Math.pow(2, 10)) + 55296;\n        var trail = code % Math.pow(2, 10) + 56320;\n        return String.fromCharCode(lead) + String.fromCharCode(trail);\n      }\n      function tokenize2(str) {\n        str = preprocess(str);\n        var i = -1;\n        var tokens = [];\n        var code;\n        var line = 0;\n        var column = 0;\n        var lastLineLength = 0;\n        var incrLineno = function() {\n          line += 1;\n          lastLineLength = column;\n          column = 0;\n        };\n        var locStart = { line, column };\n        var codepoint = function(i2) {\n          if (i2 >= str.length) {\n            return -1;\n          }\n          return str[i2];\n        };\n        var next = function(num) {\n          if (num === void 0)\n            num = 1;\n          if (num > 3)\n            throw "Spec Error: no more than three codepoints of lookahead.";\n          return codepoint(i + num);\n        };\n        var consume = function(num) {\n          if (num === void 0)\n            num = 1;\n          i += num;\n          code = codepoint(i);\n          if (newline(code))\n            incrLineno();\n          else\n            column += num;\n          return true;\n        };\n        var reconsume = function() {\n          i -= 1;\n          if (newline(code)) {\n            line -= 1;\n            column = lastLineLength;\n          } else {\n            column -= 1;\n          }\n          locStart.line = line;\n          locStart.column = column;\n          return true;\n        };\n        var eof = function(codepoint2) {\n          if (codepoint2 === void 0)\n            codepoint2 = code;\n          return codepoint2 == -1;\n        };\n        var donothing = function() {\n        };\n        var parseerror = function() {\n          console.log("Parse error at index " + i + ", processing codepoint 0x" + code.toString(16) + ".");\n          return true;\n        };\n        var consumeAToken = function() {\n          consumeComments();\n          consume();\n          if (whitespace(code)) {\n            while (whitespace(next()))\n              consume();\n            return new WhitespaceToken2();\n          } else if (code == 34)\n            return consumeAStringToken();\n          else if (code == 35) {\n            if (namechar(next()) || areAValidEscape(next(1), next(2))) {\n              var token = new HashToken2();\n              if (wouldStartAnIdentifier(next(1), next(2), next(3)))\n                token.type = "id";\n              token.value = consumeAName();\n              return token;\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 36) {\n            if (next() == 61) {\n              consume();\n              return new SuffixMatchToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 39)\n            return consumeAStringToken();\n          else if (code == 40)\n            return new OpenParenToken();\n          else if (code == 41)\n            return new CloseParenToken2();\n          else if (code == 42) {\n            if (next() == 61) {\n              consume();\n              return new SubstringMatchToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 43) {\n            if (startsWithANumber()) {\n              reconsume();\n              return consumeANumericToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 44)\n            return new CommaToken2();\n          else if (code == 45) {\n            if (startsWithANumber()) {\n              reconsume();\n              return consumeANumericToken();\n            } else if (next(1) == 45 && next(2) == 62) {\n              consume(2);\n              return new CDCToken2();\n            } else if (startsWithAnIdentifier()) {\n              reconsume();\n              return consumeAnIdentlikeToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 46) {\n            if (startsWithANumber()) {\n              reconsume();\n              return consumeANumericToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 58)\n            return new ColonToken2();\n          else if (code == 59)\n            return new SemicolonToken2();\n          else if (code == 60) {\n            if (next(1) == 33 && next(2) == 45 && next(3) == 45) {\n              consume(3);\n              return new CDOToken2();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 64) {\n            if (wouldStartAnIdentifier(next(1), next(2), next(3))) {\n              return new AtKeywordToken2(consumeAName());\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 91)\n            return new OpenSquareToken2();\n          else if (code == 92) {\n            if (startsWithAValidEscape()) {\n              reconsume();\n              return consumeAnIdentlikeToken();\n            } else {\n              parseerror();\n              return new DelimToken2(code);\n            }\n          } else if (code == 93)\n            return new CloseSquareToken2();\n          else if (code == 94) {\n            if (next() == 61) {\n              consume();\n              return new PrefixMatchToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 123)\n            return new OpenCurlyToken2();\n          else if (code == 124) {\n            if (next() == 61) {\n              consume();\n              return new DashMatchToken();\n            } else if (next() == 124) {\n              consume();\n              return new ColumnToken2();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (code == 125)\n            return new CloseCurlyToken2();\n          else if (code == 126) {\n            if (next() == 61) {\n              consume();\n              return new IncludeMatchToken();\n            } else {\n              return new DelimToken2(code);\n            }\n          } else if (digit(code)) {\n            reconsume();\n            return consumeANumericToken();\n          } else if (namestartchar(code)) {\n            reconsume();\n            return consumeAnIdentlikeToken();\n          } else if (eof())\n            return new EOFToken2();\n          else\n            return new DelimToken2(code);\n        };\n        var consumeComments = function() {\n          while (next(1) == 47 && next(2) == 42) {\n            consume(2);\n            while (true) {\n              consume();\n              if (code == 42 && next() == 47) {\n                consume();\n                break;\n              } else if (eof()) {\n                parseerror();\n                return;\n              }\n            }\n          }\n        };\n        var consumeANumericToken = function() {\n          var num = consumeANumber();\n          if (wouldStartAnIdentifier(next(1), next(2), next(3))) {\n            var token = new DimensionToken();\n            token.value = num.value;\n            token.repr = num.repr;\n            token.type = num.type;\n            token.unit = consumeAName();\n            return token;\n          } else if (next() == 37) {\n            consume();\n            var token = new PercentageToken2();\n            token.value = num.value;\n            token.repr = num.repr;\n            return token;\n          } else {\n            var token = new NumberToken2();\n            token.value = num.value;\n            token.repr = num.repr;\n            token.type = num.type;\n            return token;\n          }\n        };\n        var consumeAnIdentlikeToken = function() {\n          var str2 = consumeAName();\n          if (str2.toLowerCase() == "url" && next() == 40) {\n            consume();\n            while (whitespace(next(1)) && whitespace(next(2)))\n              consume();\n            if (next() == 34 || next() == 39) {\n              return new FunctionToken2(str2);\n            } else if (whitespace(next()) && (next(2) == 34 || next(2) == 39)) {\n              return new FunctionToken2(str2);\n            } else {\n              return consumeAURLToken();\n            }\n          } else if (next() == 40) {\n            consume();\n            return new FunctionToken2(str2);\n          } else {\n            return new IdentToken2(str2);\n          }\n        };\n        var consumeAStringToken = function(endingCodePoint) {\n          if (endingCodePoint === void 0)\n            endingCodePoint = code;\n          var string = "";\n          while (consume()) {\n            if (code == endingCodePoint || eof()) {\n              return new StringToken2(string);\n            } else if (newline(code)) {\n              parseerror();\n              reconsume();\n              return new BadStringToken2();\n            } else if (code == 92) {\n              if (eof(next())) {\n                donothing();\n              } else if (newline(next())) {\n                consume();\n              } else {\n                string += stringFromCode(consumeEscape());\n              }\n            } else {\n              string += stringFromCode(code);\n            }\n          }\n        };\n        var consumeAURLToken = function() {\n          var token = new URLToken2("");\n          while (whitespace(next()))\n            consume();\n          if (eof(next()))\n            return token;\n          while (consume()) {\n            if (code == 41 || eof()) {\n              return token;\n            } else if (whitespace(code)) {\n              while (whitespace(next()))\n                consume();\n              if (next() == 41 || eof(next())) {\n                consume();\n                return token;\n              } else {\n                consumeTheRemnantsOfABadURL();\n                return new BadURLToken2();\n              }\n            } else if (code == 34 || code == 39 || code == 40 || nonprintable(code)) {\n              parseerror();\n              consumeTheRemnantsOfABadURL();\n              return new BadURLToken2();\n            } else if (code == 92) {\n              if (startsWithAValidEscape()) {\n                token.value += stringFromCode(consumeEscape());\n              } else {\n                parseerror();\n                consumeTheRemnantsOfABadURL();\n                return new BadURLToken2();\n              }\n            } else {\n              token.value += stringFromCode(code);\n            }\n          }\n        };\n        var consumeEscape = function() {\n          consume();\n          if (hexdigit(code)) {\n            var digits = [code];\n            for (var total = 0; total < 5; total++) {\n              if (hexdigit(next())) {\n                consume();\n                digits.push(code);\n              } else {\n                break;\n              }\n            }\n            if (whitespace(next()))\n              consume();\n            var value = parseInt(digits.map(function(x) {\n              return String.fromCharCode(x);\n            }).join(""), 16);\n            if (value > maximumallowedcodepoint)\n              value = 65533;\n            return value;\n          } else if (eof()) {\n            return 65533;\n          } else {\n            return code;\n          }\n        };\n        var areAValidEscape = function(c1, c2) {\n          if (c1 != 92)\n            return false;\n          if (newline(c2))\n            return false;\n          return true;\n        };\n        var startsWithAValidEscape = function() {\n          return areAValidEscape(code, next());\n        };\n        var wouldStartAnIdentifier = function(c1, c2, c3) {\n          if (c1 == 45) {\n            return namestartchar(c2) || c2 == 45 || areAValidEscape(c2, c3);\n          } else if (namestartchar(c1)) {\n            return true;\n          } else if (c1 == 92) {\n            return areAValidEscape(c1, c2);\n          } else {\n            return false;\n          }\n        };\n        var startsWithAnIdentifier = function() {\n          return wouldStartAnIdentifier(code, next(1), next(2));\n        };\n        var wouldStartANumber = function(c1, c2, c3) {\n          if (c1 == 43 || c1 == 45) {\n            if (digit(c2))\n              return true;\n            if (c2 == 46 && digit(c3))\n              return true;\n            return false;\n          } else if (c1 == 46) {\n            if (digit(c2))\n              return true;\n            return false;\n          } else if (digit(c1)) {\n            return true;\n          } else {\n            return false;\n          }\n        };\n        var startsWithANumber = function() {\n          return wouldStartANumber(code, next(1), next(2));\n        };\n        var consumeAName = function() {\n          var result = "";\n          while (consume()) {\n            if (namechar(code)) {\n              result += stringFromCode(code);\n            } else if (startsWithAValidEscape()) {\n              result += stringFromCode(consumeEscape());\n            } else {\n              reconsume();\n              return result;\n            }\n          }\n        };\n        var consumeANumber = function() {\n          var repr = [];\n          var type = "integer";\n          if (next() == 43 || next() == 45) {\n            consume();\n            repr += stringFromCode(code);\n          }\n          while (digit(next())) {\n            consume();\n            repr += stringFromCode(code);\n          }\n          if (next(1) == 46 && digit(next(2))) {\n            consume();\n            repr += stringFromCode(code);\n            consume();\n            repr += stringFromCode(code);\n            type = "number";\n            while (digit(next())) {\n              consume();\n              repr += stringFromCode(code);\n            }\n          }\n          var c1 = next(1), c2 = next(2), c3 = next(3);\n          if ((c1 == 69 || c1 == 101) && digit(c2)) {\n            consume();\n            repr += stringFromCode(code);\n            consume();\n            repr += stringFromCode(code);\n            type = "number";\n            while (digit(next())) {\n              consume();\n              repr += stringFromCode(code);\n            }\n          } else if ((c1 == 69 || c1 == 101) && (c2 == 43 || c2 == 45) && digit(c3)) {\n            consume();\n            repr += stringFromCode(code);\n            consume();\n            repr += stringFromCode(code);\n            consume();\n            repr += stringFromCode(code);\n            type = "number";\n            while (digit(next())) {\n              consume();\n              repr += stringFromCode(code);\n            }\n          }\n          var value = convertAStringToANumber(repr);\n          return { type, value, repr };\n        };\n        var convertAStringToANumber = function(string) {\n          return +string;\n        };\n        var consumeTheRemnantsOfABadURL = function() {\n          while (consume()) {\n            if (code == 41 || eof()) {\n              return;\n            } else if (startsWithAValidEscape()) {\n              consumeEscape();\n              donothing();\n            } else {\n              donothing();\n            }\n          }\n        };\n        var iterationCount = 0;\n        while (!eof(next())) {\n          tokens.push(consumeAToken());\n          iterationCount++;\n          if (iterationCount > str.length * 2)\n            return "I\'m infinite-looping!";\n        }\n        return tokens;\n      }\n      function CSSParserToken() {\n        throw "Abstract Base Class";\n      }\n      CSSParserToken.prototype.toJSON = function() {\n        return { token: this.tokenType };\n      };\n      CSSParserToken.prototype.toString = function() {\n        return this.tokenType;\n      };\n      CSSParserToken.prototype.toSource = function() {\n        return "" + this;\n      };\n      function BadStringToken2() {\n        return this;\n      }\n      BadStringToken2.prototype = Object.create(CSSParserToken.prototype);\n      BadStringToken2.prototype.tokenType = "BADSTRING";\n      function BadURLToken2() {\n        return this;\n      }\n      BadURLToken2.prototype = Object.create(CSSParserToken.prototype);\n      BadURLToken2.prototype.tokenType = "BADURL";\n      function WhitespaceToken2() {\n        return this;\n      }\n      WhitespaceToken2.prototype = Object.create(CSSParserToken.prototype);\n      WhitespaceToken2.prototype.tokenType = "WHITESPACE";\n      WhitespaceToken2.prototype.toString = function() {\n        return "WS";\n      };\n      WhitespaceToken2.prototype.toSource = function() {\n        return " ";\n      };\n      function CDOToken2() {\n        return this;\n      }\n      CDOToken2.prototype = Object.create(CSSParserToken.prototype);\n      CDOToken2.prototype.tokenType = "CDO";\n      CDOToken2.prototype.toSource = function() {\n        return "\x3c!--";\n      };\n      function CDCToken2() {\n        return this;\n      }\n      CDCToken2.prototype = Object.create(CSSParserToken.prototype);\n      CDCToken2.prototype.tokenType = "CDC";\n      CDCToken2.prototype.toSource = function() {\n        return "--\x3e";\n      };\n      function ColonToken2() {\n        return this;\n      }\n      ColonToken2.prototype = Object.create(CSSParserToken.prototype);\n      ColonToken2.prototype.tokenType = ":";\n      function SemicolonToken2() {\n        return this;\n      }\n      SemicolonToken2.prototype = Object.create(CSSParserToken.prototype);\n      SemicolonToken2.prototype.tokenType = ";";\n      function CommaToken2() {\n        return this;\n      }\n      CommaToken2.prototype = Object.create(CSSParserToken.prototype);\n      CommaToken2.prototype.tokenType = ",";\n      function GroupingToken() {\n        throw "Abstract Base Class";\n      }\n      GroupingToken.prototype = Object.create(CSSParserToken.prototype);\n      function OpenCurlyToken2() {\n        this.value = "{";\n        this.mirror = "}";\n        return this;\n      }\n      OpenCurlyToken2.prototype = Object.create(GroupingToken.prototype);\n      OpenCurlyToken2.prototype.tokenType = "{";\n      function CloseCurlyToken2() {\n        this.value = "}";\n        this.mirror = "{";\n        return this;\n      }\n      CloseCurlyToken2.prototype = Object.create(GroupingToken.prototype);\n      CloseCurlyToken2.prototype.tokenType = "}";\n      function OpenSquareToken2() {\n        this.value = "[";\n        this.mirror = "]";\n        return this;\n      }\n      OpenSquareToken2.prototype = Object.create(GroupingToken.prototype);\n      OpenSquareToken2.prototype.tokenType = "[";\n      function CloseSquareToken2() {\n        this.value = "]";\n        this.mirror = "[";\n        return this;\n      }\n      CloseSquareToken2.prototype = Object.create(GroupingToken.prototype);\n      CloseSquareToken2.prototype.tokenType = "]";\n      function OpenParenToken() {\n        this.value = "(";\n        this.mirror = ")";\n        return this;\n      }\n      OpenParenToken.prototype = Object.create(GroupingToken.prototype);\n      OpenParenToken.prototype.tokenType = "(";\n      function CloseParenToken2() {\n        this.value = ")";\n        this.mirror = "(";\n        return this;\n      }\n      CloseParenToken2.prototype = Object.create(GroupingToken.prototype);\n      CloseParenToken2.prototype.tokenType = ")";\n      function IncludeMatchToken() {\n        return this;\n      }\n      IncludeMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      IncludeMatchToken.prototype.tokenType = "~=";\n      function DashMatchToken() {\n        return this;\n      }\n      DashMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      DashMatchToken.prototype.tokenType = "|=";\n      function PrefixMatchToken() {\n        return this;\n      }\n      PrefixMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      PrefixMatchToken.prototype.tokenType = "^=";\n      function SuffixMatchToken() {\n        return this;\n      }\n      SuffixMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      SuffixMatchToken.prototype.tokenType = "$=";\n      function SubstringMatchToken() {\n        return this;\n      }\n      SubstringMatchToken.prototype = Object.create(CSSParserToken.prototype);\n      SubstringMatchToken.prototype.tokenType = "*=";\n      function ColumnToken2() {\n        return this;\n      }\n      ColumnToken2.prototype = Object.create(CSSParserToken.prototype);\n      ColumnToken2.prototype.tokenType = "||";\n      function EOFToken2() {\n        return this;\n      }\n      EOFToken2.prototype = Object.create(CSSParserToken.prototype);\n      EOFToken2.prototype.tokenType = "EOF";\n      EOFToken2.prototype.toSource = function() {\n        return "";\n      };\n      function DelimToken2(code) {\n        this.value = stringFromCode(code);\n        return this;\n      }\n      DelimToken2.prototype = Object.create(CSSParserToken.prototype);\n      DelimToken2.prototype.tokenType = "DELIM";\n      DelimToken2.prototype.toString = function() {\n        return "DELIM(" + this.value + ")";\n      };\n      DelimToken2.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        return json;\n      };\n      DelimToken2.prototype.toSource = function() {\n        if (this.value == "\\\\")\n          return "\\\\\\n";\n        else\n          return this.value;\n      };\n      function StringValuedToken() {\n        throw "Abstract Base Class";\n      }\n      StringValuedToken.prototype = Object.create(CSSParserToken.prototype);\n      StringValuedToken.prototype.ASCIIMatch = function(str) {\n        return this.value.toLowerCase() == str.toLowerCase();\n      };\n      StringValuedToken.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        return json;\n      };\n      function IdentToken2(val) {\n        this.value = val;\n      }\n      IdentToken2.prototype = Object.create(StringValuedToken.prototype);\n      IdentToken2.prototype.tokenType = "IDENT";\n      IdentToken2.prototype.toString = function() {\n        return "IDENT(" + this.value + ")";\n      };\n      IdentToken2.prototype.toSource = function() {\n        return escapeIdent(this.value);\n      };\n      function FunctionToken2(val) {\n        this.value = val;\n        this.mirror = ")";\n      }\n      FunctionToken2.prototype = Object.create(StringValuedToken.prototype);\n      FunctionToken2.prototype.tokenType = "FUNCTION";\n      FunctionToken2.prototype.toString = function() {\n        return "FUNCTION(" + this.value + ")";\n      };\n      FunctionToken2.prototype.toSource = function() {\n        return escapeIdent(this.value) + "(";\n      };\n      function AtKeywordToken2(val) {\n        this.value = val;\n      }\n      AtKeywordToken2.prototype = Object.create(StringValuedToken.prototype);\n      AtKeywordToken2.prototype.tokenType = "AT-KEYWORD";\n      AtKeywordToken2.prototype.toString = function() {\n        return "AT(" + this.value + ")";\n      };\n      AtKeywordToken2.prototype.toSource = function() {\n        return "@" + escapeIdent(this.value);\n      };\n      function HashToken2(val) {\n        this.value = val;\n        this.type = "unrestricted";\n      }\n      HashToken2.prototype = Object.create(StringValuedToken.prototype);\n      HashToken2.prototype.tokenType = "HASH";\n      HashToken2.prototype.toString = function() {\n        return "HASH(" + this.value + ")";\n      };\n      HashToken2.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        json.type = this.type;\n        return json;\n      };\n      HashToken2.prototype.toSource = function() {\n        if (this.type == "id") {\n          return "#" + escapeIdent(this.value);\n        } else {\n          return "#" + escapeHash(this.value);\n        }\n      };\n      function StringToken2(val) {\n        this.value = val;\n      }\n      StringToken2.prototype = Object.create(StringValuedToken.prototype);\n      StringToken2.prototype.tokenType = "STRING";\n      StringToken2.prototype.toString = function() {\n        return \'"\' + escapeString(this.value) + \'"\';\n      };\n      function URLToken2(val) {\n        this.value = val;\n      }\n      URLToken2.prototype = Object.create(StringValuedToken.prototype);\n      URLToken2.prototype.tokenType = "URL";\n      URLToken2.prototype.toString = function() {\n        return "URL(" + this.value + ")";\n      };\n      URLToken2.prototype.toSource = function() {\n        return \'url("\' + escapeString(this.value) + \'")\';\n      };\n      function NumberToken2() {\n        this.value = null;\n        this.type = "integer";\n        this.repr = "";\n      }\n      NumberToken2.prototype = Object.create(CSSParserToken.prototype);\n      NumberToken2.prototype.tokenType = "NUMBER";\n      NumberToken2.prototype.toString = function() {\n        if (this.type == "integer")\n          return "INT(" + this.value + ")";\n        return "NUMBER(" + this.value + ")";\n      };\n      NumberToken2.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        json.type = this.type;\n        json.repr = this.repr;\n        return json;\n      };\n      NumberToken2.prototype.toSource = function() {\n        return this.repr;\n      };\n      function PercentageToken2() {\n        this.value = null;\n        this.repr = "";\n      }\n      PercentageToken2.prototype = Object.create(CSSParserToken.prototype);\n      PercentageToken2.prototype.tokenType = "PERCENTAGE";\n      PercentageToken2.prototype.toString = function() {\n        return "PERCENTAGE(" + this.value + ")";\n      };\n      PercentageToken2.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        json.repr = this.repr;\n        return json;\n      };\n      PercentageToken2.prototype.toSource = function() {\n        return this.repr + "%";\n      };\n      function DimensionToken() {\n        this.value = null;\n        this.type = "integer";\n        this.repr = "";\n        this.unit = "";\n      }\n      DimensionToken.prototype = Object.create(CSSParserToken.prototype);\n      DimensionToken.prototype.tokenType = "DIMENSION";\n      DimensionToken.prototype.toString = function() {\n        return "DIM(" + this.value + "," + this.unit + ")";\n      };\n      DimensionToken.prototype.toJSON = function() {\n        var json = this.constructor.prototype.constructor.prototype.toJSON.call(this);\n        json.value = this.value;\n        json.type = this.type;\n        json.repr = this.repr;\n        json.unit = this.unit;\n        return json;\n      };\n      DimensionToken.prototype.toSource = function() {\n        var source = this.repr;\n        var unit = escapeIdent(this.unit);\n        if (unit[0].toLowerCase() == "e" && (unit[1] == "-" || between(unit.charCodeAt(1), 48, 57))) {\n          unit = "\\\\65 " + unit.slice(1, unit.length);\n        }\n        return source + unit;\n      };\n      function escapeIdent(string) {\n        string = "" + string;\n        var result = "";\n        var firstcode = string.charCodeAt(0);\n        for (var i = 0; i < string.length; i++) {\n          var code = string.charCodeAt(i);\n          if (code == 0) {\n            throw new InvalidCharacterError("Invalid character: the input contains U+0000.");\n          }\n          if (between(code, 1, 31) || code == 127 || i == 0 && between(code, 48, 57) || i == 1 && between(code, 48, 57) && firstcode == 45) {\n            result += "\\\\" + code.toString(16) + " ";\n          } else if (code >= 128 || code == 45 || code == 95 || between(code, 48, 57) || between(code, 65, 90) || between(code, 97, 122)) {\n            result += string[i];\n          } else {\n            result += "\\\\" + string[i];\n          }\n        }\n        return result;\n      }\n      function escapeHash(string) {\n        string = "" + string;\n        var result = "";\n        var firstcode = string.charCodeAt(0);\n        for (var i = 0; i < string.length; i++) {\n          var code = string.charCodeAt(i);\n          if (code == 0) {\n            throw new InvalidCharacterError("Invalid character: the input contains U+0000.");\n          }\n          if (code >= 128 || code == 45 || code == 95 || between(code, 48, 57) || between(code, 65, 90) || between(code, 97, 122)) {\n            result += string[i];\n          } else {\n            result += "\\\\" + code.toString(16) + " ";\n          }\n        }\n        return result;\n      }\n      function escapeString(string) {\n        string = "" + string;\n        var result = "";\n        for (var i = 0; i < string.length; i++) {\n          var code = string.charCodeAt(i);\n          if (code == 0) {\n            throw new InvalidCharacterError("Invalid character: the input contains U+0000.");\n          }\n          if (between(code, 1, 31) || code == 127) {\n            result += "\\\\" + code.toString(16) + " ";\n          } else if (code == 34 || code == 92) {\n            result += "\\\\" + string[i];\n          } else {\n            result += string[i];\n          }\n        }\n        return result;\n      }\n      exports3.tokenize = tokenize2;\n      exports3.IdentToken = IdentToken2;\n      exports3.FunctionToken = FunctionToken2;\n      exports3.AtKeywordToken = AtKeywordToken2;\n      exports3.HashToken = HashToken2;\n      exports3.StringToken = StringToken2;\n      exports3.BadStringToken = BadStringToken2;\n      exports3.URLToken = URLToken2;\n      exports3.BadURLToken = BadURLToken2;\n      exports3.DelimToken = DelimToken2;\n      exports3.NumberToken = NumberToken2;\n      exports3.PercentageToken = PercentageToken2;\n      exports3.DimensionToken = DimensionToken;\n      exports3.IncludeMatchToken = IncludeMatchToken;\n      exports3.DashMatchToken = DashMatchToken;\n      exports3.PrefixMatchToken = PrefixMatchToken;\n      exports3.SuffixMatchToken = SuffixMatchToken;\n      exports3.SubstringMatchToken = SubstringMatchToken;\n      exports3.ColumnToken = ColumnToken2;\n      exports3.WhitespaceToken = WhitespaceToken2;\n      exports3.CDOToken = CDOToken2;\n      exports3.CDCToken = CDCToken2;\n      exports3.ColonToken = ColonToken2;\n      exports3.SemicolonToken = SemicolonToken2;\n      exports3.CommaToken = CommaToken2;\n      exports3.OpenParenToken = OpenParenToken;\n      exports3.CloseParenToken = CloseParenToken2;\n      exports3.OpenSquareToken = OpenSquareToken2;\n      exports3.CloseSquareToken = CloseSquareToken2;\n      exports3.OpenCurlyToken = OpenCurlyToken2;\n      exports3.CloseCurlyToken = CloseCurlyToken2;\n      exports3.EOFToken = EOFToken2;\n      exports3.CSSParserToken = CSSParserToken;\n      exports3.GroupingToken = GroupingToken;\n    });\n  }\n});\n\n// packages/playwright-core/src/utils/isomorphic/stringUtils.ts\nfunction escapeWithQuotes(text, char = "\'") {\n  const stringified = JSON.stringify(text);\n  const escapedText = stringified.substring(1, stringified.length - 1).replace(/\\\\"/g, \'"\');\n  if (char === "\'")\n    return char + escapedText.replace(/[\']/g, "\\\\\'") + char;\n  if (char === \'"\')\n    return char + escapedText.replace(/["]/g, \'\\\\"\') + char;\n  if (char === "`")\n    return char + escapedText.replace(/[`]/g, "`") + char;\n  throw new Error("Invalid escape char");\n}\n\n// packages/playwright-core/src/server/isomorphic/cssParser.ts\nvar css = __toESM(require_cssTokenizer());\n\n// packages/playwright-core/src/server/injected/selectorEvaluator.ts\nfunction shouldSkipForTextMatching(element) {\n  return element.nodeName === "SCRIPT" || element.nodeName === "STYLE" || document.head && document.head.contains(element);\n}\nfunction elementText(evaluator, root) {\n  let value = evaluator._cacheText.get(root);\n  if (value === void 0) {\n    value = { full: "", immediate: [] };\n    if (!shouldSkipForTextMatching(root)) {\n      let currentImmediate = "";\n      if (root instanceof HTMLInputElement && (root.type === "submit" || root.type === "button")) {\n        value = { full: root.value, immediate: [root.value] };\n      } else {\n        for (let child = root.firstChild; child; child = child.nextSibling) {\n          if (child.nodeType === Node.TEXT_NODE) {\n            value.full += child.nodeValue || "";\n            currentImmediate += child.nodeValue || "";\n          } else {\n            if (currentImmediate)\n              value.immediate.push(currentImmediate);\n            currentImmediate = "";\n            if (child.nodeType === Node.ELEMENT_NODE)\n              value.full += elementText(evaluator, child).full;\n          }\n        }\n        if (currentImmediate)\n          value.immediate.push(currentImmediate);\n        if (root.shadowRoot)\n          value.full += elementText(evaluator, root.shadowRoot).full;\n      }\n    }\n    evaluator._cacheText.set(root, value);\n  }\n  return value;\n}\n\n// packages/playwright-core/src/server/injected/selectorGenerator.ts\nvar cacheAllowText = /* @__PURE__ */ new Map();\nvar cacheDisallowText = /* @__PURE__ */ new Map();\nvar kNthScore = 1e3;\nfunction generateSelector(injectedScript, targetElement, strict) {\n  injectedScript._evaluator.begin();\n  try {\n    targetElement = targetElement.closest("button,select,input,[role=button],[role=checkbox],[role=radio]") || targetElement;\n    const targetTokens = generateSelectorFor(injectedScript, targetElement, strict);\n    const bestTokens = targetTokens || cssFallback(injectedScript, targetElement, strict);\n    const selector = joinTokens(bestTokens);\n    const parsedSelector = injectedScript.parseSelector(selector);\n    return {\n      selector,\n      elements: injectedScript.querySelectorAll(parsedSelector, targetElement.ownerDocument)\n    };\n  } finally {\n    cacheAllowText.clear();\n    cacheDisallowText.clear();\n    injectedScript._evaluator.end();\n  }\n}\nfunction filterRegexTokens(textCandidates) {\n  return textCandidates.filter((c) => c[0].selector[0] !== "/");\n}\nfunction generateSelectorFor(injectedScript, targetElement, strict) {\n  if (targetElement.ownerDocument.documentElement === targetElement)\n    return [{ engine: "css", selector: "html", score: 1 }];\n  const calculate = (element, allowText) => {\n    const allowNthMatch = element === targetElement;\n    let textCandidates = allowText ? buildTextCandidates(injectedScript, element, element === targetElement).map((token) => [token]) : [];\n    if (element !== targetElement) {\n      textCandidates = filterRegexTokens(textCandidates);\n    }\n    const noTextCandidates = buildCandidates(injectedScript, element).map((token) => [token]);\n    let result = chooseFirstSelector(injectedScript, targetElement.ownerDocument, element, [...textCandidates, ...noTextCandidates], allowNthMatch, strict);\n    textCandidates = filterRegexTokens(textCandidates);\n    const checkWithText = (textCandidatesToUse) => {\n      const allowParentText = allowText && !textCandidatesToUse.length;\n      const candidates = [...textCandidatesToUse, ...noTextCandidates].filter((c) => {\n        if (!result)\n          return true;\n        return combineScores(c) < combineScores(result);\n      });\n      let bestPossibleInParent = candidates[0];\n      if (!bestPossibleInParent)\n        return;\n      for (let parent = parentElementOrShadowHost(element); parent; parent = parentElementOrShadowHost(parent)) {\n        const parentTokens = calculateCached(parent, allowParentText);\n        if (!parentTokens)\n          continue;\n        if (result && combineScores([...parentTokens, ...bestPossibleInParent]) >= combineScores(result))\n          continue;\n        bestPossibleInParent = chooseFirstSelector(injectedScript, parent, element, candidates, allowNthMatch, strict);\n        if (!bestPossibleInParent)\n          return;\n        const combined = [...parentTokens, ...bestPossibleInParent];\n        if (!result || combineScores(combined) < combineScores(result))\n          result = combined;\n      }\n    };\n    checkWithText(textCandidates);\n    if (element === targetElement && textCandidates.length)\n      checkWithText([]);\n    return result;\n  };\n  const calculateCached = (element, allowText) => {\n    const cache = allowText ? cacheAllowText : cacheDisallowText;\n    let value = cache.get(element);\n    if (value === void 0) {\n      value = calculate(element, allowText);\n      cache.set(element, value);\n    }\n    return value;\n  };\n  return calculateCached(targetElement, true);\n}\nfunction buildCandidates(injectedScript, element) {\n  const candidates = [];\n  for (const attribute of ["data-testid", "data-test-id", "data-test"]) {\n    if (element.getAttribute(attribute))\n      candidates.push({ engine: "css", selector: `[${attribute}=${quoteAttributeValue(element.getAttribute(attribute))}]`, score: 1 });\n  }\n  if (element.nodeName === "INPUT") {\n    const input = element;\n    if (input.placeholder)\n      candidates.push({ engine: "css", selector: `[placeholder=${quoteAttributeValue(input.placeholder)}]`, score: 10 });\n  }\n  if (element.getAttribute("aria-label"))\n    candidates.push({ engine: "css", selector: `[aria-label=${quoteAttributeValue(element.getAttribute("aria-label"))}]`, score: 10 });\n  if (element.getAttribute("alt") && ["APPLET", "AREA", "IMG", "INPUT"].includes(element.nodeName))\n    candidates.push({ engine: "css", selector: `${cssEscape(element.nodeName.toLowerCase())}[alt=${quoteAttributeValue(element.getAttribute("alt"))}]`, score: 10 });\n  if (element.getAttribute("role"))\n    candidates.push({ engine: "css", selector: `${cssEscape(element.nodeName.toLowerCase())}[role=${quoteAttributeValue(element.getAttribute("role"))}]`, score: 50 });\n  if (element.getAttribute("name") && ["BUTTON", "FORM", "FIELDSET", "IFRAME", "INPUT", "KEYGEN", "OBJECT", "OUTPUT", "SELECT", "TEXTAREA", "MAP", "META", "PARAM"].includes(element.nodeName))\n    candidates.push({ engine: "css", selector: `${cssEscape(element.nodeName.toLowerCase())}[name=${quoteAttributeValue(element.getAttribute("name"))}]`, score: 50 });\n  if (["INPUT", "TEXTAREA"].includes(element.nodeName) && element.getAttribute("type") !== "hidden") {\n    if (element.getAttribute("type"))\n      candidates.push({ engine: "css", selector: `${cssEscape(element.nodeName.toLowerCase())}[type=${quoteAttributeValue(element.getAttribute("type"))}]`, score: 50 });\n  }\n  if (["INPUT", "TEXTAREA", "SELECT"].includes(element.nodeName))\n    candidates.push({ engine: "css", selector: cssEscape(element.nodeName.toLowerCase()), score: 50 });\n  const idAttr = element.getAttribute("id");\n  if (idAttr && !isGuidLike(idAttr))\n    candidates.push({ engine: "css", selector: makeSelectorForId(idAttr), score: 100 });\n  candidates.push({ engine: "css", selector: cssEscape(element.nodeName.toLowerCase()), score: 200 });\n  return candidates;\n}\nfunction buildTextCandidates(injectedScript, element, allowHasText) {\n  if (element.nodeName === "SELECT")\n    return [];\n  const text = elementText(injectedScript._evaluator, element).full.trim().replace(/\\s+/g, " ").substring(0, 80);\n  if (!text)\n    return [];\n  const candidates = [];\n  let escaped = text;\n  if (text.includes(\'"\') || text.includes(">>") || text[0] === "/")\n    escaped = `/.*${escapeForRegex(text)}.*/`;\n  candidates.push({ engine: "text", selector: escaped, score: 10 });\n  if (allowHasText && escaped === text) {\n    let prefix = element.nodeName.toLowerCase();\n    if (element.hasAttribute("role"))\n      prefix += `[role=${quoteAttributeValue(element.getAttribute("role"))}]`;\n    candidates.push({ engine: "css", selector: `${prefix}:has-text("${text}")`, score: 30 });\n  }\n  return candidates;\n}\nfunction parentElementOrShadowHost(element) {\n  if (element.parentElement)\n    return element.parentElement;\n  if (!element.parentNode)\n    return null;\n  if (element.parentNode.nodeType === Node.DOCUMENT_FRAGMENT_NODE && element.parentNode.host)\n    return element.parentNode.host;\n  return null;\n}\nfunction makeSelectorForId(id) {\n  return /^[a-zA-Z][a-zA-Z0-9\\-\\_]+$/.test(id) ? "#" + id : `[id="${cssEscape(id)}"]`;\n}\nfunction cssFallback(injectedScript, targetElement, strict) {\n  const kFallbackScore = 1e7;\n  const root = targetElement.ownerDocument;\n  const tokens = [];\n  function uniqueCSSSelector(prefix) {\n    const path = tokens.slice();\n    if (prefix)\n      path.unshift(prefix);\n    const selector = path.join(" ");\n    const parsedSelector = injectedScript.parseSelector(selector);\n    const node = injectedScript.querySelector(parsedSelector, targetElement.ownerDocument, false);\n    return node === targetElement ? selector : void 0;\n  }\n  function makeStrict(selector) {\n    const token = { engine: "css", selector, score: kFallbackScore };\n    if (!strict)\n      return [token];\n    const parsedSelector = injectedScript.parseSelector(selector);\n    const elements = injectedScript.querySelectorAll(parsedSelector, targetElement.ownerDocument);\n    if (elements.length === 1)\n      return [token];\n    const nth = { engine: "nth", selector: String(elements.indexOf(targetElement)), score: kNthScore };\n    return [token, nth];\n  }\n  for (let element = targetElement; element && element !== root; element = parentElementOrShadowHost(element)) {\n    const nodeName = element.nodeName.toLowerCase();\n    let bestTokenForLevel = "";\n    if (element.id) {\n      const token = makeSelectorForId(element.id);\n      const selector = uniqueCSSSelector(token);\n      if (selector)\n        return makeStrict(selector);\n      bestTokenForLevel = token;\n    }\n    const parent = element.parentNode;\n    const classes = [...element.classList];\n    for (let i = 0; i < classes.length; ++i) {\n      const token = "." + classes.slice(0, i + 1).join(".");\n      const selector = uniqueCSSSelector(token);\n      if (selector)\n        return makeStrict(selector);\n      if (!bestTokenForLevel && parent) {\n        const sameClassSiblings = parent.querySelectorAll(token);\n        if (sameClassSiblings.length === 1)\n          bestTokenForLevel = token;\n      }\n    }\n    if (parent) {\n      const siblings = [...parent.children];\n      const sameTagSiblings = siblings.filter((sibling) => sibling.nodeName.toLowerCase() === nodeName);\n      const token = sameTagSiblings.indexOf(element) === 0 ? cssEscape(nodeName) : `${cssEscape(nodeName)}:nth-child(${1 + siblings.indexOf(element)})`;\n      const selector = uniqueCSSSelector(token);\n      if (selector)\n        return makeStrict(selector);\n      if (!bestTokenForLevel)\n        bestTokenForLevel = token;\n    } else if (!bestTokenForLevel) {\n      bestTokenForLevel = nodeName;\n    }\n    tokens.unshift(bestTokenForLevel);\n  }\n  return makeStrict(uniqueCSSSelector());\n}\nfunction escapeForRegex(text) {\n  return text.replace(/[.*+?^>${}()|[\\]\\\\]/g, "\\\\$&");\n}\nfunction quoteAttributeValue(text) {\n  return `"${cssEscape(text).replace(/\\\\ /g, " ")}"`;\n}\nfunction joinTokens(tokens) {\n  const parts = [];\n  let lastEngine = "";\n  for (const { engine, selector } of tokens) {\n    if (parts.length && (lastEngine !== "css" || engine !== "css" || selector.startsWith(":nth-match(")))\n      parts.push(">>");\n    lastEngine = engine;\n    if (engine === "css")\n      parts.push(selector);\n    else\n      parts.push(`${engine}=${selector}`);\n  }\n  return parts.join(" ");\n}\nfunction combineScores(tokens) {\n  let score = 0;\n  for (let i = 0; i < tokens.length; i++)\n    score += tokens[i].score * (tokens.length - i);\n  return score;\n}\nfunction chooseFirstSelector(injectedScript, scope, targetElement, selectors, allowNthMatch, strict) {\n  const joined = selectors.map((tokens) => ({ tokens, score: combineScores(tokens) }));\n  joined.sort((a, b) => a.score - b.score);\n  let bestWithIndex = null;\n  for (const { tokens } of joined) {\n    const parsedSelector = injectedScript.parseSelector(joinTokens(tokens));\n    const result = injectedScript.querySelectorAll(parsedSelector, scope);\n    const isStrictEnough = !strict || result.length === 1;\n    const index = result.indexOf(targetElement);\n    if (index === 0 && isStrictEnough) {\n      return tokens;\n    }\n    if (!allowNthMatch || bestWithIndex || index === -1 || result.length > 5)\n      continue;\n    const nth = { engine: "nth", selector: String(index), score: kNthScore };\n    bestWithIndex = [...tokens, nth];\n  }\n  return bestWithIndex;\n}\nfunction isGuidLike(id) {\n  let lastCharacterType;\n  let transitionCount = 0;\n  for (let i = 0; i < id.length; ++i) {\n    const c = id[i];\n    let characterType;\n    if (c === "-" || c === "_")\n      continue;\n    if (c >= "a" && c <= "z")\n      characterType = "lower";\n    else if (c >= "A" && c <= "Z")\n      characterType = "upper";\n    else if (c >= "0" && c <= "9")\n      characterType = "digit";\n    else\n      characterType = "other";\n    if (characterType === "lower" && lastCharacterType === "upper") {\n      lastCharacterType = characterType;\n      continue;\n    }\n    if (lastCharacterType && lastCharacterType !== characterType)\n      ++transitionCount;\n    lastCharacterType = characterType;\n  }\n  return transitionCount >= id.length / 4;\n}\nfunction cssEscape(s) {\n  let result = "";\n  for (let i = 0; i < s.length; i++)\n    result += cssEscapeOne(s, i);\n  return result;\n}\nfunction cssEscapeOne(s, i) {\n  const c = s.charCodeAt(i);\n  if (c === 0)\n    return "\\uFFFD";\n  if (c >= 1 && c <= 31 || c >= 48 && c <= 57 && (i === 0 || i === 1 && s.charCodeAt(0) === 45))\n    return "\\\\" + c.toString(16) + " ";\n  if (i === 0 && c === 45 && s.length === 1)\n    return "\\\\" + s.charAt(i);\n  if (c >= 128 || c === 45 || c === 95 || c >= 48 && c <= 57 || c >= 65 && c <= 90 || c >= 97 && c <= 122)\n    return s.charAt(i);\n  return "\\\\" + s.charAt(i);\n}\n\n// packages/playwright-core/src/server/injected/consoleApi.ts\nfunction createLocator(injectedScript, initial, options) {\n  class Locator {\n    constructor(selector, options2) {\n      this.selector = selector;\n      if (options2 == null ? void 0 : options2.hasText) {\n        const text = options2.hasText;\n        if (text instanceof RegExp)\n          this.selector += ` >> :scope:text-matches(${escapeWithQuotes(text.source, \'"\')}, "${text.flags}")`;\n        else\n          this.selector += ` >> :scope:has-text(${escapeWithQuotes(text)})`;\n      }\n      if (options2 == null ? void 0 : options2.has)\n        this.selector += ` >> has=` + JSON.stringify(options2.has.selector);\n      const parsed = injectedScript.parseSelector(this.selector);\n      this.element = injectedScript.querySelector(parsed, document, false);\n      this.elements = injectedScript.querySelectorAll(parsed, document);\n    }\n    locator(selector, options2) {\n      return new Locator(this.selector ? this.selector + " >> " + selector : selector, options2);\n    }\n  }\n  return new Locator(initial, options);\n}\nvar ConsoleAPI = class {\n  constructor(injectedScript) {\n    this._injectedScript = injectedScript;\n    if (window.playwright)\n      return;\n    window.playwright = {\n      $: (selector, strict) => this._querySelector(selector, !!strict),\n      $$: (selector) => this._querySelectorAll(selector),\n      locator: (selector, options) => createLocator(this._injectedScript, selector, options),\n      inspect: (selector) => this._inspect(selector),\n      selector: (element) => this._selector(element),\n      resume: () => this._resume()\n    };\n  }\n  _querySelector(selector, strict) {\n    if (typeof selector !== "string")\n      throw new Error(`Usage: playwright.query(\'Playwright >> selector\').`);\n    const parsed = this._injectedScript.parseSelector(selector);\n    return this._injectedScript.querySelector(parsed, document, strict);\n  }\n  _querySelectorAll(selector) {\n    if (typeof selector !== "string")\n      throw new Error(`Usage: playwright.$$(\'Playwright >> selector\').`);\n    const parsed = this._injectedScript.parseSelector(selector);\n    return this._injectedScript.querySelectorAll(parsed, document);\n  }\n  _inspect(selector) {\n    if (typeof selector !== "string")\n      throw new Error(`Usage: playwright.inspect(\'Playwright >> selector\').`);\n    window.inspect(this._querySelector(selector, false));\n  }\n  _selector(element) {\n    if (!(element instanceof Element))\n      throw new Error(`Usage: playwright.selector(element).`);\n    return generateSelector(this._injectedScript, element, true).selector;\n  }\n  _resume() {\n    window._playwrightResume().catch(() => {\n    });\n  }\n};\nmodule.exports = ConsoleAPI;\n';var om={},sm={};Object.defineProperty(sm,"__esModule",{value:!0}),sm.installAppIcon=async function(e){const t=await am.default.promises.readFile(require.resolve("./appIcon.png")),n=e._delegate;await n._mainFrameSession._client.send("Browser.setDockTile",{image:t.toString("base64")})};var am=function(e){return e&&e.__esModule?e:{default:e}}(C.default);var lm={},cm={},um={exports:{}},dm={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}};const{EMPTY_BUFFER:hm}=dm;function pm(e,t){if(0===e.length)return hm;if(1===e.length)return e[0];const n=Buffer.allocUnsafe(t);let r=0;for(let t=0;t<e.length;t++){const i=e[t];n.set(i,r),r+=i.length}return r<t?n.slice(0,r):n}function fm(e,t,n,r,i){for(let o=0;o<i;o++)n[r+o]=e[o]^t[3&o]}function mm(e,t){for(let n=0;n<e.length;n++)e[n]^=t[3&n]}function gm(e){return e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function _m(e){if(_m.readOnly=!0,Buffer.isBuffer(e))return e;let t;return e instanceof ArrayBuffer?t=Buffer.from(e):ArrayBuffer.isView(e)?t=Buffer.from(e.buffer,e.byteOffset,e.byteLength):(t=Buffer.from(e),_m.readOnly=!1),t}try{const e=require("bufferutil");um.exports={concat:pm,mask(t,n,r,i,o){o<48?fm(t,n,r,i,o):e.mask(t,n,r,i,o)},toArrayBuffer:gm,toBuffer:_m,unmask(t,n){t.length<32?mm(t,n):e.unmask(t,n)}}}catch(e){um.exports={concat:pm,mask:fm,toArrayBuffer:gm,toBuffer:_m,unmask:mm}}const wm=Symbol("kDone"),vm=Symbol("kRun");var bm=class{constructor(e){this[wm]=()=>{this.pending--,this[vm]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[vm]()}[vm](){if(this.pending!==this.concurrency&&this.jobs.length){const e=this.jobs.shift();this.pending++,e(this[wm])}}};const ym=$.default,Sm=um.exports,xm=bm,{kStatusCode:km}=dm,Em=Buffer.from([0,0,255,255]),Cm=Symbol("permessage-deflate"),Tm=Symbol("total-length"),Pm=Symbol("callback"),Om=Symbol("buffers"),Am=Symbol("error");let Im;var Mm=class{constructor(e,t,n){if(this._maxPayload=0|n,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!Im){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;Im=new xm(e)}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){const e=this._deflate[Pm];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){const t=this._options,n=e.find((e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits)));if(!n)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(n.server_no_context_takeover=!0),t.clientNoContextTakeover&&(n.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(n.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?n.client_max_window_bits=t.clientMaxWindowBits:!0!==n.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete n.client_max_window_bits,n}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach((e=>{Object.keys(e).forEach((t=>{let n=e[t];if(n.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(n=n[0],"client_max_window_bits"===t){if(!0!==n){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}else if("server_max_window_bits"===t){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==n)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}e[t]=n}))})),e}decompress(e,t,n){Im.add((r=>{this._decompress(e,t,((e,t)=>{r(),n(e,t)}))}))}compress(e,t,n){Im.add((r=>{this._compress(e,t,((e,t)=>{r(),n(e,t)}))}))}_decompress(e,t,n){const r=this._isServer?"client":"server";if(!this._inflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?ym.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=ym.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[Cm]=this,this._inflate[Tm]=0,this._inflate[Om]=[],this._inflate.on("error",Rm),this._inflate.on("data",Nm)}this._inflate[Pm]=n,this._inflate.write(e),t&&this._inflate.write(Em),this._inflate.flush((()=>{const e=this._inflate[Am];if(e)return this._inflate.close(),this._inflate=null,void n(e);const i=Sm.concat(this._inflate[Om],this._inflate[Tm]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[Tm]=0,this._inflate[Om]=[],t&&this.params[`${r}_no_context_takeover`]&&this._inflate.reset()),n(null,i)}))}_compress(e,t,n){const r=this._isServer?"server":"client";if(!this._deflate){const e=`${r}_max_window_bits`,t="number"!=typeof this.params[e]?ym.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=ym.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[Tm]=0,this._deflate[Om]=[],this._deflate.on("data",Fm)}this._deflate[Pm]=n,this._deflate.write(e),this._deflate.flush(ym.Z_SYNC_FLUSH,(()=>{if(!this._deflate)return;let e=Sm.concat(this._deflate[Om],this._deflate[Tm]);t&&(e=e.slice(0,e.length-4)),this._deflate[Pm]=null,this._deflate[Tm]=0,this._deflate[Om]=[],t&&this.params[`${r}_no_context_takeover`]&&this._deflate.reset(),n(null,e)}))}};function Fm(e){this[Om].push(e),this[Tm]+=e.length}function Nm(e){this[Tm]+=e.length,this[Cm]._maxPayload<1||this[Tm]<=this[Cm]._maxPayload?this[Om].push(e):(this[Am]=new RangeError("Max payload size exceeded"),this[Am].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[Am][km]=1009,this.removeListener("data",Nm),this.reset())}function Rm(e){this[Cm]._inflate=null,e[km]=1007,this[Pm](e)}var jm={exports:{}};const Dm=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function Lm(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999}function Bm(e){const t=e.length;let n=0;for(;n<t;)if(0==(128&e[n]))n++;else if(192==(224&e[n])){if(n+1===t||128!=(192&e[n+1])||192==(254&e[n]))return!1;n+=2}else if(224==(240&e[n])){if(n+2>=t||128!=(192&e[n+1])||128!=(192&e[n+2])||224===e[n]&&128==(224&e[n+1])||237===e[n]&&160==(224&e[n+1]))return!1;n+=3}else{if(240!=(248&e[n]))return!1;if(n+3>=t||128!=(192&e[n+1])||128!=(192&e[n+2])||128!=(192&e[n+3])||240===e[n]&&128==(240&e[n+1])||244===e[n]&&e[n+1]>143||e[n]>244)return!1;n+=4}return!0}try{const e=require("utf-8-validate");jm.exports={isValidStatusCode:Lm,isValidUTF8:t=>t.length<150?Bm(t):e(t),tokenChars:Dm}}catch(e){jm.exports={isValidStatusCode:Lm,isValidUTF8:Bm,tokenChars:Dm}}const{Writable:Hm}=B.default,qm=Mm,{BINARY_TYPES:Um,EMPTY_BUFFER:Wm,kStatusCode:$m,kWebSocket:zm}=dm,{concat:Vm,toArrayBuffer:Gm,unmask:Km}=um.exports,{isValidStatusCode:Jm,isValidUTF8:Ym}=jm.exports;var Xm=class extends Hm{constructor(e={}){super(),this._binaryType=e.binaryType||Um[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[zm]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=0,this._loop=!1}_write(e,t,n){if(8===this._opcode&&0==this._state)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=t.slice(e),t.slice(0,e)}const t=Buffer.allocUnsafe(e);do{const n=this._buffers[0],r=t.length-e;e>=n.length?t.set(this._buffers.shift(),r):(t.set(new Uint8Array(n.buffer,n.byteOffset,e),r),this._buffers[0]=n.slice(e)),e-=n.length}while(e>0);return t}startLoop(e){let t;this._loop=!0;do{switch(this._state){case 0:t=this.getInfo();break;case 1:t=this.getPayloadLength16();break;case 2:t=this.getPayloadLength64();break;case 3:this.getMask();break;case 4:t=this.getData(e);break;default:return void(this._loop=!1)}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(0!=(48&e[0]))return this._loop=!1,Qm(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");const t=64==(64&e[0]);if(t&&!this._extensions[qm.extensionName])return this._loop=!1,Qm(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,Qm(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,Qm(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,Qm(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,Qm(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin)return this._loop=!1,Qm(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(t)return this._loop=!1,Qm(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,Qm(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),this._isServer){if(!this._masked)return this._loop=!1,Qm(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,Qm(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(126===this._payloadLength)this._state=1;else{if(127!==this._payloadLength)return this.haveLength();this._state=2}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,Qm(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,Qm(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=3:this._state=4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=Wm;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&0!=(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])&&Km(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=5,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}decompress(e,t){this._extensions[qm.extensionName].decompress(e,this._fin,((e,n)=>{if(e)return t(e);if(n.length){if(this._messageLength+=n.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(Qm(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(n)}const r=this.dataMessage();if(r)return t(r);this.startLoop(t)}))}dataMessage(){if(this._fin){const e=this._messageLength,t=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let n;n="nodebuffer"===this._binaryType?Vm(t,e):"arraybuffer"===this._binaryType?Gm(Vm(t,e)):t,this.emit("message",n,!0)}else{const n=Vm(t,e);if(!this._skipUTF8Validation&&!Ym(n))return this._loop=!1,Qm(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",n,!1)}}this._state=0}controlMessage(e){if(8===this._opcode)if(this._loop=!1,0===e.length)this.emit("conclude",1005,Wm),this.end();else{if(1===e.length)return Qm(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");{const t=e.readUInt16BE(0);if(!Jm(t))return Qm(RangeError,`invalid status code ${t}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");const n=e.slice(2);if(!this._skipUTF8Validation&&!Ym(n))return Qm(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",t,n),this.end()}}else 9===this._opcode?this.emit("ping",e):this.emit("pong",e);this._state=0}};function Qm(e,t,n,r,i){const o=new e(n?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(o,Qm),o.code=i,o[$m]=r,o}const{randomFillSync:Zm}=U.default,eg=Mm,{EMPTY_BUFFER:tg}=dm,{isValidStatusCode:ng}=jm.exports,{mask:rg,toBuffer:ig}=um.exports,og=Symbol("kByteLength"),sg=Buffer.alloc(4);class ag{constructor(e,t,n){this._extensions=t||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let n,r,i=!1,o=2,s=!1;t.mask&&(n=t.maskBuffer||sg,t.generateMask?t.generateMask(n):Zm(n,0,4),s=0==(n[0]|n[1]|n[2]|n[3]),o=6),"string"==typeof e?r=t.mask&&!s||void 0===t[og]?(e=Buffer.from(e)).length:t[og]:(r=e.length,i=t.mask&&t.readOnly&&!s);let a=r;r>=65536?(o+=8,a=127):r>125&&(o+=2,a=126);const l=Buffer.allocUnsafe(i?r+o:o);return l[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(l[0]|=64),l[1]=a,126===a?l.writeUInt16BE(r,2):127===a&&(l[2]=l[3]=0,l.writeUIntBE(r,4,6)),t.mask?(l[1]|=128,l[o-4]=n[0],l[o-3]=n[1],l[o-2]=n[2],l[o-1]=n[3],s?[l,e]:i?(rg(e,n,l,o,r),[l]):(rg(e,n,e,0,r),[l,e])):[l,e]}close(e,t,n,r){let i;if(void 0===e)i=tg;else{if("number"!=typeof e||!ng(e))throw new TypeError("First argument must be a valid error code number");if(void 0!==t&&t.length){const n=Buffer.byteLength(t);if(n>123)throw new RangeError("The message must not be greater than 123 bytes");i=Buffer.allocUnsafe(2+n),i.writeUInt16BE(e,0),"string"==typeof t?i.write(t,2):i.set(t,2)}else i=Buffer.allocUnsafe(2),i.writeUInt16BE(e,0)}const o={[og]:i.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,i,!1,o,r]):this.sendFrame(ag.frame(i,o),r)}ping(e,t,n){let r,i;if("string"==typeof e?(r=Buffer.byteLength(e),i=!1):(r=(e=ig(e)).length,i=ig.readOnly),r>125)throw new RangeError("The data size must not be greater than 125 bytes");const o={[og]:r,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(ag.frame(e,o),n)}pong(e,t,n){let r,i;if("string"==typeof e?(r=Buffer.byteLength(e),i=!1):(r=(e=ig(e)).length,i=ig.readOnly),r>125)throw new RangeError("The data size must not be greater than 125 bytes");const o={[og]:r,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,o,n]):this.sendFrame(ag.frame(e,o),n)}send(e,t,n){const r=this._extensions[eg.extensionName];let i,o,s=t.binary?2:1,a=t.compress;if("string"==typeof e?(i=Buffer.byteLength(e),o=!1):(i=(e=ig(e)).length,o=ig.readOnly),this._firstFragment?(this._firstFragment=!1,a&&r&&r.params[r._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(a=i>=r._threshold),this._compress=a):(a=!1,s=0),t.fin&&(this._firstFragment=!0),r){const r={[og]:i,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:s,readOnly:o,rsv1:a};this._deflating?this.enqueue([this.dispatch,e,this._compress,r,n]):this.dispatch(e,this._compress,r,n)}else this.sendFrame(ag.frame(e,{[og]:i,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:s,readOnly:o,rsv1:!1}),n)}dispatch(e,t,n,r){if(!t)return void this.sendFrame(ag.frame(e,n),r);const i=this._extensions[eg.extensionName];this._bufferedBytes+=n[og],this._deflating=!0,i.compress(e,n.fin,((e,t)=>{if(this._socket.destroyed){const e=new Error("The socket was closed while data was being compressed");"function"==typeof r&&r(e);for(let t=0;t<this._queue.length;t++){const n=this._queue[t],r=n[n.length-1];"function"==typeof r&&r(e)}}else this._bufferedBytes-=n[og],this._deflating=!1,n.readOnly=!1,this.sendFrame(ag.frame(t,n),r),this.dequeue()}))}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[3][og],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][og],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}var lg=ag;const{kForOnEventAttribute:cg,kListener:ug}=dm,dg=Symbol("kCode"),hg=Symbol("kData"),pg=Symbol("kError"),fg=Symbol("kMessage"),mg=Symbol("kReason"),gg=Symbol("kTarget"),_g=Symbol("kType"),wg=Symbol("kWasClean");class vg{constructor(e){this[gg]=null,this[_g]=e}get target(){return this[gg]}get type(){return this[_g]}}Object.defineProperty(vg.prototype,"target",{enumerable:!0}),Object.defineProperty(vg.prototype,"type",{enumerable:!0});class bg extends vg{constructor(e,t={}){super(e),this[dg]=void 0===t.code?0:t.code,this[mg]=void 0===t.reason?"":t.reason,this[wg]=void 0!==t.wasClean&&t.wasClean}get code(){return this[dg]}get reason(){return this[mg]}get wasClean(){return this[wg]}}Object.defineProperty(bg.prototype,"code",{enumerable:!0}),Object.defineProperty(bg.prototype,"reason",{enumerable:!0}),Object.defineProperty(bg.prototype,"wasClean",{enumerable:!0});class yg extends vg{constructor(e,t={}){super(e),this[pg]=void 0===t.error?null:t.error,this[fg]=void 0===t.message?"":t.message}get error(){return this[pg]}get message(){return this[fg]}}Object.defineProperty(yg.prototype,"error",{enumerable:!0}),Object.defineProperty(yg.prototype,"message",{enumerable:!0});class Sg extends vg{constructor(e,t={}){super(e),this[hg]=void 0===t.data?null:t.data}get data(){return this[hg]}}Object.defineProperty(Sg.prototype,"data",{enumerable:!0});const xg={addEventListener(e,t,n={}){let r;if("message"===e)r=function(e,n){const r=new Sg("message",{data:n?e:e.toString()});r[gg]=this,t.call(this,r)};else if("close"===e)r=function(e,n){const r=new bg("close",{code:e,reason:n.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});r[gg]=this,t.call(this,r)};else if("error"===e)r=function(e){const n=new yg("error",{error:e,message:e.message});n[gg]=this,t.call(this,n)};else{if("open"!==e)return;r=function(){const e=new vg("open");e[gg]=this,t.call(this,e)}}r[cg]=!!n[cg],r[ug]=t,n.once?this.once(e,r):this.on(e,r)},removeEventListener(e,t){for(const n of this.listeners(e))if(n[ug]===t&&!n[cg]){this.removeListener(e,n);break}}};var kg={CloseEvent:bg,ErrorEvent:yg,Event:vg,EventTarget:xg,MessageEvent:Sg};const{tokenChars:Eg}=jm.exports;function Cg(e,t,n){void 0===e[t]?e[t]=[n]:e[t].push(n)}var Tg={format:function(e){return Object.keys(e).map((t=>{let n=e[t];return Array.isArray(n)||(n=[n]),n.map((e=>[t].concat(Object.keys(e).map((t=>{let n=e[t];return Array.isArray(n)||(n=[n]),n.map((e=>!0===e?t:`${t}=${e}`)).join("; ")}))).join("; "))).join(", ")})).join(", ")},parse:function(e){const t=Object.create(null);let n,r,i=Object.create(null),o=!1,s=!1,a=!1,l=-1,c=-1,u=-1,d=0;for(;d<e.length;d++)if(c=e.charCodeAt(d),void 0===n)if(-1===u&&1===Eg[c])-1===l&&(l=d);else if(0===d||32!==c&&9!==c){if(59!==c&&44!==c)throw new SyntaxError(`Unexpected character at index ${d}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${d}`);-1===u&&(u=d);const r=e.slice(l,u);44===c?(Cg(t,r,i),i=Object.create(null)):n=r,l=u=-1}}else-1===u&&-1!==l&&(u=d);else if(void 0===r)if(-1===u&&1===Eg[c])-1===l&&(l=d);else if(32===c||9===c)-1===u&&-1!==l&&(u=d);else if(59===c||44===c){if(-1===l)throw new SyntaxError(`Unexpected character at index ${d}`);-1===u&&(u=d),Cg(i,e.slice(l,u),!0),44===c&&(Cg(t,n,i),i=Object.create(null),n=void 0),l=u=-1}else{if(61!==c||-1===l||-1!==u)throw new SyntaxError(`Unexpected character at index ${d}`);r=e.slice(l,d),l=u=-1}else if(s){if(1!==Eg[c])throw new SyntaxError(`Unexpected character at index ${d}`);-1===l?l=d:o||(o=!0),s=!1}else if(a)if(1===Eg[c])-1===l&&(l=d);else if(34===c&&-1!==l)a=!1,u=d;else{if(92!==c)throw new SyntaxError(`Unexpected character at index ${d}`);s=!0}else if(34===c&&61===e.charCodeAt(d-1))a=!0;else if(-1===u&&1===Eg[c])-1===l&&(l=d);else if(-1===l||32!==c&&9!==c){if(59!==c&&44!==c)throw new SyntaxError(`Unexpected character at index ${d}`);{if(-1===l)throw new SyntaxError(`Unexpected character at index ${d}`);-1===u&&(u=d);let s=e.slice(l,u);o&&(s=s.replace(/\\/g,""),o=!1),Cg(i,r,s),44===c&&(Cg(t,n,i),i=Object.create(null),n=void 0),r=void 0,l=u=-1}}else-1===u&&(u=d);if(-1===l||a||32===c||9===c)throw new SyntaxError("Unexpected end of input");-1===u&&(u=d);const h=e.slice(l,u);return void 0===n?Cg(t,h,i):(void 0===r?Cg(i,h,!0):Cg(i,r,o?h.replace(/\\/g,""):h),Cg(t,n,i)),t}};const Pg=M.default,Og=O.default,Ag=P.default,Ig=A.default,Mg=I.default,{randomBytes:Fg,createHash:Ng}=U.default,{URL:Rg}=H.default,jg=Mm,Dg=Xm,Lg=lg,{BINARY_TYPES:Bg,EMPTY_BUFFER:Hg,GUID:qg,kForOnEventAttribute:Ug,kListener:Wg,kStatusCode:$g,kWebSocket:zg,NOOP:Vg}=dm,{EventTarget:{addEventListener:Gg,removeEventListener:Kg}}=kg,{format:Jg,parse:Yg}=Tg,{toBuffer:Xg}=um.exports,Qg=["CONNECTING","OPEN","CLOSING","CLOSED"],Zg=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,e_=[8,13];class t_ extends Pg{constructor(e,t,n){super(),this._binaryType=Bg[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=Hg,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=t_.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(n=t,t=[]):t=[t]),r_(this,e,t,n)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(e){Bg.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,n){const r=new Dg({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation});this._sender=new Lg(e,this._extensions,n.generateMask),this._receiver=r,this._socket=e,r[zg]=this,e[zg]=this,r.on("conclude",c_),r.on("drain",u_),r.on("error",d_),r.on("message",p_),r.on("ping",f_),r.on("pong",m_),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",__),e.on("data",w_),e.on("end",v_),e.on("error",b_),this._readyState=t_.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=t_.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[jg.extensionName]&&this._extensions[jg.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=t_.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==t_.CLOSED){if(this.readyState===t_.CONNECTING){const e="WebSocket was closed before the connection was established";return a_(this,this._req,e)}this.readyState!==t_.CLOSING?(this._readyState=t_.CLOSING,this._sender.close(e,t,!this._isServer,(e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())})),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),3e4)):this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end()}}pause(){this.readyState!==t_.CONNECTING&&this.readyState!==t_.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,n){if(this.readyState===t_.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===t_.OPEN?(void 0===t&&(t=!this._isServer),this._sender.ping(e||Hg,t,n)):l_(this,e,n)}pong(e,t,n){if(this.readyState===t_.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState===t_.OPEN?(void 0===t&&(t=!this._isServer),this._sender.pong(e||Hg,t,n)):l_(this,e,n)}resume(){this.readyState!==t_.CONNECTING&&this.readyState!==t_.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,n){if(this.readyState===t_.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(n=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==t_.OPEN)return void l_(this,e,n);const r={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[jg.extensionName]||(r.compress=!1),this._sender.send(e||Hg,r,n)}terminate(){if(this.readyState!==t_.CLOSED){if(this.readyState===t_.CONNECTING){const e="WebSocket was closed before the connection was established";return a_(this,this._req,e)}this._socket&&(this._readyState=t_.CLOSING,this._socket.destroy())}}}Object.defineProperty(t_,"CONNECTING",{enumerable:!0,value:Qg.indexOf("CONNECTING")}),Object.defineProperty(t_.prototype,"CONNECTING",{enumerable:!0,value:Qg.indexOf("CONNECTING")}),Object.defineProperty(t_,"OPEN",{enumerable:!0,value:Qg.indexOf("OPEN")}),Object.defineProperty(t_.prototype,"OPEN",{enumerable:!0,value:Qg.indexOf("OPEN")}),Object.defineProperty(t_,"CLOSING",{enumerable:!0,value:Qg.indexOf("CLOSING")}),Object.defineProperty(t_.prototype,"CLOSING",{enumerable:!0,value:Qg.indexOf("CLOSING")}),Object.defineProperty(t_,"CLOSED",{enumerable:!0,value:Qg.indexOf("CLOSED")}),Object.defineProperty(t_.prototype,"CLOSED",{enumerable:!0,value:Qg.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach((e=>{Object.defineProperty(t_.prototype,e,{enumerable:!0})})),["open","error","close","message"].forEach((e=>{Object.defineProperty(t_.prototype,`on${e}`,{enumerable:!0,get(){for(const t of this.listeners(e))if(t[Ug])return t[Wg];return null},set(t){for(const t of this.listeners(e))if(t[Ug]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[Ug]:!0})}})})),t_.prototype.addEventListener=Gg,t_.prototype.removeEventListener=Kg;var n_=t_;function r_(e,t,n,r){const i={protocolVersion:e_[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...r,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0};if(!e_.includes(i.protocolVersion))throw new RangeError(`Unsupported protocol version: ${i.protocolVersion} (supported versions: ${e_.join(", ")})`);let o;if(t instanceof Rg)o=t,e._url=t.href;else{try{o=new Rg(t)}catch(e){throw new SyntaxError(`Invalid URL: ${t}`)}e._url=t}const s="wss:"===o.protocol,a="ws+unix:"===o.protocol;let l;if("ws:"===o.protocol||s||a?a&&!o.pathname?l="The URL's pathname is empty":o.hash&&(l="The URL contains a fragment identifier"):l='The URL\'s protocol must be one of "ws:", "wss:", or "ws+unix:"',l){const t=new SyntaxError(l);if(0===e._redirects)throw t;return void i_(e,t)}const c=s?443:80,u=Fg(16).toString("base64"),d=s?Og.get:Ag.get,h=new Set;let p;if(i.createConnection=s?s_:o_,i.defaultPort=i.defaultPort||c,i.port=o.port||c,i.host=o.hostname.startsWith("[")?o.hostname.slice(1,-1):o.hostname,i.headers={"Sec-WebSocket-Version":i.protocolVersion,"Sec-WebSocket-Key":u,Connection:"Upgrade",Upgrade:"websocket",...i.headers},i.path=o.pathname+o.search,i.timeout=i.handshakeTimeout,i.perMessageDeflate&&(p=new jg(!0!==i.perMessageDeflate?i.perMessageDeflate:{},!1,i.maxPayload),i.headers["Sec-WebSocket-Extensions"]=Jg({[jg.extensionName]:p.offer()})),n.length){for(const e of n){if("string"!=typeof e||!Zg.test(e)||h.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");h.add(e)}i.headers["Sec-WebSocket-Protocol"]=n.join(",")}if(i.origin&&(i.protocolVersion<13?i.headers["Sec-WebSocket-Origin"]=i.origin:i.headers.Origin=i.origin),(o.username||o.password)&&(i.auth=`${o.username}:${o.password}`),a){const e=i.path.split(":");i.socketPath=e[0],i.path=e[1]}let f=e._req=d(i);i.timeout&&f.on("timeout",(()=>{a_(e,f,"Opening handshake has timed out")})),f.on("error",(t=>{null===f||f.aborted||(f=e._req=null,i_(e,t))})),f.on("response",(o=>{const s=o.headers.location,a=o.statusCode;if(s&&i.followRedirects&&a>=300&&a<400){if(++e._redirects>i.maxRedirects)return void a_(e,f,"Maximum redirects exceeded");let o;f.abort();try{o=new Rg(s,t)}catch(t){const n=new SyntaxError(`Invalid URL: ${s}`);return void i_(e,n)}r_(e,o,n,r)}else e.emit("unexpected-response",f,o)||a_(e,f,`Unexpected server response: ${o.statusCode}`)})),f.on("upgrade",((t,n,r)=>{if(e.emit("upgrade",t),e.readyState!==t_.CONNECTING)return;f=e._req=null;const o=Ng("sha1").update(u+qg).digest("base64");if(t.headers["sec-websocket-accept"]!==o)return void a_(e,n,"Invalid Sec-WebSocket-Accept header");const s=t.headers["sec-websocket-protocol"];let a;if(void 0!==s?h.size?h.has(s)||(a="Server sent an invalid subprotocol"):a="Server sent a subprotocol but none was requested":h.size&&(a="Server sent no subprotocol"),a)return void a_(e,n,a);s&&(e._protocol=s);const l=t.headers["sec-websocket-extensions"];if(void 0!==l){if(!p){return void a_(e,n,"Server sent a Sec-WebSocket-Extensions header but no extension was requested")}let t;try{t=Yg(l)}catch(t){return void a_(e,n,"Invalid Sec-WebSocket-Extensions header")}const r=Object.keys(t);if(1!==r.length||r[0]!==jg.extensionName){return void a_(e,n,"Server indicated an extension that was not requested")}try{p.accept(t[jg.extensionName])}catch(t){return void a_(e,n,"Invalid Sec-WebSocket-Extensions header")}e._extensions[jg.extensionName]=p}e.setSocket(n,r,{generateMask:i.generateMask,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation})}))}function i_(e,t){e._readyState=t_.CLOSING,e.emit("error",t),e.emitClose()}function o_(e){return e.path=e.socketPath,Ig.connect(e)}function s_(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=Ig.isIP(e.host)?"":e.host),Mg.connect(e)}function a_(e,t,n){e._readyState=t_.CLOSING;const r=new Error(n);Error.captureStackTrace(r,a_),t.setHeader?(t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),t.once("abort",e.emitClose.bind(e)),e.emit("error",r)):(t.destroy(r),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function l_(e,t,n){if(t){const n=Xg(t).length;e._socket?e._sender._bufferedBytes+=n:e._bufferedAmount+=n}if(n){n(new Error(`WebSocket is not open: readyState ${e.readyState} (${Qg[e.readyState]})`))}}function c_(e,t){const n=this[zg];n._closeFrameReceived=!0,n._closeMessage=t,n._closeCode=e,void 0!==n._socket[zg]&&(n._socket.removeListener("data",w_),process.nextTick(g_,n._socket),1005===e?n.close():n.close(e,t))}function u_(){const e=this[zg];e.isPaused||e._socket.resume()}function d_(e){const t=this[zg];void 0!==t._socket[zg]&&(t._socket.removeListener("data",w_),process.nextTick(g_,t._socket),t.close(e[$g])),t.emit("error",e)}function h_(){this[zg].emitClose()}function p_(e,t){this[zg].emit("message",e,t)}function f_(e){const t=this[zg];t.pong(e,!t._isServer,Vg),t.emit("ping",e)}function m_(e){this[zg].emit("pong",e)}function g_(e){e.resume()}function __(){const e=this[zg];let t;this.removeListener("close",__),this.removeListener("data",w_),this.removeListener("end",v_),e._readyState=t_.CLOSING,this._readableState.endEmitted||e._closeFrameReceived||e._receiver._writableState.errorEmitted||null===(t=e._socket.read())||e._receiver.write(t),e._receiver.end(),this[zg]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",h_),e._receiver.on("finish",h_))}function w_(e){this[zg]._receiver.write(e)||this.pause()}function v_(){const e=this[zg];e._readyState=t_.CLOSING,e._receiver.end(),this.end()}function b_(){const e=this[zg];this.removeListener("error",b_),this.on("error",Vg),e&&(e._readyState=t_.CLOSING,this.destroy())}const{Duplex:y_}=B.default;function S_(e){e.emit("close")}function x_(){!this.destroyed&&this._writableState.finished&&this.destroy()}function k_(e){this.removeListener("error",k_),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}var E_=function(e,t){let n=!0;const r=new y_({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",(function(t,n){const i=!n&&r._readableState.objectMode?t.toString():t;r.push(i)||e.pause()})),e.once("error",(function(e){r.destroyed||(n=!1,r.destroy(e))})),e.once("close",(function(){r.destroyed||r.push(null)})),r._destroy=function(t,i){if(e.readyState===e.CLOSED)return i(t),void process.nextTick(S_,r);let o=!1;e.once("error",(function(e){o=!0,i(e)})),e.once("close",(function(){o||i(t),process.nextTick(S_,r)})),n&&e.terminate()},r._final=function(t){e.readyState!==e.CONNECTING?null!==e._socket&&(e._socket._writableState.finished?(t(),r._readableState.endEmitted&&r.destroy()):(e._socket.once("finish",(function(){t()})),e.close())):e.once("open",(function(){r._final(t)}))},r._read=function(){e.isPaused&&e.resume()},r._write=function(t,n,i){e.readyState!==e.CONNECTING?e.send(t,i):e.once("open",(function(){r._write(t,n,i)}))},r.on("end",x_),r.on("error",k_),r};const{tokenChars:C_}=jm.exports;var T_={parse:function(e){const t=new Set;let n=-1,r=-1,i=0;for(;i<e.length;i++){const o=e.charCodeAt(i);if(-1===r&&1===C_[o])-1===n&&(n=i);else if(0===i||32!==o&&9!==o){if(44!==o)throw new SyntaxError(`Unexpected character at index ${i}`);{if(-1===n)throw new SyntaxError(`Unexpected character at index ${i}`);-1===r&&(r=i);const o=e.slice(n,r);if(t.has(o))throw new SyntaxError(`The "${o}" subprotocol is duplicated`);t.add(o),n=r=-1}}else-1===r&&-1!==n&&(r=i)}if(-1===n||-1!==r)throw new SyntaxError("Unexpected end of input");const o=e.slice(n,i);if(t.has(o))throw new SyntaxError(`The "${o}" subprotocol is duplicated`);return t.add(o),t}};const P_=M.default,O_=P.default,{createHash:A_}=U.default,I_=Tg,M_=Mm,F_=T_,N_=n_,{GUID:R_,kWebSocket:j_}=dm,D_=/^[+/0-9A-Za-z]{22}==$/;var L_=class extends P_{constructor(e,t){if(super(),null==(e={maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=O_.createServer(((e,t)=>{const n=O_.STATUS_CODES[426];t.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),t.end(n)})),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){const e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(const n of Object.keys(t))e.on(n,t[n]);return function(){for(const n of Object.keys(t))e.removeListener(n,t[n])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,n,r)=>{this.handleUpgrade(t,n,r,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state)return e&&this.once("close",(()=>{e(new Error("The server is not running"))})),void process.nextTick(B_,this);if(e&&this.once("close",e),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(B_,this);else{const e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close((()=>{B_(this)}))}}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,n,r){t.on("error",H_);const i=void 0!==e.headers["sec-websocket-key"]&&e.headers["sec-websocket-key"],o=+e.headers["sec-websocket-version"];if("GET"!==e.method||"websocket"!==e.headers.upgrade.toLowerCase()||!i||!D_.test(i)||8!==o&&13!==o||!this.shouldHandle(e))return q_(t,400);const s=e.headers["sec-websocket-protocol"];let a=new Set;if(void 0!==s)try{a=F_.parse(s)}catch(e){return q_(t,400)}const l=e.headers["sec-websocket-extensions"],c={};if(this.options.perMessageDeflate&&void 0!==l){const e=new M_(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const t=I_.parse(l);t[M_.extensionName]&&(e.accept(t[M_.extensionName]),c[M_.extensionName]=e)}catch(e){return q_(t,400)}}if(this.options.verifyClient){const s={origin:e.headers[""+(8===o?"sec-websocket-origin":"origin")],secure:!(!e.socket.authorized&&!e.socket.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(s,((o,s,l,u)=>{if(!o)return q_(t,s||401,l,u);this.completeUpgrade(c,i,a,e,t,n,r)}));if(!this.options.verifyClient(s))return q_(t,401)}this.completeUpgrade(c,i,a,e,t,n,r)}completeUpgrade(e,t,n,r,i,o,s){if(!i.readable||!i.writable)return i.destroy();if(i[j_])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return q_(i,503);const a=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${A_("sha1").update(t+R_).digest("base64")}`],l=new N_(null);if(n.size){const e=this.options.handleProtocols?this.options.handleProtocols(n,r):n.values().next().value;e&&(a.push(`Sec-WebSocket-Protocol: ${e}`),l._protocol=e)}if(e[M_.extensionName]){const t=e[M_.extensionName].params,n=I_.format({[M_.extensionName]:[t]});a.push(`Sec-WebSocket-Extensions: ${n}`),l._extensions=e}this.emit("headers",a,r),i.write(a.concat("\r\n").join("\r\n")),i.removeListener("error",H_),l.setSocket(i,o,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(l),l.on("close",(()=>{this.clients.delete(l),this._shouldEmitClose&&!this.clients.size&&process.nextTick(B_,this)}))),s(l,r)}};function B_(e){e._state=2,e.emit("close")}function H_(){this.destroy()}function q_(e,t,n,r){e.writable&&(n=n||O_.STATUS_CODES[t],r={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(n),...r},e.write(`HTTP/1.1 ${t} ${O_.STATUS_CODES[t]}\r\n`+Object.keys(r).map((e=>`${e}: ${r[e]}`)).join("\r\n")+"\r\n\r\n"+n)),e.removeListener("error",H_),e.destroy()}const U_=n_;U_.createWebSocketStream=E_,U_.Server=L_,U_.Receiver=Xm,U_.Sender=lg,U_.WebSocket=U_,U_.WebSocketServer=U_.Server;var W_=U_,$_={},z_={},V_={};Object.defineProperty(V_,"__esModule",{value:!0}),V_.Download=void 0;var G_,K_=function(e){return e&&e.__esModule?e:{default:e}}(T.default),J_=Uh(),Y_=Ci,X_=Np;function Q_(){if(G_)return z_;G_=1,Object.defineProperty(z_,"__esModule",{value:!0}),z_.Browser=void 0;var e=fx(),t=Uh(),n=V_,r=Hl,i=Np;class o extends r.SdkObject{constructor(e){super(e.rootSdkObject,"browser"),this.options=void 0,this._downloads=new Map,this._defaultContext=null,this._startedClosing=!1,this._idToVideo=new Map,this.attribution.browser=this,this.options=e}async newContext(t,n){(0,e.validateBrowserContextOptions)(n,this.options);const r=await this.doCreateNewContext(n);return n.storageState&&await r.setStorageState(t,n.storageState),r}_downloadCreated(e,t,r,i){const o=new n.Download(e,this.options.downloadsPath||"",t,r,i);this._downloads.set(t,o)}_downloadFilenameSuggested(e,t){const n=this._downloads.get(e);n&&n._filenameSuggested(t)}_downloadFinished(e,t){const n=this._downloads.get(e);n&&(n.artifact.reportFinished(t),this._downloads.delete(e))}_videoStarted(n,r,o,s){const a=new i.Artifact(n,o);this._idToVideo.set(r,{context:n,artifact:a}),s.then((n=>{n instanceof t.Page&&(n._video=a,n.emitOnContext(e.BrowserContext.Events.VideoStarted,a),n.emit(t.Page.Events.Video,a))}))}_takeVideo(e){const t=this._idToVideo.get(e);return this._idToVideo.delete(e),null==t?void 0:t.artifact}_didClose(){for(const e of this.contexts())e._browserClosed();this._defaultContext&&this._defaultContext._browserClosed(),this.emit(o.Events.Disconnected)}async close(){this._startedClosing||(this._startedClosing=!0,await this.options.browserProcess.close()),this.isConnected()&&await new Promise((e=>this.once(o.Events.Disconnected,e)))}async killForTests(){await this.options.browserProcess.kill()}}return z_.Browser=o,o.Events={Disconnected:"disconnected"},z_}V_.Download=class{constructor(e,t,n,r,i){this.artifact=void 0,this.url=void 0,this._page=void 0,this._suggestedFilename=void 0;const o=e._browserContext._options.acceptDownloads?void 0:"Pass { acceptDownloads: true } when you are creating your browser context.";this.artifact=new X_.Artifact(e,K_.default.join(t,n),o,(()=>this._page._browserContext.cancelDownload(n))),this._page=e,this.url=r,this._suggestedFilename=i,e._browserContext._downloads.add(this),void 0!==i&&this._page.emit(J_.Page.Events.Download,this)}_filenameSuggested(e){(0,Y_.assert)(void 0===this._suggestedFilename),this._suggestedFilename=e,this._page.emit(J_.Page.Events.Download,this)}suggestedFilename(){return this._suggestedFilename}};var Z_={};Object.defineProperty(Z_,"__esModule",{value:!0}),Z_.kBrowserCloseMessageId=Z_.ConnectionEvents=Z_.CRSessionEvents=Z_.CRSession=Z_.CRConnection=void 0;var ew=Ci,tw=M.default,nw=$l,rw=Ka,iw=su,ow=ku;const sw={Disconnected:Symbol("ConnectionEvents.Disconnected")};Z_.ConnectionEvents=sw;Z_.kBrowserCloseMessageId=-9999;class aw extends tw.EventEmitter{constructor(e,t,n){super(),this._lastId=0,this._transport=void 0,this._sessions=new Map,this._protocolLogger=void 0,this._browserLogsCollector=void 0,this.rootSession=void 0,this._closed=!1,this.setMaxListeners(0),this._transport=e,this._protocolLogger=t,this._browserLogsCollector=n,this._transport.onmessage=this._onMessage.bind(this),this._transport.onclose=this._onClose.bind(this),this.rootSession=new cw(this,"","browser",""),this._sessions.set("",this.rootSession)}static fromSession(e){return e._connection}session(e){return this._sessions.get(e)||null}_rawSend(e,t,n){const r=++this._lastId,i={id:r,method:t,params:n};return e&&(i.sessionId=e),this._protocolLogger("send",i),this._transport.send(i),r}async _onMessage(e){if(this._protocolLogger("receive",e),-9999===e.id)return;if("Target.attachedToTarget"===e.method){const t=e.params.sessionId,n=e.sessionId||"",r=new cw(this,n,e.params.targetInfo.type,t);this._sessions.set(t,r)}else if("Target.detachedFromTarget"===e.method){const t=this._sessions.get(e.params.sessionId);t&&(t._onClosed(void 0),this._sessions.delete(e.params.sessionId))}const t=this._sessions.get(e.sessionId||"");t&&t._onMessage(e)}_onClose(){this._closed=!0,this._transport.onmessage=void 0,this._transport.onclose=void 0;const e=iw.helper.formatBrowserLogs(this._browserLogsCollector.recentLogs());for(const t of this._sessions.values())t._onClosed(e);this._sessions.clear(),Promise.resolve().then((()=>this.emit(sw.Disconnected)))}close(){this._closed||this._transport.close()}async createSession(e){const{sessionId:t}=await this.rootSession.send("Target.attachToTarget",{targetId:e.targetId,flatten:!0});return this._sessions.get(t)}async createBrowserSession(){const{sessionId:e}=await this.rootSession.send("Target.attachToBrowserTarget");return this._sessions.get(e)}}Z_.CRConnection=aw;const lw={Disconnected:Symbol("Events.CDPSession.Disconnected")};Z_.CRSessionEvents=lw;class cw extends tw.EventEmitter{constructor(e,t,n,r){super(),this._connection=void 0,this._eventListener=void 0,this._callbacks=new Map,this._targetType=void 0,this._sessionId=void 0,this._rootSessionId=void 0,this._crashed=!1,this._browserDisconnectedLogs=void 0,this.on=void 0,this.addListener=void 0,this.off=void 0,this.removeListener=void 0,this.once=void 0,this.guid=void 0,this.guid=`cdp-session@${r}`,this.setMaxListeners(0),this._connection=e,this._rootSessionId=t,this._targetType=n,this._sessionId=r,this.on=super.on,this.addListener=super.addListener,this.off=super.removeListener,this.removeListener=super.removeListener,this.once=super.once}_markAsCrashed(){this._crashed=!0}async send(e,t){if(this._crashed)throw new ow.ProtocolError(!0,"Target crashed");if(void 0!==this._browserDisconnectedLogs)throw new ow.ProtocolError(!0,"Browser closed."+this._browserDisconnectedLogs);if(!this._connection)throw new ow.ProtocolError(!0,"Target closed");const n=this._connection._rawSend(this._sessionId,e,t);return new Promise(((t,r)=>{this._callbacks.set(n,{resolve:t,reject:r,error:new ow.ProtocolError(!1),method:e})}))}_sendMayFail(e,t){return this.send(e,t).catch((e=>rw.debugLogger.log("error",e)))}_onMessage(e){if(e.id&&this._callbacks.has(e.id)){const t=this._callbacks.get(e.id);this._callbacks.delete(e.id),e.error?t.reject(function(e,t,n){let r=`Protocol error (${t}): ${n.message}`;"data"in n&&(r+=` ${n.data}`);return(0,nw.rewriteErrorMessage)(e,r)}(t.error,t.method,e.error)):t.resolve(e.result)}else(0,ew.assert)(!e.id),Promise.resolve().then((()=>{this._eventListener&&this._eventListener(e.method,e.params),this.emit(e.method,e.params)}))}async detach(){if(!this._connection)throw new Error(`Session already detached. Most likely the ${this._targetType} has been closed.`);const e=this._connection.session(this._rootSessionId);if(!e)throw new Error("Root session has been closed");await e.send("Target.detachFromTarget",{sessionId:this._sessionId})}_onClosed(e){this._browserDisconnectedLogs=e;const t=void 0!==e?"Browser closed."+e:"Target closed";for(const e of this._callbacks.values())e.error.sessionClosed=!0,e.reject((0,nw.rewriteErrorMessage)(e.error,t));this._callbacks.clear(),this._connection=null,Promise.resolve().then((()=>this.emit(lw.Disconnected)))}}Z_.CRSession=cw;var uw={},dw={};Object.defineProperty(dw,"__esModule",{value:!0}),dw.Dialog=void 0;var hw=Ci,pw=Hl;class fw extends pw.SdkObject{constructor(e,t,n,r,i){super(e,"dialog"),this._page=void 0,this._type=void 0,this._message=void 0,this._onHandle=void 0,this._handled=!1,this._defaultValue=void 0,this._page=e,this._type=t,this._message=n,this._onHandle=r,this._defaultValue=i||"",this._page._frameManager.dialogDidOpen(this)}type(){return this._type}message(){return this._message}defaultValue(){return this._defaultValue}async accept(e){(0,hw.assert)(!this._handled,"Cannot accept dialog which is already handled!"),this._handled=!0,this._page._frameManager.dialogWillClose(this),await this._onHandle(!0,e)}async dismiss(){(0,hw.assert)(!this._handled,"Cannot dismiss dialog which is already handled!"),this._handled=!0,this._page._frameManager.dialogWillClose(this),await this._onHandle(!1)}}dw.Dialog=fw;var mw={};Object.defineProperty(mw,"__esModule",{value:!0}),mw.getAccessibilityTree=async function(e,t){const{nodes:n}=await e.send("Accessibility.getFullAXTree"),r=gw.createTree(e,n);return{tree:r,needle:t?await r._findElement(t):null}};class gw{constructor(e,t){this._payload=void 0,this._children=[],this._richlyEditable=!1,this._editable=!1,this._focusable=!1,this._expanded=!1,this._hidden=!1,this._name=void 0,this._role=void 0,this._cachedHasFocusableChild=void 0,this._client=void 0,this._client=e,this._payload=t,this._name=this._payload.name?this._payload.name.value:"",this._role=this._payload.role?this._payload.role.value:"Unknown";for(const e of this._payload.properties||[])"editable"===e.name&&(this._richlyEditable="richtext"===e.value.value,this._editable=!0),"focusable"===e.name&&(this._focusable=e.value.value),"expanded"===e.name&&(this._expanded=e.value.value),"hidden"===e.name&&(this._hidden=e.value.value)}_isPlainTextField(){return!this._richlyEditable&&(!!this._editable||("textbox"===this._role||"ComboBox"===this._role||"searchbox"===this._role))}_isTextOnlyObject(){const e=this._role;return"LineBreak"===e||"text"===e||"InlineTextBox"===e||"StaticText"===e}_hasFocusableChild(){if(void 0===this._cachedHasFocusableChild){this._cachedHasFocusableChild=!1;for(const e of this._children)if(e._focusable||e._hasFocusableChild()){this._cachedHasFocusableChild=!0;break}}return this._cachedHasFocusableChild}children(){return this._children}async _findElement(e){const t=e._objectId,{node:{backendNodeId:n}}=await this._client.send("DOM.describeNode",{objectId:t}),r=this.find((e=>e._payload.backendDOMNodeId===n));return r||null}find(e){if(e(this))return this;for(const t of this._children){const n=t.find(e);if(n)return n}return null}isLeafNode(){if(!this._children.length)return!0;if(this._isPlainTextField()||this._isTextOnlyObject())return!0;switch(this._role){case"doc-cover":case"graphics-symbol":case"img":case"Meter":case"scrollbar":case"slider":case"separator":case"progressbar":return!0}return!this._hasFocusableChild()&&(!(!this._focusable||"WebArea"===this._role||"RootWebArea"===this._role||!this._name)||!("heading"!==this._role||!this._name))}isControl(){switch(this._role){case"button":case"checkbox":case"ColorWell":case"combobox":case"DisclosureTriangle":case"listbox":case"menu":case"menubar":case"menuitem":case"menuitemcheckbox":case"menuitemradio":case"radio":case"scrollbar":case"searchbox":case"slider":case"spinbutton":case"switch":case"tab":case"textbox":case"tree":return!0;default:return!1}}isInteresting(e){return"Ignored"!==this._role&&!this._hidden&&(!(!this._focusable&&!this._richlyEditable)||(!!this.isControl()||!e&&(this.isLeafNode()&&!!this._name)))}normalizedRole(){switch(this._role){case"RootWebArea":return"WebArea";case"StaticText":return"text";default:return this._role}}serialize(){const e=new Map;for(const t of this._payload.properties||[])e.set(t.name.toLowerCase(),t.value.value);this._payload.description&&e.set("description",this._payload.description.value);const t={role:this.normalizedRole(),name:this._payload.name&&this._payload.name.value||""},n=["description","keyshortcuts","roledescription","valuetext"];for(const r of n)e.has(r)&&(t[r]=e.get(r));const r=["disabled","expanded","focused","modal","multiline","multiselectable","readonly","required","selected"];for(const n of r){if("focused"===n&&("WebArea"===this._role||"RootWebArea"===this._role))continue;const r=e.get(n);r&&(t[n]=r)}const i=["level","valuemax","valuemin"];for(const n of i)e.has(n)&&(t[n]=e.get(n));const o=["autocomplete","haspopup","invalid","orientation"];for(const n of o){const r=e.get(n);r&&"false"!==r&&(t[n]=r)}const s=t;return this._payload.value&&("string"==typeof this._payload.value.value&&(s.valueString=this._payload.value.value),"number"==typeof this._payload.value.value&&(s.valueNumber=this._payload.value.value)),e.has("checked")&&(s.checked="true"===e.get("checked")?"checked":"false"===e.get("checked")?"unchecked":"mixed"),e.has("pressed")&&(s.pressed="true"===e.get("pressed")?"pressed":"false"===e.get("pressed")?"released":"mixed"),s}static createTree(e,t){const n=new Map;for(const r of t)n.set(r.nodeId,new gw(e,r));for(const e of n.values())for(const t of e._payload.childIds||[])e._children.push(n.get(t));return n.values().next().value}}var _w={};Object.defineProperty(_w,"__esModule",{value:!0}),_w.CRCoverage=void 0;var ww=au,vw=Ci;_w.CRCoverage=class{constructor(e){this._jsCoverage=void 0,this._cssCoverage=void 0,this._jsCoverage=new bw(e),this._cssCoverage=new yw(e)}async startJSCoverage(e){return await this._jsCoverage.start(e)}async stopJSCoverage(){return await this._jsCoverage.stop()}async startCSSCoverage(e){return await this._cssCoverage.start(e)}async stopCSSCoverage(){return await this._cssCoverage.stop()}};class bw{constructor(e){this._client=void 0,this._enabled=void 0,this._scriptIds=void 0,this._scriptSources=void 0,this._eventListeners=void 0,this._resetOnNavigation=void 0,this._reportAnonymousScripts=!1,this._client=e,this._enabled=!1,this._scriptIds=new Set,this._scriptSources=new Map,this._eventListeners=[],this._resetOnNavigation=!1}async start(e={}){(0,vw.assert)(!this._enabled,"JSCoverage is already enabled");const{resetOnNavigation:t=!0,reportAnonymousScripts:n=!1}=e;this._resetOnNavigation=t,this._reportAnonymousScripts=n,this._enabled=!0,this._scriptIds.clear(),this._scriptSources.clear(),this._eventListeners=[ww.eventsHelper.addEventListener(this._client,"Debugger.scriptParsed",this._onScriptParsed.bind(this)),ww.eventsHelper.addEventListener(this._client,"Runtime.executionContextsCleared",this._onExecutionContextsCleared.bind(this)),ww.eventsHelper.addEventListener(this._client,"Debugger.paused",this._onDebuggerPaused.bind(this))],await Promise.all([this._client.send("Profiler.enable"),this._client.send("Profiler.startPreciseCoverage",{callCount:!0,detailed:!0}),this._client.send("Debugger.enable"),this._client.send("Debugger.setSkipAllPauses",{skip:!0})])}_onDebuggerPaused(){this._client.send("Debugger.resume")}_onExecutionContextsCleared(){this._resetOnNavigation&&(this._scriptIds.clear(),this._scriptSources.clear())}async _onScriptParsed(e){if(this._scriptIds.add(e.scriptId),!e.url&&!this._reportAnonymousScripts)return;const t=await this._client._sendMayFail("Debugger.getScriptSource",{scriptId:e.scriptId});t&&this._scriptSources.set(e.scriptId,t.scriptSource)}async stop(){(0,vw.assert)(this._enabled,"JSCoverage is not enabled"),this._enabled=!1;const[e]=await Promise.all([this._client.send("Profiler.takePreciseCoverage"),this._client.send("Profiler.stopPreciseCoverage"),this._client.send("Profiler.disable"),this._client.send("Debugger.disable")]);ww.eventsHelper.removeEventListeners(this._eventListeners);const t=[];for(const n of e.result){if(!this._scriptIds.has(n.scriptId))continue;if(!n.url&&!this._reportAnonymousScripts)continue;const e=this._scriptSources.get(n.scriptId);e?t.push({...n,source:e}):t.push(n)}return t}}class yw{constructor(e){this._client=void 0,this._enabled=void 0,this._stylesheetURLs=void 0,this._stylesheetSources=void 0,this._eventListeners=void 0,this._resetOnNavigation=void 0,this._client=e,this._enabled=!1,this._stylesheetURLs=new Map,this._stylesheetSources=new Map,this._eventListeners=[],this._resetOnNavigation=!1}async start(e={}){(0,vw.assert)(!this._enabled,"CSSCoverage is already enabled");const{resetOnNavigation:t=!0}=e;this._resetOnNavigation=t,this._enabled=!0,this._stylesheetURLs.clear(),this._stylesheetSources.clear(),this._eventListeners=[ww.eventsHelper.addEventListener(this._client,"CSS.styleSheetAdded",this._onStyleSheet.bind(this)),ww.eventsHelper.addEventListener(this._client,"Runtime.executionContextsCleared",this._onExecutionContextsCleared.bind(this))],await Promise.all([this._client.send("DOM.enable"),this._client.send("CSS.enable"),this._client.send("CSS.startRuleUsageTracking")])}_onExecutionContextsCleared(){this._resetOnNavigation&&(this._stylesheetURLs.clear(),this._stylesheetSources.clear())}async _onStyleSheet(e){const t=e.header;if(!t.sourceURL)return;const n=await this._client._sendMayFail("CSS.getStyleSheetText",{styleSheetId:t.styleSheetId});n&&(this._stylesheetURLs.set(t.styleSheetId,t.sourceURL),this._stylesheetSources.set(t.styleSheetId,n.text))}async stop(){(0,vw.assert)(this._enabled,"CSSCoverage is not enabled"),this._enabled=!1;const e=await this._client.send("CSS.stopRuleUsageTracking");await Promise.all([this._client.send("CSS.disable"),this._client.send("DOM.disable")]),ww.eventsHelper.removeEventListeners(this._eventListeners);const t=new Map;for(const n of e.ruleUsage){let e=t.get(n.styleSheetId);e||(e=[],t.set(n.styleSheetId,e)),e.push({startOffset:n.startOffset,endOffset:n.endOffset,count:n.used?1:0})}const n=[];for(const e of this._stylesheetURLs.keys()){const r=this._stylesheetURLs.get(e),i=this._stylesheetSources.get(e),o=Sw(t.get(e)||[]);n.push({url:r,ranges:o,text:i})}return n}}function Sw(e){const t=[];for(const n of e)t.push({offset:n.startOffset,type:0,range:n}),t.push({offset:n.endOffset,type:1,range:n});t.sort(((e,t)=>{if(e.offset!==t.offset)return e.offset-t.offset;if(e.type!==t.type)return t.type-e.type;const n=e.range.endOffset-e.range.startOffset,r=t.range.endOffset-t.range.startOffset;return 0===e.type?r-n:n-r}));const n=[],r=[];let i=0;for(const e of t){if(n.length&&i<e.offset&&n[n.length-1]>0){const t=r.length?r[r.length-1]:null;t&&t.end===i?t.end=e.offset:r.push({start:i,end:e.offset})}i=e.offset,0===e.type?n.push(e.range.count):n.pop()}return r.filter((e=>e.end-e.start>1))}var xw={},kw={};Object.defineProperty(kw,"__esModule",{value:!0}),kw.exceptionToError=function(e){const t=Pw(e),n=t.split("\n"),r=n.findIndex((e=>e.startsWith("    at")));let i="",o="";-1===r?i=t:(i=n.slice(0,r).join("\n"),o=t);const{name:s,message:a}=(0,Tw.splitErrorMessage)(i),l=new Error(a);return l.stack=o,l.name=s,l},kw.getExceptionMessage=Pw,kw.readProtocolStream=async function(e,t,n){let r,i=!1;n&&(await(0,Cw.mkdirIfNeeded)(n),r=await Ew.default.promises.open(n,"w"));const o=[];for(;!i;){const n=await e.send("IO.read",{handle:t});i=n.eof;const s=Buffer.from(n.data,n.base64Encoded?"base64":void 0);o.push(s),r&&await r.write(s)}r&&await r.close();return await e.send("IO.close",{handle:t}),Buffer.concat(o)},kw.releaseObject=async function(e,t){await e.send("Runtime.releaseObject",{objectId:t}).catch((e=>{}))},kw.toButtonsMask=function(e){let t=0;e.has("left")&&(t|=1);e.has("right")&&(t|=2);e.has("middle")&&(t|=4);return t},kw.toConsoleMessageLocation=function(e){return e&&e.callFrames.length?{url:e.callFrames[0].url,lineNumber:e.callFrames[0].lineNumber,columnNumber:e.callFrames[0].columnNumber}:{url:"",lineNumber:0,columnNumber:0}},kw.toModifiersMask=function(e){let t=0;e.has("Alt")&&(t|=1);e.has("Control")&&(t|=2);e.has("Meta")&&(t|=4);e.has("Shift")&&(t|=8);return t};var Ew=function(e){return e&&e.__esModule?e:{default:e}}(C.default),Cw=Ri,Tw=$l;function Pw(e){if(e.exception)return e.exception.description||String(e.exception.value);let t=e.text;if(e.stackTrace)for(const n of e.stackTrace.callFrames){const e=n.url+":"+n.lineNumber+":"+n.columnNumber;t+=`\n    at ${n.functionName||"<anonymous>"} (${e})`}return t}Object.defineProperty(xw,"__esModule",{value:!0}),xw.DragManager=void 0;var Ow=Ci,Aw=kw;xw.DragManager=class{constructor(e){this._crPage=void 0,this._dragState=null,this._lastPosition={x:0,y:0},this._crPage=e}async cancelDrag(){return!!this._dragState&&(await this._crPage._mainFrameSession._client.send("Input.dispatchDragEvent",{type:"dragCancel",x:this._lastPosition.x,y:this._lastPosition.y,data:{items:[],dragOperationsMask:65535}}),this._dragState=null,!0)}async interceptDragCausedByMove(e,t,n,r,i,o){if(this._lastPosition={x:e,y:t},this._dragState)return void await this._crPage._mainFrameSession._client.send("Input.dispatchDragEvent",{type:"dragOver",x:e,y:t,data:this._dragState,modifiers:(0,Aw.toModifiersMask)(i)});if("left"!==n)return o();const s=this._crPage._mainFrameSession._client;let a;const l=new Promise((e=>a=e));await Promise.all(this._crPage._page.frames().map((async e=>{await e.nonStallingEvaluateInExistingContext(function(){let e=Promise.resolve(!1),t=null;const n=e=>t=e,r=()=>{e=new Promise((e=>{window.addEventListener("dragstart",n,{once:!0,capture:!0}),setTimeout((()=>e(!!t&&!t.defaultPrevented)),0)}))};window.addEventListener("mousemove",r,{once:!0,capture:!0}),window.__cleanupDrag=async()=>{const t=await e;return window.removeEventListener("mousemove",r,{capture:!0}),window.removeEventListener("dragstart",n,{capture:!0}),delete window.__cleanupDrag,t}}.toString(),!0,"utility").catch((()=>{}))}))),s.on("Input.dragIntercepted",a);try{await s.send("Input.setInterceptDrags",{enabled:!0})}catch{return s.off("Input.dragIntercepted",a),o()}await o();const c=(await Promise.all(this._crPage._page.frames().map((async e=>e.nonStallingEvaluateInExistingContext("window.__cleanupDrag && window.__cleanupDrag()",!1,"utility").catch((()=>!1)))))).some((e=>e));this._dragState=c?(await l).data:null,s.off("Input.dragIntercepted",a),await s.send("Input.setInterceptDrags",{enabled:!1}),this._dragState&&await this._crPage._mainFrameSession._client.send("Input.dispatchDragEvent",{type:"dragEnter",x:e,y:t,data:this._dragState,modifiers:(0,Aw.toModifiersMask)(i)})}isDragging(){return!!this._dragState}async drop(e,t,n){(0,Ow.assert)(this._dragState,"missing drag state"),await this._crPage._mainFrameSession._client.send("Input.dispatchDragEvent",{type:"drop",x:e,y:t,data:this._dragState,modifiers:(0,Aw.toModifiersMask)(n)}),this._dragState=null}};var Iw={};Object.defineProperty(Iw,"__esModule",{value:!0}),Iw.CRExecutionContext=void 0;var Mw=kw,Fw=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=Dw(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(Cu),Nw=$l,Rw=Pu,jw=ku;function Dw(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(Dw=function(e){return e?n:t})(e)}function Lw(e){if(e.message.includes("Object reference chain is too long"))return{result:{type:"undefined"}};if(e.message.includes("Object couldn't be returned by value"))return{result:{type:"undefined"}};if(e instanceof TypeError&&e.message.startsWith("Converting circular structure to JSON")&&(0,Nw.rewriteErrorMessage)(e,e.message+" Are you passing a nested JSHandle?"),!Fw.isJavaScriptErrorInEvaluate(e)&&!(0,jw.isSessionClosedError)(e))throw new Error("Execution context was destroyed, most likely because of a navigation.");throw e}Iw.CRExecutionContext=class{constructor(e,t){this._client=void 0,this._contextId=void 0,this._client=e,this._contextId=t.id}async rawEvaluateJSON(e){const{exceptionDetails:t,result:n}=await this._client.send("Runtime.evaluate",{expression:e,contextId:this._contextId,returnByValue:!0}).catch(Lw);if(t)throw new Fw.JavaScriptErrorInEvaluate((0,Mw.getExceptionMessage)(t));return n.value}async rawEvaluateHandle(e){const{exceptionDetails:t,result:n}=await this._client.send("Runtime.evaluate",{expression:e,contextId:this._contextId}).catch(Lw);if(t)throw new Fw.JavaScriptErrorInEvaluate((0,Mw.getExceptionMessage)(t));return n.objectId}rawCallFunctionNoReply(e,...t){this._client.send("Runtime.callFunctionOn",{functionDeclaration:e.toString(),arguments:t.map((e=>e instanceof Fw.JSHandle?{objectId:e._objectId}:{value:e})),returnByValue:!0,executionContextId:this._contextId,userGesture:!0}).catch((()=>{}))}async evaluateWithArguments(e,t,n,r,i){const{exceptionDetails:o,result:s}=await this._client.send("Runtime.callFunctionOn",{functionDeclaration:e,objectId:n._objectId,arguments:[{objectId:n._objectId},...r.map((e=>({value:e}))),...i.map((e=>({objectId:e})))],returnByValue:t,awaitPromise:!0,userGesture:!0}).catch(Lw);if(o)throw new Fw.JavaScriptErrorInEvaluate((0,Mw.getExceptionMessage)(o));return t?(0,Rw.parseEvaluationResultValue)(s.value):n._context.createHandle(s)}async getProperties(e,t){const n=await this._client.send("Runtime.getProperties",{objectId:t,ownProperties:!0}),r=new Map;for(const t of n.result)t.enumerable&&t.value&&r.set(t.name,e.createHandle(t.value));return r}createHandle(e,t){return new Fw.JSHandle(e,t.subtype||t.type,function(e){if("undefined"===e.type)return"undefined";if("value"in e)return String(e.value);if(e.unserializableValue)return String(e.unserializableValue);if("Object"===e.description&&e.preview){const t=[];for(const{name:n,value:r}of e.preview.properties)t.push(`${n}: ${r}`);return`{${t.join(", ")}}`}if("array"===e.subtype&&e.preview){const t=[];for(const{name:n,value:r}of e.preview.properties)t[+n]=r;return"["+String(t)+"]"}return e.description}(t),t.objectId,function(e){const t=e.value,n=e.unserializableValue;return n?Fw.parseUnserializableValue(n):t}(t))}async releaseHandle(e){await(0,Mw.releaseObject)(this._client,e)}};var Bw={},Hw={};Object.defineProperty(Hw,"__esModule",{value:!0}),Hw.macEditingCommands=void 0;Hw.macEditingCommands={Backspace:"deleteBackward:",Enter:"insertNewline:",NumpadEnter:"insertNewline:",Escape:"cancelOperation:",ArrowUp:"moveUp:",ArrowDown:"moveDown:",ArrowLeft:"moveLeft:",ArrowRight:"moveRight:",F5:"complete:",Delete:"deleteForward:",Home:"scrollToBeginningOfDocument:",End:"scrollToEndOfDocument:",PageUp:"scrollPageUp:",PageDown:"scrollPageDown:","Shift+Backspace":"deleteBackward:","Shift+Enter":"insertNewline:","Shift+NumpadEnter":"insertNewline:","Shift+Escape":"cancelOperation:","Shift+ArrowUp":"moveUpAndModifySelection:","Shift+ArrowDown":"moveDownAndModifySelection:","Shift+ArrowLeft":"moveLeftAndModifySelection:","Shift+ArrowRight":"moveRightAndModifySelection:","Shift+F5":"complete:","Shift+Delete":"deleteForward:","Shift+Home":"moveToBeginningOfDocumentAndModifySelection:","Shift+End":"moveToEndOfDocumentAndModifySelection:","Shift+PageUp":"pageUpAndModifySelection:","Shift+PageDown":"pageDownAndModifySelection:","Shift+Numpad5":"delete:","Control+Tab":"selectNextKeyView:","Control+Enter":"insertLineBreak:","Control+NumpadEnter":"insertLineBreak:","Control+Quote":"insertSingleQuoteIgnoringSubstitution:","Control+KeyA":"moveToBeginningOfParagraph:","Control+KeyB":"moveBackward:","Control+KeyD":"deleteForward:","Control+KeyE":"moveToEndOfParagraph:","Control+KeyF":"moveForward:","Control+KeyH":"deleteBackward:","Control+KeyK":"deleteToEndOfParagraph:","Control+KeyL":"centerSelectionInVisibleArea:","Control+KeyN":"moveDown:","Control+KeyO":["insertNewlineIgnoringFieldEditor:","moveBackward:"],"Control+KeyP":"moveUp:","Control+KeyT":"transpose:","Control+KeyV":"pageDown:","Control+KeyY":"yank:","Control+Backspace":"deleteBackwardByDecomposingPreviousCharacter:","Control+ArrowUp":"scrollPageUp:","Control+ArrowDown":"scrollPageDown:","Control+ArrowLeft":"moveToLeftEndOfLine:","Control+ArrowRight":"moveToRightEndOfLine:","Shift+Control+Enter":"insertLineBreak:","Shift+Control+NumpadEnter":"insertLineBreak:","Shift+Control+Tab":"selectPreviousKeyView:","Shift+Control+Quote":"insertDoubleQuoteIgnoringSubstitution:","Shift+Control+KeyA":"moveToBeginningOfParagraphAndModifySelection:","Shift+Control+KeyB":"moveBackwardAndModifySelection:","Shift+Control+KeyE":"moveToEndOfParagraphAndModifySelection:","Shift+Control+KeyF":"moveForwardAndModifySelection:","Shift+Control+KeyN":"moveDownAndModifySelection:","Shift+Control+KeyP":"moveUpAndModifySelection:","Shift+Control+KeyV":"pageDownAndModifySelection:","Shift+Control+Backspace":"deleteBackwardByDecomposingPreviousCharacter:","Shift+Control+ArrowUp":"scrollPageUp:","Shift+Control+ArrowDown":"scrollPageDown:","Shift+Control+ArrowLeft":"moveToLeftEndOfLineAndModifySelection:","Shift+Control+ArrowRight":"moveToRightEndOfLineAndModifySelection:","Alt+Backspace":"deleteWordBackward:","Alt+Enter":"insertNewlineIgnoringFieldEditor:","Alt+NumpadEnter":"insertNewlineIgnoringFieldEditor:","Alt+Escape":"complete:","Alt+ArrowUp":["moveBackward:","moveToBeginningOfParagraph:"],"Alt+ArrowDown":["moveForward:","moveToEndOfParagraph:"],"Alt+ArrowLeft":"moveWordLeft:","Alt+ArrowRight":"moveWordRight:","Alt+Delete":"deleteWordForward:","Alt+PageUp":"pageUp:","Alt+PageDown":"pageDown:","Shift+Alt+Backspace":"deleteWordBackward:","Shift+Alt+Enter":"insertNewlineIgnoringFieldEditor:","Shift+Alt+NumpadEnter":"insertNewlineIgnoringFieldEditor:","Shift+Alt+Escape":"complete:","Shift+Alt+ArrowUp":"moveParagraphBackwardAndModifySelection:","Shift+Alt+ArrowDown":"moveParagraphForwardAndModifySelection:","Shift+Alt+ArrowLeft":"moveWordLeftAndModifySelection:","Shift+Alt+ArrowRight":"moveWordRightAndModifySelection:","Shift+Alt+Delete":"deleteWordForward:","Shift+Alt+PageUp":"pageUp:","Shift+Alt+PageDown":"pageDown:","Control+Alt+KeyB":"moveWordBackward:","Control+Alt+KeyF":"moveWordForward:","Control+Alt+Backspace":"deleteWordBackward:","Shift+Control+Alt+KeyB":"moveWordBackwardAndModifySelection:","Shift+Control+Alt+KeyF":"moveWordForwardAndModifySelection:","Shift+Control+Alt+Backspace":"deleteWordBackward:","Meta+NumpadSubtract":"cancel:","Meta+Backspace":"deleteToBeginningOfLine:","Meta+ArrowUp":"moveToBeginningOfDocument:","Meta+ArrowDown":"moveToEndOfDocument:","Meta+ArrowLeft":"moveToLeftEndOfLine:","Meta+ArrowRight":"moveToRightEndOfLine:","Shift+Meta+NumpadSubtract":"cancel:","Shift+Meta+Backspace":"deleteToBeginningOfLine:","Shift+Meta+ArrowUp":"moveToBeginningOfDocumentAndModifySelection:","Shift+Meta+ArrowDown":"moveToEndOfDocumentAndModifySelection:","Shift+Meta+ArrowLeft":"moveToLeftEndOfLineAndModifySelection:","Shift+Meta+ArrowRight":"moveToRightEndOfLineAndModifySelection:","Meta+KeyA":"selectAll:","Meta+KeyC":"copy:","Meta+KeyV":"paste:"},Object.defineProperty(Bw,"__esModule",{value:!0}),Bw.RawTouchscreenImpl=Bw.RawMouseImpl=Bw.RawKeyboardImpl=void 0;var qw=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=zw(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(Sd),Uw=Hw,Ww=Ci,$w=kw;function zw(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(zw=function(e){return e?n:t})(e)}Bw.RawKeyboardImpl=class{constructor(e,t,n){this._client=e,this._isMac=t,this._dragManger=n}_commandsForCode(e,t){if(!this._isMac)return[];const n=[];for(const e of["Shift","Control","Alt","Meta"])t.has(e)&&n.push(e);n.push(e);const r=n.join("+");let i=Uw.macEditingCommands[r]||[];return(0,Ww.isString)(i)&&(i=[i]),i=i.filter((e=>!e.startsWith("insert"))),i.map((e=>e.substring(0,e.length-1)))}async keydown(e,t,n,r,i,o,s,a){if("Escape"===t&&await this._dragManger.cancelDrag())return;const l=this._commandsForCode(t,e);await this._client.send("Input.dispatchKeyEvent",{type:a?"keyDown":"rawKeyDown",modifiers:(0,$w.toModifiersMask)(e),windowsVirtualKeyCode:r,code:t,commands:l,key:i,text:a,unmodifiedText:a,autoRepeat:s,location:o,isKeypad:o===qw.keypadLocation})}async keyup(e,t,n,r,i,o){await this._client.send("Input.dispatchKeyEvent",{type:"keyUp",modifiers:(0,$w.toModifiersMask)(e),key:i,windowsVirtualKeyCode:r,code:t,location:o})}async sendText(e){await this._client.send("Input.insertText",{text:e})}};Bw.RawMouseImpl=class{constructor(e,t,n){this._client=void 0,this._page=void 0,this._dragManager=void 0,this._page=e,this._client=t,this._dragManager=n}async move(e,t,n,r,i,o){const s=async()=>{await this._client.send("Input.dispatchMouseEvent",{type:"mouseMoved",button:n,buttons:(0,$w.toButtonsMask)(r),x:e,y:t,modifiers:(0,$w.toModifiersMask)(i)})};if(o)return s();await this._dragManager.interceptDragCausedByMove(e,t,n,r,i,s)}async down(e,t,n,r,i,o){this._dragManager.isDragging()||await this._client.send("Input.dispatchMouseEvent",{type:"mousePressed",button:n,buttons:(0,$w.toButtonsMask)(r),x:e,y:t,modifiers:(0,$w.toModifiersMask)(i),clickCount:o})}async up(e,t,n,r,i,o){this._dragManager.isDragging()?await this._dragManager.drop(e,t,i):await this._client.send("Input.dispatchMouseEvent",{type:"mouseReleased",button:n,buttons:(0,$w.toButtonsMask)(r),x:e,y:t,modifiers:(0,$w.toModifiersMask)(i),clickCount:o})}async wheel(e,t,n,r,i,o){await this._client.send("Input.dispatchMouseEvent",{type:"mouseWheel",x:e,y:t,modifiers:(0,$w.toModifiersMask)(r),deltaX:i,deltaY:o})}};Bw.RawTouchscreenImpl=class{constructor(e){this._client=void 0,this._client=e}async tap(e,t,n){await Promise.all([this._client.send("Input.dispatchTouchEvent",{type:"touchStart",modifiers:(0,$w.toModifiersMask)(n),touchPoints:[{x:e,y:t}]}),this._client.send("Input.dispatchTouchEvent",{type:"touchEnd",modifiers:(0,$w.toModifiersMask)(n),touchPoints:[]})])}};var Vw,Gw={};var Kw={};Object.defineProperty(Kw,"__esModule",{value:!0}),Kw.CRPDF=void 0;var Jw=Ci,Yw=kw;const Xw={letter:{width:8.5,height:11},legal:{width:8.5,height:14},tabloid:{width:11,height:17},ledger:{width:17,height:11},a0:{width:33.1,height:46.8},a1:{width:23.4,height:33.1},a2:{width:16.54,height:23.4},a3:{width:11.7,height:16.54},a4:{width:8.27,height:11.7},a5:{width:5.83,height:8.27},a6:{width:4.13,height:5.83}},Qw={px:1,in:96,cm:37.8,mm:3.78};function Zw(e){if(void 0===e)return;let t=e.substring(e.length-2).toLowerCase(),n="";Qw.hasOwnProperty(t)?n=e.substring(0,e.length-2):(t="px",n=e);const r=Number(n);(0,Jw.assert)(!isNaN(r),"Failed to parse parameter value: "+e);return r*Qw[t]/96}Kw.CRPDF=class{constructor(e){this._client=void 0,this._client=e}async generate(e={}){const{scale:t=1,displayHeaderFooter:n=!1,headerTemplate:r="",footerTemplate:i="",printBackground:o=!1,landscape:s=!1,pageRanges:a="",preferCSSPageSize:l=!1,margin:c={}}=e;let u=8.5,d=11;if(e.format){const t=Xw[e.format.toLowerCase()];(0,Jw.assert)(t,"Unknown paper format: "+e.format),u=t.width,d=t.height}else u=Zw(e.width)||u,d=Zw(e.height)||d;const h=Zw(c.top)||0,p=Zw(c.left)||0,f=Zw(c.bottom)||0,m=Zw(c.right)||0,g=await this._client.send("Page.printToPDF",{transferMode:"ReturnAsStream",landscape:s,displayHeaderFooter:n,headerTemplate:r,footerTemplate:i,printBackground:o,scale:t,paperWidth:u,paperHeight:d,marginTop:h,marginBottom:f,marginLeft:p,marginRight:m,pageRanges:a,preferCSSPageSize:l});return await(0,Yw.readProtocolStream)(this._client,g.stream,null)}};var ev={};Object.defineProperty(ev,"__esModule",{value:!0}),ev.platformToFontFamilies=void 0;ev.platformToFontFamilies={linux:{fontFamilies:{standard:"Times New Roman",fixed:"Monospace",serif:"Times New Roman",sansSerif:"Arial",cursive:"Comic Sans MS",fantasy:"Impact",pictograph:"Times New Roman"}},mac:{fontFamilies:{standard:"Times",fixed:"Courier",serif:"Times",sansSerif:"Helvetica",cursive:"Apple Chancery",fantasy:"Papyrus",pictograph:"Apple Color Emoji"},forScripts:[{script:"jpan",fontFamilies:{standard:"Hiragino Kaku Gothic ProN",fixed:"Osaka-Mono",serif:"Hiragino Mincho ProN",sansSerif:"Hiragino Kaku Gothic ProN"}},{script:"hang",fontFamilies:{standard:"Apple SD Gothic Neo",serif:"AppleMyungjo",sansSerif:"Apple SD Gothic Neo"}},{script:"hans",fontFamilies:{standard:",PingFang SC,STHeiti",serif:"Songti SC",sansSerif:",PingFang SC,STHeiti",cursive:"Kaiti SC"}},{script:"hant",fontFamilies:{standard:",PingFang TC,Heiti TC",serif:"Songti TC",sansSerif:",PingFang TC,Heiti TC",cursive:"Kaiti TC"}}]},win:{fontFamilies:{standard:"Times New Roman",fixed:"Consolas",serif:"Times New Roman",sansSerif:"Arial",cursive:"Comic Sans MS",fantasy:"Impact",pictograph:"Segoe UI Symbol"},forScripts:[{script:"cyrl",fontFamilies:{standard:"Times New Roman",fixed:"Courier New",serif:"Times New Roman",sansSerif:"Arial"}},{script:"arab",fontFamilies:{fixed:"Courier New",sansSerif:"Segoe UI"}},{script:"grek",fontFamilies:{standard:"Times New Roman",fixed:"Courier New",serif:"Times New Roman",sansSerif:"Arial"}},{script:"jpan",fontFamilies:{standard:",Meiryo,Yu Gothic",fixed:"MS Gothic",serif:",Yu Mincho,MS PMincho",sansSerif:",Meiryo,Yu Gothic"}},{script:"hang",fontFamilies:{standard:"Malgun Gothic",fixed:"Gulimche",serif:"Batang",sansSerif:"Malgun Gothic",cursive:"Gungsuh"}},{script:"hans",fontFamilies:{standard:"Microsoft YaHei",fixed:"NSimsun",serif:"Simsun",sansSerif:"Microsoft YaHei",cursive:"KaiTi"}},{script:"hant",fontFamilies:{standard:"Microsoft JhengHei",fixed:"MingLiU",serif:"PMingLiU",sansSerif:"Microsoft JhengHei",cursive:"DFKai-SB"}}]}};var tv={},nv={};Object.defineProperty(nv,"__esModule",{value:!0}),nv.envArrayToObject=function(e){const t={};for(const{name:n,value:r}of e)t[n]=r;return t},nv.gracefullyCloseAll=async function(){await Promise.all(Array.from(dv).map((e=>e().catch((e=>{})))))},nv.gracefullyCloseSet=void 0,nv.launchProcess=async function(e){const t="pipe"===e.stdio?["ignore","pipe","pipe","pipe","pipe"]:["pipe","pipe","pipe"];e.log(`<launching> ${e.command} ${e.args?e.args.join(" "):""}`);const n={detached:"win32"!==process.platform,env:e.env,cwd:e.cwd,shell:e.shell,stdio:t},r=rv.spawn(e.command,e.args||[],n),i=async()=>{e.log(`[pid=${r.pid||"N/A"}] starting temporary directories cleanup`);const t=await(0,av.removeFolders)(e.tempDirectories);for(let n=0;n<e.tempDirectories.length;++n)t[n]&&e.log(`[pid=${r.pid||"N/A"}] exception while removing ${e.tempDirectories[n]}: ${t[n]}`);e.log(`[pid=${r.pid||"N/A"}] finished temporary directories cleanup`)};if(r.on("error",(()=>{})),!r.pid){let e;const t=new Promise(((t,n)=>e=t));return r.once("error",(t=>{e(new Error("Failed to launch: "+t))})),i().then((()=>t)).then((e=>Promise.reject(e)))}e.log(`<launched> pid=${r.pid}`);iv.createInterface({input:r.stdout}).on("line",(t=>{e.log(`[pid=${r.pid}][out] `+t)}));iv.createInterface({input:r.stderr}).on("line",(t=>{e.log(`[pid=${r.pid}][err] `+t)}));let o=!1,s=()=>{};const a=new Promise((e=>s=e));let l=()=>{};const c=new Promise((e=>l=e));r.once("exit",((t,n)=>{e.log(`[pid=${r.pid}] <process did exit: exitCode=${t}, signal=${n}>`),o=!0,ov.eventsHelper.removeEventListeners(u),dv.delete(h),e.onExit(t,n),s(),i().then(l)}));const u=[ov.eventsHelper.addEventListener(process,"exit",(function(){p(),e.log(`[pid=${r.pid||"N/A"}] starting temporary directories cleanup`);for(const t of e.tempDirectories)try{lv.default.sync(t,{maxBusyTries:10})}catch(n){e.log(`[pid=${r.pid||"N/A"}] exception while removing ${t}: ${n}`)}e.log(`[pid=${r.pid||"N/A"}] finished temporary directories cleanup`)}))];e.handleSIGINT&&u.push(ov.eventsHelper.addEventListener(process,"SIGINT",(()=>{h().then((()=>{(0,sv.isUnderTest)()?setTimeout((()=>process.exit(130)),0):process.exit(130)}))})));e.handleSIGTERM&&u.push(ov.eventsHelper.addEventListener(process,"SIGTERM",h));e.handleSIGHUP&&u.push(ov.eventsHelper.addEventListener(process,"SIGHUP",h));dv.add(h);let d=!1;async function h(){if(dv.delete(h),d)return e.log(`[pid=${r.pid}] <forecefully close>`),p(),void await a;d=!0,e.log(`[pid=${r.pid}] <gracefully close start>`),await e.attemptToGracefullyClose().catch((()=>p())),await c,e.log(`[pid=${r.pid}] <gracefully close end>`)}function p(){if(e.log(`[pid=${r.pid}] <kill>`),ov.eventsHelper.removeEventListeners(u),!r.pid||r.killed||o)e.log(`[pid=${r.pid}] <skipped force kill spawnedProcess.killed=${r.killed} processClosed=${o}>`);else{e.log(`[pid=${r.pid}] <will force kill>`);try{if("win32"===process.platform){const t=rv.spawnSync(`taskkill /pid ${r.pid} /T /F /FI "MEMUSAGE gt 0"`,{shell:!0}),[n,i]=[t.stdout.toString(),t.stderr.toString()];i&&e.log(`[pid=${r.pid}] taskkill stdout: ${i}`),n&&e.log(`[pid=${r.pid}] taskkill stderr: ${n}`)}else process.kill(-r.pid,"SIGKILL")}catch(t){e.log(`[pid=${r.pid}] exception while trying to kill process: ${t}`)}}}return{launchedProcess:r,gracefullyClose:h,kill:function(){return p(),c}}};var rv=uv(j.default),iv=uv(G.default),ov=au,sv=Ci,av=Ri,lv=function(e){return e&&e.__esModule?e:{default:e}}(ts);function cv(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(cv=function(e){return e?n:t})(e)}function uv(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=cv(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}const dv=new Set;nv.gracefullyCloseSet=dv;const hv=process.getMaxListeners();var pv,fv,mv;function gv(){if(fv)return uw;fv=1,Object.defineProperty(uw,"__esModule",{value:!0}),uw.CRPage=void 0;var e=function(e){return e&&e.__esModule?e:{default:e}}(T.default),t=au,n=Tl(),r=$l,i=Ci,o=x(dw),s=x(bu),a=su,l=x(_u()),c=Uh(),u=mw,d=_v(),h=Z_,p=_w,f=xw,m=Iw,g=Bw,_=function(){if(Vw)return Gw;Vw=1,Object.defineProperty(Gw,"__esModule",{value:!0}),Gw.CRNetworkManager=void 0;var e=su,t=au,n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,n&&n.set(e,r),r}(_u()),r=Ci;function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}Gw.CRNetworkManager=class{constructor(e,t,n){this._client=void 0,this._page=void 0,this._parentManager=void 0,this._requestIdToRequest=new Map,this._requestIdToRequestWillBeSentEvent=new Map,this._credentials=null,this._attemptedAuthentications=new Set,this._userRequestInterceptionEnabled=!1,this._protocolRequestInterceptionEnabled=!1,this._requestIdToRequestPausedEvent=new Map,this._eventListeners=void 0,this._responseExtraInfoTracker=new l,this._client=e,this._page=t,this._parentManager=n,this._eventListeners=this.instrumentNetworkEvents(e)}instrumentNetworkEvents(e,n){return[t.eventsHelper.addEventListener(e,"Fetch.requestPaused",this._onRequestPaused.bind(this,n)),t.eventsHelper.addEventListener(e,"Fetch.authRequired",this._onAuthRequired.bind(this)),t.eventsHelper.addEventListener(e,"Network.requestWillBeSent",this._onRequestWillBeSent.bind(this,n)),t.eventsHelper.addEventListener(e,"Network.requestWillBeSentExtraInfo",this._onRequestWillBeSentExtraInfo.bind(this)),t.eventsHelper.addEventListener(e,"Network.requestServedFromCache",this._onRequestServedFromCache.bind(this)),t.eventsHelper.addEventListener(e,"Network.responseReceived",this._onResponseReceived.bind(this)),t.eventsHelper.addEventListener(e,"Network.responseReceivedExtraInfo",this._onResponseReceivedExtraInfo.bind(this)),t.eventsHelper.addEventListener(e,"Network.loadingFinished",this._onLoadingFinished.bind(this)),t.eventsHelper.addEventListener(e,"Network.loadingFailed",this._onLoadingFailed.bind(this,n)),t.eventsHelper.addEventListener(e,"Network.webSocketCreated",(e=>this._page._frameManager.onWebSocketCreated(e.requestId,e.url))),t.eventsHelper.addEventListener(e,"Network.webSocketWillSendHandshakeRequest",(e=>this._page._frameManager.onWebSocketRequest(e.requestId))),t.eventsHelper.addEventListener(e,"Network.webSocketHandshakeResponseReceived",(e=>this._page._frameManager.onWebSocketResponse(e.requestId,e.response.status,e.response.statusText))),t.eventsHelper.addEventListener(e,"Network.webSocketFrameSent",(e=>e.response.payloadData&&this._page._frameManager.onWebSocketFrameSent(e.requestId,e.response.opcode,e.response.payloadData))),t.eventsHelper.addEventListener(e,"Network.webSocketFrameReceived",(e=>e.response.payloadData&&this._page._frameManager.webSocketFrameReceived(e.requestId,e.response.opcode,e.response.payloadData))),t.eventsHelper.addEventListener(e,"Network.webSocketClosed",(e=>this._page._frameManager.webSocketClosed(e.requestId))),t.eventsHelper.addEventListener(e,"Network.webSocketFrameError",(e=>this._page._frameManager.webSocketError(e.requestId,e.errorMessage)))]}async initialize(){await this._client.send("Network.enable")}dispose(){t.eventsHelper.removeEventListeners(this._eventListeners)}async authenticate(e){this._credentials=e,await this._updateProtocolRequestInterception()}async setOffline(e){await this._client.send("Network.emulateNetworkConditions",{offline:e,latency:0,downloadThroughput:-1,uploadThroughput:-1})}async setRequestInterception(e){this._userRequestInterceptionEnabled=e,await this._updateProtocolRequestInterception()}async _updateProtocolRequestInterception(){const e=this._userRequestInterceptionEnabled||!!this._credentials;e!==this._protocolRequestInterceptionEnabled&&(this._protocolRequestInterceptionEnabled=e,e?await Promise.all([this._client.send("Network.setCacheDisabled",{cacheDisabled:!0}),this._client.send("Fetch.enable",{handleAuthRequests:!0,patterns:[{urlPattern:"*",requestStage:"Request"}]})]):await Promise.all([this._client.send("Network.setCacheDisabled",{cacheDisabled:!1}),this._client.send("Fetch.disable")]))}_onRequestWillBeSent(e,t){if(this._responseExtraInfoTracker.requestWillBeSent(t),this._protocolRequestInterceptionEnabled&&!t.request.url.startsWith("data:")){const n=t.requestId,r=this._requestIdToRequestPausedEvent.get(n);r?(this._onRequest(e,t,r),this._requestIdToRequestPausedEvent.delete(n)):this._requestIdToRequestWillBeSentEvent.set(t.requestId,t)}else this._onRequest(e,t,null)}_onRequestServedFromCache(e){this._responseExtraInfoTracker.requestServedFromCache(e)}_onRequestWillBeSentExtraInfo(e){this._responseExtraInfoTracker.requestWillBeSentExtraInfo(e)}_onAuthRequired(e){let t="Default";this._attemptedAuthentications.has(e.requestId)?t="CancelAuth":this._credentials&&(t="ProvideCredentials",this._attemptedAuthentications.add(e.requestId));const{username:n,password:r}=this._credentials||{username:void 0,password:void 0};this._client._sendMayFail("Fetch.continueWithAuth",{requestId:e.requestId,authChallengeResponse:{response:t,username:n,password:r}})}_onRequestPaused(e,t){if(!t.responseStatusCode&&!t.responseErrorReason){const e=this._requestIdToRequest.get(t.networkId);e&&this._responseExtraInfoTracker.requestPaused(e.request,t)}if(!t.networkId)return void this._client._sendMayFail("Fetch.failRequest",{requestId:t.requestId,errorReason:"Aborted"});if(t.request.url.startsWith("data:"))return;const n=t.networkId,r=this._requestIdToRequestWillBeSentEvent.get(n);r?(this._onRequest(e,r,t),this._requestIdToRequestWillBeSentEvent.delete(n)):this._requestIdToRequestPausedEvent.set(n,t)}_onRequest(e,t,r){if(t.request.url.startsWith("data:"))return;let i=null;if(t.redirectResponse){const e=this._requestIdToRequest.get(t.requestId);e&&(this._handleRequestRedirect(e,t.redirectResponse,t.timestamp),i=e)}let a=t.frameId?this._page._frameManager.frame(t.frameId):e;if(!a&&r&&r.frameId&&(a=this._page._frameManager.frame(r.frameId)),a||t.frameId!==this._page._delegate._targetId||(a=this._page._frameManager.frameAttached(t.frameId,null)),r&&"OPTIONS"===r.request.method&&this._page._needsRequestInterception()){const e=r.request.headers,t=[{name:"Access-Control-Allow-Origin",value:e.Origin||"*"},{name:"Access-Control-Allow-Methods",value:e["Access-Control-Request-Method"]||"GET, POST, OPTIONS, DELETE"},{name:"Access-Control-Allow-Credentials",value:"true"}];return e["Access-Control-Request-Headers"]&&t.push({name:"Access-Control-Allow-Headers",value:e["Access-Control-Request-Headers"]}),void this._client._sendMayFail("Fetch.fulfillRequest",{requestId:r.requestId,responseCode:204,responsePhrase:n.STATUS_TEXTS[204],responseHeaders:t,body:""})}if(!a)return void(r&&this._client._sendMayFail("Fetch.continueRequest",{requestId:r.requestId}));let l=null;r&&(i||!this._userRequestInterceptionEnabled&&this._protocolRequestInterceptionEnabled?this._client._sendMayFail("Fetch.continueRequest",{requestId:r.requestId}):l=new s(this._client,r.requestId));const c=t.requestId===t.loaderId&&"Document"===t.type?t.loaderId:void 0,u=new o({frame:a,documentId:c,route:l,requestWillBeSentEvent:t,requestPausedEvent:r,redirectedFrom:i});this._requestIdToRequest.set(t.requestId,u),this._page._frameManager.requestStarted(u.request,l||void 0)}_createResponse(e,t){var i,o,s,a,l;const c=t.timing;let u;u=c?{startTime:1e3*(c.requestTime-e._timestamp+e._wallTime),domainLookupStart:c.dnsStart,domainLookupEnd:c.dnsEnd,connectStart:c.connectStart,secureConnectionStart:c.sslStart,connectEnd:c.connectEnd,requestStart:c.sendStart,responseStart:c.receiveHeadersEnd}:{startTime:1e3*e._wallTime,domainLookupStart:-1,domainLookupEnd:-1,connectStart:-1,secureConnectionStart:-1,connectEnd:-1,requestStart:-1,responseStart:-1};const d=new n.Response(e.request,t.status,t.statusText,(0,r.headersObjectToArray)(t.headers),u,(async()=>{const t=await this._client.send("Network.getResponseBody",{requestId:e._requestId});return Buffer.from(t.body,t.base64Encoded?"base64":"utf8")}),t.protocol);return null!=t&&t.remoteIPAddress&&"number"==typeof(null==t?void 0:t.remotePort)?d._serverAddrFinished({ipAddress:t.remoteIPAddress,port:t.remotePort}):d._serverAddrFinished(),d._securityDetailsFinished({protocol:null==t||null===(i=t.securityDetails)||void 0===i?void 0:i.protocol,subjectName:null==t||null===(o=t.securityDetails)||void 0===o?void 0:o.subjectName,issuer:null==t||null===(s=t.securityDetails)||void 0===s?void 0:s.issuer,validFrom:null==t||null===(a=t.securityDetails)||void 0===a?void 0:a.validFrom,validTo:null==t||null===(l=t.securityDetails)||void 0===l?void 0:l.validTo}),this._responseExtraInfoTracker.processResponse(e._requestId,d,e.wasFulfilled()),d}_handleRequestRedirect(e,t,n){const r=this._createResponse(e,t);r._requestFinished(1e3*(n-e._timestamp)),this._requestIdToRequest.delete(e._requestId),e._interceptionId&&this._attemptedAuthentications.delete(e._interceptionId),this._page._frameManager.requestReceivedResponse(r),this._page._frameManager.reportRequestFinished(e.request,r)}_onResponseReceivedExtraInfo(e){this._responseExtraInfoTracker.responseReceivedExtraInfo(e)}_onResponseReceived(e){this._responseExtraInfoTracker.responseReceived(e);const t=this._requestIdToRequest.get(e.requestId);if(!t)return;const n=this._createResponse(t,e.response);this._page._frameManager.requestReceivedResponse(n)}_onLoadingFinished(t){this._responseExtraInfoTracker.loadingFinished(t);let n=this._requestIdToRequest.get(t.requestId);if(n||(n=this._maybeAdoptMainRequest(t.requestId)),!n)return;const r=n.request._existingResponse();r&&(n.request.responseSize.transferSize=t.encodedDataLength,n.request.responseSize.encodedBodySize=t.encodedDataLength-n.request.responseSize.responseHeadersSize,r._requestFinished(e.helper.secondsToRoundishMillis(t.timestamp-n._timestamp))),this._requestIdToRequest.delete(n._requestId),n._interceptionId&&this._attemptedAuthentications.delete(n._interceptionId),this._page._frameManager.reportRequestFinished(n.request,r)}_onLoadingFailed(t,n){this._responseExtraInfoTracker.loadingFailed(n);let r=this._requestIdToRequest.get(n.requestId);if(r||(r=this._maybeAdoptMainRequest(n.requestId)),!r){const e=this._requestIdToRequestWillBeSentEvent.get(n.requestId);e&&(this._requestIdToRequestWillBeSentEvent.delete(n.requestId),this._onRequest(t,e,null),r=this._requestIdToRequest.get(n.requestId))}if(!r)return;const i=r.request._existingResponse();i&&i._requestFinished(e.helper.secondsToRoundishMillis(n.timestamp-r._timestamp)),this._requestIdToRequest.delete(r._requestId),r._interceptionId&&this._attemptedAuthentications.delete(r._interceptionId),r.request._setFailureText(n.errorText),this._page._frameManager.requestFailed(r.request,!!n.canceled)}_maybeAdoptMainRequest(e){if(!this._parentManager)return;const t=this._parentManager._requestIdToRequest.get(e);return t&&t._documentId===e?(this._requestIdToRequest.set(e,t),this._parentManager._requestIdToRequest.delete(e),t._interceptionId&&this._parentManager._attemptedAuthentications.has(t._interceptionId)&&(this._parentManager._attemptedAuthentications.delete(t._interceptionId),this._attemptedAuthentications.add(t._interceptionId)),t):void 0}};class o{constructor(e){this.request=void 0,this._requestId=void 0,this._interceptionId=void 0,this._documentId=void 0,this._timestamp=void 0,this._wallTime=void 0,this._route=void 0,this._redirectedFrom=void 0;const{frame:t,documentId:i,route:o,requestWillBeSentEvent:s,requestPausedEvent:a,redirectedFrom:l}=e;this._timestamp=s.timestamp,this._wallTime=s.wallTime,this._requestId=s.requestId,this._interceptionId=a&&a.requestId,this._documentId=i,this._route=o,this._redirectedFrom=l;const{headers:c,method:u,url:d,postDataEntries:h=null}=a?a.request:s.request,p=(s.type||"").toLowerCase();let f=null;h&&h.length&&h[0].bytes&&(f=Buffer.from(h[0].bytes,"base64")),this.request=new n.Request(t,(null==l?void 0:l.request)||null,i,d,p,u,f,(0,r.headersObjectToArray)(c))}_routeForRedirectChain(){let e=this;for(;e._redirectedFrom;)e=e._redirectedFrom;return e._route}wasFulfilled(){var e;return(null===(e=this._routeForRedirectChain())||void 0===e?void 0:e._wasFulfilled)||!1}}class s{constructor(e,t){this._client=void 0,this._interceptionId=void 0,this._wasFulfilled=!1,this._client=e,this._interceptionId=t}async continue(e,t){await this._client._sendMayFail("Fetch.continueRequest",{requestId:this._interceptionId,url:t.url,headers:t.headers,method:t.method,postData:t.postData?t.postData.toString("base64"):void 0})}async fulfill(e){this._wasFulfilled=!0;const t=e.isBase64?e.body:Buffer.from(e.body).toString("base64"),r=function(e){const t=e.findIndex((({name:e})=>"set-cookie"===e.toLowerCase()));if(-1===t)return e;const n=e[t],r=n.value.split("\n");if(1===r.length)return e;const i=e.slice();return i.splice(t,1,...r.map((e=>({name:n.name,value:e})))),i}(e.headers);await this._client._sendMayFail("Fetch.fulfillRequest",{requestId:this._interceptionId,responseCode:e.status,responsePhrase:n.STATUS_TEXTS[String(e.status)],responseHeaders:r,body:t})}async abort(e="failed"){const t=a[e];(0,r.assert)(t,"Unknown error code: "+e),await this._client._sendMayFail("Fetch.failRequest",{requestId:this._interceptionId,errorReason:t})}}const a={aborted:"Aborted",accessdenied:"AccessDenied",addressunreachable:"AddressUnreachable",blockedbyclient:"BlockedByClient",blockedbyresponse:"BlockedByResponse",connectionaborted:"ConnectionAborted",connectionclosed:"ConnectionClosed",connectionfailed:"ConnectionFailed",connectionrefused:"ConnectionRefused",connectionreset:"ConnectionReset",internetdisconnected:"InternetDisconnected",namenotresolved:"NameNotResolved",timedout:"TimedOut",failed:"Failed"};class l{constructor(){this._requests=new Map}requestWillBeSent(e){const t=this._requests.get(e.requestId);t&&e.redirectResponse?this._innerResponseReceived(t,e.redirectResponse):this._getOrCreateEntry(e.requestId)}requestWillBeSentExtraInfo(e){const t=this._getOrCreateEntry(e.requestId);t.requestWillBeSentExtraInfo.push(e),this._patchHeaders(t,t.requestWillBeSentExtraInfo.length-1)}requestServedFromCache(e){this._getOrCreateEntry(e.requestId).requestServedFromCache=!0}responseReceived(e){const t=this._requests.get(e.requestId);t&&this._innerResponseReceived(t,e.response)}requestPaused(e,t){e.setRawRequestHeaders((0,r.headersObjectToArray)(t.request.headers,"\n"))}_innerResponseReceived(e,t){t.connectionId||(e.sawResponseWithoutConnectionId=!0)}responseReceivedExtraInfo(e){const t=this._getOrCreateEntry(e.requestId);t.responseReceivedExtraInfo.push(e),this._patchHeaders(t,t.responseReceivedExtraInfo.length-1),this._checkFinished(t)}processResponse(e,t,n){if(n)return void this._stopTracking(e);const r=this._requests.get(e);r&&!r.sawResponseWithoutConnectionId&&(r.requestServedFromCache||t.setWillReceiveExtraHeaders(),r.responses.push(t),this._patchHeaders(r,r.responses.length-1))}loadingFinished(e){const t=this._requests.get(e.requestId);t&&(t.loadingFinished=e,this._checkFinished(t))}loadingFailed(e){const t=this._requests.get(e.requestId);t&&(t.loadingFailed=e,this._checkFinished(t))}_getOrCreateEntry(e){let t=this._requests.get(e);return t||(t={requestId:e,requestWillBeSentExtraInfo:[],responseReceivedExtraInfo:[],responses:[],sawResponseWithoutConnectionId:!1,requestServedFromCache:!1},this._requests.set(e,t)),t}_patchHeaders(e,t){const n=e.responses[t],i=e.requestWillBeSentExtraInfo[t];n&&i&&n.request().setRawRequestHeaders((0,r.headersObjectToArray)(i.headers,"\n"));const o=e.responseReceivedExtraInfo[t];var s;n&&o&&(n.setRawResponseHeaders((0,r.headersObjectToArray)(o.headers,"\n")),n.request().responseSize.responseHeadersSize=(null===(s=o.headersText)||void 0===s?void 0:s.length)||0)}_checkFinished(e){(e.loadingFinished||e.loadingFailed)&&e.responses.length<=e.responseReceivedExtraInfo.length&&this._stopTracking(e.requestId)}_stopTracking(e){this._requests.delete(e)}}return Gw}(),w=Kw,v=kw,b=ev,y=function(){if(pv)return tv;pv=1,Object.defineProperty(tv,"__esModule",{value:!0}),tv.VideoRecorder=void 0;var e=Ci,t=Uh(),n=nv,r=Uu,i=Hl;class o{static async launch(e,t,n){if(!n.outputFile.endsWith(".webm"))throw new Error("File must have .webm extension");const s=new r.ProgressController((0,i.serverSideCallMetadata)(),e);return s.setLogName("browser"),await s.run((async r=>{const i=new o(e,t,r);return await i._launch(n),i}))}constructor(e,n,r){this._process=null,this._gracefullyClose=null,this._lastWritePromise=Promise.resolve(),this._lastFrameTimestamp=0,this._lastFrameBuffer=null,this._lastWriteTimestamp=0,this._progress=void 0,this._frameQueue=[],this._isStopped=!1,this._ffmpegPath=void 0,this._progress=r,this._ffmpegPath=n,e.on(t.Page.Events.ScreencastFrame,(e=>this.writeFrame(e.buffer,e.timestamp)))}async _launch(e){const t=e.width,r=e.height,i=`-loglevel error -f image2pipe -avioflags direct -fpsprobesize 0 -probesize 32 -analyzeduration 0 -c:v mjpeg -i - -y -an -r 25 -c:v vp8 -qmin 0 -qmax 50 -crf 8 -deadline realtime -speed 8 -b:v 1M -threads 1 -vf pad=${t}:${r}:0:0:gray,crop=${t}:${r}:0:0`.split(" ");i.push(e.outputFile);const o=this._progress,{launchedProcess:s,gracefullyClose:a}=await(0,n.launchProcess)({command:this._ffmpegPath,args:i,stdio:"stdin",log:e=>o.log(e),tempDirectories:[],attemptToGracefullyClose:async()=>{o.log("Closing stdin..."),s.stdin.end()},onExit:(e,t)=>{o.log(`ffmpeg onkill exitCode=${e} signal=${t}`)}});s.stdin.on("finish",(()=>{o.log("ffmpeg finished input.")})),s.stdin.on("error",(()=>{o.log("ffmpeg error.")})),this._process=s,this._gracefullyClose=a}writeFrame(t,n){if((0,e.assert)(this._process),!this._isStopped){if(this._progress.log("writing frame "+n),this._lastFrameBuffer){const e=n-this._lastFrameTimestamp,t=Math.max(1,Math.round(25*e));for(let e=0;e<t;++e)this._frameQueue.push(this._lastFrameBuffer);this._lastWritePromise=this._lastWritePromise.then((()=>this._sendFrames()))}this._lastFrameBuffer=t,this._lastFrameTimestamp=n,this._lastWriteTimestamp=(0,e.monotonicTime)()}}async _sendFrames(){for(;this._frameQueue.length;)await this._sendFrame(this._frameQueue.shift())}async _sendFrame(e){return new Promise((t=>this._process.stdin.write(e,t))).then((e=>{e&&this._progress.log(`ffmpeg failed to write: ${e}`)}))}async stop(){this._isStopped||(this.writeFrame(Buffer.from([]),this._lastFrameTimestamp+((0,e.monotonicTime)()-this._lastWriteTimestamp)/1e3),this._isStopped=!0,await this._lastWritePromise,await this._gracefullyClose())}}return tv.VideoRecorder=o,tv}();function S(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(S=function(e){return e?n:t})(e)}function x(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=S(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}const k="__playwright_utility_world__";uw.CRPage=class{static mainFrameSession(e){return e._delegate._mainFrameSession}constructor(e,t,n,r,i){this._mainFrameSession=void 0,this._sessions=new Map,this._page=void 0,this.rawMouse=void 0,this.rawKeyboard=void 0,this.rawTouchscreen=void 0,this._targetId=void 0,this._opener=void 0,this._pdf=void 0,this._coverage=void 0,this._browserContext=void 0,this._pagePromise=void 0,this._initializedPage=null,this._isBackgroundPage=void 0,this._nextWindowOpenPopupFeatures=[],this._targetId=t,this._opener=r,this._isBackgroundPage=i.isBackgroundPage;const o=new f.DragManager(this);if(this.rawKeyboard=new g.RawKeyboardImpl(e,"mac"===n._browser._platform(),o),this.rawMouse=new g.RawMouseImpl(this,e,o),this.rawTouchscreen=new g.RawTouchscreenImpl(e),this._pdf=new w.CRPDF(e),this._coverage=new p.CRCoverage(e),this._browserContext=n,this._page=new c.Page(this,n),this._mainFrameSession=new E(this,e,t,null),this._sessions.set(t,this._mainFrameSession),e.once(h.CRSessionEvents.Disconnected,(()=>this._page._didDisconnect())),r&&!n._options.noDefaultViewport){const e=r._nextWindowOpenPopupFeatures.shift()||[],t=a.helper.getViewportSizeFromWindowFeatures(e);t&&(this._page._state.emulatedSize={viewport:t,screen:t})}this._pagePromise=this._mainFrameSession._initialize(i.hasUIWindow).then((async e=>(await this._page.initOpener(this._opener),e))).catch((async e=>{throw await this._page.initOpener(this._opener),e})).then((()=>(this._initializedPage=this._page,this._reportAsNew(),this._page))).catch((e=>(this._reportAsNew(e),e)))}potentiallyUninitializedPage(){return this._page}_reportAsNew(e){this._isBackgroundPage?e||this._browserContext.emit(d.CRBrowserContext.CREvents.BackgroundPage,this._page):this._page.reportAsNew(e)}async _forAllFrameSessions(e){const t=Array.from(this._sessions.values());await Promise.all(t.map((t=>t._isMainFrame()?e(t):e(t).catch((e=>{if(!e.message||!e.message.includes("Target closed.")&&!e.message.includes("Session closed."))throw e})))))}_sessionForFrame(e){for(;!this._sessions.has(e._id);){const t=e.parentFrame();if(!t)throw new Error("Frame has been detached.");e=t}return this._sessions.get(e._id)}_sessionForHandle(e){const t=e._context.frame;return this._sessionForFrame(t)}willBeginDownload(){this._mainFrameSession._willBeginDownload()}async pageOrError(){return this._pagePromise}didClose(){for(const e of this._sessions.values())e.dispose();this._page._didClose()}async navigateFrame(e,t,n){return this._sessionForFrame(e)._navigate(e,t,n)}async exposeBinding(e){await this._forAllFrameSessions((t=>t._initBinding(e))),await Promise.all(this._page.frames().map((t=>t.evaluateExpression(e.source,!1,{}).catch((e=>{})))))}async removeExposedBindings(){await this._forAllFrameSessions((e=>e._removeExposedBindings()))}async updateExtraHTTPHeaders(){await this._forAllFrameSessions((e=>e._updateExtraHTTPHeaders(!1)))}async updateGeolocation(){await this._forAllFrameSessions((e=>e._updateGeolocation(!1)))}async updateOffline(){await this._forAllFrameSessions((e=>e._updateOffline(!1)))}async updateHttpCredentials(){await this._forAllFrameSessions((e=>e._updateHttpCredentials(!1)))}async setEmulatedSize(e){(0,i.assert)(this._page._state.emulatedSize===e),await this._mainFrameSession._updateViewport()}async bringToFront(){await this._mainFrameSession._client.send("Page.bringToFront")}async updateEmulateMedia(){await this._forAllFrameSessions((e=>e._updateEmulateMedia(!1)))}async updateRequestInterception(){await this._forAllFrameSessions((e=>e._updateRequestInterception()))}async setFileChooserIntercepted(e){await this._forAllFrameSessions((t=>t.setFileChooserIntercepted(e)))}async reload(){await this._mainFrameSession._client.send("Page.reload")}async _go(e){const t=await this._mainFrameSession._client.send("Page.getNavigationHistory"),n=t.entries[t.currentIndex+e];return!!n&&(await this._mainFrameSession._client.send("Page.navigateToHistoryEntry",{entryId:n.id}),!0)}goBack(){return this._go(-1)}goForward(){return this._go(1)}async addInitScript(e,t="main"){await this._forAllFrameSessions((n=>n._evaluateOnNewDocument(e,t)))}async removeInitScripts(){await this._forAllFrameSessions((e=>e._removeEvaluatesOnNewDocument()))}async closePage(e){e?await this._mainFrameSession._client.send("Page.close"):await this._browserContext._browser._closePage(this)}async setBackgroundColor(e){await this._mainFrameSession._client.send("Emulation.setDefaultBackgroundColorOverride",{color:e})}async takeScreenshot(e,t,n,r,i,o,s){const{visualViewport:l}=await this._mainFrameSession._client.send("Page.getLayoutMetrics");n||(n={x:l.pageX+r.x,y:l.pageY+r.y,...a.helper.enclosingIntSize({width:r.width/l.scale,height:r.height/l.scale})});const c={...n,scale:r?l.scale:1};if("css"===s){const e=this._browserContext._options.deviceScaleFactor||1;c.scale/=e}e.throwIfAborted();const u=await this._mainFrameSession._client.send("Page.captureScreenshot",{format:t,quality:i,clip:c,captureBeyondViewport:!o});return Buffer.from(u.data,"base64")}async getContentFrame(e){return this._sessionForHandle(e)._getContentFrame(e)}async getOwnerFrame(e){return this._sessionForHandle(e)._getOwnerFrame(e)}isElementHandle(e){return"node"===e.subtype}async getBoundingBox(e){return this._sessionForHandle(e)._getBoundingBox(e)}async scrollRectIntoViewIfNeeded(e,t){return this._sessionForHandle(e)._scrollRectIntoViewIfNeeded(e,t)}async setScreencastOptions(e){e?await this._mainFrameSession._startScreencast(this,{format:"jpeg",quality:e.quality,maxWidth:e.width,maxHeight:e.height}):await this._mainFrameSession._stopScreencast(this)}rafCountForStablePosition(){return 1}async getContentQuads(e){return this._sessionForHandle(e)._getContentQuads(e)}async setInputFiles(e,t){await e.evaluateInUtility((([e,t,n])=>e.setInputFiles(t,n)),t)}async setInputFilePaths(e,t){const n=await e.ownerFrame();if(!n)throw new Error("Cannot set input files to detached input element");const r=this._sessionForFrame(n);await r._client.send("DOM.setFileInputFiles",{objectId:e._objectId,files:t})}async adoptElementHandle(e,t){return this._sessionForHandle(e)._adoptElementHandle(e,t)}async getAccessibilityTree(e){return(0,u.getAccessibilityTree)(this._mainFrameSession._client,e)}async inputActionEpilogue(){await this._mainFrameSession._client.send("Page.enable").catch((e=>{}))}async pdf(e){return this._pdf.generate(e)}coverage(){return this._coverage}async getFrameElement(e){let t=e.parentFrame();if(!t)throw new Error("Frame has been detached.");const n=this._sessionForFrame(t),{backendNodeId:i}=await n._client.send("DOM.getFrameOwner",{frameId:e._id}).catch((e=>{throw e instanceof Error&&e.message.includes("Frame with the given id was not found.")&&(0,r.rewriteErrorMessage)(e,"Frame has been detached."),e}));if(t=e.parentFrame(),!t)throw new Error("Frame has been detached.");return n._adoptBackendNodeId(i,await t._mainContext())}};class E{constructor(e,t,n,r){this._client=void 0,this._crPage=void 0,this._page=void 0,this._networkManager=void 0,this._contextIdToContext=new Map,this._eventListeners=[],this._targetId=void 0,this._firstNonInitialNavigationCommittedPromise=void 0,this._firstNonInitialNavigationCommittedFulfill=()=>{},this._firstNonInitialNavigationCommittedReject=e=>{},this._windowId=void 0,this._swappedIn=!1,this._videoRecorder=null,this._screencastId=null,this._screencastClients=new Set,this._evaluateOnNewDocumentIdentifiers=[],this._exposedBindingNames=[],this._client=t,this._crPage=e,this._page=e._page,this._targetId=n,this._networkManager=new _.CRNetworkManager(t,this._page,r?r._networkManager:null),this._firstNonInitialNavigationCommittedPromise=new Promise(((e,t)=>{this._firstNonInitialNavigationCommittedFulfill=e,this._firstNonInitialNavigationCommittedReject=t})),t.once(h.CRSessionEvents.Disconnected,(()=>{this._firstNonInitialNavigationCommittedReject(new Error("Page closed"))}))}_isMainFrame(){return this._targetId===this._crPage._targetId}_addRendererListeners(){this._eventListeners.push(t.eventsHelper.addEventListener(this._client,"Log.entryAdded",(e=>this._onLogEntryAdded(e))),t.eventsHelper.addEventListener(this._client,"Page.fileChooserOpened",(e=>this._onFileChooserOpened(e))),t.eventsHelper.addEventListener(this._client,"Page.frameAttached",(e=>this._onFrameAttached(e.frameId,e.parentFrameId))),t.eventsHelper.addEventListener(this._client,"Page.frameDetached",(e=>this._onFrameDetached(e.frameId,e.reason))),t.eventsHelper.addEventListener(this._client,"Page.frameNavigated",(e=>this._onFrameNavigated(e.frame,!1))),t.eventsHelper.addEventListener(this._client,"Page.frameRequestedNavigation",(e=>this._onFrameRequestedNavigation(e))),t.eventsHelper.addEventListener(this._client,"Page.frameStoppedLoading",(e=>this._onFrameStoppedLoading(e.frameId))),t.eventsHelper.addEventListener(this._client,"Page.javascriptDialogOpening",(e=>this._onDialog(e))),t.eventsHelper.addEventListener(this._client,"Page.navigatedWithinDocument",(e=>this._onFrameNavigatedWithinDocument(e.frameId,e.url))),t.eventsHelper.addEventListener(this._client,"Runtime.bindingCalled",(e=>this._onBindingCalled(e))),t.eventsHelper.addEventListener(this._client,"Runtime.consoleAPICalled",(e=>this._onConsoleAPI(e))),t.eventsHelper.addEventListener(this._client,"Runtime.exceptionThrown",(e=>this._handleException(e.exceptionDetails))),t.eventsHelper.addEventListener(this._client,"Runtime.executionContextCreated",(e=>this._onExecutionContextCreated(e.context))),t.eventsHelper.addEventListener(this._client,"Runtime.executionContextDestroyed",(e=>this._onExecutionContextDestroyed(e.executionContextId))),t.eventsHelper.addEventListener(this._client,"Runtime.executionContextsCleared",(e=>this._onExecutionContextsCleared())),t.eventsHelper.addEventListener(this._client,"Target.attachedToTarget",(e=>this._onAttachedToTarget(e))),t.eventsHelper.addEventListener(this._client,"Target.detachedFromTarget",(e=>this._onDetachedFromTarget(e))))}_addBrowserListeners(){this._eventListeners.push(t.eventsHelper.addEventListener(this._client,"Inspector.targetCrashed",(e=>this._onTargetCrashed())),t.eventsHelper.addEventListener(this._client,"Page.screencastFrame",(e=>this._onScreencastFrame(e))),t.eventsHelper.addEventListener(this._client,"Page.windowOpen",(e=>this._onWindowOpen(e))))}async _initialize(n){const r=this._page._browserContext.isSettingStorageState();if(!r&&n&&!this._crPage._browserContext._browser.isClank()&&!this._crPage._browserContext._options.noDefaultViewport){const{windowId:e}=await this._client.send("Browser.getWindowForTarget");this._windowId=e}let o,s;if(!r&&this._isMainFrame()&&this._crPage._browserContext._options.recordVideo&&n){const t=(0,i.createGuid)(),n=e.default.join(this._crPage._browserContext._options.recordVideo.dir,t+".webm");o={...this._crPage._browserContext._options.recordVideo.size,outputFile:n},await this._crPage._browserContext._ensureVideosPath(),await this._createVideoRecorder(t,o),this._crPage.pageOrError().then((e=>{e instanceof Error&&this._stopVideoRecording().catch((()=>{}))}))}this._isMainFrame()||this._addRendererListeners(),this._addBrowserListeners();const a=[this._client.send("Page.enable"),this._client.send("Page.getFrameTree").then((({frameTree:e})=>{this._isMainFrame()&&(this._handleFrameTree(e),this._addRendererListeners());const n=this._isMainFrame()?this._page.frames():[this._page._frameManager.frame(this._targetId)];for(const e of n){this._client._sendMayFail("Page.createIsolatedWorld",{frameId:e._id,grantUniveralAccess:!0,worldName:k});for(const t of this._crPage._browserContext._pageBindings.values())e.evaluateExpression(t.source,!1,void 0).catch((e=>{}));for(const t of this._crPage._browserContext.initScripts)e.evaluateExpression(t,!1,void 0,"main").catch((e=>{}))}this._isMainFrame()&&":"===this._page.mainFrame().url()?s.catch((e=>{})).then((()=>{this._eventListeners.push(t.eventsHelper.addEventListener(this._client,"Page.lifecycleEvent",(e=>this._onLifecycleEvent(e))))})):(this._firstNonInitialNavigationCommittedFulfill(),this._eventListeners.push(t.eventsHelper.addEventListener(this._client,"Page.lifecycleEvent",(e=>this._onLifecycleEvent(e)))))})),this._client.send("Log.enable",{}),s=this._client.send("Page.setLifecycleEventsEnabled",{enabled:!0}),this._client.send("Runtime.enable",{}),this._client.send("Page.addScriptToEvaluateOnNewDocument",{source:"",worldName:k}),this._networkManager.initialize(),this._client.send("Target.setAutoAttach",{autoAttach:!0,waitForDebuggerOnStart:!0,flatten:!0})];if(!r){this._isMainFrame()&&a.push(this._client.send("Emulation.setFocusEmulationEnabled",{enabled:!0}));const e=this._crPage._browserContext._options;e.bypassCSP&&a.push(this._client.send("Page.setBypassCSP",{enabled:!0})),e.ignoreHTTPSErrors&&a.push(this._client.send("Security.setIgnoreCertificateErrors",{ignore:!0})),this._isMainFrame()&&a.push(this._updateViewport()),e.hasTouch&&a.push(this._client.send("Emulation.setTouchEmulationEnabled",{enabled:!0})),!1===e.javaScriptEnabled&&a.push(this._client.send("Emulation.setScriptExecutionDisabled",{value:!0})),(e.userAgent||e.locale)&&a.push(this._client.send("Emulation.setUserAgentOverride",{userAgent:e.userAgent||"",acceptLanguage:e.locale})),e.locale&&a.push(async function(e,t){try{await e.send("Emulation.setLocaleOverride",{locale:t})}catch(e){if(e.message.includes("Another locale override is already in effect"))return;throw e}}(this._client,e.locale)),e.timezoneId&&a.push(async function(e,t){try{await e.send("Emulation.setTimezoneOverride",{timezoneId:t})}catch(e){if(e.message.includes("Timezone override is already in effect"))return;if(e.message.includes("Invalid timezone"))throw new Error(`Invalid timezone ID: ${t}`);throw e}}(this._client,e.timezoneId)),this._crPage._browserContext._browser.options.headful||a.push(this._setDefaultFontFamilies(this._client)),a.push(this._updateGeolocation(!0)),a.push(this._updateExtraHTTPHeaders(!0)),a.push(this._updateRequestInterception()),a.push(this._updateOffline(!0)),a.push(this._updateHttpCredentials(!0)),a.push(this._updateEmulateMedia(!0));for(const e of this._crPage._page.allBindings())a.push(this._initBinding(e));for(const e of this._crPage._browserContext.initScripts)a.push(this._evaluateOnNewDocument(e,"main"));for(const e of this._crPage._page.initScripts)a.push(this._evaluateOnNewDocument(e,"main"));o&&a.push(this._startVideoRecording(o))}a.push(this._client.send("Runtime.runIfWaitingForDebugger")),a.push(this._firstNonInitialNavigationCommittedPromise),await Promise.all(a)}dispose(){t.eventsHelper.removeEventListeners(this._eventListeners),this._networkManager.dispose(),this._crPage._sessions.delete(this._targetId)}async _navigate(e,t,n){const r=await this._client.send("Page.navigate",{url:t,referrer:n,frameId:e._id});if(r.errorText)throw new Error(`${r.errorText} at ${t}`);return{newDocumentId:r.loaderId}}_onLifecycleEvent(e){this._eventBelongsToStaleFrame(e.frameId)||("load"===e.name?this._page._frameManager.frameLifecycleEvent(e.frameId,"load"):"DOMContentLoaded"===e.name&&this._page._frameManager.frameLifecycleEvent(e.frameId,"domcontentloaded"))}_onFrameStoppedLoading(e){this._eventBelongsToStaleFrame(e)||this._page._frameManager.frameStoppedLoading(e)}_handleFrameTree(e){if(this._onFrameAttached(e.frame.id,e.frame.parentId||null),this._onFrameNavigated(e.frame,!0),e.childFrames)for(const t of e.childFrames)this._handleFrameTree(t)}_eventBelongsToStaleFrame(e){const t=this._page._frameManager.frame(e);if(!t)return!0;const n=this._crPage._sessionForFrame(t);return n&&n!==this&&!n._swappedIn}_onFrameAttached(e,t){const n=this._crPage._sessions.get(e);if(n&&e!==this._targetId){n._swappedIn=!0;const t=this._page._frameManager.frame(e);t&&this._page._frameManager.removeChildFramesRecursively(t)}else t&&!this._page._frameManager.frame(t)||this._page._frameManager.frameAttached(e,t)}_onFrameNavigated(e,t){this._eventBelongsToStaleFrame(e.id)||(this._page._frameManager.frameCommittedNewDocumentNavigation(e.id,e.url+(e.urlFragment||""),e.name||"",e.loaderId,t),t||this._firstNonInitialNavigationCommittedFulfill())}_onFrameRequestedNavigation(e){this._eventBelongsToStaleFrame(e.frameId)||"currentTab"===e.disposition&&this._page._frameManager.frameRequestedNavigation(e.frameId)}_onFrameNavigatedWithinDocument(e,t){this._eventBelongsToStaleFrame(e)||this._page._frameManager.frameCommittedSameDocumentNavigation(e,t)}_onFrameDetached(e,t){if(!this._crPage._sessions.has(e))if("swap"!==t)this._page._frameManager.frameDetached(e);else{const t=this._page._frameManager.frame(e);t&&this._page._frameManager.removeChildFramesRecursively(t)}}_onExecutionContextCreated(e){const t=e.auxData?this._page._frameManager.frame(e.auxData.frameId):null;if(!t||this._eventBelongsToStaleFrame(t._id))return;const n=new m.CRExecutionContext(this._client,e);let r=null;e.auxData&&e.auxData.isDefault?r="main":e.name===k&&(r="utility");const i=new s.FrameExecutionContext(n,t,r);i[C]=n,r&&t._contextCreated(r,i),this._contextIdToContext.set(e.id,i)}_onExecutionContextDestroyed(e){const t=this._contextIdToContext.get(e);t&&(this._contextIdToContext.delete(e),t.frame._contextDestroyed(t))}_onExecutionContextsCleared(){for(const e of Array.from(this._contextIdToContext.keys()))this._onExecutionContextDestroyed(e)}_onAttachedToTarget(e){const t=h.CRConnection.fromSession(this._client).session(e.sessionId);if("iframe"===e.targetInfo.type){const n=e.targetInfo.targetId,r=this._page._frameManager.frame(n);if(!r)return;this._page._frameManager.removeChildFramesRecursively(r);const i=new E(this._crPage,t,n,this);return this._crPage._sessions.set(n,i),void i._initialize(!1).catch((e=>e))}if("worker"!==e.targetInfo.type)return void t._sendMayFail("Runtime.runIfWaitingForDebugger").then((()=>{this._client._sendMayFail("Target.detachFromTarget",{sessionId:e.sessionId})}));const n=e.targetInfo.url,r=new c.Worker(this._page,n);this._page._addWorker(e.sessionId,r),t.once("Runtime.executionContextCreated",(async e=>{r._createExecutionContext(new m.CRExecutionContext(t,e.context))})),t._sendMayFail("Runtime.enable"),t._sendMayFail("Network.enable"),t._sendMayFail("Runtime.runIfWaitingForDebugger"),t.on("Runtime.consoleAPICalled",(e=>{const t=e.args.map((e=>r._existingExecutionContext.createHandle(e)));this._page._addConsoleMessage(e.type,t,(0,v.toConsoleMessageLocation)(e.stackTrace))})),t.on("Runtime.exceptionThrown",(e=>this._page.emit(c.Page.Events.PageError,(0,v.exceptionToError)(e.exceptionDetails)))),this._networkManager.instrumentNetworkEvents(t,this._page._frameManager.frame(this._targetId))}_onDetachedFromTarget(e){this._page._removeWorker(e.sessionId);const t=this._crPage._sessions.get(e.targetId);t&&(t._swappedIn?t.dispose():this._client.send("Page.enable").catch((e=>null)).then((()=>{t._swappedIn||this._page._frameManager.frameDetached(e.targetId),t.dispose()})))}_onWindowOpen(e){this._crPage._nextWindowOpenPopupFeatures.push(e.windowFeatures)}async _onConsoleAPI(e){if(0===e.executionContextId)return;const t=this._contextIdToContext.get(e.executionContextId);if(!t)return;const n=e.args.map((e=>t.createHandle(e)));this._page._addConsoleMessage(e.type,n,(0,v.toConsoleMessageLocation)(e.stackTrace))}async _initBinding(e){const[,t]=await Promise.all([this._client.send("Runtime.addBinding",{name:e.name}),this._client.send("Page.addScriptToEvaluateOnNewDocument",{source:e.source})]);this._exposedBindingNames.push(e.name),this._evaluateOnNewDocumentIdentifiers.push(t.identifier)}async _removeExposedBindings(){const e=this._exposedBindingNames;this._exposedBindingNames=[],await Promise.all(e.map((e=>this._client.send("Runtime.removeBinding",{name:e}))))}async _onBindingCalled(e){if(!(await this._crPage.pageOrError()instanceof Error)){const t=this._contextIdToContext.get(e.executionContextId);t&&await this._page._onBindingCalled(e.payload,t)}}_onDialog(e){this._page._frameManager.frame(this._targetId)&&this._page.emit(c.Page.Events.Dialog,new o.Dialog(this._page,e.type,e.message,(async(e,t)=>{await this._client.send("Page.handleJavaScriptDialog",{accept:e,promptText:t})}),e.defaultPrompt))}_handleException(e){this._page.firePageError((0,v.exceptionToError)(e))}async _onTargetCrashed(){this._client._markAsCrashed(),this._page._didCrash()}_onLogEntryAdded(e){const{level:t,text:n,args:r,source:i,url:o,lineNumber:s}=e.entry;if(r&&r.map((e=>(0,v.releaseObject)(this._client,e.objectId))),"worker"!==i){const e={url:o||"",lineNumber:s||0,columnNumber:0};this._page._addConsoleMessage(t,[],e,n)}}async _onFileChooserOpened(e){const t=this._page._frameManager.frame(e.frameId);if(!t)return;let n;try{const r=await t._utilityContext();n=await this._adoptBackendNodeId(e.backendNodeId,r)}catch(e){return}await this._page._onFileChooserOpened(n)}_willBeginDownload(){this._crPage._initializedPage||this._firstNonInitialNavigationCommittedReject(new Error("Starting new page download"))}_onScreencastFrame(e){this._page.throttleScreencastFrameAck((()=>{this._client.send("Page.screencastFrameAck",{sessionId:e.sessionId}).catch((()=>{}))}));const t=Buffer.from(e.data,"base64");this._page.emit(c.Page.Events.ScreencastFrame,{buffer:t,timestamp:e.metadata.timestamp,width:e.metadata.deviceWidth,height:e.metadata.deviceHeight})}async _createVideoRecorder(e,t){(0,i.assert)(!this._screencastId);const r=n.registry.findExecutable("ffmpeg").executablePathOrDie(this._page._browserContext._browser.options.sdkLanguage);this._videoRecorder=await y.VideoRecorder.launch(this._crPage._page,r,t),this._screencastId=e}async _startVideoRecording(e){const t=this._screencastId;(0,i.assert)(t),this._page.once(c.Page.Events.Close,(()=>this._stopVideoRecording().catch((()=>{}))));const n=new Promise((e=>this._client.once("Page.screencastFrame",e)));await this._startScreencast(this._videoRecorder,{format:"jpeg",quality:90,maxWidth:e.width,maxHeight:e.height}),n.then((()=>{this._crPage._browserContext._browser._videoStarted(this._crPage._browserContext,t,e.outputFile,this._crPage.pageOrError())}))}async _stopVideoRecording(){if(!this._screencastId)return;const e=this._screencastId;this._screencastId=null;const t=this._videoRecorder;this._videoRecorder=null,await this._stopScreencast(t),await t.stop().catch((()=>{}));const n=this._crPage._browserContext._browser._takeVideo(e);null==n||n.reportFinished()}async _startScreencast(e,t={}){this._screencastClients.add(e),1===this._screencastClients.size&&await this._client.send("Page.startScreencast",t)}async _stopScreencast(e){this._screencastClients.delete(e),this._screencastClients.size||await this._client._sendMayFail("Page.stopScreencast")}async _updateExtraHTTPHeaders(e){const t=l.mergeHeaders([this._crPage._browserContext._options.extraHTTPHeaders,this._page._state.extraHTTPHeaders]);e&&!t.length||await this._client.send("Network.setExtraHTTPHeaders",{headers:(0,i.headersArrayToObject)(t,!1)})}async _updateGeolocation(e){const t=this._crPage._browserContext._options.geolocation;e&&!t||await this._client.send("Emulation.setGeolocationOverride",t||{})}async _updateOffline(e){const t=!!this._crPage._browserContext._options.offline;e&&!t||await this._networkManager.setOffline(t)}async _updateHttpCredentials(e){const t=this._crPage._browserContext._options.httpCredentials||null;e&&!t||await this._networkManager.authenticate(t)}async _updateViewport(){if(this._crPage._browserContext._browser.isClank())return;(0,i.assert)(this._isMainFrame());const e=this._crPage._browserContext._options,t=this._page._state.emulatedSize;if(null===t)return;const n=t.viewport,r=t.screen,o=n.width>n.height,s=[this._client.send("Emulation.setDeviceMetricsOverride",{mobile:!!e.isMobile,width:n.width,height:n.height,screenWidth:r.width,screenHeight:r.height,deviceScaleFactor:e.deviceScaleFactor||1,screenOrientation:o?{angle:90,type:"landscapePrimary"}:{angle:0,type:"portraitPrimary"}})];if(this._windowId){let e={width:0,height:0};this._crPage._browserContext._browser.options.headful&&(e={width:24,height:88},"win32"===process.platform?e={width:16,height:88}:"linux"===process.platform?e={width:8,height:85}:"darwin"===process.platform&&(e={width:2,height:80}),this._crPage._browserContext.isPersistentContext()&&(e.height+=46)),s.push(this.setWindowBounds({width:n.width+e.width,height:n.height+e.height}))}await Promise.all(s)}async windowBounds(){const{bounds:e}=await this._client.send("Browser.getWindowBounds",{windowId:this._windowId});return e}async setWindowBounds(e){return await this._client.send("Browser.setWindowBounds",{windowId:this._windowId,bounds:e})}async _updateEmulateMedia(e){const t=[{name:"prefers-color-scheme",value:null===this._page._state.colorScheme?"":this._page._state.colorScheme},{name:"prefers-reduced-motion",value:null===this._page._state.reducedMotion?"":this._page._state.reducedMotion},{name:"forced-colors",value:null===this._page._state.forcedColors?"":this._page._state.forcedColors}];await this._client.send("Emulation.setEmulatedMedia",{media:this._page._state.mediaType||"",features:t})}async _setDefaultFontFamilies(e){const t=b.platformToFontFamilies[this._crPage._browserContext._browser._platform()];await e.send("Page.setFontFamilies",t)}async _updateRequestInterception(){await this._networkManager.setRequestInterception(this._page._needsRequestInterception())}async setFileChooserIntercepted(e){await this._client.send("Page.setInterceptFileChooserDialog",{enabled:e}).catch((e=>{}))}async _evaluateOnNewDocument(e,t){const n="utility"===t?k:void 0,{identifier:r}=await this._client.send("Page.addScriptToEvaluateOnNewDocument",{source:e,worldName:n});this._evaluateOnNewDocumentIdentifiers.push(r)}async _removeEvaluatesOnNewDocument(){const e=this._evaluateOnNewDocumentIdentifiers;this._evaluateOnNewDocumentIdentifiers=[],await Promise.all(e.map((e=>this._client.send("Page.removeScriptToEvaluateOnNewDocument",{identifier:e}))))}async _getContentFrame(e){const t=await this._client.send("DOM.describeNode",{objectId:e._objectId});return t&&"string"==typeof t.node.frameId?this._page._frameManager.frame(t.node.frameId):null}async _getOwnerFrame(e){const t=await e.evaluateHandle((e=>{const t=e;return t.documentElement&&t.documentElement.ownerDocument===t?t.documentElement:e.ownerDocument?e.ownerDocument.documentElement:null}));if(!t)return null;if(!t._objectId)return null;const n=await this._client.send("DOM.describeNode",{objectId:t._objectId}),r=n&&"string"==typeof n.node.frameId?n.node.frameId:null;return t.dispose(),r}async _getBoundingBox(e){const t=await this._client._sendMayFail("DOM.getBoxModel",{objectId:e._objectId});if(!t)return null;const n=t.model.border,r=Math.min(n[0],n[2],n[4],n[6]),i=Math.min(n[1],n[3],n[5],n[7]),o=Math.max(n[0],n[2],n[4],n[6])-r,s=Math.max(n[1],n[3],n[5],n[7])-i,a=await this._framePosition();return a?{x:r+a.x,y:i+a.y,width:o,height:s}:null}async _framePosition(){const e=this._page._frameManager.frame(this._targetId);if(!e)return null;if(e===this._page.mainFrame())return{x:0,y:0};const t=await e.frameElement();return await t.boundingBox()}async _scrollRectIntoViewIfNeeded(e,t){return await this._client.send("DOM.scrollIntoViewIfNeeded",{objectId:e._objectId,rect:t}).then((()=>"done")).catch((e=>{if(e instanceof Error&&e.message.includes("Node does not have a layout object"))return"error:notvisible";if(e instanceof Error&&e.message.includes("Node is detached from document"))return"error:notconnected";throw e}))}async _getContentQuads(e){const t=await this._client._sendMayFail("DOM.getContentQuads",{objectId:e._objectId});if(!t)return null;const n=await this._framePosition();return n?t.quads.map((e=>[{x:e[0]+n.x,y:e[1]+n.y},{x:e[2]+n.x,y:e[3]+n.y},{x:e[4]+n.x,y:e[5]+n.y},{x:e[6]+n.x,y:e[7]+n.y}])):null}async _adoptElementHandle(e,t){const n=await this._client.send("DOM.describeNode",{objectId:e._objectId});return this._adoptBackendNodeId(n.node.backendNodeId,t)}async _adoptBackendNodeId(e,t){const n=await this._client._sendMayFail("DOM.resolveNode",{backendNodeId:e,executionContextId:t[C]._contextId});if(!n||"null"===n.object.subtype)throw new Error(s.kUnableToAdoptErrorMessage);return t.createHandle(n.object).asElement()}}const C=Symbol("delegate");return uw}function _v(){if(mv)return $_;mv=1,Object.defineProperty($_,"__esModule",{value:!0}),$_.CRBrowserContext=$_.CRBrowser=void 0;var e=Q_(),t=fx(),n=Ci,r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(_u()),i=Uh(),o=yd(),s=Z_,a=gv(),l=kw,c=Iw;function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}class d extends e.Browser{static async connect(e,t,n){t={...t};const r=new s.CRConnection(e,t.protocolLogger,t.browserLogsCollector),i=new d(r,t);i._devtools=n;const o=r.rootSession;t.__testHookOnConnectToBrowser&&await t.__testHookOnConnectToBrowser();const a=await o.send("Browser.getVersion");return i._version=a.product.substring(a.product.indexOf("/")+1),i._userAgent=a.userAgent,i.options.headful=!a.userAgent.includes("Headless"),t.persistent?(i._defaultContext=new p(i,void 0,t.persistent),await Promise.all([o.send("Target.setAutoAttach",{autoAttach:!0,waitForDebuggerOnStart:!0,flatten:!0}).then((async()=>{await o.send("Target.getTargetInfo")})),i._defaultContext._initialize()]),await i._waitForAllPagesToBeInitialized(),i):(await o.send("Target.setAutoAttach",{autoAttach:!0,waitForDebuggerOnStart:!0,flatten:!0}),i)}constructor(e,t){super(t),this._connection=void 0,this._session=void 0,this._clientRootSessionPromise=null,this._contexts=new Map,this._crPages=new Map,this._backgroundPages=new Map,this._serviceWorkers=new Map,this._devtools=void 0,this._version="",this._tracingRecording=!1,this._tracingPath="",this._tracingClient=void 0,this._userAgent="",this._connection=e,this._session=this._connection.rootSession,this._connection.on(s.ConnectionEvents.Disconnected,(()=>this._didClose())),this._session.on("Target.attachedToTarget",this._onAttachedToTarget.bind(this)),this._session.on("Target.detachedFromTarget",this._onDetachedFromTarget.bind(this)),this._session.on("Browser.downloadWillBegin",this._onDownloadWillBegin.bind(this)),this._session.on("Browser.downloadProgress",this._onDownloadProgress.bind(this))}async doCreateNewContext(e){let t;e.proxy&&(t=process.env.PLAYWRIGHT_DISABLE_FORCED_CHROMIUM_PROXIED_LOOPBACK?e.proxy.bypass:"<-loopback>"+(e.proxy.bypass?`,${e.proxy.bypass}`:""));const{browserContextId:n}=await this._session.send("Target.createBrowserContext",{disposeOnDetach:!0,proxyServer:e.proxy?e.proxy.server:void 0,proxyBypassList:t}),r=new p(this,n,e);return await r._initialize(),this._contexts.set(n,r),r}contexts(){return Array.from(this._contexts.values())}version(){return this._version}userAgent(){return this._userAgent}_platform(){return this._userAgent.includes("Windows")?"win":this._userAgent.includes("Macintosh")?"mac":"linux"}isClank(){return"clank"===this.options.name}async _waitForAllPagesToBeInitialized(){await Promise.all([...this._crPages.values()].map((e=>e.pageOrError())))}_onAttachedToTarget({targetInfo:e,sessionId:t,waitingForDebugger:r}){if("browser"===e.type)return;const i=this._connection.session(t);(0,n.assert)(e.browserContextId,"targetInfo: "+JSON.stringify(e,null,2));let o=this._contexts.get(e.browserContextId)||null;if(o||(o=this._defaultContext),"other"===e.type&&e.url.startsWith("devtools://devtools")&&this._devtools)this._devtools.install(i);else if("other"!==e.type&&o)if((0,n.assert)(!this._crPages.has(e.targetId),"Duplicate target "+e.targetId),(0,n.assert)(!this._backgroundPages.has(e.targetId),"Duplicate target "+e.targetId),(0,n.assert)(!this._serviceWorkers.has(e.targetId),"Duplicate target "+e.targetId),"background_page"!==e.type)if("page"!==e.type){if("service_worker"===e.type){const t=new h(o,i,e.url);return this._serviceWorkers.set(e.targetId,t),void o.emit(p.CREvents.ServiceWorker,t)}}else{const t=e.openerId&&this._crPages.get(e.openerId)||null,n=new a.CRPage(i,e.targetId,o,t,{hasUIWindow:!0,isBackgroundPage:!1});this._crPages.set(e.targetId,n)}else{const t=new a.CRPage(i,e.targetId,o,null,{hasUIWindow:!1,isBackgroundPage:!0});this._backgroundPages.set(e.targetId,t)}else r&&i._sendMayFail("Runtime.runIfWaitingForDebugger").then((()=>{this._session._sendMayFail("Target.detachFromTarget",{sessionId:t})}))}_onDetachedFromTarget(e){const t=e.targetId,n=this._crPages.get(t);if(n)return this._crPages.delete(t),void n.didClose();const r=this._backgroundPages.get(t);if(r)return this._backgroundPages.delete(t),void r.didClose();const i=this._serviceWorkers.get(t);return i?(this._serviceWorkers.delete(t),void i.didClose()):void 0}_findOwningPage(e){for(const t of this._crPages.values()){if(t._page._frameManager.frame(e))return t}return null}_onDownloadWillBegin(e){const t=this._findOwningPage(e.frameId);(0,n.assert)(t,"Download started in unknown page: "+JSON.stringify(e)),t.willBeginDownload();let r=t._initializedPage;!r&&t._opener&&(r=t._opener._initializedPage),r&&this._downloadCreated(r,e.guid,e.url,e.suggestedFilename)}_onDownloadProgress(e){"completed"===e.state&&this._downloadFinished(e.guid,""),"canceled"===e.state&&this._downloadFinished(e.guid,"canceled")}async _closePage(e){await this._session.send("Target.closeTarget",{targetId:e._targetId})}async newBrowserCDPSession(){return await this._connection.createBrowserSession()}async startTracing(e,t={}){(0,n.assert)(!this._tracingRecording,"Cannot start recording trace while already recording trace."),this._tracingClient=e?e._delegate._mainFrameSession._client:this._session;const r=["-*","devtools.timeline","v8.execute","disabled-by-default-devtools.timeline","disabled-by-default-devtools.timeline.frame","toplevel","blink.console","blink.user_timing","latencyInfo","disabled-by-default-devtools.timeline.stack","disabled-by-default-v8.cpu_profiler","disabled-by-default-v8.cpu_profiler.hires"],{path:i=null,screenshots:o=!1,categories:s=r}=t;o&&s.push("disabled-by-default-devtools.screenshot"),this._tracingPath=i,this._tracingRecording=!0,await this._tracingClient.send("Tracing.start",{transferMode:"ReturnAsStream",categories:s.join(",")})}async stopTracing(){(0,n.assert)(this._tracingClient,"Tracing was not started.");const[e]=await Promise.all([new Promise((e=>this._tracingClient.once("Tracing.tracingComplete",e))),this._tracingClient.send("Tracing.end")]),t=await(0,l.readProtocolStream)(this._tracingClient,e.stream,this._tracingPath);return this._tracingRecording=!1,t}isConnected(){return!this._connection._closed}async _clientRootSession(){return this._clientRootSessionPromise||(this._clientRootSessionPromise=this._connection.createBrowserSession()),this._clientRootSessionPromise}}$_.CRBrowser=d;class h extends i.Worker{constructor(e,t,n){super(e,n),this._browserContext=void 0,this._browserContext=e,t.once("Runtime.executionContextCreated",(e=>{this._createExecutionContext(new c.CRExecutionContext(t,e.context))})),t.send("Runtime.enable",{}).catch((e=>{})),t.send("Runtime.runIfWaitingForDebugger").catch((e=>{}))}}class p extends t.BrowserContext{constructor(e,t,n){super(e,n,t),this._authenticateProxyViaCredentials()}async _initialize(){(0,n.assert)(!Array.from(this._browser._crPages.values()).some((e=>e._browserContext===this)));const e=[super._initialize()];"electron"!==this._browser.options.name&&"clank"!==this._browser.options.name&&e.push(this._browser._session.send("Browser.setDownloadBehavior",{behavior:this._options.acceptDownloads?"allowAndName":"deny",browserContextId:this._browserContextId,downloadPath:this._browser.options.downloadsPath,eventsEnabled:!0})),this._options.permissions&&e.push(this.grantPermissions(this._options.permissions)),await Promise.all(e)}pages(){const e=[];for(const t of this._browser._crPages.values())t._browserContext===this&&t._initializedPage&&e.push(t._initializedPage);return e}async newPageDelegate(){(0,t.assertBrowserContextIsNotOwned)(this);const e=this._browser.isClank()?new Set(this._browser._crPages.keys()):void 0;let{targetId:r}=await this._browser._session.send("Target.createTarget",{url:"about:blank",browserContextId:this._browserContextId});if(e){const t=new Set(this._browser._crPages.keys());for(const n of e)t.delete(n);for(const e of t){this._browser._crPages.get(e)._opener&&t.delete(e)}(0,n.assert)(1===t.size),[r]=[...t]}return this._browser._crPages.get(r)}async doGetCookies(e){const{cookies:t}=await this._browser._session.send("Storage.getCookies",{browserContextId:this._browserContextId});return r.filterCookies(t.map((e=>{const t={sameSite:"Lax",...e};return delete t.size,delete t.priority,delete t.session,delete t.sameParty,delete t.sourceScheme,delete t.sourcePort,t})),e)}async addCookies(e){await this._browser._session.send("Storage.setCookies",{cookies:r.rewriteCookies(e),browserContextId:this._browserContextId})}async clearCookies(){await this._browser._session.send("Storage.clearCookies",{browserContextId:this._browserContextId})}async doGrantPermissions(e,t){const n=new Map([["geolocation","geolocation"],["midi","midi"],["notifications","notifications"],["camera","videoCapture"],["microphone","audioCapture"],["background-sync","backgroundSync"],["ambient-light-sensor","sensors"],["accelerometer","sensors"],["gyroscope","sensors"],["magnetometer","sensors"],["accessibility-events","accessibilityEvents"],["clipboard-read","clipboardReadWrite"],["clipboard-write","clipboardSanitizedWrite"],["payment-handler","paymentHandler"],["midi-sysex","midiSysex"]]),r=t.map((e=>{const t=n.get(e);if(!t)throw new Error("Unknown permission: "+e);return t}));await this._browser._session.send("Browser.grantPermissions",{origin:"*"===e?void 0:e,browserContextId:this._browserContextId,permissions:r})}async doClearPermissions(){await this._browser._session.send("Browser.resetPermissions",{browserContextId:this._browserContextId})}async setGeolocation(e){(0,t.verifyGeolocation)(e),this._options.geolocation=e;for(const e of this.pages())await e._delegate.updateGeolocation()}async setExtraHTTPHeaders(e){this._options.extraHTTPHeaders=e;for(const e of this.pages())await e._delegate.updateExtraHTTPHeaders()}async setOffline(e){this._options.offline=e;for(const e of this.pages())await e._delegate.updateOffline()}async doSetHTTPCredentials(e){this._options.httpCredentials=e;for(const e of this.pages())await e._delegate.updateHttpCredentials()}async doAddInitScript(e){for(const t of this.pages())await t._delegate.addInitScript(e)}async doRemoveInitScripts(){for(const e of this.pages())await e._delegate.removeInitScripts()}async doExposeBinding(e){for(const t of this.pages())await t._delegate.exposeBinding(e)}async doRemoveExposedBindings(){for(const e of this.pages())await e._delegate.removeExposedBindings()}async doUpdateRequestInterception(){for(const e of this.pages())await e._delegate.updateRequestInterception()}async doClose(){(0,n.assert)(this._browserContextId);const e=[];for(const t of this._browser._crPages.values()){if(t._browserContext!==this)continue;const n=[...t._page._frameManager._openedDialogs].filter((e=>"beforeunload"===e.type()));e.push(...n)}await Promise.all(e.map((e=>e.dismiss()))),await this._browser._session.send("Target.disposeBrowserContext",{browserContextId:this._browserContextId}),this._browser._contexts.delete(this._browserContextId);for(const[e,t]of this._browser._serviceWorkers)t._browserContext===this&&(t.didClose(),this._browser._serviceWorkers.delete(e))}onClosePersistent(){for(const[e,t]of this._browser._backgroundPages.entries())t._browserContext===this&&t._initializedPage&&(t.didClose(),this._browser._backgroundPages.delete(e))}async cancelDownload(e){await this._browser._session.send("Browser.cancelDownload",{guid:e,browserContextId:this._browserContextId})}backgroundPages(){const e=[];for(const t of this._browser._backgroundPages.values())t._browserContext===this&&t._initializedPage&&e.push(t._initializedPage);return e}serviceWorkers(){return Array.from(this._browser._serviceWorkers.values()).filter((e=>e._browserContext===this))}async newCDPSession(e){let t=null;if(e instanceof i.Page)t=e._delegate._targetId;else{if(!(e instanceof o.Frame))throw new Error("page: expected Page or Frame");{const n=e._page._delegate._sessions.get(e._id);if(!n)throw new Error("This frame does not have a separate CDP session, it is a part of the parent frame's session");t=n._targetId}}const n=await this._browser._clientRootSession(),{sessionId:r}=await n.send("Target.attachToTarget",{targetId:t,flatten:!0});return this._browser._connection.session(r)}}return $_.CRBrowserContext=p,p.CREvents={BackgroundPage:"backgroundpage",ServiceWorker:"serviceworker"},$_}0!==hv&&process.setMaxListeners(Math.max(hv||0,100));var wv={};Object.defineProperty(wv,"__esModule",{value:!0}),wv.PipeTransport=wv.IpcTransport=void 0;var vv,bv=Ci;wv.PipeTransport=class{constructor(e,t,n,r="le"){this._pipeWrite=void 0,this._data=Buffer.from([]),this._waitForNextTask=(0,bv.makeWaitForNextTask)(),this._closed=!1,this._bytesLeft=0,this.onmessage=void 0,this.onclose=void 0,this._endian=void 0,this._closeableStream=void 0,this._pipeWrite=e,this._endian=r,this._closeableStream=n,t.on("data",(e=>this._dispatch(e))),t.on("close",(()=>{this._closed=!0,this.onclose&&this.onclose()})),this.onmessage=void 0,this.onclose=void 0}send(e){if(this._closed)throw new Error("Pipe has been closed");const t=Buffer.from(e,"utf-8"),n=Buffer.alloc(4);"be"===this._endian?n.writeUInt32BE(t.length,0):n.writeUInt32LE(t.length,0),this._pipeWrite.write(n),this._pipeWrite.write(t)}close(){this._closeableStream.close()}_dispatch(e){for(this._data=Buffer.concat([this._data,e]);(this._bytesLeft||!(this._data.length<4))&&(this._bytesLeft||(this._bytesLeft="be"===this._endian?this._data.readUInt32BE(0):this._data.readUInt32LE(0),this._data=this._data.slice(4)),this._bytesLeft&&!(this._data.length<this._bytesLeft));){const e=this._data.slice(0,this._bytesLeft);this._data=this._data.slice(this._bytesLeft),this._bytesLeft=0,this._waitForNextTask((()=>{this.onmessage&&this.onmessage(e.toString("utf-8"))}))}}};function yv(){if(vv)return cm;vv=1,Object.defineProperty(cm,"__esModule",{value:!0}),cm.AndroidDevice=cm.Android=void 0;var e=w(Ja.exports),t=M.default,n=w(C.default),r=w(E.default),i=w(T.default),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(W_),s=Ci,a=Ri,l=fx(),c=Uu,u=_v(),d=su,h=wv,p=Ka,f=nv,m=ru,g=Hl;function _(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_=function(e){return e?n:t})(e)}function w(e){return e&&e.__esModule?e:{default:e}}const v=i.default.join(r.default.tmpdir(),"playwright-artifacts-");class b extends g.SdkObject{constructor(e,t){super(t.rootSdkObject,"android"),this._backend=void 0,this._devices=new Map,this._timeoutSettings=void 0,this._playwrightOptions=void 0,this._backend=e,this._playwrightOptions=t,this._timeoutSettings=new m.TimeoutSettings}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e)}async devices(e){const t=(await this._backend.devices(e)).filter((e=>"device"===e.status)),n=new Set;for(const r of t){if(n.add(r.serial),this._devices.has(r.serial))continue;const t=await y.create(this,r,e);this._devices.set(r.serial,t)}for(const e of this._devices.keys())n.has(e)||this._devices.delete(e);return[...this._devices.values()]}_deviceClosed(e){this._devices.delete(e.serial)}}cm.Android=b;class y extends g.SdkObject{constructor(e,t,n,r){super(e,"android-device"),this._backend=void 0,this.model=void 0,this.serial=void 0,this._options=void 0,this._driverPromise=void 0,this._lastId=0,this._callbacks=new Map,this._pollingWebViews=void 0,this._timeoutSettings=void 0,this._webViews=new Map,this._browserConnections=new Set,this._android=void 0,this._isClosed=!1,this._android=e,this._backend=t,this.model=n,this.serial=t.serial,this._options=r,this._timeoutSettings=new m.TimeoutSettings(e._timeoutSettings)}static async create(e,t,n){await t.init();const r=await t.runCommand("shell:getprop ro.product.model"),i=new y(e,t,r.toString().trim(),n);return await i._init(),i}async _init(){await this._refreshWebViews();const e=()=>{this._pollingWebViews=setTimeout((()=>this._refreshWebViews().then(e).catch((()=>{}))),500)};e()}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e)}async shell(e){const t=await this._backend.runCommand(`shell:${e}`);return await this._refreshWebViews(),t}async open(e){return await this._backend.open(`${e}`)}async screenshot(){return await this._backend.runCommand("shell:screencap -p")}async _driver(){return this._driverPromise||(this._driverPromise=this._installDriver()),this._driverPromise}async _installDriver(){if((0,e.default)("pw:android")("Stopping the old driver"),await this.shell("am force-stop com.microsoft.playwright.androiddriver"),this._options.omitDriverInstall)(0,e.default)("pw:android")("Skipping the driver installation");else{(0,e.default)("pw:android")("Uninstalling the old driver"),await this.shell("cmd package uninstall com.microsoft.playwright.androiddriver"),await this.shell("cmd package uninstall com.microsoft.playwright.androiddriver.test"),(0,e.default)("pw:android")("Installing the new driver");for(const e of["android-driver.apk","android-driver-target.apk"])await this.installApk(await n.default.promises.readFile(require.resolve(`../../../bin/${e}`)))}(0,e.default)("pw:android")("Starting the new driver"),this.shell("am instrument -w com.microsoft.playwright.androiddriver.test/androidx.test.runner.AndroidJUnitRunner").catch((t=>(0,e.default)("pw:android")(t)));const t=await this._waitForLocalAbstract("playwright_android_driver_socket"),r=new h.PipeTransport(t,t,t,"be");return r.onmessage=e=>{const t=JSON.parse(e),{id:n,result:r,error:i}=t,o=this._callbacks.get(n);o&&(i?o.reject(new Error(i)):o.fulfill(r),this._callbacks.delete(n))},r}async _waitForLocalAbstract(t){let n;for((0,e.default)("pw:android")(`Polling the socket localabstract:${t}`);!n;)try{n=await this._backend.open(`localabstract:${t}`)}catch(e){await new Promise((e=>setTimeout(e,250)))}return(0,e.default)("pw:android")(`Connected to localabstract:${t}`),n}async send(e,t={}){t.timeout=this._timeoutSettings.timeout(t);const n=await this._driver(),r=++this._lastId,i=new Promise(((e,t)=>this._callbacks.set(r,{fulfill:e,reject:t})));return n.send(JSON.stringify({id:r,method:e,params:t})),i}async close(){this._isClosed=!0,this._pollingWebViews&&clearTimeout(this._pollingWebViews);for(const e of this._browserConnections)await e.close();if(this._driverPromise){(await this._driver()).close()}await this._backend.close(),this._android._deviceClosed(this),this.emit(y.Events.Closed)}async launchBrowser(t="com.android.chrome",n){(0,e.default)("pw:android")("Force-stopping",t),await this._backend.runCommand(`shell:am force-stop ${t}`);const r="playwright-"+(0,s.createGuid)(),i=`_ --disable-fre --no-default-browser-check --no-first-run --remote-debugging-socket-name=${r}`;return(0,e.default)("pw:android")("Starting",t,i),await this._backend.runCommand(`shell:echo "${i}" > /data/local/tmp/chrome-command-line`),await this._backend.runCommand(`shell:am start -n ${t}/com.google.android.apps.chrome.Main about:blank`),await this._connectToBrowser(r,n)}async connectToWebView(e){if(!this._webViews.get(e))throw new Error("WebView has been closed");return await this._connectToBrowser(`webview_devtools_remote_${e}`)}async _connectToBrowser(t,r={}){const i=await this._waitForLocalAbstract(t),o=new S(this,i);await o._init(),this._browserConnections.add(o);const s=await n.default.promises.mkdtemp(v),h=async()=>{const t=await(0,a.removeFolders)([s]);for(let n=0;n<(t||[]).length;++n)(0,e.default)("pw:android")(`exception while removing ${s}: ${t[n]}`)};f.gracefullyCloseSet.add(h),i.on("close",(async()=>{f.gracefullyCloseSet.delete(h),h().catch((t=>(0,e.default)("pw:android")(`could not cleanup artifacts dir: ${t}`)))}));const m={...this._android._playwrightOptions,name:"clank",isChromium:!0,slowMo:0,persistent:{...r,noDefaultViewport:!0},artifactsDir:s,downloadsPath:s,tracesDir:s,browserProcess:new x(o),proxy:r.proxy,protocolLogger:d.helper.debugProtocolLogger(),browserLogsCollector:new p.RecentLogsCollector};(0,l.validateBrowserContextOptions)(r,m);const _=await u.CRBrowser.connect(o,m),w=new c.ProgressController((0,g.serverSideCallMetadata)(),this),b=_._defaultContext;return await w.run((async e=>{await b._loadDefaultContextAsIs(e)})),b}webViews(){return[...this._webViews.values()]}async installApk(t,n){const r=n&&n.args?n.args:["-r","-t","-S"];(0,e.default)("pw:android")("Opening install socket");const i=await this._backend.open(`shell:cmd package install ${r.join(" ")} ${t.length}`);(0,e.default)("pw:android")("Writing driver bytes: "+t.length),await i.write(t);const o=await new Promise((e=>i.on("data",e)));(0,e.default)("pw:android")("Written driver bytes: "+o),i.close()}async push(e,t,n=420){const r=await this._backend.open("sync:"),i=async(e,t)=>{const n=Buffer.alloc(e.length+4);n.write(e,0),n.writeUInt32LE(t,e.length),await r.write(n)},o=async(e,t)=>{await i(e,t.length),await r.write(t)};await o("SEND",Buffer.from(`${t},${n}`));for(let t=0;t<e.length;t+=65535)await o("DATA",e.slice(t,t+65535));await i("DONE",Date.now()/1e3|0);const s=(await new Promise((e=>r.once("data",e)))).slice(0,4).toString();if("OKAY"!==s)throw new Error("Could not push: "+s);r.close()}async _refreshWebViews(){const e=(await this._backend.runCommand("shell:cat /proc/net/unix | grep webview_devtools_remote")).toString().split("\n");if(this._isClosed)return;const t=new Set;for(const n of e){const e=n.match(/[^@]+@webview_devtools_remote_(\d+)/);if(!e)continue;const r=+e[1];t.add(r)}for(const e of t){if(this._webViews.has(e))continue;const t=(await this._backend.runCommand(`shell:ps -A | grep ${e}`)).toString().split("\n");if(this._isClosed)return;let n="";for(const r of t){const t=r.match(/[^\s]+\s+(\d+).*$/);if(!t)continue;+t[1]===e&&(n=r.substring(r.lastIndexOf(" ")+1))}const r={pid:e,pkg:n};this._webViews.set(e,r),this.emit(y.Events.WebViewAdded,r)}for(const e of this._webViews.keys())t.has(e)||(this._webViews.delete(e),this.emit(y.Events.WebViewRemoved,e))}}cm.AndroidDevice=y,y.Events={WebViewAdded:"webViewAdded",WebViewRemoved:"webViewRemoved",Closed:"closed"};class S extends t.EventEmitter{constructor(e,t){super(),this.device=void 0,this._socket=void 0,this._receiver=void 0,this._waitForNextTask=(0,s.makeWaitForNextTask)(),this.onmessage=void 0,this.onclose=void 0,this.setMaxListeners(0),this.device=e,this._socket=t,this._socket.on("close",(()=>{this._waitForNextTask((()=>{this.onclose&&this.onclose()}))})),this._receiver=new o.Receiver,this._receiver.on("message",(e=>{this._waitForNextTask((()=>{this.onmessage&&this.onmessage(JSON.parse(e))}))}))}async _init(){await this._socket.write(Buffer.from("GET /devtools/browser HTTP/1.1\r\n\tUpgrade: WebSocket\r\n\tConnection: Upgrade\r\n\tSec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ==\r\n\tSec-WebSocket-Version: 13\r\n\t\r\n\t")),await new Promise((e=>this._socket.once("data",e))),this._socket.on("data",(e=>this._receiver._write(e,"binary",(()=>{}))))}async send(e){var t;await this._socket.write((t=JSON.stringify(e),o.Sender.frame(Buffer.from(t),{opcode:1,mask:!0,fin:!0,readOnly:!0})[0]))}async close(){this._socket.close()}}class x{constructor(e){this._browser=void 0,this.onclose=void 0,this._browser=e}async kill(){}async close(){await this._browser.close()}}return cm}wv.IpcTransport=class{constructor(e){this._process=void 0,this.onmessage=void 0,this.onclose=void 0,this._process=e,this._process.on("message",(e=>{var t,n;"<eof>"===e?null===(t=this.onclose)||void 0===t||t.call(this):null===(n=this.onmessage)||void 0===n||n.call(this,e)}))}send(e){this._process.send(e)}close(){this._process.send("<eof>")}};var Sv={};Object.defineProperty(Sv,"__esModule",{value:!0}),Sv.AdbBackend=void 0;var xv=function(e){return e&&e.__esModule?e:{default:e}}(Ja.exports),kv=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=Tv(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(A.default),Ev=M.default,Cv=Ci;function Tv(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(Tv=function(e){return e?n:t})(e)}Sv.AdbBackend=class{async devices(e={}){const t=e.port?e.port:5037;return(await Ov("host:devices",t)).toString().trim().split("\n").map((e=>{const[n,r]=e.trim().split("\t");return new Pv(n,r,t)}))}};class Pv{constructor(e,t,n){this.serial=e,this.status=t,this.port=n}async init(){}async close(){}runCommand(e){return Ov(e,this.port,this.serial)}async open(e){const t=await async function(e,t=5037,n){const r=new Iv(e,kv.createConnection({port:t}));if(n){await r.write(Av(`host:transport:${n}`));const e=await r.read(4);(0,Cv.assert)("OKAY"===e.toString(),e.toString())}await r.write(Av(e));const i=await r.read(4);return(0,Cv.assert)("OKAY"===i.toString(),i.toString()),r}(e,this.port,this.serial);return t.becomeSocket(),t}}async function Ov(e,t=5037,n){(0,xv.default)("pw:adb:runCommand")(e,n);const r=new Iv(e,kv.createConnection({port:t}));if(n){await r.write(Av(`host:transport:${n}`));const e=await r.read(4);(0,Cv.assert)("OKAY"===e.toString(),e.toString())}await r.write(Av(e));const i=await r.read(4);let o;if((0,Cv.assert)("OKAY"===i.toString(),i.toString()),e.startsWith("shell:"))o=await r.readAll();else{const e=parseInt((await r.read(4)).toString(),16);o=await r.read(e)}return r.close(),o}function Av(e){let t=e.length.toString(16);return t="0".repeat(4-t.length)+t,Buffer.from(t+e)}class Iv extends Ev.EventEmitter{constructor(e,t){super(),this.guid=(0,Cv.createGuid)(),this._socket=void 0,this._buffer=Buffer.from([]),this._isSocket=!1,this._notifyReader=void 0,this._connectPromise=void 0,this._isClosed=!1,this._command=void 0,this._command=e,this._socket=t,this._connectPromise=new Promise((e=>this._socket.on("connect",e))),this._socket.on("data",(e=>{(0,xv.default)("pw:adb:data")(e.toString()),this._isSocket?this.emit("data",e):(this._buffer=Buffer.concat([this._buffer,e]),this._notifyReader&&this._notifyReader())})),this._socket.on("close",(()=>{this._isClosed=!0,this._notifyReader&&this._notifyReader(),this.close(),this.emit("close")})),this._socket.on("error",(e=>this.emit("error",e)))}async write(e){(0,xv.default)("pw:adb:send")(e.toString().substring(0,100)+"..."),await this._connectPromise,await new Promise((t=>this._socket.write(e,t)))}close(){this._isClosed||((0,xv.default)("pw:adb")("Close "+this._command),this._socket.destroy())}async read(e){for(await this._connectPromise,(0,Cv.assert)(!this._isSocket,"Can not read by length in socket mode");this._buffer.length<e;)await new Promise((e=>this._notifyReader=e));const t=this._buffer.slice(0,e);return this._buffer=this._buffer.slice(e),(0,xv.default)("pw:adb:recv")(t.toString().substring(0,100)+"..."),t}async readAll(){for(;!this._isClosed;)await new Promise((e=>this._notifyReader=e));return this._buffer}becomeSocket(){(0,Cv.assert)(!this._buffer.length),this._isSocket=!0}}var Mv={},Fv={},Nv={};Object.defineProperty(Nv,"__esModule",{value:!0}),Nv.WebSocketTransport=void 0;var Rv=function(e){return e&&e.__esModule?e:{default:e}}(W_),jv=Ci;class Dv{static async connect(e,t,n,r){e.log(`<ws connecting> ${t}`);const i=new Dv(e,t,n,r);let o=!1;return e.cleanupWhenAborted((async()=>{o||await i.closeAndWait().catch((e=>null))})),await new Promise(((n,r)=>{i._ws.addEventListener("open",(async()=>{e.log(`<ws connected> ${t}`),n(i)})),i._ws.addEventListener("error",(n=>{e.log(`<ws connect error> ${t} ${n.message}`),r(new Error("WebSocket error: "+n.message)),i._ws.close()}))})),o=!0,i}constructor(e,t,n,r){this._ws=void 0,this._progress=void 0,this.onmessage=void 0,this.onclose=void 0,this.wsEndpoint=void 0,this.wsEndpoint=t,this._ws=new Rv.default(t,[],{perMessageDeflate:!1,maxPayload:268435456,handshakeTimeout:Math.max(e.timeUntilDeadline(),1),headers:n,followRedirects:r}),this._progress=e;const i=(0,jv.makeWaitForNextTask)();this._ws.addEventListener("message",(e=>{i((()=>{try{this.onmessage&&this.onmessage.call(null,JSON.parse(e.data))}catch(e){this._ws.close()}}))})),this._ws.addEventListener("close",(e=>{this._progress&&this._progress.log(`<ws disconnected> ${t} code=${e.code} reason=${e.reason}`),this.onclose&&this.onclose.call(null)})),this._ws.addEventListener("error",(e=>this._progress&&this._progress.log(`<ws error> ${e}`)))}send(e){this._ws.send(JSON.stringify(e))}close(){this._progress&&this._progress.log(`<ws disconnecting> ${this._ws.url}`),this._ws.close()}async closeAndWait(){if(this._ws.readyState===Rv.default.CLOSED)return;const e=new Promise((e=>this._ws.once("close",e)));this.close(),await e}}Nv.WebSocketTransport=Dv;var Lv={};Object.defineProperty(Lv,"__esModule",{value:!0}),Lv.PipeTransport=void 0;var Bv,Hv=Ci,qv=Ka;function Uv(){if(Bv)return Fv;Bv=1,Object.defineProperty(Fv,"__esModule",{value:!0}),Fv.kNoXServerRunningError=Fv.BrowserType=void 0;var e=g(C.default),t=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(E.default),n=g(T.default),r=fx(),i=Tl(),o=Nv,s=nv,a=Lv,l=Uu,c=ru,u=Ci,d=Ri,h=su,p=Ka,f=Hl;function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}function g(e){return e&&e.__esModule?e:{default:e}}Fv.kNoXServerRunningError="Looks like you launched a headed browser without having a XServer running.\nSet either 'headless: false' or use 'xvfb-run <your-playwright-app>' before running Playwright.\n\n<3 Playwright Team";class _ extends f.SdkObject{constructor(e,t){super(t.rootSdkObject,"browser-type"),this._name=void 0,this._playwrightOptions=void 0,this.attribution.browserType=this,this._playwrightOptions=t,this._name=e}executablePath(){return i.registry.findExecutable(this._name).executablePath(this._playwrightOptions.sdkLanguage)||""}name(){return this._name}async launch(e,t,n){t=this._validateLaunchOptions(t);const r=new l.ProgressController(e,this);r.setLogName("browser");const i=await r.run((e=>{const r=t.__testHookSeleniumRemoteURL||process.env.SELENIUM_REMOTE_URL;return r?this._launchWithSeleniumHub(e,r,t):this._innerLaunchWithRetries(e,t,void 0,h.helper.debugProtocolLogger(n)).catch((e=>{throw this._rewriteStartupError(e)}))}),c.TimeoutSettings.timeout(t));return i}async launchPersistentContext(e,t,n){n=this._validateLaunchOptions(n);const r=new l.ProgressController(e,this),i=n;r.setLogName("browser");const o=await r.run((e=>this._innerLaunchWithRetries(e,n,i,h.helper.debugProtocolLogger(),t).catch((e=>{throw this._rewriteStartupError(e)}))),c.TimeoutSettings.timeout(n));return o._defaultContext}async _innerLaunchWithRetries(e,t,n,r,i){try{return await this._innerLaunch(e,t,n,r,i)}catch(o){if(("object"==typeof o&&"string"==typeof o.message?o.message:"").includes("Inconsistency detected by ld.so"))return e.log("<restarting browser due to hitting race condition in glibc>"),this._innerLaunch(e,t,n,r,i);throw o}}async _innerLaunch(e,t,n,i,o){t.proxy=t.proxy?(0,r.normalizeProxySettings)(t.proxy):void 0;const s=new p.RecentLogsCollector,{browserProcess:a,artifactsDir:l,transport:c}=await this._launchProcess(e,t,!!n,s,o);t.__testHookBeforeCreateBrowser&&await t.__testHookBeforeCreateBrowser();const u={...this._playwrightOptions,name:this._name,isChromium:"chromium"===this._name,channel:t.channel,slowMo:t.slowMo,persistent:n,headful:!t.headless,artifactsDir:l,downloadsPath:t.downloadsPath||l,tracesDir:t.tracesDir||l,browserProcess:a,customExecutablePath:t.executablePath,proxy:t.proxy,protocolLogger:i,browserLogsCollector:s,wsEndpoint:t.useWebSocket?c.wsEndpoint:void 0};n&&(0,r.validateBrowserContextOptions)(n,u),function(e,t){for(const[n,r]of Object.entries(e))n.startsWith("__testHook")&&(t[n]=r)}(t,u);const d=await this._connectToTransport(c,u);return n&&!t.ignoreAllDefaultArgs&&await d._defaultContext._loadDefaultContext(e),d}async _launchProcess(r,l,u,h,p){var f;const{ignoreDefaultArgs:m,ignoreAllDefaultArgs:g,args:_=[],executablePath:w=null,handleSIGINT:v=!0,handleSIGTERM:b=!0,handleSIGHUP:y=!0}=l,S=l.env?(0,s.envArrayToObject)(l.env):process.env,x=[];l.downloadsPath&&await e.default.promises.mkdir(l.downloadsPath,{recursive:!0}),l.tracesDir&&await e.default.promises.mkdir(l.tracesDir,{recursive:!0});const k=await e.default.promises.mkdtemp(n.default.join(t.tmpdir(),"playwright-artifacts-"));x.push(k),p?await(0,d.existsAsync)(p)||await e.default.promises.mkdir(p,{recursive:!0,mode:448}):(p=await e.default.promises.mkdtemp(n.default.join(t.tmpdir(),`playwright_${this._name}dev_profile-`)),x.push(p));const E=[];let C,T;if(g?E.push(..._):m?E.push(...this._defaultArgs(l,u,p).filter((e=>-1===m.indexOf(e)))):E.push(...this._defaultArgs(l,u,p)),w){if(!await(0,d.existsAsync)(w))throw new Error(`Failed to launch ${this._name} because executable doesn't exist at ${w}`);C=w}else{const e=i.registry.findExecutable(l.channel||this._name);if(!e||e.browserName!==this._name)throw new Error(`Unsupported ${this._name} channel "${l.channel}"`);C=e.executablePathOrDie(this._playwrightOptions.sdkLanguage),await e.validateHostRequirements(this._playwrightOptions.sdkLanguage)}const P=l.useWebSocket||(null===(f=l.args)||void 0===f?void 0:f.some((e=>e.startsWith("--remote-debugging-port")))),O=P?new Promise((e=>T=e)):void 0;let A,I;const{launchedProcess:M,gracefullyClose:F,kill:N}=await(0,s.launchProcess)({command:C,args:E,env:this._amendEnvironment(S,p,C,E),handleSIGINT:v,handleSIGTERM:b,handleSIGHUP:y,log:e=>{if(T){const t=e.match(/DevTools listening on (.*)/);t&&T(t[1])}r.log(e),h.log(e)},stdio:"pipe",tempDirectories:x,attemptToGracefullyClose:async()=>{l.__testHookGracefullyClose&&await l.__testHookGracefullyClose(),this._attemptToGracefullyCloseBrowser(A)},onExit:(e,t)=>{I&&I.onclose&&I.onclose(e,t)}});async function R(e){let t;try{await Promise.race([F(),new Promise(((n,r)=>t=setTimeout(r,e)))])}catch(e){await N().catch((e=>{}))}finally{clearTimeout(t)}}let j;if(I={onclose:void 0,process:M,close:()=>R(l.__testHookBrowserCloseTimeout||c.DEFAULT_TIMEOUT),kill:N},r.cleanupWhenAborted((()=>R(r.timeUntilDeadline()))),P&&(j=await O),l.useWebSocket)A=await o.WebSocketTransport.connect(r,j);else{const e=M.stdio;A=new a.PipeTransport(e[3],e[4])}return{browserProcess:I,artifactsDir:k,transport:A}}async connectOverCDP(e,t,n,r){throw new Error("CDP connections are only supported by Chromium")}async _launchWithSeleniumHub(e,t,n){throw new Error("Connecting to SELENIUM_REMOTE_URL is only supported by Chromium")}_validateLaunchOptions(e){const{devtools:t=!1}=e;let{headless:r=!t,downloadsPath:i,proxy:o}=e;return(0,u.debugMode)()&&(r=!1),i&&!n.default.isAbsolute(i)&&(i=n.default.join(process.cwd(),i)),this._playwrightOptions.socksProxyPort&&(o={server:`socks5://127.0.0.1:${this._playwrightOptions.socksProxyPort}`}),{...e,devtools:t,headless:r,downloadsPath:i,proxy:o}}}return Fv.BrowserType=_,Fv}Lv.PipeTransport=class{constructor(e,t){this._pipeWrite=void 0,this._pendingMessage="",this._waitForNextTask=(0,Hv.makeWaitForNextTask)(),this._closed=!1,this.onmessage=void 0,this.onclose=void 0,this._pipeWrite=e,t.on("data",(e=>this._dispatch(e))),t.on("close",(()=>{this._closed=!0,this.onclose&&this.onclose.call(null)})),t.on("error",(e=>qv.debugLogger.log("error",e))),e.on("error",(e=>qv.debugLogger.log("error",e))),this.onmessage=void 0,this.onclose=void 0}send(e){if(this._closed)throw new Error("Pipe has been closed");this._pipeWrite.write(JSON.stringify(e)),this._pipeWrite.write("\0")}close(){throw new Error("unimplemented")}_dispatch(e){let t=e.indexOf("\0");if(-1===t)return void(this._pendingMessage+=e.toString());const n=this._pendingMessage+e.toString(void 0,0,t);this._waitForNextTask((()=>{this.onmessage&&this.onmessage.call(null,JSON.parse(n))}));let r=t+1;for(t=e.indexOf("\0",r);-1!==t;){const n=e.toString(void 0,r,t);this._waitForNextTask((()=>{this.onmessage&&this.onmessage.call(null,JSON.parse(n))})),r=t+1,t=e.indexOf("\0",r)}this._pendingMessage=e.toString(void 0,r)}};var Wv={};Object.defineProperty(Wv,"__esModule",{value:!0}),Wv.CRDevTools=void 0;var $v=function(e){return e&&e.__esModule?e:{default:e}}(C.default);var zv;function Vv(){if(zv)return Mv;zv=1,Object.defineProperty(Mv,"__esModule",{value:!0}),Mv.Chromium=void 0;var e=x(C.default),t=x(E.default),n=x(T.default),r=_v(),i=nv,o=Z_,s=$l,a=Uv(),l=Nv,c=Wv,u=Q_(),d=nr,h=gi,p=Ci,f=Ri,m=Ka,g=Uu,_=ru,w=su,v=x(P.default),b=x(O.default),y=Tl(),S=pu;function x(e){return e&&e.__esModule?e:{default:e}}const k=n.default.join(t.default.tmpdir(),"playwright-artifacts-");class A extends a.BrowserType{constructor(e){super("chromium",e),this._devtools=void 0,(0,p.debugMode)()&&(this._devtools=this._createDevTools())}async connectOverCDP(e,t,n,r){const i=new g.ProgressController(e,this);return i.setLogName("browser"),i.run((async e=>await this._connectOverCDPInternal(e,t,n)),_.TimeoutSettings.timeout({timeout:r}))}async _connectOverCDPInternal(t,n,i,o){let s;i.headers&&(s=(0,p.headersArrayToObject)(i.headers,!1)),s?s&&!Object.keys(s).some((e=>"user-agent"===e.toLowerCase()))&&(s["User-Agent"]=(0,h.getUserAgent)()):s={"User-Agent":(0,h.getUserAgent)()};const a=await e.default.promises.mkdtemp(k),c=await async function(e,t){if(t.startsWith("ws"))return t;e.log(`<ws preparing> retrieving websocket url from ${t}`);const n=t.endsWith("/")?`${t}json/version/`:`${t}/json/version/`,r=t.startsWith("https")?b.default:v.default,i=await new Promise(((e,t)=>{r.get(n,(r=>{(r.statusCode<200||r.statusCode>=400)&&t(new Error(`Unexpected status ${r.statusCode} when connecting to ${n}.\nThis does not look like a DevTools server, try connecting via ws://.`));let i="";r.on("data",(e=>i+=e)),r.on("end",(()=>e(i)))})).on("error",t)}));return JSON.parse(i).webSocketDebuggerUrl}(t,n);t.throwIfAborted();const d=await l.WebSocketTransport.connect(t,c,s),g=new S.ManualPromise,_=async()=>{await d.closeAndWait(),await g},y={close:_,kill:_},x={...this._playwrightOptions,slowMo:i.slowMo,name:"chromium",isChromium:!0,persistent:{noDefaultViewport:!0},browserProcess:y,protocolLogger:w.helper.debugProtocolLogger(),browserLogsCollector:new m.RecentLogsCollector,artifactsDir:a,downloadsPath:a,tracesDir:a,proxy:{server:"per-context"}};t.throwIfAborted();const E=await r.CRBrowser.connect(d,x);return E.on(u.Browser.Events.Disconnected,(async()=>{await(0,f.removeFolders)([a]),await(null==o?void 0:o()),g.resolve()})),E}_createDevTools(){const e=y.registry.findExecutable("chromium").directory;return e?new c.CRDevTools(n.default.join(e,"devtools-preferences.json")):void 0}async _connectToTransport(e,t){let n=this._devtools;return t.__testHookForDevTools&&(n=this._createDevTools(),await t.__testHookForDevTools(n)),r.CRBrowser.connect(e,t,n)}_rewriteStartupError(e){return e.message.includes("Missing X server")?(0,s.rewriteErrorMessage)(e,"\n"+(0,p.wrapInASCIIBox)(a.kNoXServerRunningError,1)):e.message.includes("crbug.com/357670")||e.message.includes("No usable sandbox!")||e.message.includes("crbug.com/638180")?(0,s.rewriteErrorMessage)(e,["Chromium sandboxing failed!","================================","To workaround sandboxing issues, do either of the following:","  - (preferred): Configure environment to support sandboxing: https://playwright.dev/docs/troubleshooting","  - (alternative): Launch Chromium without sandbox using 'chromiumSandbox: false' option","================================",""].join("\n")):e}_amendEnvironment(e,t,n,r){return e}_attemptToGracefullyCloseBrowser(e){const t={method:"Browser.close",id:o.kBrowserCloseMessageId,params:{}};e.send(t)}async _launchWithSeleniumHub(e,t,n){t.endsWith("/")||(t+="/");const r=this._innerDefaultArgs(n);r.push("--remote-debugging-port=0");const o=n.channel&&n.channel.startsWith("msedge");let s={browserName:o?"MicrosoftEdge":"chrome",[o?"ms:edgeOptions":"goog:chromeOptions"]:{args:r}};try{if(process.env.SELENIUM_REMOTE_CAPABILITIES){const t=JSON.parse(process.env.SELENIUM_REMOTE_CAPABILITIES);s={...s,...t},e.log(`<selenium> using additional capabilities "${process.env.SELENIUM_REMOTE_CAPABILITIES}"`)}}catch(t){e.log(`<selenium> ignoring additional capabilities "${process.env.SELENIUM_REMOTE_CAPABILITIES}": ${t}`)}e.log(`<selenium> connecting to ${t}`);const a=await(0,d.fetchData)({url:t+"session",method:"POST",data:JSON.stringify({desiredCapabilities:s,capabilities:{alwaysMatch:s}}),timeout:e.timeUntilDeadline()},M),l=JSON.parse(a).value,c=l.sessionId;e.log(`<selenium> connected to sessionId=${c}`);const u=async()=>{e.log(`<selenium> disconnecting from sessionId=${c}`),await(0,d.fetchData)({url:t+"session/"+c,method:"DELETE"}).catch((t=>e.log(`<error disconnecting from selenium>: ${t}`))),e.log(`<selenium> disconnected from sessionId=${c}`),i.gracefullyCloseSet.delete(u)};i.gracefullyCloseSet.add(u);try{const r=l.capabilities;let i;if(r["se:cdp"]){e.log("<selenium> using selenium v4");const n=F(r["se:cdp"]);i=new URL(n),"localhost"!==i.hostname&&"127.0.0.1"!==i.hostname||(i.hostname=new URL(t).hostname),e.log(`<selenium> retrieved endpoint ${i.toString()} for sessionId=${c}`)}else{e.log("<selenium> using selenium v3");const n=r["goog:chromeOptions"],o=n&&"object"==typeof n?n:void 0,s=o&&"string"==typeof o.debuggerAddress?o.debuggerAddress:void 0,a="string"==typeof n?n:void 0,l=F(s||a);if(e.log(`<selenium> retrieved endpoint ${l} for sessionId=${c}`),i=new URL(l),"localhost"===i.hostname||"127.0.0.1"===i.hostname){const n=new URL(t).origin+"/grid/api/testsession?session="+c;try{const t=await(0,d.fetchData)({url:n,method:"GET",timeout:e.timeUntilDeadline()},M),r=JSON.parse(t).proxyId;i.hostname=new URL(r).hostname,e.log(`<selenium> resolved endpoint ip ${i.toString()} for sessionId=${c}`)}catch(t){e.log(`<selenium> unable to resolve endpoint ip for sessionId=${c}, running in standalone?`)}}}return await this._connectOverCDPInternal(e,i.toString(),{slowMo:n.slowMo},u)}catch(e){throw await u(),e}}_defaultArgs(e,t,n){const r=this._innerDefaultArgs(e);return r.push(`--user-data-dir=${n}`),e.useWebSocket?r.push("--remote-debugging-port=0"):r.push("--remote-debugging-pipe"),t?r.push("about:blank"):r.push("--no-startup-window"),r}_innerDefaultArgs(e){const{args:n=[],proxy:r}=e;if(n.find((e=>e.startsWith("--user-data-dir"))))throw new Error("Pass userDataDir parameter to `browserType.launchPersistentContext(userDataDir, ...)` instead of specifying --user-data-dir argument");if(n.find((e=>e.startsWith("--remote-debugging-pipe"))))throw new Error("Playwright manages remote debugging connection itself.");if(n.find((e=>!e.startsWith("-"))))throw new Error("Arguments can not specify page to be opened");const i=[...I];if("darwin"===t.default.platform()&&i.push("--enable-use-zoom-for-dsf=false"),e.devtools&&i.push("--auto-open-devtools-for-tabs"),e.headless&&i.push("--headless","--hide-scrollbars","--mute-audio","--blink-settings=primaryHoverType=2,availableHoverTypes=2,primaryPointerType=4,availablePointerTypes=4"),!0!==e.chromiumSandbox&&i.push("--no-sandbox"),r){const e=new URL(r.server);"socks5:"===e.protocol&&!this._playwrightOptions.socksProxyPort&&i.push(`--host-resolver-rules="MAP * ~NOTFOUND , EXCLUDE ${e.hostname}"`),i.push(`--proxy-server=${r.server}`);const t=[];this._playwrightOptions.socksProxyPort&&t.push("<-loopback>"),r.bypass&&t.push(...r.bypass.split(",").map((e=>e.trim())).map((e=>e.startsWith(".")?"*"+e:e))),process.env.PLAYWRIGHT_DISABLE_FORCED_CHROMIUM_PROXIED_LOOPBACK||t.includes("<-loopback>")||t.push("<-loopback>"),t.length>0&&i.push(`--proxy-bypass-list=${t.join(";")}`)}return i.push(...n),i}}Mv.Chromium=A;const I=["--disable-background-networking","--enable-features=NetworkService,NetworkServiceInProcess","--disable-background-timer-throttling","--disable-backgrounding-occluded-windows","--disable-breakpad","--disable-client-side-phishing-detection","--disable-component-extensions-with-background-pages","--disable-default-apps","--disable-dev-shm-usage","--disable-extensions","--disable-features=ImprovedCookieControls,LazyFrameLoading,GlobalMediaControls,DestroyProfileOnBrowserClose,MediaRouter,AcceptCHFrame,AutoExpandDetailsElement,CertificateTransparencyComponentUpdater","--allow-pre-commit-input","--disable-hang-monitor","--disable-ipc-flooding-protection","--disable-popup-blocking","--disable-prompt-on-repost","--disable-renderer-backgrounding","--disable-sync","--force-color-profile=srgb","--metrics-recording-only","--no-first-run","--enable-automation","--password-store=basic","--use-mock-keychain","--no-service-autorun","--export-tagged-pdf"];async function M(e,t){const n=await(0,p.streamToString)(t);let r=n;try{const e=JSON.parse(n);r=e.value.localizedMessage||e.value.message}catch(e){}return new Error(`Error connecting to Selenium at ${e.url}: ${r}`)}function F(e){return["ws://","wss://","http://","https://"].some((t=>e.startsWith(t)))?e:"http://"+e}return Mv}Wv.CRDevTools=class{constructor(e){this._preferencesPath=void 0,this._prefs=void 0,this._savePromise=void 0,this.__testHookOnBinding=void 0,this._preferencesPath=e,this._savePromise=Promise.resolve()}install(e){e.on("Runtime.bindingCalled",(async t=>{if("__pw_devtools__"!==t.name)return;const n=JSON.parse(t.payload);let r;if(this.__testHookOnBinding&&this.__testHookOnBinding(n),"getPreferences"===n.method){if(void 0===this._prefs)try{const e=await $v.default.promises.readFile(this._preferencesPath,"utf8");this._prefs=JSON.parse(e)}catch(e){this._prefs={}}r=this._prefs}else"setPreference"===n.method?(this._prefs[n.params[0]]=n.params[1],this._save()):"removePreference"===n.method?(delete this._prefs[n.params[0]],this._save()):"clearPreferences"===n.method&&(this._prefs={},this._save());e.send("Runtime.evaluate",{expression:`window.DevToolsAPI.embedderMessageAck(${n.id}, ${JSON.stringify(r)})`,contextId:t.executionContextId}).catch((e=>null))})),Promise.all([e.send("Runtime.enable"),e.send("Runtime.addBinding",{name:"__pw_devtools__"}),e.send("Page.enable"),e.send("Page.addScriptToEvaluateOnNewDocument",{source:"\n        (() => {\n          const init = () => {\n            // Lazy init happens when InspectorFrontendHost is initialized.\n            // At this point DevToolsHost is ready to be used.\n            const host = window.DevToolsHost;\n            const old = host.sendMessageToEmbedder.bind(host);\n            host.sendMessageToEmbedder = message => {\n              if (['getPreferences', 'setPreference', 'removePreference', 'clearPreferences'].includes(JSON.parse(message).method))\n                window.__pw_devtools__(message);\n              else\n                old(message);\n            };\n          };\n          let value;\n          Object.defineProperty(window, 'InspectorFrontendHost', {\n            configurable: true,\n            enumerable: true,\n            get() { return value; },\n            set(v) { value = v; init(); },\n          });\n        })()\n      "}),e.send("Runtime.runIfWaitingForDebugger")]).catch((e=>null))}_save(){this._savePromise=this._savePromise.then((async()=>{await $v.default.promises.writeFile(this._preferencesPath,JSON.stringify(this._prefs)).catch((e=>null))}))}};var Gv,Kv={};function Jv(){if(Gv)return Kv;Gv=1,Object.defineProperty(Kv,"__esModule",{value:!0}),Kv.ElectronApplication=Kv.Electron=void 0;var e=b(C.default),t=b(E.default),n=b(T.default),r=_v(),i=Z_,o=Iw,s=v(Cu),a=ru,l=Ci,c=Nv,u=nv,d=fx(),h=Uu,p=su,f=au,m=v(G.default),g=Ka,_=Hl;function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(w=function(e){return e?n:t})(e)}function v(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=w(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}function b(e){return e&&e.__esModule?e:{default:e}}const y=n.default.join(t.default.tmpdir(),"playwright-artifacts-");class S extends _.SdkObject{constructor(e,t,n,r){super(e,"electron-app"),this._browserContext=void 0,this._nodeConnection=void 0,this._nodeSession=void 0,this._nodeExecutionContext=void 0,this._nodeElectronHandlePromise=void 0,this._timeoutSettings=new a.TimeoutSettings,this._process=void 0,this._process=r,this._browserContext=t._defaultContext,this._browserContext.on(d.BrowserContext.Events.Close,(()=>{Promise.resolve().then((()=>this.emit(S.Events.Close)))})),this._nodeConnection=n,this._nodeSession=n.rootSession,this._nodeElectronHandlePromise=new Promise((e=>{this._nodeSession.on("Runtime.executionContextCreated",(async t=>{t.context.auxData&&t.context.auxData.isDefault&&(this._nodeExecutionContext=new s.ExecutionContext(this,new o.CRExecutionContext(this._nodeSession,t.context)),e(await s.evaluate(this._nodeExecutionContext,!1,"process.mainModule.require('electron')")))}))})),this._browserContext.setCustomCloseHandler((async()=>{const e=await this._nodeElectronHandlePromise;await e.evaluate((({app:e})=>e.quit()))})),this._nodeSession.send("Runtime.enable",{}).catch((e=>{}))}process(){return this._process}context(){return this._browserContext}async close(){const e=new h.ProgressController((0,_.serverSideCallMetadata)(),this).run((e=>p.helper.waitForEvent(e,this,S.Events.Close).promise));await this._browserContext.close((0,_.serverSideCallMetadata)()),this._nodeConnection.close(),await e}async browserWindow(e){const t=e._delegate._targetId,n=await this._nodeElectronHandlePromise;return await n.evaluateHandle((({BrowserWindow:e,webContents:t},n)=>{const r=t.fromDevToolsTargetId(n);return e.fromWebContents(r)}),t)}}Kv.ElectronApplication=S,S.Events={Close:"close"};class x extends _.SdkObject{constructor(e){super(e.rootSdkObject,"electron"),this._playwrightOptions=void 0,this._playwrightOptions=e}async launch(n){const{args:o=[]}=n,s=new h.ProgressController((0,_.serverSideCallMetadata)(),this);return s.setLogName("browser"),s.run((async s=>{let a;const h=["--inspect=0","--remote-debugging-port=0",...o];if("linux"===t.default.platform()){process.geteuid&&0===process.geteuid()&&-1===h.indexOf("--no-sandbox")&&h.push("--no-sandbox")}const f=await e.default.promises.mkdtemp(y),m=new g.RecentLogsCollector,_=n.env?(0,u.envArrayToObject)(n.env):process.env;let w;if(n.executablePath)w=n.executablePath;else try{w=require("electron/index.js")}catch(e){if("MODULE_NOT_FOUND"===(null==e?void 0:e.code))throw new Error("\n"+(0,l.wrapInASCIIBox)(["Electron executablePath not found!","Please install it using `npm install -D electron` or set the executablePath to your Electron executable."].join("\n"),1));throw e}delete _.NODE_OPTIONS;const{launchedProcess:v,gracefullyClose:b,kill:x}=await(0,u.launchProcess)({command:w,args:h,env:_,log:e=>{s.log(e),m.log(e)},stdio:"pipe",cwd:n.cwd,tempDirectories:[f],attemptToGracefullyClose:()=>a.close(),handleSIGINT:!0,handleSIGTERM:!0,handleSIGHUP:!0,onExit:()=>{}}),E=new Promise((async(e,t)=>{k(s,v,/Unable to open X display/).then((()=>t(new Error(["Unable to open X display!","================================","Most likely this is because there is no X server available.","Use 'xvfb-run' on Linux to launch your tests with an emulated display server.","For example: 'xvfb-run npm run test:e2e'","================================",s.metadata.log].join("\n"))))).catch((()=>{}))})),C=await k(s,v,/^Debugger listening on (ws:\/\/.*)$/),T=await c.WebSocketTransport.connect(s,C[1]),P=new i.CRConnection(T,p.helper.debugProtocolLogger(),m);k(s,v,/Waiting for the debugger to disconnect\.\.\./).then((()=>{T.close()})).catch((()=>{}));const O=await Promise.race([k(s,v,/^DevTools listening on (ws:\/\/.*)$/),E]),A=await c.WebSocketTransport.connect(s,O[1]),I={onclose:void 0,process:v,close:b,kill:x},M={...n,noDefaultViewport:!0},F={...this._playwrightOptions,name:"electron",isChromium:!0,headful:!0,persistent:M,browserProcess:I,protocolLogger:p.helper.debugProtocolLogger(),browserLogsCollector:m,artifactsDir:f,downloadsPath:f,tracesDir:f};(0,d.validateBrowserContextOptions)(M,F);const N=await r.CRBrowser.connect(A,F);return a=new S(this,N,P,v),a}),a.TimeoutSettings.timeout(n))}}function k(e,t,n){return new Promise(((r,i)=>{const o=m.createInterface({input:t.stderr}),s=new Error("Process failed to launch!"),a=[f.eventsHelper.addEventListener(o,"line",(function(e){const t=e.match(n);if(!t)return;l(),r(t)})),f.eventsHelper.addEventListener(o,"close",i.bind(null,s)),f.eventsHelper.addEventListener(t,"exit",i.bind(null,s)),f.eventsHelper.addEventListener(t,"error",i.bind(null,s))];function l(){f.eventsHelper.removeEventListeners(a)}e.cleanupWhenAborted(l)}))}return Kv.Electron=x,Kv}var Yv={},Xv={},Qv={};Object.defineProperty(Qv,"__esModule",{value:!0}),Qv.kBrowserCloseMessageId=Qv.FFSessionEvents=Qv.FFSession=Qv.FFConnection=Qv.ConnectionEvents=void 0;var Zv=M.default,eb=Ci,tb=$l,nb=Ka,rb=su,ib=ku;const ob={Disconnected:Symbol("Disconnected")};Qv.ConnectionEvents=ob;Qv.kBrowserCloseMessageId=-9999;class sb extends Zv.EventEmitter{constructor(e,t,n){super(),this._lastId=void 0,this._callbacks=void 0,this._transport=void 0,this._protocolLogger=void 0,this._browserLogsCollector=void 0,this._sessions=void 0,this._closed=void 0,this.on=void 0,this.addListener=void 0,this.off=void 0,this.removeListener=void 0,this.once=void 0,this.setMaxListeners(0),this._transport=e,this._protocolLogger=t,this._browserLogsCollector=n,this._lastId=0,this._callbacks=new Map,this._transport.onmessage=this._onMessage.bind(this),this._transport.onclose=this._onClose.bind(this),this._sessions=new Map,this._closed=!1,this.on=super.on,this.addListener=super.addListener,this.off=super.removeListener,this.removeListener=super.removeListener,this.once=super.once}async send(e,t){this._checkClosed(e);const n=this.nextMessageId();return this._rawSend({id:n,method:e,params:t}),new Promise(((t,r)=>{this._callbacks.set(n,{resolve:t,reject:r,error:new ib.ProtocolError(!1),method:e})}))}nextMessageId(){return++this._lastId}_checkClosed(e){if(this._closed)throw new ib.ProtocolError(!0,`${e}): Browser closed.`+rb.helper.formatBrowserLogs(this._browserLogsCollector.recentLogs()))}_rawSend(e){this._protocolLogger("send",e),this._transport.send(e)}async _onMessage(e){if(this._protocolLogger("receive",e),-9999!==e.id)if(e.sessionId){const t=this._sessions.get(e.sessionId);t&&t.dispatchMessage(e)}else if(e.id){const t=this._callbacks.get(e.id);t&&(this._callbacks.delete(e.id),e.error?t.reject(cb(t.error,t.method,e.error)):t.resolve(e.result))}else Promise.resolve().then((()=>this.emit(e.method,e.params)))}_onClose(){this._closed=!0,this._transport.onmessage=void 0,this._transport.onclose=void 0;const e=rb.helper.formatBrowserLogs(this._browserLogsCollector.recentLogs());for(const e of this._sessions.values())e.dispose();this._sessions.clear();for(const t of this._callbacks.values()){const n=(0,tb.rewriteErrorMessage)(t.error,`Protocol error (${t.method}): Browser closed.`+e);n.sessionClosed=!0,t.reject(n)}this._callbacks.clear(),Promise.resolve().then((()=>this.emit(ob.Disconnected)))}close(){this._closed||this._transport.close()}createSession(e){const t=new lb(this,e,(t=>this._rawSend({...t,sessionId:e})));return this._sessions.set(e,t),t}}Qv.FFConnection=sb;const ab={Disconnected:Symbol("Disconnected")};Qv.FFSessionEvents=ab;class lb extends Zv.EventEmitter{constructor(e,t,n){super(),this._connection=void 0,this._disposed=!1,this._callbacks=void 0,this._sessionId=void 0,this._rawSend=void 0,this._crashed=!1,this.on=void 0,this.addListener=void 0,this.off=void 0,this.removeListener=void 0,this.once=void 0,this.setMaxListeners(0),this._callbacks=new Map,this._connection=e,this._sessionId=t,this._rawSend=n,this.on=super.on,this.addListener=super.addListener,this.off=super.removeListener,this.removeListener=super.removeListener,this.once=super.once}markAsCrashed(){this._crashed=!0}async send(e,t){if(this._crashed)throw new ib.ProtocolError(!0,"Target crashed");if(this._connection._checkClosed(e),this._disposed)throw new ib.ProtocolError(!0,"Target closed");const n=this._connection.nextMessageId();return this._rawSend({method:e,params:t,id:n}),new Promise(((t,r)=>{this._callbacks.set(n,{resolve:t,reject:r,error:new ib.ProtocolError(!1),method:e})}))}sendMayFail(e,t){return this.send(e,t).catch((e=>nb.debugLogger.log("error",e)))}dispatchMessage(e){if(e.id&&this._callbacks.has(e.id)){const t=this._callbacks.get(e.id);this._callbacks.delete(e.id),e.error?t.reject(cb(t.error,t.method,e.error)):t.resolve(e.result)}else(0,eb.assert)(!e.id),Promise.resolve().then((()=>this.emit(e.method,e.params)))}dispose(){for(const e of this._callbacks.values())e.error.sessionClosed=!0,e.reject((0,tb.rewriteErrorMessage)(e.error,"Target closed"));this._callbacks.clear(),this._disposed=!0,this._connection._sessions.delete(this._sessionId),Promise.resolve().then((()=>this.emit(ab.Disconnected)))}}function cb(e,t,n){let r=`Protocol error (${t}): ${n.message}`;return"data"in n&&(r+=` ${n.data}`),(0,tb.rewriteErrorMessage)(e,r)}Qv.FFSession=lb;var ub={},db={};Object.defineProperty(db,"__esModule",{value:!0}),db.getAccessibilityTree=async function(e,t){const n=t?t._objectId:void 0,{tree:r}=await e.send("Accessibility.getFullAXTree",{objectId:n}),i=new pb(r);return{tree:i,needle:t?i._findNeedle():null}};const hb=new Map(Object.entries({pushbutton:"button",checkbutton:"checkbox",editcombobox:"combobox","content deletion":"deletion",footnote:"doc-footnote","non-native document":"document",grouping:"group",graphic:"img","content insertion":"insertion",animation:"marquee","flat equation":"math",menupopup:"menu","check menu item":"menuitemcheckbox","radio menu item":"menuitemradio","listbox option":"option",radiobutton:"radio",statusbar:"status",pagetab:"tab",pagetablist:"tablist",propertypage:"tabpanel",entry:"textbox",outline:"tree","tree table":"treegrid",outlineitem:"treeitem"}));class pb{constructor(e){this._children=void 0,this._payload=void 0,this._editable=void 0,this._richlyEditable=void 0,this._focusable=void 0,this._expanded=void 0,this._name=void 0,this._role=void 0,this._cachedHasFocusableChild=void 0,this._payload=e,this._children=(e.children||[]).map((e=>new pb(e))),this._editable=!!e.editable,this._richlyEditable=this._editable&&"textarea"!==e.tag&&"input"!==e.tag,this._focusable=!!e.focusable,this._expanded=!!e.expanded,this._name=this._payload.name,this._role=this._payload.role}_isPlainTextField(){return!this._richlyEditable&&(!!this._editable||"entry"===this._role)}_isTextOnlyObject(){const e=this._role;return"text leaf"===e||"text"===e||"statictext"===e}_hasFocusableChild(){if(void 0===this._cachedHasFocusableChild){this._cachedHasFocusableChild=!1;for(const e of this._children)if(e._focusable||e._hasFocusableChild()){this._cachedHasFocusableChild=!0;break}}return this._cachedHasFocusableChild}children(){return this._children}_findNeedle(){if(this._payload.foundObject)return this;for(const e of this._children){const t=e._findNeedle();if(t)return t}return null}isLeafNode(){if(!this._children.length)return!0;if(this._isPlainTextField()||this._isTextOnlyObject())return!0;switch(this._role){case"graphic":case"scrollbar":case"slider":case"separator":case"progressbar":return!0}return!this._hasFocusableChild()&&(!(!this._focusable||"document"===this._role||!this._name)||!("heading"!==this._role||!this._name))}isControl(){switch(this._role){case"checkbutton":case"check menu item":case"check rich option":case"combobox":case"combobox option":case"color chooser":case"listbox":case"listbox option":case"listbox rich option":case"popup menu":case"menupopup":case"menuitem":case"menubar":case"button":case"pushbutton":case"radiobutton":case"radio menuitem":case"scrollbar":case"slider":case"spinbutton":case"switch":case"pagetab":case"entry":case"tree table":return!0;default:return!1}}isInteresting(e){return!(!this._focusable&&!this._richlyEditable)||(!!this.isControl()||!e&&(this.isLeafNode()&&!!this._name.trim()))}serialize(){const e={role:hb.get(this._role)||this._role,name:this._name||""},t=["name","description","roledescription","valuetext","keyshortcuts"];for(const n of t)n in this._payload&&(e[n]=this._payload[n]);const n=["disabled","expanded","focused","modal","multiline","multiselectable","readonly","required","selected"];for(const t of n){if("document"===this._role&&"focused"===t)continue;const n=this._payload[t];n&&(e[t]=n)}const r=["level"];for(const t of r)t in this._payload&&(e[t]=this._payload[t]);const i=["autocomplete","haspopup","invalid","orientation"];for(const t of i){const n=this._payload[t];n&&"false"!==n&&(e[t]=n)}const o=e;return o.valueString=this._payload.value,"checked"in this._payload&&(o.checked=!0===this._payload.checked?"checked":"mixed"===this._payload.checked?"mixed":"unchecked"),"pressed"in this._payload&&(o.pressed=!0===this._payload.pressed?"pressed":"released"),o}}var fb={};Object.defineProperty(fb,"__esModule",{value:!0}),fb.FFExecutionContext=void 0;var mb=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=vb(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(Cu),gb=$l,_b=Pu,wb=ku;function vb(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(vb=function(e){return e?n:t})(e)}function bb(e){if(e)throw e.value?new mb.JavaScriptErrorInEvaluate(JSON.stringify(e.value)):new mb.JavaScriptErrorInEvaluate(e.text+(e.stack?"\n"+e.stack:""))}function yb(e){if(e.message.includes("cyclic object value")||e.message.includes("Object is not serializable"))return{result:{type:"undefined",value:void 0}};if(e instanceof TypeError&&e.message.startsWith("Converting circular structure to JSON")&&(0,gb.rewriteErrorMessage)(e,e.message+" Are you passing a nested JSHandle?"),!mb.isJavaScriptErrorInEvaluate(e)&&!(0,wb.isSessionClosedError)(e))throw new Error("Execution context was destroyed, most likely because of a navigation.");throw e}fb.FFExecutionContext=class{constructor(e,t){this._session=void 0,this._executionContextId=void 0,this._session=e,this._executionContextId=t}async rawEvaluateJSON(e){const t=await this._session.send("Runtime.evaluate",{expression:e,returnByValue:!0,executionContextId:this._executionContextId}).catch(yb);return bb(t.exceptionDetails),t.result.value}async rawEvaluateHandle(e){const t=await this._session.send("Runtime.evaluate",{expression:e,returnByValue:!1,executionContextId:this._executionContextId}).catch(yb);return bb(t.exceptionDetails),t.result.objectId}rawCallFunctionNoReply(e,...t){this._session.send("Runtime.callFunction",{functionDeclaration:e.toString(),args:t.map((e=>e instanceof mb.JSHandle?{objectId:e._objectId}:{value:e})),returnByValue:!0,executionContextId:this._executionContextId}).catch((()=>{}))}async evaluateWithArguments(e,t,n,r,i){const o=await this._session.send("Runtime.callFunction",{functionDeclaration:e,args:[{objectId:n._objectId,value:void 0},...r.map((e=>({value:e}))),...i.map((e=>({objectId:e,value:void 0})))],returnByValue:t,executionContextId:this._executionContextId}).catch(yb);return bb(o.exceptionDetails),t?(0,_b.parseEvaluationResultValue)(o.result.value):n._context.createHandle(o.result)}async getProperties(e,t){const n=await this._session.send("Runtime.getObjectProperties",{executionContextId:this._executionContextId,objectId:t}),r=new Map;for(const t of n.properties)r.set(t.name,e.createHandle(t.value));return r}createHandle(e,t){return new mb.JSHandle(e,t.subtype||t.type||"",function(e){if("undefined"===e.type)return"undefined";if(e.unserializableValue)return String(e.unserializableValue);if("symbol"===e.type)return"Symbol()";if("regexp"===e.subtype)return"RegExp";if("weakmap"===e.subtype)return"WeakMap";if("weakset"===e.subtype)return"WeakSet";if(e.subtype)return e.subtype[0].toUpperCase()+e.subtype.slice(1);if("value"in e)return String(e.value)}(t),t.objectId,function(e){const t=e.value,n=e.unserializableValue;return n?mb.parseUnserializableValue(n):t}(t))}async releaseHandle(e){await this._session.send("Runtime.disposeObject",{executionContextId:this._executionContextId,objectId:e})}};var Sb={};function xb(e){let t=0;return e.has("Alt")&&(t|=1),e.has("Control")&&(t|=2),e.has("Shift")&&(t|=4),e.has("Meta")&&(t|=8),t}function kb(e){return"left"===e?0:"middle"===e?1:"right"===e?2:0}function Eb(e){let t=0;return e.has("left")&&(t|=1),e.has("right")&&(t|=2),e.has("middle")&&(t|=4),t}Object.defineProperty(Sb,"__esModule",{value:!0}),Sb.RawTouchscreenImpl=Sb.RawMouseImpl=Sb.RawKeyboardImpl=void 0;Sb.RawKeyboardImpl=class{constructor(e){this._client=void 0,this._client=e}async keydown(e,t,n,r,i,o,s,a){"MetaLeft"===t&&(t="OSLeft"),"MetaRight"===t&&(t="OSRight"),"\r"===a&&(a=""),await this._client.send("Page.dispatchKeyEvent",{type:"keydown",keyCode:r,code:t,key:i,repeat:s,location:o,text:a})}async keyup(e,t,n,r,i,o){"MetaLeft"===t&&(t="OSLeft"),"MetaRight"===t&&(t="OSRight"),await this._client.send("Page.dispatchKeyEvent",{type:"keyup",key:i,keyCode:r,code:t,location:o,repeat:!1})}async sendText(e){await this._client.send("Page.insertText",{text:e})}};Sb.RawMouseImpl=class{constructor(e){this._client=void 0,this._page=void 0,this._client=e}async move(e,t,n,r,i,o){await this._client.send("Page.dispatchMouseEvent",{type:"mousemove",button:0,buttons:Eb(r),x:Math.floor(e),y:Math.floor(t),modifiers:xb(i)})}async down(e,t,n,r,i,o){await this._client.send("Page.dispatchMouseEvent",{type:"mousedown",button:kb(n),buttons:Eb(r),x:Math.floor(e),y:Math.floor(t),modifiers:xb(i),clickCount:o})}async up(e,t,n,r,i,o){await this._client.send("Page.dispatchMouseEvent",{type:"mouseup",button:kb(n),buttons:Eb(r),x:Math.floor(e),y:Math.floor(t),modifiers:xb(i),clickCount:o})}async wheel(e,t,n,r,i,o){await this._page.mainFrame().evaluateExpression("new Promise(requestAnimationFrame)",!1,!1,"utility"),await this._client.send("Page.dispatchWheelEvent",{deltaX:i,deltaY:o,x:Math.floor(e),y:Math.floor(t),deltaZ:0,modifiers:xb(r)})}setPage(e){this._page=e}};Sb.RawTouchscreenImpl=class{constructor(e){this._client=void 0,this._client=e}async tap(e,t,n){await this._client.send("Page.dispatchTapEvent",{x:e,y:t,modifiers:xb(n)})}};var Cb,Tb,Pb,Ob,Ab={};function Ib(){if(Tb)return ub;Tb=1,Object.defineProperty(ub,"__esModule",{value:!0}),ub.UTILITY_WORLD_NAME=ub.FFPage=void 0;var e=f(dw),t=f(bu),n=au,r=Ci,i=Uh(),o=db,s=Qv,a=fb,l=Sb,c=function(){if(Cb)return Ab;Cb=1,Object.defineProperty(Ab,"__esModule",{value:!0}),Ab.FFNetworkManager=void 0;var e=au,t=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=e[s]}return i.default=e,r&&r.set(e,i),i}(_u());function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}Ab.FFNetworkManager=class{constructor(t,n){this._session=void 0,this._requests=void 0,this._page=void 0,this._eventListeners=void 0,this._session=t,this._requests=new Map,this._page=n,this._eventListeners=[e.eventsHelper.addEventListener(t,"Network.requestWillBeSent",this._onRequestWillBeSent.bind(this)),e.eventsHelper.addEventListener(t,"Network.responseReceived",this._onResponseReceived.bind(this)),e.eventsHelper.addEventListener(t,"Network.requestFinished",this._onRequestFinished.bind(this)),e.eventsHelper.addEventListener(t,"Network.requestFailed",this._onRequestFailed.bind(this))]}dispose(){e.eventsHelper.removeEventListeners(this._eventListeners)}async setRequestInterception(e){await this._session.send("Network.setRequestInterception",{enabled:e})}_onRequestWillBeSent(e){const t=e.redirectedFrom&&this._requests.get(e.redirectedFrom)||null,n=t?t.request.frame():e.frameId?this._page._frameManager.frame(e.frameId):null;if(!n)return;t&&this._requests.delete(t._id);const r=new o(n,t,e);let i;e.isIntercepted&&(i=new s(this._session,r)),this._requests.set(r._id,r),this._page._frameManager.requestStarted(r.request,i)}_onResponseReceived(e){var n,r,i,o,s;const a=this._requests.get(e.requestId);if(!a)return;const l=e.timing.startTime;function c(e){return e?(e-l)/1e3:-1}const u={startTime:l/1e3,domainLookupStart:c(e.timing.domainLookupStart),domainLookupEnd:c(e.timing.domainLookupEnd),connectStart:c(e.timing.connectStart),secureConnectionStart:c(e.timing.secureConnectionStart),connectEnd:c(e.timing.connectEnd),requestStart:c(e.timing.requestStart),responseStart:c(e.timing.responseStart)},d=new t.Response(a.request,e.status,e.statusText,function(e){const t=[];for(const n of e){const e="set-cookie"===n.name.toLowerCase()?"\n":",",r=n.value.split(e).map((e=>e.trim()));for(const e of r)t.push({name:n.name,value:e})}return t}(e.headers),u,(async()=>{const e=await this._session.send("Network.getResponseBody",{requestId:a._id});if(e.evicted)throw new Error(`Response body for ${a.request.method()} ${a.request.url()} was evicted!`);return Buffer.from(e.base64body,"base64")}));null!=e&&e.remoteIPAddress&&"number"==typeof(null==e?void 0:e.remotePort)?d._serverAddrFinished({ipAddress:e.remoteIPAddress,port:e.remotePort}):d._serverAddrFinished(),d._securityDetailsFinished({protocol:null==e||null===(n=e.securityDetails)||void 0===n?void 0:n.protocol,subjectName:null==e||null===(r=e.securityDetails)||void 0===r?void 0:r.subjectName,issuer:null==e||null===(i=e.securityDetails)||void 0===i?void 0:i.issuer,validFrom:null==e||null===(o=e.securityDetails)||void 0===o?void 0:o.validFrom,validTo:null==e||null===(s=e.securityDetails)||void 0===s?void 0:s.validTo}),this._page._frameManager.requestReceivedResponse(d)}_onRequestFinished(e){const t=this._requests.get(e.requestId);if(!t)return;const n=t.request._existingResponse();t.request.responseSize.transferSize=e.transferSize;const r=n.status()>=300&&n.status()<=399,i=e.responseEndTime?e.responseEndTime/1e3-n.timing().startTime:-1;r||this._requests.delete(t._id),n._requestFinished(i),e.protocolVersion&&n._setHttpVersion(e.protocolVersion),this._page._frameManager.reportRequestFinished(t.request,n)}_onRequestFailed(e){const t=this._requests.get(e.requestId);if(!t)return;this._requests.delete(t._id);const n=t.request._existingResponse();n&&n._requestFinished(-1),t.request._setFailureText(e.errorCode),this._page._frameManager.requestFailed(t.request,"NS_BINDING_ABORTED"===e.errorCode)}};const r={TYPE_INVALID:"other",TYPE_OTHER:"other",TYPE_SCRIPT:"script",TYPE_IMAGE:"image",TYPE_STYLESHEET:"stylesheet",TYPE_OBJECT:"other",TYPE_DOCUMENT:"document",TYPE_SUBDOCUMENT:"document",TYPE_REFRESH:"document",TYPE_XBL:"other",TYPE_PING:"other",TYPE_XMLHTTPREQUEST:"xhr",TYPE_OBJECT_SUBREQUEST:"other",TYPE_DTD:"other",TYPE_FONT:"font",TYPE_MEDIA:"media",TYPE_WEBSOCKET:"websocket",TYPE_CSP_REPORT:"other",TYPE_XSLT:"other",TYPE_BEACON:"other",TYPE_FETCH:"fetch",TYPE_IMAGESET:"images",TYPE_WEB_MANIFEST:"manifest"},i={TYPE_INTERNAL_EVENTSOURCE:"eventsource"};class o{constructor(e,n,o){this.request=void 0,this._id=void 0,this._redirectedTo=void 0,this._id=o.requestId,n&&(n._redirectedTo=this);let s=null;o.postData&&(s=Buffer.from(o.postData,"base64")),this.request=new t.Request(e,n?n.request:null,o.navigationId,o.url,i[o.internalCause]||r[o.cause]||"other",o.method,s,o.headers)}_finalRequest(){let e=this;for(;e._redirectedTo;)e=e._redirectedTo;return e}}class s{constructor(e,t){this._request=void 0,this._session=void 0,this._session=e,this._request=t}async continue(e,t){await this._session.sendMayFail("Network.resumeInterceptedRequest",{requestId:this._request._id,url:t.url,method:t.method,headers:t.headers,postData:t.postData?Buffer.from(t.postData).toString("base64"):void 0})}async fulfill(e){const n=e.isBase64?e.body:Buffer.from(e.body).toString("base64");await this._session.sendMayFail("Network.fulfillInterceptedRequest",{requestId:this._request._id,status:e.status,statusText:t.STATUS_TEXTS[String(e.status)]||"",headers:e.headers,base64body:n})}async abort(e){await this._session.sendMayFail("Network.abortInterceptedRequest",{requestId:this._request._id,errorCode:e})}}return Ab}(),u=$l,d=Ka,h=pu;function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function f(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}const m="__playwright_utility_world__";ub.UTILITY_WORLD_NAME=m;function g(e,t){return`${e}---${t}`}ub.FFPage=class{constructor(e,t,r){this.cspErrorsAsynchronousForInlineScipts=!0,this.rawMouse=void 0,this.rawKeyboard=void 0,this.rawTouchscreen=void 0,this._session=void 0,this._page=void 0,this._networkManager=void 0,this._browserContext=void 0,this._pagePromise=new h.ManualPromise,this._initializedPage=null,this._initializationFailed=!1,this._opener=void 0,this._contextIdToContext=void 0,this._eventListeners=void 0,this._workers=new Map,this._screencastId=void 0,this._initScripts=[],this._session=e,this._opener=r,this.rawKeyboard=new l.RawKeyboardImpl(e),this.rawMouse=new l.RawMouseImpl(e),this.rawTouchscreen=new l.RawTouchscreenImpl(e),this._contextIdToContext=new Map,this._browserContext=t,this._page=new i.Page(this,t),this.rawMouse.setPage(this._page),this._networkManager=new c.FFNetworkManager(e,this._page),this._page.on(i.Page.Events.FrameDetached,(e=>this._removeContextsForFrame(e))),this._eventListeners=[n.eventsHelper.addEventListener(this._session,"Page.eventFired",this._onEventFired.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.frameAttached",this._onFrameAttached.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.frameDetached",this._onFrameDetached.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.navigationAborted",this._onNavigationAborted.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.navigationCommitted",this._onNavigationCommitted.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.navigationStarted",this._onNavigationStarted.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.sameDocumentNavigation",this._onSameDocumentNavigation.bind(this)),n.eventsHelper.addEventListener(this._session,"Runtime.executionContextCreated",this._onExecutionContextCreated.bind(this)),n.eventsHelper.addEventListener(this._session,"Runtime.executionContextDestroyed",this._onExecutionContextDestroyed.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.linkClicked",(e=>this._onLinkClicked(e.phase))),n.eventsHelper.addEventListener(this._session,"Page.uncaughtError",this._onUncaughtError.bind(this)),n.eventsHelper.addEventListener(this._session,"Runtime.console",this._onConsole.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.dialogOpened",this._onDialogOpened.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.bindingCalled",this._onBindingCalled.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.fileChooserOpened",this._onFileChooserOpened.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.workerCreated",this._onWorkerCreated.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.workerDestroyed",this._onWorkerDestroyed.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.dispatchMessageFromWorker",this._onDispatchMessageFromWorker.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.crashed",this._onCrashed.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.videoRecordingStarted",this._onVideoRecordingStarted.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.webSocketCreated",this._onWebSocketCreated.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.webSocketClosed",this._onWebSocketClosed.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.webSocketFrameReceived",this._onWebSocketFrameReceived.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.webSocketFrameSent",this._onWebSocketFrameSent.bind(this)),n.eventsHelper.addEventListener(this._session,"Page.screencastFrame",this._onScreencastFrame.bind(this))],e.once(s.FFSessionEvents.Disconnected,(()=>{this._markAsError(new Error("Page closed")),this._page._didDisconnect()})),this._session.once("Page.ready",(async()=>{await this._page.initOpener(this._opener),this._initializationFailed||(this._initializedPage=this._page,this._page.reportAsNew(),this._pagePromise.resolve(this._page))})),this.addInitScript("",m).catch((e=>this._markAsError(e)))}potentiallyUninitializedPage(){return this._page}async _markAsError(e){this._initializationFailed||(this._initializationFailed=!0,this._initializedPage||(await this._page.initOpener(this._opener),this._page.reportAsNew(e),this._pagePromise.resolve(e)))}async pageOrError(){return this._pagePromise}_onWebSocketCreated(e){this._page._frameManager.onWebSocketCreated(g(e.frameId,e.wsid),e.requestURL),this._page._frameManager.onWebSocketRequest(g(e.frameId,e.wsid))}_onWebSocketClosed(e){e.error&&this._page._frameManager.webSocketError(g(e.frameId,e.wsid),e.error),this._page._frameManager.webSocketClosed(g(e.frameId,e.wsid))}_onWebSocketFrameReceived(e){this._page._frameManager.webSocketFrameReceived(g(e.frameId,e.wsid),e.opcode,e.data)}_onWebSocketFrameSent(e){this._page._frameManager.onWebSocketFrameSent(g(e.frameId,e.wsid),e.opcode,e.data)}_onExecutionContextCreated(e){const{executionContextId:n,auxData:r}=e,i=this._page._frameManager.frame(r.frameId);if(!i)return;const o=new a.FFExecutionContext(this._session,n);let s=null;r.name===m?s="utility":r.name||(s="main");const l=new t.FrameExecutionContext(o,i,s);l[_]=o,s&&i._contextCreated(s,l),this._contextIdToContext.set(n,l)}_onExecutionContextDestroyed(e){const{executionContextId:t}=e,n=this._contextIdToContext.get(t);n&&(this._contextIdToContext.delete(t),n.frame._contextDestroyed(n))}_removeContextsForFrame(e){for(const[t,n]of this._contextIdToContext)n.frame===e&&this._contextIdToContext.delete(t)}_onLinkClicked(e){"before"===e?this._page._frameManager.frameWillPotentiallyRequestNavigation():this._page._frameManager.frameDidPotentiallyRequestNavigation()}_onNavigationStarted(e){this._page._frameManager.frameRequestedNavigation(e.frameId,e.navigationId)}_onNavigationAborted(e){this._page._frameManager.frameAbortedNavigation(e.frameId,e.errorText,e.navigationId)}_onNavigationCommitted(e){for(const[t,n]of this._workers)n.frameId===e.frameId&&this._onWorkerDestroyed({workerId:t});this._page._frameManager.frameCommittedNewDocumentNavigation(e.frameId,e.url,e.name||"",e.navigationId||"",!1)}_onSameDocumentNavigation(e){this._page._frameManager.frameCommittedSameDocumentNavigation(e.frameId,e.url)}_onFrameAttached(e){this._page._frameManager.frameAttached(e.frameId,e.parentFrameId)}_onFrameDetached(e){this._page._frameManager.frameDetached(e.frameId)}_onEventFired(e){const{frameId:t,name:n}=e;"load"===n&&this._page._frameManager.frameLifecycleEvent(t,"load"),"DOMContentLoaded"===n&&this._page._frameManager.frameLifecycleEvent(t,"domcontentloaded")}_onUncaughtError(e){const{name:t,message:n}=(0,u.splitErrorMessage)(e.message),r=new Error(n);r.stack=e.message+"\n"+e.stack.split("\n").filter(Boolean).map((e=>e.replace(/([^@]*)@(.*)/,"    at $1 ($2)"))).join("\n"),r.name=t,this._page.firePageError(r)}_onConsole(e){const{type:t,args:n,executionContextId:r,location:i}=e,o=this._contextIdToContext.get(r);o&&this._page._addConsoleMessage(t,n.map((e=>o.createHandle(e))),i)}_onDialogOpened(t){this._page.emit(i.Page.Events.Dialog,new e.Dialog(this._page,t.type,t.message,(async(e,n)=>{await this._session.sendMayFail("Page.handleDialog",{dialogId:t.dialogId,accept:e,promptText:n})}),t.defaultValue))}async _onBindingCalled(e){if(!(await this.pageOrError()instanceof Error)){const t=this._contextIdToContext.get(e.executionContextId);t&&await this._page._onBindingCalled(e.payload,t)}}async _onFileChooserOpened(e){const{executionContextId:t,element:n}=e,r=this._contextIdToContext.get(t);if(!r)return;const i=r.createHandle(n).asElement();await this._page._onFileChooserOpened(i)}async _onWorkerCreated(e){const t=e.workerId,n=new i.Worker(this._page,e.url),r=new s.FFSession(this._session._connection,t,(n=>{this._session.send("Page.sendMessageToWorker",{frameId:e.frameId,workerId:t,message:JSON.stringify(n)}).catch((e=>{r.dispatchMessage({id:n.id,method:"",params:{},error:{message:e.message,data:void 0}})}))}));this._workers.set(t,{session:r,frameId:e.frameId}),this._page._addWorker(t,n),r.once("Runtime.executionContextCreated",(e=>{n._createExecutionContext(new a.FFExecutionContext(r,e.executionContextId))})),r.on("Runtime.console",(e=>{const{type:t,args:r,location:i}=e,o=n._existingExecutionContext;this._page._addConsoleMessage(t,r.map((e=>o.createHandle(e))),i)}))}_onWorkerDestroyed(e){const t=e.workerId,n=this._workers.get(t);n&&(n.session.dispose(),this._workers.delete(t),this._page._removeWorker(t))}async _onDispatchMessageFromWorker(e){const t=this._workers.get(e.workerId);t&&t.session.dispatchMessage(JSON.parse(e.message))}async _onCrashed(e){this._session.markAsCrashed(),this._page._didCrash()}_onVideoRecordingStarted(e){this._browserContext._browser._videoStarted(this._browserContext,e.screencastId,e.file,this.pageOrError())}async exposeBinding(e){await this._session.send("Page.addBinding",{name:e.name,script:e.source})}async removeExposedBindings(){}didClose(){this._session.dispose(),n.eventsHelper.removeEventListeners(this._eventListeners),this._networkManager.dispose(),this._page._didClose()}async navigateFrame(e,t,n){return{newDocumentId:(await this._session.send("Page.navigate",{url:t,referer:n,frameId:e._id})).navigationId||void 0}}async updateExtraHTTPHeaders(){await this._session.send("Network.setExtraHTTPHeaders",{headers:this._page._state.extraHTTPHeaders||[]})}async setEmulatedSize(e){(0,r.assert)(this._page._state.emulatedSize===e),await this._session.send("Page.setViewportSize",{viewportSize:{width:e.viewport.width,height:e.viewport.height}})}async bringToFront(){await this._session.send("Page.bringToFront",{})}async updateEmulateMedia(){const e=null===this._page._state.colorScheme?void 0:this._page._state.colorScheme,t=null===this._page._state.reducedMotion?void 0:this._page._state.reducedMotion,n=null===this._page._state.forcedColors?void 0:this._page._state.forcedColors;await this._session.send("Page.setEmulatedMedia",{type:null===this._page._state.mediaType?"":this._page._state.mediaType,colorScheme:e,reducedMotion:t,forcedColors:n})}async updateRequestInterception(){await this._networkManager.setRequestInterception(this._page._needsRequestInterception())}async setFileChooserIntercepted(e){await this._session.send("Page.setInterceptFileChooserDialog",{enabled:e}).catch((e=>{}))}async reload(){await this._session.send("Page.reload",{frameId:this._page.mainFrame()._id})}async goBack(){const{success:e}=await this._session.send("Page.goBack",{frameId:this._page.mainFrame()._id});return e}async goForward(){const{success:e}=await this._session.send("Page.goForward",{frameId:this._page.mainFrame()._id});return e}async addInitScript(e,t){this._initScripts.push({script:e,worldName:t}),await this._session.send("Page.setInitScripts",{scripts:this._initScripts})}async removeInitScripts(){this._initScripts=[],await this._session.send("Page.setInitScripts",{scripts:[]})}async closePage(e){await this._session.send("Page.close",{runBeforeUnload:e})}async setBackgroundColor(e){if(e)throw new Error("Not implemented")}async takeScreenshot(e,t,n,r,i,o,s){if(!n){const t=await this._page.mainFrame().waitForFunctionValueInUtility(e,(()=>({x:window.scrollX,y:window.scrollY})));n={x:r.x+t.x,y:r.y+t.y,width:r.width,height:r.height}}e.throwIfAborted();const{data:a}=await this._session.send("Page.screenshot",{mimeType:"image/"+t,clip:n,omitDeviceScaleFactor:"css"===s});return Buffer.from(a,"base64")}async getContentFrame(e){const{contentFrameId:t}=await this._session.send("Page.describeNode",{frameId:e._context.frame._id,objectId:e._objectId});return t?this._page._frameManager.frame(t):null}async getOwnerFrame(e){const{ownerFrameId:t}=await this._session.send("Page.describeNode",{frameId:e._context.frame._id,objectId:e._objectId});return t||null}isElementHandle(e){return"node"===e.subtype}async getBoundingBox(e){const t=await this.getContentQuads(e);if(!t||!t.length)return null;let n=1/0,r=-1/0,i=1/0,o=-1/0;for(const e of t)for(const t of e)n=Math.min(n,t.x),r=Math.max(r,t.x),i=Math.min(i,t.y),o=Math.max(o,t.y);return{x:n,y:i,width:r-n,height:o-i}}async scrollRectIntoViewIfNeeded(e,t){return await this._session.send("Page.scrollIntoViewIfNeeded",{frameId:e._context.frame._id,objectId:e._objectId,rect:t}).then((()=>"done")).catch((e=>{if(e instanceof Error&&e.message.includes("Node is detached from document"))return"error:notconnected";if(e instanceof Error&&e.message.includes("Node does not have a layout object"))return"error:notvisible";throw e}))}async setScreencastOptions(e){if(e){const{screencastId:t}=await this._session.send("Page.startScreencast",e);this._screencastId=t}else await this._session.send("Page.stopScreencast")}_onScreencastFrame(e){if(!this._screencastId)return;const t=this._screencastId;this._page.throttleScreencastFrameAck((()=>{this._session.send("Page.screencastFrameAck",{screencastId:t}).catch((e=>d.debugLogger.log("error",e)))}));const n=Buffer.from(e.data,"base64");this._page.emit(i.Page.Events.ScreencastFrame,{buffer:n,width:e.deviceWidth,height:e.deviceHeight})}rafCountForStablePosition(){return 1}async getContentQuads(e){const t=await this._session.sendMayFail("Page.getContentQuads",{frameId:e._context.frame._id,objectId:e._objectId});return t?t.quads.map((e=>[e.p1,e.p2,e.p3,e.p4])):null}async setInputFiles(e,t){await e.evaluateInUtility((([e,t,n])=>e.setInputFiles(t,n)),t)}async setInputFilePaths(e,t){await Promise.all([this._session.send("Page.setFileInputFiles",{frameId:e._context.frame._id,objectId:e._objectId,files:t}),e.dispatchEvent("input"),e.dispatchEvent("change")])}async adoptElementHandle(e,n){const r=await this._session.send("Page.adoptNode",{frameId:e._context.frame._id,objectId:e._objectId,executionContextId:n[_]._executionContextId});if(!r.remoteObject)throw new Error(t.kUnableToAdoptErrorMessage);return n.createHandle(r.remoteObject)}async getAccessibilityTree(e){return(0,o.getAccessibilityTree)(this._session,e)}async inputActionEpilogue(){}async getFrameElement(e){const t=e.parentFrame();if(!t)throw new Error("Frame has been detached.");const n=this._page.parseSelector("frame,iframe"),r=await this._page.selectors._queryAll(t,n),i=await Promise.all(r.map((async e=>{const t=await e.contentFrame().catch((e=>null));return{handle:e,frame:t}}))),o=i.find((t=>t.frame===e));if(i.map((e=>e===o?Promise.resolve():e.handle.dispose())),!o)throw new Error("Frame has been detached.");return o.handle}};const _=Symbol("delegate");return ub}function Mb(){if(Ob)return Yv;Ob=1,Object.defineProperty(Yv,"__esModule",{value:!0}),Yv.Firefox=void 0;var e=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(E.default),t=l(C.default),n=l(T.default),r=function(){if(Pb)return Xv;Pb=1,Object.defineProperty(Xv,"__esModule",{value:!0}),Xv.FFBrowserContext=Xv.FFBrowser=void 0;var e=Al,t=Ci,n=Q_(),r=fx(),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(_u()),o=Qv,s=Ib();function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}class l extends n.Browser{static async connect(e,t){const n=new o.FFConnection(e,t.protocolLogger,t.browserLogsCollector),r=new l(n,t);t.__testHookOnConnectToBrowser&&await t.__testHookOnConnectToBrowser();const i=[n.send("Browser.enable",{attachToDefaultContext:!!t.persistent}),r._initVersion()];return t.persistent&&(r._defaultContext=new c(r,void 0,t.persistent),i.push(r._defaultContext._initialize())),t.proxy&&i.push(r._connection.send("Browser.setBrowserProxy",u(t.proxy))),await Promise.all(i),r}constructor(e,t){super(t),this._connection=void 0,this._ffPages=void 0,this._contexts=void 0,this._version="",this._userAgent="",this._connection=e,this._ffPages=new Map,this._contexts=new Map,this._connection.on(o.ConnectionEvents.Disconnected,(()=>this._onDisconnect())),this._connection.on("Browser.attachedToTarget",this._onAttachedToTarget.bind(this)),this._connection.on("Browser.detachedFromTarget",this._onDetachedFromTarget.bind(this)),this._connection.on("Browser.downloadCreated",this._onDownloadCreated.bind(this)),this._connection.on("Browser.downloadFinished",this._onDownloadFinished.bind(this)),this._connection.on("Browser.videoRecordingFinished",this._onVideoRecordingFinished.bind(this))}async _initVersion(){const e=await this._connection.send("Browser.getInfo");this._version=e.version.substring(e.version.indexOf("/")+1),this._userAgent=e.userAgent}isConnected(){return!this._connection._closed}async doCreateNewContext(e){if(e.isMobile)throw new Error("options.isMobile is not supported in Firefox");const{browserContextId:t}=await this._connection.send("Browser.createBrowserContext",{removeOnDetach:!0}),n=new c(this,t,e);return await n._initialize(),this._contexts.set(t,n),n}contexts(){return Array.from(this._contexts.values())}version(){return this._version}userAgent(){return this._userAgent}_onDetachedFromTarget(e){const t=this._ffPages.get(e.targetId);this._ffPages.delete(e.targetId),t.didClose()}_onAttachedToTarget(e){const{targetId:n,browserContextId:r,openerId:i,type:o}=e.targetInfo;(0,t.assert)("page"===o);const a=r?this._contexts.get(r):this._defaultContext;(0,t.assert)(a,`Unknown context id:${r}, _defaultContext: ${this._defaultContext}`);const l=this._connection.createSession(e.sessionId),c=i?this._ffPages.get(i):null,u=new s.FFPage(l,a,c);this._ffPages.set(n,u)}_onDownloadCreated(e){const n=this._ffPages.get(e.pageTargetId);if((0,t.assert)(n),!n)return;let r=n._initializedPage;r||(n._markAsError(new Error("Starting new page download")),n._opener&&(r=n._opener._initializedPage)),r&&this._downloadCreated(r,e.uuid,e.url,e.suggestedFileName)}_onDownloadFinished(e){const t=e.canceled?"canceled":e.error;this._downloadFinished(e.uuid,t)}_onVideoRecordingFinished(e){var t;null===(t=this._takeVideo(e.screencastId))||void 0===t||t.reportFinished()}_onDisconnect(){for(const t of this._idToVideo.values())t.artifact.reportFinished(e.kBrowserClosedError);this._idToVideo.clear(),this._didClose()}}Xv.FFBrowser=l;class c extends r.BrowserContext{constructor(e,t,n){super(e,n,t)}async _initialize(){(0,t.assert)(!this._ffPages().length);const e=this._browserContextId,n=[super._initialize()];if(n.push(this._browser._connection.send("Browser.setDownloadOptions",{browserContextId:e,downloadOptions:{behavior:this._options.acceptDownloads?"saveToDisk":"cancel",downloadsDir:this._browser.options.downloadsPath}})),this._options.viewport){const t={viewportSize:{width:this._options.viewport.width,height:this._options.viewport.height},deviceScaleFactor:this._options.deviceScaleFactor||1};n.push(this._browser._connection.send("Browser.setDefaultViewport",{browserContextId:e,viewport:t}))}this._options.hasTouch&&n.push(this._browser._connection.send("Browser.setTouchOverride",{browserContextId:e,hasTouch:!0})),this._options.userAgent&&n.push(this._browser._connection.send("Browser.setUserAgentOverride",{browserContextId:e,userAgent:this._options.userAgent})),this._options.bypassCSP&&n.push(this._browser._connection.send("Browser.setBypassCSP",{browserContextId:e,bypassCSP:!0})),this._options.ignoreHTTPSErrors&&n.push(this._browser._connection.send("Browser.setIgnoreHTTPSErrors",{browserContextId:e,ignoreHTTPSErrors:!0})),!1===this._options.javaScriptEnabled&&n.push(this._browser._connection.send("Browser.setJavaScriptDisabled",{browserContextId:e,javaScriptDisabled:!0})),this._options.locale&&n.push(this._browser._connection.send("Browser.setLocaleOverride",{browserContextId:e,locale:this._options.locale})),this._options.timezoneId&&n.push(this._browser._connection.send("Browser.setTimezoneOverride",{browserContextId:e,timezoneId:this._options.timezoneId})),this._options.permissions&&n.push(this.grantPermissions(this._options.permissions)),(this._options.extraHTTPHeaders||this._options.locale)&&n.push(this.setExtraHTTPHeaders(this._options.extraHTTPHeaders||[])),this._options.httpCredentials&&n.push(this.setHTTPCredentials(this._options.httpCredentials)),this._options.geolocation&&n.push(this.setGeolocation(this._options.geolocation)),this._options.offline&&n.push(this.setOffline(this._options.offline)),n.push(this._browser._connection.send("Browser.setColorScheme",{browserContextId:e,colorScheme:void 0!==this._options.colorScheme?this._options.colorScheme:"light"})),n.push(this._browser._connection.send("Browser.setReducedMotion",{browserContextId:e,reducedMotion:void 0!==this._options.reducedMotion?this._options.reducedMotion:"no-preference"})),n.push(this._browser._connection.send("Browser.setForcedColors",{browserContextId:e,forcedColors:void 0!==this._options.forcedColors?this._options.forcedColors:"none"})),this._options.recordVideo&&n.push(this._ensureVideosPath().then((()=>this._browser._connection.send("Browser.setVideoRecordingOptions",{options:{...this._options.recordVideo.size,dir:this._options.recordVideo.dir},browserContextId:this._browserContextId})))),this._options.proxy&&n.push(this._browser._connection.send("Browser.setContextProxy",{browserContextId:this._browserContextId,...u(this._options.proxy)})),await Promise.all(n)}_ffPages(){return Array.from(this._browser._ffPages.values()).filter((e=>e._browserContext===this))}pages(){return this._ffPages().map((e=>e._initializedPage)).filter((e=>!!e))}async newPageDelegate(){(0,r.assertBrowserContextIsNotOwned)(this);const{targetId:e}=await this._browser._connection.send("Browser.newPage",{browserContextId:this._browserContextId}).catch((e=>{if(e.message.includes("Failed to override timezone"))throw new Error(`Invalid timezone ID: ${this._options.timezoneId}`);throw e}));return this._browser._ffPages.get(e)}async doGetCookies(e){const{cookies:t}=await this._browser._connection.send("Browser.getCookies",{browserContextId:this._browserContextId});return i.filterCookies(t.map((e=>{const t={...e};return delete t.size,delete t.session,t})),e)}async addCookies(e){const t=i.rewriteCookies(e).map((e=>({...e,expires:e.expires&&-1!==e.expires?e.expires:void 0})));await this._browser._connection.send("Browser.setCookies",{browserContextId:this._browserContextId,cookies:t})}async clearCookies(){await this._browser._connection.send("Browser.clearCookies",{browserContextId:this._browserContextId})}async doGrantPermissions(e,t){const n=new Map([["geolocation","geo"],["persistent-storage","persistent-storage"],["push","push"],["notifications","desktop-notification"]]),r=t.map((e=>{const t=n.get(e);if(!t)throw new Error("Unknown permission: "+e);return t}));await this._browser._connection.send("Browser.grantPermissions",{origin:e,browserContextId:this._browserContextId,permissions:r})}async doClearPermissions(){await this._browser._connection.send("Browser.resetPermissions",{browserContextId:this._browserContextId})}async setGeolocation(e){(0,r.verifyGeolocation)(e),this._options.geolocation=e,await this._browser._connection.send("Browser.setGeolocationOverride",{browserContextId:this._browserContextId,geolocation:e||null})}async setExtraHTTPHeaders(e){this._options.extraHTTPHeaders=e;let t=this._options.extraHTTPHeaders;this._options.locale&&(t=i.mergeHeaders([t,i.singleHeader("Accept-Language",this._options.locale)])),await this._browser._connection.send("Browser.setExtraHTTPHeaders",{browserContextId:this._browserContextId,headers:t})}async setOffline(e){this._options.offline=e,await this._browser._connection.send("Browser.setOnlineOverride",{browserContextId:this._browserContextId,override:e?"offline":"online"})}async doSetHTTPCredentials(e){this._options.httpCredentials=e,await this._browser._connection.send("Browser.setHTTPCredentials",{browserContextId:this._browserContextId,credentials:e||null})}async doAddInitScript(e){await this._browser._connection.send("Browser.setInitScripts",{browserContextId:this._browserContextId,scripts:this.initScripts.map((e=>({script:e})))})}async doRemoveInitScripts(){await this._browser._connection.send("Browser.setInitScripts",{browserContextId:this._browserContextId,scripts:[]})}async doExposeBinding(e){await this._browser._connection.send("Browser.addBinding",{browserContextId:this._browserContextId,name:e.name,script:e.source})}async doRemoveExposedBindings(){}async doUpdateRequestInterception(){await this._browser._connection.send("Browser.setRequestInterception",{browserContextId:this._browserContextId,enabled:!!this._requestInterceptor})}onClosePersistent(){}async doClose(){(0,t.assert)(this._browserContextId),await this._browser._connection.send("Browser.removeBrowserContext",{browserContextId:this._browserContextId}),this._browser._contexts.delete(this._browserContextId)}async cancelDownload(e){await this._browser._connection.send("Browser.cancelDownload",{uuid:e})}}function u(e){const t=new URL(e.server);let n=parseInt(t.port,10),r="http";return"socks5:"===t.protocol?r="socks":"socks4:"===t.protocol?r="socks4":"https:"===t.protocol&&(r="https"),""===t.port&&("http:"===t.protocol?n=80:"https:"===t.protocol&&(n=443)),{type:r,bypass:e.bypass?e.bypass.split(",").map((e=>e.trim())):[],host:t.hostname,port:n,username:e.username,password:e.password}}return Xv.FFBrowserContext=c,Xv}(),i=Qv,o=Uv(),s=$l,a=Ci;function l(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}class u extends o.BrowserType{constructor(e){super("firefox",e)}_connectToTransport(e,t){return r.FFBrowser.connect(e,t)}_rewriteStartupError(e){return e.message.includes("no DISPLAY environment variable specified")?(0,s.rewriteErrorMessage)(e,"\n"+(0,a.wrapInASCIIBox)(o.kNoXServerRunningError,1)):e}_amendEnvironment(t,r,i,o){if(!n.default.isAbsolute(e.homedir()))throw new Error(`Cannot launch Firefox with relative home directory. Did you set ${"win32"===e.platform()?"USERPROFILE":"HOME"} to a relative path?`);return"linux"===e.platform()?{...t,LD_LIBRARY_PATH:`${n.default.dirname(i)}:${process.env.LD_LIBRARY_PATH}`}:t}_attemptToGracefullyCloseBrowser(e){const t={method:"Browser.close",params:{},id:i.kBrowserCloseMessageId};e.send(t)}_defaultArgs(e,r,i){const{args:o=[],headless:s}=e;if(o.find((e=>e.startsWith("-profile")||e.startsWith("--profile"))))throw new Error("Pass userDataDir parameter to `browserType.launchPersistentContext(userDataDir, ...)` instead of specifying --profile argument");if(o.find((e=>e.startsWith("-juggler"))))throw new Error("Use the port parameter instead of -juggler argument");const a=r?void 0:e.firefoxUserPrefs;if(a){const e=[];for(const[t,n]of Object.entries(a))e.push(`user_pref(${JSON.stringify(t)}, ${JSON.stringify(n)});`);t.default.writeFileSync(n.default.join(i,"user.js"),e.join("\n"))}const l=["-no-remote"];return s?l.push("-headless"):(l.push("-wait-for-browser"),l.push("-foreground")),l.push("-profile",i),l.push("-juggler-pipe"),l.push(...o),r?l.push("about:blank"):l.push("-silent"),l}}return Yv.Firefox=u,Yv}var Fb={};Object.defineProperty(Fb,"__esModule",{value:!0}),Fb.Selectors=void 0;var Nb=fd,Rb=Ci;Fb.Selectors=class{constructor(){this._builtinEngines=void 0,this._builtinEnginesInMainWorld=void 0,this._engines=void 0,this.guid=`selectors@${(0,Rb.createGuid)()}`,this._builtinEngines=new Set(["css","css:light","xpath","xpath:light","_react","_vue","text","text:light","id","id:light","data-testid","data-testid:light","data-test-id","data-test-id:light","data-test","data-test:light","nth","visible","control","has"]),this._builtinEnginesInMainWorld=new Set(["_react","_vue"]),this._engines=new Map}async register(e,t,n=!1){if(!e.match(/^[a-zA-Z_0-9-]+$/))throw new Error("Selector engine name may only contain [a-zA-Z0-9_] characters");if(this._builtinEngines.has(e)||"zs"===e||"zs:light"===e)throw new Error(`"${e}" is a predefined selector engine`);if(this._engines.has(e))throw new Error(`"${e}" selector engine has been already registered`);this._engines.set(e,{source:t,contentScript:n})}unregisterAll(){this._engines.clear()}async query(e,t,n){const r=await e._context(t.world),i=await r.injectedScript(),o=await i.evaluateHandle(((e,{parsed:t,scope:n,strict:r})=>e.querySelector(t,n||document,r)),{parsed:t.parsed,scope:n,strict:t.strict}),s=o.asElement();if(!s)return o.dispose(),null;const a=await e._mainContext();return this._adoptIfNeeded(s,a)}async _queryArrayInMainWorld(e,t,n){const r=await e._mainContext(),i=await r.injectedScript();return await i.evaluateHandle(((e,{parsed:t,scope:n})=>e.querySelectorAll(t,n||document)),{parsed:t.parsed,scope:n})}async _queryCount(e,t,n){const r=await e._context(t.world),i=await r.injectedScript();return await i.evaluate(((e,{parsed:t,scope:n})=>e.querySelectorAll(t,n||document).length),{parsed:t.parsed,scope:n})}async _queryAll(e,t,n,r){const i="string"==typeof t?e._page.parseSelector(t):t,o=await e._context(i.world),s=await o.injectedScript(),a=await s.evaluateHandle(((e,{parsed:t,scope:n})=>e.querySelectorAll(t,n||document)),{parsed:i.parsed,scope:n}),l=await a.getProperties();a.dispose();const c=r?await e._mainContext():o,u=[];for(const e of l.values()){const t=e.asElement();t?u.push(this._adoptIfNeeded(t,c)):e.dispose()}return Promise.all(u)}async _adoptIfNeeded(e,t){if(e._context===t)return e;const n=e._page._delegate.adoptElementHandle(e,t);return e.dispose(),n}parseSelector(e,t){(0,Rb.experimentalFeaturesEnabled)()&&this._builtinEngines.add("role");const n="string"==typeof e?(0,Nb.parseSelector)(e):e;let r=!1;for(const e of(0,Nb.allEngineNames)(n)){const t=this._engines.get(e);if(!t&&!this._builtinEngines.has(e))throw new Nb.InvalidSelectorError(`Unknown engine "${e}" while parsing selector ${(0,Nb.stringifySelector)(n)}`);t&&!t.contentScript&&(r=!0),this._builtinEnginesInMainWorld.has(e)&&(r=!0)}return{parsed:n,world:r?"main":"utility",strict:t}}};var jb={},Db={},Lb={};Object.defineProperty(Lb,"__esModule",{value:!0}),Lb.WKSession=Lb.WKConnection=void 0,Lb.createProtocolError=Gb,Lb.kPageProxyMessageReceived=Lb.kBrowserCloseMessageId=void 0;var Bb=M.default,Hb=Ci,qb=$l,Ub=Ka,Wb=su,$b=Al,zb=ku;Lb.kBrowserCloseMessageId=-9999;Lb.kPageProxyMessageReceived="kPageProxyMessageReceived";Lb.WKConnection=class{constructor(e,t,n,r){this._transport=void 0,this._onDisconnect=void 0,this._protocolLogger=void 0,this._browserLogsCollector=void 0,this._lastId=0,this._closed=!1,this.browserSession=void 0,this._transport=e,this._transport.onmessage=this._dispatchMessage.bind(this),this._transport.onclose=this._onClose.bind(this),this._onDisconnect=t,this._protocolLogger=n,this._browserLogsCollector=r,this.browserSession=new Vb(this,"",$b.kBrowserClosedError,(e=>{this.rawSend(e)}))}nextMessageId(){return++this._lastId}rawSend(e){this._protocolLogger("send",e),this._transport.send(e)}_dispatchMessage(e){if(this._protocolLogger("receive",e),-9999!==e.id)if(e.pageProxyId){const t={message:e,pageProxyId:e.pageProxyId};this.browserSession.dispatchMessage({method:"kPageProxyMessageReceived",params:t})}else this.browserSession.dispatchMessage(e)}_onClose(){this._closed=!0,this._transport.onmessage=void 0,this._transport.onclose=void 0,this.browserSession.dispose(!0),this._onDisconnect()}isClosed(){return this._closed}close(){this._closed||this._transport.close()}};class Vb extends Bb.EventEmitter{constructor(e,t,n,r){super(),this.connection=void 0,this.errorText=void 0,this.sessionId=void 0,this._disposed=!1,this._rawSend=void 0,this._callbacks=new Map,this._crashed=!1,this.on=void 0,this.addListener=void 0,this.off=void 0,this.removeListener=void 0,this.once=void 0,this.setMaxListeners(0),this.connection=e,this.sessionId=t,this._rawSend=r,this.errorText=n,this.on=super.on,this.off=super.removeListener,this.addListener=super.addListener,this.removeListener=super.removeListener,this.once=super.once}async send(e,t){if(this._crashed)throw new zb.ProtocolError(!0,"Target crashed");if(this._disposed)throw new zb.ProtocolError(!0,"Target closed");const n=this.connection.nextMessageId(),r={id:n,method:e,params:t};return this._rawSend(r),new Promise(((t,r)=>{this._callbacks.set(n,{resolve:t,reject:r,error:new zb.ProtocolError(!1),method:e})}))}sendMayFail(e,t){return this.send(e,t).catch((e=>Ub.debugLogger.log("error",e)))}markAsCrashed(){this._crashed=!0}isDisposed(){return this._disposed}dispose(e){e&&(this.errorText="Browser closed."+Wb.helper.formatBrowserLogs(this.connection._browserLogsCollector.recentLogs()));for(const e of this._callbacks.values())e.error.sessionClosed=!0,e.reject((0,qb.rewriteErrorMessage)(e.error,this.errorText));this._callbacks.clear(),this._disposed=!0}dispatchMessage(e){if(e.id&&this._callbacks.has(e.id)){const t=this._callbacks.get(e.id);this._callbacks.delete(e.id),e.error?t.reject(Gb(t.error,t.method,e.error)):t.resolve(e.result)}else e.id&&!e.error?(0,Hb.assert)(this.isDisposed()):Promise.resolve().then((()=>this.emit(e.method,e.params)))}}function Gb(e,t,n){let r=`Protocol error (${t}): ${n.message}`;return"data"in n&&(r+=` ${JSON.stringify(n.data)}`),(0,qb.rewriteErrorMessage)(e,r)}Lb.WKSession=Vb;var Kb={},Jb={},Yb={exports:{}},Xb={exports:{}};let Qb=N.default,Zb=B.default,ey=Xb.exports=function(){Zb.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};Qb.inherits(ey,Zb),ey.prototype.read=function(e,t){this._reads.push({length:Math.abs(e),allowLess:e<0,func:t}),process.nextTick(function(){this._process(),this._paused&&this._reads&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}.bind(this))},ey.prototype.write=function(e,t){if(!this.writable)return this.emit("error",new Error("Stream not writable")),!1;let n;return n=Buffer.isBuffer(e)?e:Buffer.from(e,t||this._encoding),this._buffers.push(n),this._buffered+=n.length,this._process(),this._reads&&0===this._reads.length&&(this._paused=!0),this.writable&&!this._paused},ey.prototype.end=function(e,t){e&&this.write(e,t),this.writable=!1,this._buffers&&(0===this._buffers.length?this._end():(this._buffers.push(null),this._process()))},ey.prototype.destroySoon=ey.prototype.end,ey.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("Unexpected end of input")),this.destroy()},ey.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},ey.prototype._processReadAllowingLess=function(e){this._reads.shift();let t=this._buffers[0];t.length>e.length?(this._buffered-=e.length,this._buffers[0]=t.slice(e.length),e.func.call(this,t.slice(0,e.length))):(this._buffered-=t.length,this._buffers.shift(),e.func.call(this,t))},ey.prototype._processRead=function(e){this._reads.shift();let t=0,n=0,r=Buffer.alloc(e.length);for(;t<e.length;){let i=this._buffers[n++],o=Math.min(i.length,e.length-t);i.copy(r,t,0,o),t+=o,o!==i.length&&(this._buffers[--n]=i.slice(o))}n>0&&this._buffers.splice(0,n),this._buffered-=e.length,e.func.call(this,r)},ey.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){let e=this._reads[0];if(e.allowLess)this._processReadAllowingLess(e);else{if(!(this._buffered>=e.length))break;this._processRead(e)}}this._buffers&&!this.writable&&this._end()}catch(e){this.emit("error",e)}};var ty={exports:{}},ny={exports:{}},ry={};let iy=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];ry.getImagePasses=function(e,t){let n=[],r=e%8,i=t%8,o=(e-r)/8,s=(t-i)/8;for(let e=0;e<iy.length;e++){let t=iy[e],a=o*t.x.length,l=s*t.y.length;for(let e=0;e<t.x.length&&t.x[e]<r;e++)a++;for(let e=0;e<t.y.length&&t.y[e]<i;e++)l++;a>0&&l>0&&n.push({width:a,height:l,index:e})}return n},ry.getInterlaceIterator=function(e){return function(t,n,r){let i=t%iy[r].x.length,o=(t-i)/iy[r].x.length*8+iy[r].x[i],s=n%iy[r].y.length;return 4*o+((n-s)/iy[r].y.length*8+iy[r].y[s])*e*4}};var oy=function(e,t,n){let r=e+t-n,i=Math.abs(r-e),o=Math.abs(r-t),s=Math.abs(r-n);return i<=o&&i<=s?e:o<=s?t:n};let sy=ry,ay=oy;function ly(e,t,n){let r=e*t;return 8!==n&&(r=Math.ceil(r/(8/n))),r}let cy=ny.exports=function(e,t){let n=e.width,r=e.height,i=e.interlace,o=e.bpp,s=e.depth;if(this.read=t.read,this.write=t.write,this.complete=t.complete,this._imageIndex=0,this._images=[],i){let e=sy.getImagePasses(n,r);for(let t=0;t<e.length;t++)this._images.push({byteWidth:ly(e[t].width,o,s),height:e[t].height,lineIndex:0})}else this._images.push({byteWidth:ly(n,o,s),height:r,lineIndex:0});this._xComparison=8===s?o:16===s?2*o:1};cy.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},cy.prototype._unFilterType1=function(e,t,n){let r=this._xComparison,i=r-1;for(let o=0;o<n;o++){let n=e[1+o],s=o>i?t[o-r]:0;t[o]=n+s}},cy.prototype._unFilterType2=function(e,t,n){let r=this._lastLine;for(let i=0;i<n;i++){let n=e[1+i],o=r?r[i]:0;t[i]=n+o}},cy.prototype._unFilterType3=function(e,t,n){let r=this._xComparison,i=r-1,o=this._lastLine;for(let s=0;s<n;s++){let n=e[1+s],a=o?o[s]:0,l=s>i?t[s-r]:0,c=Math.floor((l+a)/2);t[s]=n+c}},cy.prototype._unFilterType4=function(e,t,n){let r=this._xComparison,i=r-1,o=this._lastLine;for(let s=0;s<n;s++){let n=e[1+s],a=o?o[s]:0,l=s>i?t[s-r]:0,c=s>i&&o?o[s-r]:0,u=ay(l,a,c);t[s]=n+u}},cy.prototype._reverseFilterLine=function(e){let t,n=e[0],r=this._images[this._imageIndex],i=r.byteWidth;if(0===n)t=e.slice(1,i+1);else switch(t=Buffer.alloc(i),n){case 1:this._unFilterType1(e,t,i);break;case 2:this._unFilterType2(e,t,i);break;case 3:this._unFilterType3(e,t,i);break;case 4:this._unFilterType4(e,t,i);break;default:throw new Error("Unrecognised filter type - "+n)}this.write(t),r.lineIndex++,r.lineIndex>=r.height?(this._lastLine=null,this._imageIndex++,r=this._images[this._imageIndex]):this._lastLine=t,r?this.read(r.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())};let uy=N.default,dy=Xb.exports,hy=ny.exports,py=ty.exports=function(e){dy.call(this);let t=[],n=this;this._filter=new hy(e,{read:this.read.bind(this),write:function(e){t.push(e)},complete:function(){n.emit("complete",Buffer.concat(t))}}),this._filter.start()};uy.inherits(py,dy);var fy={exports:{}},my={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5},gy={exports:{}};let _y=[];!function(){for(let e=0;e<256;e++){let t=e;for(let e=0;e<8;e++)1&t?t=3988292384^t>>>1:t>>>=1;_y[e]=t}}();let wy=gy.exports=function(){this._crc=-1};wy.prototype.write=function(e){for(let t=0;t<e.length;t++)this._crc=_y[255&(this._crc^e[t])]^this._crc>>>8;return!0},wy.prototype.crc32=function(){return-1^this._crc},wy.crc32=function(e){let t=-1;for(let n=0;n<e.length;n++)t=_y[255&(t^e[n])]^t>>>8;return-1^t};let vy=my,by=gy.exports,yy=fy.exports=function(e,t){this._options=e,e.checkCRC=!1!==e.checkCRC,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[vy.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[vy.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[vy.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[vy.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[vy.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[vy.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=t.read,this.error=t.error,this.metadata=t.metadata,this.gamma=t.gamma,this.transColor=t.transColor,this.palette=t.palette,this.parsed=t.parsed,this.inflateData=t.inflateData,this.finished=t.finished,this.simpleTransparency=t.simpleTransparency,this.headersFinished=t.headersFinished||function(){}};yy.prototype.start=function(){this.read(vy.PNG_SIGNATURE.length,this._parseSignature.bind(this))},yy.prototype._parseSignature=function(e){let t=vy.PNG_SIGNATURE;for(let n=0;n<t.length;n++)if(e[n]!==t[n])return void this.error(new Error("Invalid file signature"));this.read(8,this._parseChunkBegin.bind(this))},yy.prototype._parseChunkBegin=function(e){let t=e.readUInt32BE(0),n=e.readUInt32BE(4),r="";for(let t=4;t<8;t++)r+=String.fromCharCode(e[t]);let i=Boolean(32&e[4]);if(this._hasIHDR||n===vy.TYPE_IHDR){if(this._crc=new by,this._crc.write(Buffer.from(r)),this._chunks[n])return this._chunks[n](t);i?this.read(t+4,this._skipChunk.bind(this)):this.error(new Error("Unsupported critical chunk type "+r))}else this.error(new Error("Expected IHDR on beggining"))},yy.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},yy.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},yy.prototype._parseChunkEnd=function(e){let t=e.readInt32BE(0),n=this._crc.crc32();this._options.checkCRC&&n!==t?this.error(new Error("Crc error - "+t+" - "+n)):this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},yy.prototype._handleIHDR=function(e){this.read(e,this._parseIHDR.bind(this))},yy.prototype._parseIHDR=function(e){this._crc.write(e);let t=e.readUInt32BE(0),n=e.readUInt32BE(4),r=e[8],i=e[9],o=e[10],s=e[11],a=e[12];if(8!==r&&4!==r&&2!==r&&1!==r&&16!==r)return void this.error(new Error("Unsupported bit depth "+r));if(!(i in vy.COLORTYPE_TO_BPP_MAP))return void this.error(new Error("Unsupported color type"));if(0!==o)return void this.error(new Error("Unsupported compression method"));if(0!==s)return void this.error(new Error("Unsupported filter method"));if(0!==a&&1!==a)return void this.error(new Error("Unsupported interlace method"));this._colorType=i;let l=vy.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:t,height:n,depth:r,interlace:Boolean(a),palette:Boolean(i&vy.COLORTYPE_PALETTE),color:Boolean(i&vy.COLORTYPE_COLOR),alpha:Boolean(i&vy.COLORTYPE_ALPHA),bpp:l,colorType:i}),this._handleChunkEnd()},yy.prototype._handlePLTE=function(e){this.read(e,this._parsePLTE.bind(this))},yy.prototype._parsePLTE=function(e){this._crc.write(e);let t=Math.floor(e.length/3);for(let n=0;n<t;n++)this._palette.push([e[3*n],e[3*n+1],e[3*n+2],255]);this.palette(this._palette),this._handleChunkEnd()},yy.prototype._handleTRNS=function(e){this.simpleTransparency(),this.read(e,this._parseTRNS.bind(this))},yy.prototype._parseTRNS=function(e){if(this._crc.write(e),this._colorType===vy.COLORTYPE_PALETTE_COLOR){if(0===this._palette.length)return void this.error(new Error("Transparency chunk must be after palette"));if(e.length>this._palette.length)return void this.error(new Error("More transparent colors than palette size"));for(let t=0;t<e.length;t++)this._palette[t][3]=e[t];this.palette(this._palette)}this._colorType===vy.COLORTYPE_GRAYSCALE&&this.transColor([e.readUInt16BE(0)]),this._colorType===vy.COLORTYPE_COLOR&&this.transColor([e.readUInt16BE(0),e.readUInt16BE(2),e.readUInt16BE(4)]),this._handleChunkEnd()},yy.prototype._handleGAMA=function(e){this.read(e,this._parseGAMA.bind(this))},yy.prototype._parseGAMA=function(e){this._crc.write(e),this.gamma(e.readUInt32BE(0)/vy.GAMMA_DIVISION),this._handleChunkEnd()},yy.prototype._handleIDAT=function(e){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-e,this._parseIDAT.bind(this,e))},yy.prototype._parseIDAT=function(e,t){if(this._crc.write(t),this._colorType===vy.COLORTYPE_PALETTE_COLOR&&0===this._palette.length)throw new Error("Expected palette not found");this.inflateData(t);let n=e-t.length;n>0?this._handleIDAT(n):this._handleChunkEnd()},yy.prototype._handleIEND=function(e){this.read(e,this._parseIEND.bind(this))},yy.prototype._parseIEND=function(e){this._crc.write(e),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()};var Sy={};let xy=ry,ky=[function(){},function(e,t,n,r){if(r===t.length)throw new Error("Ran out of data");let i=t[r];e[n]=i,e[n+1]=i,e[n+2]=i,e[n+3]=255},function(e,t,n,r){if(r+1>=t.length)throw new Error("Ran out of data");let i=t[r];e[n]=i,e[n+1]=i,e[n+2]=i,e[n+3]=t[r+1]},function(e,t,n,r){if(r+2>=t.length)throw new Error("Ran out of data");e[n]=t[r],e[n+1]=t[r+1],e[n+2]=t[r+2],e[n+3]=255},function(e,t,n,r){if(r+3>=t.length)throw new Error("Ran out of data");e[n]=t[r],e[n+1]=t[r+1],e[n+2]=t[r+2],e[n+3]=t[r+3]}],Ey=[function(){},function(e,t,n,r){let i=t[0];e[n]=i,e[n+1]=i,e[n+2]=i,e[n+3]=r},function(e,t,n){let r=t[0];e[n]=r,e[n+1]=r,e[n+2]=r,e[n+3]=t[1]},function(e,t,n,r){e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=r},function(e,t,n){e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=t[3]}];function Cy(e,t,n,r,i,o){let s=e.width,a=e.height,l=e.index;for(let e=0;e<a;e++)for(let a=0;a<s;a++){let s=n(a,e,l);ky[r](t,i,s,o),o+=r}return o}function Ty(e,t,n,r,i,o){let s=e.width,a=e.height,l=e.index;for(let e=0;e<a;e++){for(let a=0;a<s;a++){let s=i.get(r),c=n(a,e,l);Ey[r](t,s,c,o)}i.resetAfterLine()}}Sy.dataToBitMap=function(e,t){let n,r,i=t.width,o=t.height,s=t.depth,a=t.bpp,l=t.interlace;8!==s&&(n=function(e,t){let n=[],r=0;function i(){if(r===e.length)throw new Error("Ran out of data");let i,o,s,a,l,c,u,d,h=e[r];switch(r++,t){default:throw new Error("unrecognised depth");case 16:u=e[r],r++,n.push((h<<8)+u);break;case 4:u=15&h,d=h>>4,n.push(d,u);break;case 2:l=3&h,c=h>>2&3,u=h>>4&3,d=h>>6&3,n.push(d,u,c,l);break;case 1:i=1&h,o=h>>1&1,s=h>>2&1,a=h>>3&1,l=h>>4&1,c=h>>5&1,u=h>>6&1,d=h>>7&1,n.push(d,u,c,l,a,s,o,i)}}return{get:function(e){for(;n.length<e;)i();let t=n.slice(0,e);return n=n.slice(e),t},resetAfterLine:function(){n.length=0},end:function(){if(r!==e.length)throw new Error("extra data found")}}}(e,s)),r=s<=8?Buffer.alloc(i*o*4):new Uint16Array(i*o*4);let c,u,d=Math.pow(2,s)-1,h=0;if(l)c=xy.getImagePasses(i,o),u=xy.getInterlaceIterator(i,o);else{let e=0;u=function(){let t=e;return e+=4,t},c=[{width:i,height:o}]}for(let t=0;t<c.length;t++)8===s?h=Cy(c[t],r,u,a,e,h):Ty(c[t],r,u,a,n,d);if(8===s){if(h!==e.length)throw new Error("extra data found")}else n.end();return r};var Py=function(e,t,n=!1){let r=t.depth,i=t.width,o=t.height,s=t.colorType,a=t.transColor,l=t.palette,c=e;return 3===s?function(e,t,n,r,i){let o=0;for(let s=0;s<r;s++)for(let r=0;r<n;r++){let n=i[e[o]];if(!n)throw new Error("index "+e[o]+" not in palette");for(let e=0;e<4;e++)t[o+e]=n[e];o+=4}}(e,c,i,o,l):(a&&function(e,t,n,r,i){let o=0;for(let s=0;s<r;s++)for(let r=0;r<n;r++){let n=!1;if(1===i.length?i[0]===e[o]&&(n=!0):i[0]===e[o]&&i[1]===e[o+1]&&i[2]===e[o+2]&&(n=!0),n)for(let e=0;e<4;e++)t[o+e]=0;o+=4}}(e,c,i,o,a),8===r||n||(16===r&&(c=Buffer.alloc(i*o*4)),function(e,t,n,r,i){let o=Math.pow(2,i)-1,s=0;for(let i=0;i<r;i++)for(let r=0;r<n;r++){for(let n=0;n<4;n++)t[s+n]=Math.floor(255*e[s+n]/o+.5);s+=4}}(e,c,i,o,r))),c};let Oy=N.default,Ay=$.default,Iy=Xb.exports,My=ty.exports,Fy=fy.exports,Ny=Sy,Ry=Py,jy=Yb.exports=function(e){Iy.call(this),this._parser=new Fy(e,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=e,this.writable=!0,this._parser.start()};Oy.inherits(jy,Iy),jy.prototype._handleError=function(e){this.emit("error",e),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",(function(){}))),this.errord=!0},jy.prototype._inflateData=function(e){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=Ay.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{let e=(1+(this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3))*this._bitmapInfo.height,t=Math.max(e,Ay.Z_MIN_CHUNK);this._inflate=Ay.createInflate({chunkSize:t});let n=e,r=this.emit.bind(this,"error");this._inflate.on("error",(function(e){n&&r(e)})),this._filter.on("complete",this._complete.bind(this));let i=this._filter.write.bind(this._filter);this._inflate.on("data",(function(e){n&&(e.length>n&&(e=e.slice(0,n)),n-=e.length,i(e))})),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(e)},jy.prototype._handleMetaData=function(e){this._metaData=e,this._bitmapInfo=Object.create(e),this._filter=new My(this._bitmapInfo)},jy.prototype._handleTransColor=function(e){this._bitmapInfo.transColor=e},jy.prototype._handlePalette=function(e){this._bitmapInfo.palette=e},jy.prototype._simpleTransparency=function(){this._metaData.alpha=!0},jy.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},jy.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"))},jy.prototype._complete=function(e){if(this.errord)return;let t;try{let n=Ny.dataToBitMap(e,this._bitmapInfo);t=Ry(n,this._bitmapInfo,this._options.skipRescale),n=null}catch(e){return void this._handleError(e)}this.emit("parsed",t)};var Dy={exports:{}},Ly={exports:{}};let By=my;let Hy=oy;let qy={0:function(e,t,n,r,i){for(let o=0;o<n;o++)r[i+o]=e[t+o]},1:function(e,t,n,r,i,o){for(let s=0;s<n;s++){let n=s>=o?e[t+s-o]:0,a=e[t+s]-n;r[i+s]=a}},2:function(e,t,n,r,i){for(let o=0;o<n;o++){let s=t>0?e[t+o-n]:0,a=e[t+o]-s;r[i+o]=a}},3:function(e,t,n,r,i,o){for(let s=0;s<n;s++){let a=s>=o?e[t+s-o]:0,l=t>0?e[t+s-n]:0,c=e[t+s]-(a+l>>1);r[i+s]=c}},4:function(e,t,n,r,i,o){for(let s=0;s<n;s++){let a=s>=o?e[t+s-o]:0,l=t>0?e[t+s-n]:0,c=t>0&&s>=o?e[t+s-(n+o)]:0,u=e[t+s]-Hy(a,l,c);r[i+s]=u}}},Uy={0:function(e,t,n){let r=0,i=t+n;for(let n=t;n<i;n++)r+=Math.abs(e[n]);return r},1:function(e,t,n,r){let i=0;for(let o=0;o<n;o++){let n=o>=r?e[t+o-r]:0,s=e[t+o]-n;i+=Math.abs(s)}return i},2:function(e,t,n){let r=0,i=t+n;for(let o=t;o<i;o++){let i=t>0?e[o-n]:0,s=e[o]-i;r+=Math.abs(s)}return r},3:function(e,t,n,r){let i=0;for(let o=0;o<n;o++){let s=o>=r?e[t+o-r]:0,a=t>0?e[t+o-n]:0,l=e[t+o]-(s+a>>1);i+=Math.abs(l)}return i},4:function(e,t,n,r){let i=0;for(let o=0;o<n;o++){let s=o>=r?e[t+o-r]:0,a=t>0?e[t+o-n]:0,l=t>0&&o>=r?e[t+o-(n+r)]:0,c=e[t+o]-Hy(s,a,l);i+=Math.abs(c)}return i}};let Wy=my,$y=gy.exports,zy=function(e,t,n,r){let i=-1!==[By.COLORTYPE_COLOR_ALPHA,By.COLORTYPE_ALPHA].indexOf(r.colorType);if(r.colorType===r.inputColorType){let t=function(){let e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256!==new Int16Array(e)[0]}();if(8===r.bitDepth||16===r.bitDepth&&t)return e}let o=16!==r.bitDepth?e:new Uint16Array(e.buffer),s=255,a=By.COLORTYPE_TO_BPP_MAP[r.inputColorType];4!==a||r.inputHasAlpha||(a=3);let l=By.COLORTYPE_TO_BPP_MAP[r.colorType];16===r.bitDepth&&(s=65535,l*=2);let c=Buffer.alloc(t*n*l),u=0,d=0,h=r.bgColor||{};function p(){let e,t,n,a=s;switch(r.inputColorType){case By.COLORTYPE_COLOR_ALPHA:a=o[u+3],e=o[u],t=o[u+1],n=o[u+2];break;case By.COLORTYPE_COLOR:e=o[u],t=o[u+1],n=o[u+2];break;case By.COLORTYPE_ALPHA:a=o[u+1],e=o[u],t=e,n=e;break;case By.COLORTYPE_GRAYSCALE:e=o[u],t=e,n=e;break;default:throw new Error("input color type:"+r.inputColorType+" is not supported at present")}return r.inputHasAlpha&&(i||(a/=s,e=Math.min(Math.max(Math.round((1-a)*h.red+a*e),0),s),t=Math.min(Math.max(Math.round((1-a)*h.green+a*t),0),s),n=Math.min(Math.max(Math.round((1-a)*h.blue+a*n),0),s))),{red:e,green:t,blue:n,alpha:a}}void 0===h.red&&(h.red=s),void 0===h.green&&(h.green=s),void 0===h.blue&&(h.blue=s);for(let e=0;e<n;e++)for(let e=0;e<t;e++){let e=p();switch(r.colorType){case By.COLORTYPE_COLOR_ALPHA:case By.COLORTYPE_COLOR:8===r.bitDepth?(c[d]=e.red,c[d+1]=e.green,c[d+2]=e.blue,i&&(c[d+3]=e.alpha)):(c.writeUInt16BE(e.red,d),c.writeUInt16BE(e.green,d+2),c.writeUInt16BE(e.blue,d+4),i&&c.writeUInt16BE(e.alpha,d+6));break;case By.COLORTYPE_ALPHA:case By.COLORTYPE_GRAYSCALE:{let t=(e.red+e.green+e.blue)/3;8===r.bitDepth?(c[d]=t,i&&(c[d+1]=e.alpha)):(c.writeUInt16BE(t,d),i&&c.writeUInt16BE(e.alpha,d+2));break}default:throw new Error("unrecognised color Type "+r.colorType)}u+=a,d+=l}return c},Vy=function(e,t,n,r,i){let o;if("filterType"in r&&-1!==r.filterType){if("number"!=typeof r.filterType)throw new Error("unrecognised filter types");o=[r.filterType]}else o=[0,1,2,3,4];16===r.bitDepth&&(i*=2);let s=t*i,a=0,l=0,c=Buffer.alloc((s+1)*n),u=o[0];for(let t=0;t<n;t++){if(o.length>1){let t=1/0;for(let n=0;n<o.length;n++){let r=Uy[o[n]](e,l,s,i);r<t&&(u=o[n],t=r)}}c[a]=u,a++,qy[u](e,l,s,c,a,i),a+=s,l+=s}return c},Gy=$.default,Ky=Ly.exports=function(e){if(this._options=e,e.deflateChunkSize=e.deflateChunkSize||32768,e.deflateLevel=null!=e.deflateLevel?e.deflateLevel:9,e.deflateStrategy=null!=e.deflateStrategy?e.deflateStrategy:3,e.inputHasAlpha=null==e.inputHasAlpha||e.inputHasAlpha,e.deflateFactory=e.deflateFactory||Gy.createDeflate,e.bitDepth=e.bitDepth||8,e.colorType="number"==typeof e.colorType?e.colorType:Wy.COLORTYPE_COLOR_ALPHA,e.inputColorType="number"==typeof e.inputColorType?e.inputColorType:Wy.COLORTYPE_COLOR_ALPHA,-1===[Wy.COLORTYPE_GRAYSCALE,Wy.COLORTYPE_COLOR,Wy.COLORTYPE_COLOR_ALPHA,Wy.COLORTYPE_ALPHA].indexOf(e.colorType))throw new Error("option color type:"+e.colorType+" is not supported at present");if(-1===[Wy.COLORTYPE_GRAYSCALE,Wy.COLORTYPE_COLOR,Wy.COLORTYPE_COLOR_ALPHA,Wy.COLORTYPE_ALPHA].indexOf(e.inputColorType))throw new Error("option input color type:"+e.inputColorType+" is not supported at present");if(8!==e.bitDepth&&16!==e.bitDepth)throw new Error("option bit depth:"+e.bitDepth+" is not supported at present")};Ky.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},Ky.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},Ky.prototype.filterData=function(e,t,n){let r=zy(e,t,n,this._options),i=Wy.COLORTYPE_TO_BPP_MAP[this._options.colorType];return Vy(r,t,n,this._options,i)},Ky.prototype._packChunk=function(e,t){let n=t?t.length:0,r=Buffer.alloc(n+12);return r.writeUInt32BE(n,0),r.writeUInt32BE(e,4),t&&t.copy(r,8),r.writeInt32BE($y.crc32(r.slice(4,r.length-4)),r.length-4),r},Ky.prototype.packGAMA=function(e){let t=Buffer.alloc(4);return t.writeUInt32BE(Math.floor(e*Wy.GAMMA_DIVISION),0),this._packChunk(Wy.TYPE_gAMA,t)},Ky.prototype.packIHDR=function(e,t){let n=Buffer.alloc(13);return n.writeUInt32BE(e,0),n.writeUInt32BE(t,4),n[8]=this._options.bitDepth,n[9]=this._options.colorType,n[10]=0,n[11]=0,n[12]=0,this._packChunk(Wy.TYPE_IHDR,n)},Ky.prototype.packIDAT=function(e){return this._packChunk(Wy.TYPE_IDAT,e)},Ky.prototype.packIEND=function(){return this._packChunk(Wy.TYPE_IEND,null)};let Jy=N.default,Yy=B.default,Xy=my,Qy=Ly.exports,Zy=Dy.exports=function(e){Yy.call(this);let t=e||{};this._packer=new Qy(t),this._deflate=this._packer.createDeflate(),this.readable=!0};Jy.inherits(Zy,Yy),Zy.prototype.pack=function(e,t,n,r){this.emit("data",Buffer.from(Xy.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(t,n)),r&&this.emit("data",this._packer.packGAMA(r));let i=this._packer.filterData(e,t,n);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(e){this.emit("data",this._packer.packIDAT(e))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(i)};var eS={},tS={exports:{}};!function(e,t){let n=F.default.ok,r=$.default,i=N.default,o=W.default.kMaxLength;function s(e){if(!(this instanceof s))return new s(e);e&&e.chunkSize<r.Z_MIN_CHUNK&&(e.chunkSize=r.Z_MIN_CHUNK),r.Inflate.call(this,e),this._offset=void 0===this._offset?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,e&&null!=e.maxLength&&(this._maxLength=e.maxLength)}function a(e,t){t&&process.nextTick(t),e._handle&&(e._handle.close(),e._handle=null)}function l(e,t){return function(e,t){if("string"==typeof t&&(t=Buffer.from(t)),!(t instanceof Buffer))throw new TypeError("Not a string or buffer");let n=e._finishFlushFlag;return null==n&&(n=r.Z_FINISH),e._processChunk(t,n)}(new s(t),e)}s.prototype._processChunk=function(e,t,i){if("function"==typeof i)return r.Inflate._processChunk.call(this,e,t,i);let s,l,c=this,u=e&&e.length,d=this._chunkSize-this._offset,h=this._maxLength,p=0,f=[],m=0;function g(e,t){if(c._hadError)return;let r=d-t;if(n(r>=0,"have should not go down"),r>0){let e=c._buffer.slice(c._offset,c._offset+r);if(c._offset+=r,e.length>h&&(e=e.slice(0,h)),f.push(e),m+=e.length,h-=e.length,0===h)return!1}return(0===t||c._offset>=c._chunkSize)&&(d=c._chunkSize,c._offset=0,c._buffer=Buffer.allocUnsafe(c._chunkSize)),0===t&&(p+=u-e,u=e,!0)}this.on("error",(function(e){s=e})),n(this._handle,"zlib binding closed");do{l=this._handle.writeSync(t,e,p,u,this._buffer,this._offset,d),l=l||this._writeState}while(!this._hadError&&g(l[0],l[1]));if(this._hadError)throw s;if(m>=o)throw a(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+o.toString(16)+" bytes");let _=Buffer.concat(f,m);return a(this),_},i.inherits(s,r.Inflate),e.exports=t=l,t.Inflate=s,t.createInflate=function(e){return new s(e)},t.inflateSync=l}(tS,tS.exports);var nS={exports:{}};let rS=nS.exports=function(e){this._buffer=e,this._reads=[]};rS.prototype.read=function(e,t){this._reads.push({length:Math.abs(e),allowLess:e<0,func:t})},rS.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){let e=this._reads[0];if(!this._buffer.length||!(this._buffer.length>=e.length||e.allowLess))break;{this._reads.shift();let t=this._buffer;this._buffer=t.slice(e.length),e.func.call(this,t.slice(0,e.length))}}if(this._reads.length>0)throw new Error("There are some read requests waitng on finished stream");if(this._buffer.length>0)throw new Error("unrecognised content at end of stream")};var iS={};let oS=nS.exports,sS=ny.exports;iS.process=function(e,t){let n=[],r=new oS(e);return new sS(t,{read:r.read.bind(r),write:function(e){n.push(e)},complete:function(){}}).start(),r.process(),Buffer.concat(n)};let aS=!0,lS=$.default,cS=tS.exports;lS.deflateSync||(aS=!1);let uS=nS.exports,dS=iS,hS=fy.exports,pS=Sy,fS=Py;let mS=!0,gS=$.default;gS.deflateSync||(mS=!1);let _S=my,wS=Ly.exports;let vS=function(e,t){if(!aS)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let n,r,i;let o=[];let s=new uS(e),a=new hS(t,{read:s.read.bind(s),error:function(e){n=e},metadata:function(e){r=e},gamma:function(e){i=e},palette:function(e){r.palette=e},transColor:function(e){r.transColor=e},inflateData:function(e){o.push(e)},simpleTransparency:function(){r.alpha=!0}});if(a.start(),s.process(),n)throw n;let l,c=Buffer.concat(o);if(o.length=0,r.interlace)l=lS.inflateSync(c);else{let e=(1+(r.width*r.bpp*r.depth+7>>3))*r.height;l=cS(c,{chunkSize:e,maxLength:e})}if(c=null,!l||!l.length)throw new Error("bad png - invalid inflate data response");let u=dS.process(l,r);c=null;let d=pS.dataToBitMap(u,r);u=null;let h=fS(d,r,t.skipRescale);return r.data=h,r.gamma=i||0,r},bS=function(e,t){if(!mS)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let n=new wS(t||{}),r=[];r.push(Buffer.from(_S.PNG_SIGNATURE)),r.push(n.packIHDR(e.width,e.height)),e.gamma&&r.push(n.packGAMA(e.gamma));let i=n.filterData(e.data,e.width,e.height),o=gS.deflateSync(i,n.getDeflateOptions());if(i=null,!o||!o.length)throw new Error("bad png - invalid compressed data response");return r.push(n.packIDAT(o)),r.push(n.packIEND()),Buffer.concat(r)};eS.read=function(e,t){return vS(e,t||{})},eS.write=function(e,t){return bS(e,t)};let yS=N.default,SS=B.default,xS=Yb.exports,kS=Dy.exports,ES=eS,CS=Jb.PNG=function(e){SS.call(this),e=e||{},this.width=0|e.width,this.height=0|e.height,this.data=this.width>0&&this.height>0?Buffer.alloc(4*this.width*this.height):null,e.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new xS(e),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(e){this.data=e,this.emit("parsed",e)}.bind(this)),this._packer=new kS(e),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};yS.inherits(CS,SS),CS.sync=ES,CS.prototype.pack=function(){return this.data&&this.data.length?(process.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this):(this.emit("error","No data provided"),this)},CS.prototype.parse=function(e,t){if(t){let e,n;e=function(e){this.removeListener("error",n),this.data=e,t(null,this)}.bind(this),n=function(n){this.removeListener("parsed",e),t(n,null)}.bind(this),this.once("parsed",e),this.once("error",n)}return this.end(e),this},CS.prototype.write=function(e){return this._parser.write(e),!0},CS.prototype.end=function(e){this._parser.end(e)},CS.prototype._metadata=function(e){this.width=e.width,this.height=e.height,this.emit("metadata",e)},CS.prototype._gamma=function(e){this.gamma=e},CS.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},CS.bitblt=function(e,t,n,r,i,o,s,a){if(r|=0,i|=0,o|=0,s|=0,a|=0,(n|=0)>e.width||r>e.height||n+i>e.width||r+o>e.height)throw new Error("bitblt reading outside image");if(s>t.width||a>t.height||s+i>t.width||a+o>t.height)throw new Error("bitblt writing outside image");for(let l=0;l<o;l++)e.data.copy(t.data,(a+l)*t.width+s<<2,(r+l)*e.width+n<<2,(r+l)*e.width+n+i<<2)},CS.prototype.bitblt=function(e,t,n,r,i,o,s){return CS.bitblt(this,e,t,n,r,i,o,s),this},CS.adjustGamma=function(e){if(e.gamma){for(let t=0;t<e.height;t++)for(let n=0;n<e.width;n++){let r=e.width*t+n<<2;for(let t=0;t<3;t++){let n=e.data[r+t]/255;n=Math.pow(n,1/2.2/e.gamma),e.data[r+t]=Math.round(255*n)}}e.gamma=0}},CS.prototype.adjustGamma=function(){CS.adjustGamma(this)};var TS={};Object.defineProperty(TS,"__esModule",{value:!0}),TS.getAccessibilityTree=async function(e,t){const n=t?t._objectId:void 0,{axNode:r}=await e.send("Page.accessibilitySnapshot",{objectId:n}),i=new AS(r);return{tree:i,needle:t?i._findNeedle():null}};const PS=new Map(Object.entries({TextField:"textbox"})),OS=new Map(Object.entries({WebArea:"HTML content",Summary:"summary",DescriptionList:"description list",ImageMap:"image map",ListMarker:"list marker",Video:"video playback",Mark:"highlighted",contentinfo:"content information",Details:"details",DescriptionListDetail:"description",DescriptionListTerm:"term",alertdialog:"web alert dialog",dialog:"web dialog",status:"application status",tabpanel:"tab panel",application:"web application"}));class AS{constructor(e){this._payload=void 0,this._children=void 0,this._payload=e,this._children=[];for(const e of this._payload.children||[])this._children.push(new AS(e))}children(){return this._children}_findNeedle(){if(this._payload.found)return this;for(const e of this._children){const t=e._findNeedle();if(t)return t}return null}isControl(){switch(this._payload.role){case"button":case"checkbox":case"ColorWell":case"combobox":case"DisclosureTriangle":case"listbox":case"menu":case"menubar":case"menuitem":case"menuitemcheckbox":case"menuitemradio":case"radio":case"scrollbar":case"searchbox":case"slider":case"spinbutton":case"switch":case"tab":case"textbox":case"TextField":case"tree":return!0;default:return!1}}_isTextControl(){switch(this._payload.role){case"combobox":case"searchfield":case"textbox":case"TextField":return!0}return!1}_name(){return"text"===this._payload.role?this._payload.value||"":this._payload.name||""}isInteresting(e){const{role:t,focusable:n}=this._payload,r=this._name();return"ScrollArea"!==t&&("WebArea"===t||(!(!n&&"MenuListOption"!==t)||(!!this.isControl()||!e&&(this.isLeafNode()&&!!r))))}_hasRendundantTextChild(){if(1!==this._children.length)return!1;const e=this._children[0];return"text"===e._payload.role&&this._payload.name===e._payload.value}isLeafNode(){return!this._children.length||(!!this._isTextControl()||!!this._hasRendundantTextChild())}serialize(){const e={role:PS.get(this._payload.role)||this._payload.role,name:this._name()};if("description"in this._payload&&this._payload.description!==e.name&&(e.description=this._payload.description),"roledescription"in this._payload){const t=this._payload.roledescription;t!==this._payload.role&&OS.get(this._payload.role)!==t&&(e.roledescription=t)}"value"in this._payload&&"text"!==this._payload.role&&("string"==typeof this._payload.value?e.valueString=this._payload.value:"number"==typeof this._payload.value&&(e.valueNumber=this._payload.value)),"checked"in this._payload&&(e.checked="true"===this._payload.checked?"checked":"false"===this._payload.checked?"unchecked":"mixed"),"pressed"in this._payload&&(e.pressed="true"===this._payload.pressed?"pressed":"false"===this._payload.pressed?"released":"mixed");const t=["keyshortcuts","valuetext"];for(const n of t)n in this._payload&&(e[n]=this._payload[n]);const n=["disabled","expanded","focused","modal","multiline","multiselectable","readonly","required","selected"];for(const t of n){if("focused"===t&&("WebArea"===this._payload.role||"ScrollArea"===this._payload.role))continue;const n=this._payload[t];n&&(e[t]=n)}const r=["level","valuemax","valuemin"];for(const t of r)t in this._payload&&(e[t]=this._payload[t]);const i=["autocomplete","haspopup","invalid"];for(const t of i){const n=this._payload[t];n&&"false"!==n&&(e[t]=n)}const o=new Set(["ScrollArea","scrollbar","listbox","combobox","menu","tree","separator","slider","tablist","toolbar"]);return this._payload.orientation&&o.has(this._payload.role)&&(e.orientation=this._payload.orientation),e}}var IS={};Object.defineProperty(IS,"__esModule",{value:!0}),IS.WKExecutionContext=void 0;var MS=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=RS(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(Cu),FS=Pu,NS=ku;function RS(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(RS=function(e){return e?n:t})(e)}function jS(e){return MS.isJavaScriptErrorInEvaluate(e)||(0,NS.isSessionClosedError)(e)?e:new Error("Execution context was destroyed, most likely because of a navigation.")}IS.WKExecutionContext=class{constructor(e,t){this._session=void 0,this._contextId=void 0,this._session=e,this._contextId=t}async rawEvaluateJSON(e){try{const t=await this._session.send("Runtime.evaluate",{expression:e,contextId:this._contextId,returnByValue:!0});if(t.wasThrown)throw new MS.JavaScriptErrorInEvaluate(t.result.description);return t.result.value}catch(e){throw jS(e)}}async rawEvaluateHandle(e){try{const t=await this._session.send("Runtime.evaluate",{expression:e,contextId:this._contextId,returnByValue:!1});if(t.wasThrown)throw new MS.JavaScriptErrorInEvaluate(t.result.description);return t.result.objectId}catch(e){throw jS(e)}}rawCallFunctionNoReply(e,...t){this._session.send("Runtime.callFunctionOn",{functionDeclaration:e.toString(),objectId:t.find((e=>e instanceof MS.JSHandle))._objectId,arguments:t.map((e=>e instanceof MS.JSHandle?{objectId:e._objectId}:{value:e})),returnByValue:!0,emulateUserGesture:!0}).catch((()=>{}))}async evaluateWithArguments(e,t,n,r,i){try{const o=await this._session.send("Runtime.callFunctionOn",{functionDeclaration:e,objectId:n._objectId,arguments:[{objectId:n._objectId},...r.map((e=>({value:e}))),...i.map((e=>({objectId:e})))],returnByValue:t,emulateUserGesture:!0,awaitPromise:!0});if(o.wasThrown)throw new MS.JavaScriptErrorInEvaluate(o.result.description);return t?(0,FS.parseEvaluationResultValue)(o.result.value):n._context.createHandle(o.result)}catch(e){throw jS(e)}}async getProperties(e,t){const n=await this._session.send("Runtime.getProperties",{objectId:t,ownProperties:!0}),r=new Map;for(const t of n.properties)t.enumerable&&t.value&&r.set(t.name,e.createHandle(t.value));return r}createHandle(e,t){const n="Promise"===t.className;return new MS.JSHandle(e,n?"promise":t.subtype||t.type,function(e){if("undefined"===e.type)return"undefined";if("value"in e)return String(e.value);if("Object"===e.description&&e.preview){const t=[];for(const{name:n,value:r}of e.preview.properties)t.push(`${n}: ${r}`);return`{${t.join(", ")}}`}if("array"===e.subtype&&e.preview){const t=[];for(const{name:n,value:r}of e.preview.properties)t[+n]=r;return"["+String(t)+"]"}return e.description}(t),t.objectId,function(e){const t=e.value;return"number"===e.type&&["NaN","-Infinity","Infinity","-0"].includes(e.description)?MS.parseUnserializableValue(e.description):t}(t))}async releaseHandle(e){await this._session.send("Runtime.releaseObject",{objectId:e})}};var DS={};Object.defineProperty(DS,"__esModule",{value:!0}),DS.RawTouchscreenImpl=DS.RawMouseImpl=DS.RawKeyboardImpl=void 0;var LS=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=qS(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(Sd),BS=Hw,HS=Ci;function qS(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(qS=function(e){return e?n:t})(e)}function US(e){let t=0;return e.has("Shift")&&(t|=1),e.has("Control")&&(t|=2),e.has("Alt")&&(t|=4),e.has("Meta")&&(t|=8),t}function WS(e){let t=0;return e.has("left")&&(t|=1),e.has("right")&&(t|=2),e.has("middle")&&(t|=4),t}DS.RawKeyboardImpl=class{constructor(e){this._pageProxySession=void 0,this._session=void 0,this._pageProxySession=e}setSession(e){this._session=e}async keydown(e,t,n,r,i,o,s,a){const l=[];for(const t of["Shift","Control","Alt","Meta"])e.has(t)&&l.push(t);l.push(t);const c=l.join("+");let u=BS.macEditingCommands[c];(0,HS.isString)(u)&&(u=[u]),await this._pageProxySession.send("Input.dispatchKeyEvent",{type:"keyDown",modifiers:US(e),windowsVirtualKeyCode:n,code:t,key:i,text:a,unmodifiedText:a,autoRepeat:s,macCommands:u,isKeypad:o===LS.keypadLocation})}async keyup(e,t,n,r,i,o){await this._pageProxySession.send("Input.dispatchKeyEvent",{type:"keyUp",modifiers:US(e),key:i,windowsVirtualKeyCode:n,code:t,isKeypad:o===LS.keypadLocation})}async sendText(e){await this._session.send("Page.insertText",{text:e})}};DS.RawMouseImpl=class{constructor(e){this._pageProxySession=void 0,this._session=void 0,this._page=void 0,this._pageProxySession=e}setSession(e){this._session=e}async move(e,t,n,r,i,o){await this._pageProxySession.send("Input.dispatchMouseEvent",{type:"move",button:n,buttons:WS(r),x:e,y:t,modifiers:US(i)})}async down(e,t,n,r,i,o){await this._pageProxySession.send("Input.dispatchMouseEvent",{type:"down",button:n,buttons:WS(r),x:e,y:t,modifiers:US(i),clickCount:o})}async up(e,t,n,r,i,o){await this._pageProxySession.send("Input.dispatchMouseEvent",{type:"up",button:n,buttons:WS(r),x:e,y:t,modifiers:US(i),clickCount:o})}async wheel(e,t,n,r,i,o){var s;if(null!==(s=this._page)&&void 0!==s&&s._browserContext._options.isMobile)throw new Error("Mouse wheel is not supported in mobile WebKit");await this._session.send("Page.updateScrollingState"),await this._page.mainFrame().evaluateExpression("new Promise(requestAnimationFrame)",!1,!1,"utility"),await this._pageProxySession.send("Input.dispatchWheelEvent",{x:e,y:t,deltaX:i,deltaY:o,modifiers:US(r)})}setPage(e){this._page=e}};DS.RawTouchscreenImpl=class{constructor(e){this._pageProxySession=void 0,this._pageProxySession=e}async tap(e,t,n){await this._pageProxySession.send("Input.dispatchTapEvent",{x:e,y:t,modifiers:US(n)})}};var $S,zS={};var VS={};Object.defineProperty(VS,"__esModule",{value:!0}),VS.WKProvisionalPage=void 0;var GS=au,KS=Ci;VS.WKProvisionalPage=class{constructor(e,t){this._session=void 0,this._wkPage=void 0,this._sessionListeners=[],this._mainFrameId=null,this.initializationPromise=void 0,this._session=e,this._wkPage=t;const n=e=>t=>{t.frameId&&(t.frameId=this._wkPage._page._frameManager.mainFrame()._id),e(t)},r=this._wkPage;this._sessionListeners=[GS.eventsHelper.addEventListener(e,"Network.requestWillBeSent",n((t=>r._onRequestWillBeSent(e,t)))),GS.eventsHelper.addEventListener(e,"Network.requestIntercepted",n((t=>r._onRequestIntercepted(e,t)))),GS.eventsHelper.addEventListener(e,"Network.responseReceived",n((e=>r._onResponseReceived(e)))),GS.eventsHelper.addEventListener(e,"Network.loadingFinished",n((e=>r._onLoadingFinished(e)))),GS.eventsHelper.addEventListener(e,"Network.loadingFailed",n((e=>r._onLoadingFailed(e))))],this.initializationPromise=this._wkPage._initializeSession(e,!0,(({frameTree:e})=>this._handleFrameTree(e)))}dispose(){GS.eventsHelper.removeEventListeners(this._sessionListeners)}commit(){(0,KS.assert)(this._mainFrameId),this._wkPage._onFrameAttached(this._mainFrameId,null)}_handleFrameTree(e){(0,KS.assert)(!e.frame.parentId),this._mainFrameId=e.frame.id}};var JS,YS,XS,QS,ZS,ex,tx={};function nx(){if(YS)return Kb;YS=1,Object.defineProperty(Kb,"__esModule",{value:!0}),Kb.WKPage=void 0;var e=S(gh),t=function(e){return e&&e.__esModule?e:{default:e}}(T.default),n=S(Jb),r=$l,i=Ci,o=ss,s=S(dw),a=S(bu),l=au,c=su,u=S(_u()),d=Uh(),h=TS,p=Lb,f=IS,m=DS,g=function(){if($S)return zS;$S=1,Object.defineProperty(zS,"__esModule",{value:!0}),zS.WKRouteImpl=zS.WKInterceptableRequest=void 0;var e=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=e[s]}return i.default=e,n&&n.set(e,i),i}(_u()),t=Ci,n=pu;function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)}const i={aborted:"Cancellation",accessdenied:"AccessControl",addressunreachable:"General",blockedbyclient:"Cancellation",blockedbyresponse:"General",connectionaborted:"General",connectionclosed:"General",connectionfailed:"General",connectionrefused:"General",connectionreset:"General",internetdisconnected:"General",namenotresolved:"General",timedout:"Timeout",failed:"General"};function o(e){return-1e3===e||e<=0?-1:(1e3*e|0)/1e3}return zS.WKInterceptableRequest=class{constructor(n,r,i,o,s,a){this._session=void 0,this.request=void 0,this._requestId=void 0,this._timestamp=void 0,this._wallTime=void 0,this._route=void 0,this._redirectedFrom=void 0,this._session=n,this._requestId=o.requestId,this._route=r,this._redirectedFrom=s;const l=o.type?o.type.toLowerCase():s?s.request.resourceType():"other";let c=null;this._timestamp=o.timestamp,this._wallTime=1e3*o.walltime,o.request.postData&&(c=Buffer.from(o.request.postData,"base64")),this.request=new e.Request(i,(null==s?void 0:s.request)||null,a,o.request.url,l,o.request.method,c,(0,t.headersObjectToArray)(o.request.headers))}_routeForRedirectChain(){let e=this;for(;e._redirectedFrom;)e=e._redirectedFrom;return e._route}createResponse(n){const r=n.timing,i={startTime:this._wallTime,domainLookupStart:r?o(r.domainLookupStart):-1,domainLookupEnd:r?o(r.domainLookupEnd):-1,connectStart:r?o(r.connectStart):-1,secureConnectionStart:r?o(r.secureConnectionStart):-1,connectEnd:r?o(r.connectEnd):-1,requestStart:r?o(r.requestStart):-1,responseStart:r?o(r.responseStart):-1},s="darwin"===process.platform?",":"\n";return new e.Response(this.request,n.status,n.statusText,(0,t.headersObjectToArray)(n.headers,",",s),i,(async()=>{const e=await this._session.send("Network.getResponseBody",{requestId:this._requestId});return Buffer.from(e.body,e.base64Encoded?"base64":"utf8")}))}},zS.WKRouteImpl=class{constructor(e,t){this._session=void 0,this._requestId=void 0,this._requestInterceptedPromise=new n.ManualPromise,this._session=e,this._requestId=t}async abort(e){const n=i[e];(0,t.assert)(n,"Unknown error code: "+e),await this._requestInterceptedPromise,await this._session.sendMayFail("Network.interceptRequestWithError",{requestId:this._requestId,errorType:n})}async fulfill(n){if(300<=n.status&&n.status<400)throw new Error("Cannot fulfill with redirect status: "+n.status);await this._requestInterceptedPromise;let r=n.isBase64?"application/octet-stream":"text/plain";const i=(0,t.headersArrayToObject)(n.headers,!0),o=i["content-type"];o&&(r=o.split(";")[0].trim()),await this._session.sendMayFail("Network.interceptRequestWithResponse",{requestId:this._requestId,status:n.status,statusText:e.STATUS_TEXTS[String(n.status)],mimeType:r,headers:i,base64Encoded:n.isBase64,content:n.body})}async continue(e,n){await this._requestInterceptedPromise,await this._session.sendMayFail("Network.interceptWithRequest",{requestId:this._requestId,url:n.url,method:n.method,headers:n.headers?(0,t.headersArrayToObject)(n.headers,!1):void 0,postData:n.postData?Buffer.from(n.postData).toString("base64"):void 0})}},zS}(),_=VS,w=function(){if(JS)return tx;JS=1,Object.defineProperty(tx,"__esModule",{value:!0}),tx.WKWorkers=void 0;var e=au,t=Uh(),n=Lb,r=IS;return tx.WKWorkers=class{constructor(e){this._sessionListeners=[],this._page=void 0,this._workerSessions=new Map,this._page=e}setSession(i){e.eventsHelper.removeEventListeners(this._sessionListeners),this.clear(),this._sessionListeners=[e.eventsHelper.addEventListener(i,"Worker.workerCreated",(e=>{const o=new t.Worker(this._page,e.url),s=new n.WKSession(i.connection,e.workerId,"Most likely the worker has been closed.",(t=>{i.send("Worker.sendMessageToWorker",{workerId:e.workerId,message:JSON.stringify(t)}).catch((e=>{s.dispatchMessage({id:t.id,error:{message:e.message}})}))}));this._workerSessions.set(e.workerId,s),o._createExecutionContext(new r.WKExecutionContext(s,void 0)),this._page._addWorker(e.workerId,o),s.on("Console.messageAdded",(e=>this._onConsoleMessage(o,e))),Promise.all([s.send("Runtime.enable"),s.send("Console.enable"),i.send("Worker.initialized",{workerId:e.workerId})]).catch((t=>{this._page._removeWorker(e.workerId)}))})),e.eventsHelper.addEventListener(i,"Worker.dispatchMessageFromWorker",(e=>{const t=this._workerSessions.get(e.workerId);t&&t.dispatchMessage(JSON.parse(e.message))})),e.eventsHelper.addEventListener(i,"Worker.workerTerminated",(e=>{const t=this._workerSessions.get(e.workerId);t&&(t.dispose(!1),this._workerSessions.delete(e.workerId),this._page._removeWorker(e.workerId))}))]}clear(){this._page._clearWorkers(),this._workerSessions.clear()}async initializeSession(e){await e.send("Worker.enable")}async _onConsoleMessage(e,t){const{type:n,level:r,text:i,parameters:o,url:s,line:a,column:l}=t.message;let c=n||"";"log"===n?c=r:"timing"===n&&(c="timeEnd");const u=(o||[]).map((t=>e._existingExecutionContext.createHandle(t))),d={url:s||"",lineNumber:(a||1)-1,columnNumber:(l||1)-1};this._page._addConsoleMessage(c,u,d,u.length?void 0:i)}},tx}(),v=Ka,b=pu;function y(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(y=function(e){return e?n:t})(e)}function S(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=y(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}const x="__playwright_utility_world__",k="__playwright_binding_call__";class E{constructor(e,t,n){if(this.rawMouse=void 0,this.rawKeyboard=void 0,this.rawTouchscreen=void 0,this._session=void 0,this._provisionalPage=null,this._page=void 0,this._pagePromise=new b.ManualPromise,this._pageProxySession=void 0,this._opener=void 0,this._requestIdToRequest=new Map,this._workers=void 0,this._contextIdToContext=void 0,this._mainFrameContextId=void 0,this._sessionListeners=[],this._eventListeners=void 0,this._browserContext=void 0,this._initializedPage=null,this._firstNonInitialNavigationCommittedPromise=void 0,this._firstNonInitialNavigationCommittedFulfill=()=>{},this._firstNonInitialNavigationCommittedReject=e=>{},this._lastConsoleMessage=null,this._requestIdToResponseReceivedPayloadEvent=new Map,this._nextWindowOpenPopupFeatures=void 0,this._recordingVideoFile=null,this._screencastGeneration=0,this._interceptingFileChooser=!1,this._pageProxySession=t,this._opener=n,this.rawKeyboard=new m.RawKeyboardImpl(t),this.rawMouse=new m.RawMouseImpl(t),this.rawTouchscreen=new m.RawTouchscreenImpl(t),this._contextIdToContext=new Map,this._page=new d.Page(this,e),this.rawMouse.setPage(this._page),this._workers=new w.WKWorkers(this._page),this._session=void 0,this._browserContext=e,this._page.on(d.Page.Events.FrameDetached,(e=>this._removeContextsForFrame(e,!1))),this._eventListeners=[l.eventsHelper.addEventListener(this._pageProxySession,"Target.targetCreated",this._onTargetCreated.bind(this)),l.eventsHelper.addEventListener(this._pageProxySession,"Target.targetDestroyed",this._onTargetDestroyed.bind(this)),l.eventsHelper.addEventListener(this._pageProxySession,"Target.dispatchMessageFromTarget",this._onDispatchMessageFromTarget.bind(this)),l.eventsHelper.addEventListener(this._pageProxySession,"Target.didCommitProvisionalTarget",this._onDidCommitProvisionalTarget.bind(this)),l.eventsHelper.addEventListener(this._pageProxySession,"Screencast.screencastFrame",this._onScreencastFrame.bind(this))],this._firstNonInitialNavigationCommittedPromise=new Promise(((e,t)=>{this._firstNonInitialNavigationCommittedFulfill=e,this._firstNonInitialNavigationCommittedReject=t})),n&&!e._options.noDefaultViewport&&n._nextWindowOpenPopupFeatures){const e=c.helper.getViewportSizeFromWindowFeatures(n._nextWindowOpenPopupFeatures);n._nextWindowOpenPopupFeatures=void 0,e&&(this._page._state.emulatedSize={viewport:e,screen:e})}}potentiallyUninitializedPage(){return this._page}async _initializePageProxySession(){if(this._page._browserContext.isSettingStorageState())return;const e=[this._pageProxySession.send("Dialog.enable"),this._pageProxySession.send("Emulation.setActiveAndFocused",{active:!0})];if(!1===this._browserContext._options.javaScriptEnabled&&e.push(this._pageProxySession.send("Emulation.setJavaScriptEnabled",{enabled:!1})),e.push(this._updateViewport()),e.push(this.updateHttpCredentials()),this._browserContext._permissions.size)for(const[t,n]of this._browserContext._permissions)e.push(this._grantPermissions(t,n));if(this._browserContext._options.recordVideo){const n=t.default.join(this._browserContext._options.recordVideo.dir,(0,i.createGuid)()+".webm");e.push(this._browserContext._ensureVideosPath().then((()=>this._startVideo({...this._browserContext._options.recordVideo.size,outputFile:n}))))}await Promise.all(e)}_setSession(e){l.eventsHelper.removeEventListeners(this._sessionListeners),this._session=e,this.rawKeyboard.setSession(e),this.rawMouse.setSession(e),this._addSessionListeners(),this._workers.setSession(e)}async _initializeSession(e,t,n){await this._initializeSessionMayThrow(e,n).catch((n=>{if(!(t&&e.isDisposed()||this._session!==e))throw n}))}async _initializeSessionMayThrow(e,t){const[,n]=await Promise.all([e.send("Page.enable"),e.send("Page.getResourceTree")]);t(n);const r=[e.send("Runtime.enable"),e.send("Page.createUserWorld",{name:x}).catch((e=>{})),e.send("Console.enable"),e.send("Network.enable"),this._workers.initializeSession(e)];if(this._page._needsRequestInterception()&&(r.push(e.send("Network.setInterceptionEnabled",{enabled:!0})),r.push(e.send("Network.addInterception",{url:".*",stage:"request",isRegex:!0}))),this._page._browserContext.isSettingStorageState())return void await Promise.all(r);const o=this._browserContext._options;o.userAgent&&r.push(e.send("Page.overrideUserAgent",{value:o.userAgent})),(this._page._state.mediaType||this._page._state.colorScheme||this._page._state.reducedMotion)&&r.push(E._setEmulateMedia(e,this._page._state.mediaType,this._page._state.colorScheme,this._page._state.reducedMotion));const s=this._calculateBootstrapScript();s.length&&r.push(e.send("Page.setBootstrapScript",{source:s})),this._page.frames().map((e=>e.evaluateExpression(s,!1,void 0).catch((e=>{})))),o.bypassCSP&&r.push(e.send("Page.setBypassCSP",{enabled:!0})),this._page._state.emulatedSize&&r.push(e.send("Page.setScreenSizeOverride",{width:this._page._state.emulatedSize.screen.width,height:this._page._state.emulatedSize.screen.height})),r.push(this.updateEmulateMedia()),r.push(e.send("Network.setExtraHTTPHeaders",{headers:(0,i.headersArrayToObject)(this._calculateExtraHTTPHeaders(),!1)})),o.offline&&r.push(e.send("Network.setEmulateOfflineState",{offline:!0})),r.push(e.send("Page.setTouchEmulationEnabled",{enabled:!!o.hasTouch})),o.timezoneId&&r.push(e.send("Page.setTimeZone",{timeZone:o.timezoneId}).catch((e=>{throw new Error(`Invalid timezone ID: ${o.timezoneId}`)}))),this._interceptingFileChooser&&r.push(e.send("Page.setInterceptFileChooserDialog",{enabled:!0})),r.push(e.send("Page.overrideSetting",{setting:"DeviceOrientationEventEnabled",value:o.isMobile})),r.push(e.send("Page.overrideSetting",{setting:"FullScreenEnabled",value:!o.isMobile})),r.push(e.send("Page.overrideSetting",{setting:"NotificationsEnabled",value:!o.isMobile})),r.push(e.send("Page.overrideSetting",{setting:"PointerLockEnabled",value:!o.isMobile})),r.push(e.send("Page.overrideSetting",{setting:"InputTypeMonthEnabled",value:o.isMobile})),r.push(e.send("Page.overrideSetting",{setting:"InputTypeWeekEnabled",value:o.isMobile})),await Promise.all(r)}_onDidCommitProvisionalTarget(e){const{oldTargetId:t,newTargetId:n}=e;(0,i.assert)(this._provisionalPage),(0,i.assert)(this._provisionalPage._session.sessionId===n,"Unknown new target: "+n),(0,i.assert)(this._session.sessionId===t,"Unknown old target: "+t);const r=this._provisionalPage._session;this._provisionalPage.commit(),this._provisionalPage.dispose(),this._provisionalPage=null,this._setSession(r)}_onTargetDestroyed(e){const{targetId:t,crashed:n}=e;this._provisionalPage&&this._provisionalPage._session.sessionId===t?(this._provisionalPage._session.dispose(!1),this._provisionalPage.dispose(),this._provisionalPage=null):this._session.sessionId===t&&(this._session.dispose(!1),l.eventsHelper.removeEventListeners(this._sessionListeners),n&&(this._session.markAsCrashed(),this._page._didCrash()))}didClose(){this._page._didClose()}dispose(e){this._pageProxySession.dispose(e),l.eventsHelper.removeEventListeners(this._sessionListeners),l.eventsHelper.removeEventListeners(this._eventListeners),this._session&&this._session.dispose(e),this._provisionalPage&&(this._provisionalPage._session.dispose(e),this._provisionalPage.dispose(),this._provisionalPage=null),this._page._didDisconnect(),this._firstNonInitialNavigationCommittedReject(new Error("Page closed"))}dispatchMessageToSession(e){this._pageProxySession.dispatchMessage(e)}handleProvisionalLoadFailed(e){if(!this._initializedPage)return void this._firstNonInitialNavigationCommittedReject(new Error("Initial load failed"));if(!this._provisionalPage)return;let t=e.error;t.includes("cancelled")&&(t+="; maybe frame was detached?"),this._page._frameManager.frameAbortedNavigation(this._page.mainFrame()._id,t,e.loaderId)}handleWindowOpen(e){(0,i.debugAssert)(!this._nextWindowOpenPopupFeatures),this._nextWindowOpenPopupFeatures=e.windowFeatures}async pageOrError(){return this._pagePromise}async _onTargetCreated(e){const{targetInfo:t}=e,n=new p.WKSession(this._pageProxySession.connection,t.targetId,"Target closed",(e=>{this._pageProxySession.send("Target.sendMessageToTarget",{message:JSON.stringify(e),targetId:t.targetId}).catch((t=>{n.dispatchMessage({id:e.id,error:{message:t.message}})}))}));if((0,i.assert)("page"===t.type,"Only page targets are expected in WebKit, received: "+t.type),t.isProvisional)(0,i.assert)(t.isProvisional),(0,i.assert)(!this._provisionalPage),this._provisionalPage=new _.WKProvisionalPage(n,this),t.isPaused&&this._provisionalPage.initializationPromise.then((()=>{this._pageProxySession.sendMayFail("Target.resume",{targetId:t.targetId})}));else{let e;(0,i.assert)(!this._initializedPage);try{this._setSession(n),await Promise.all([this._initializePageProxySession(),this._initializeSession(n,!1,(({frameTree:e})=>this._handleFrameTree(e)))]),e=this._page}catch(t){e=t}if(t.isPaused&&this._pageProxySession.sendMayFail("Target.resume",{targetId:t.targetId}),e instanceof d.Page&&""===this._page.mainFrame().url())try{await this._firstNonInitialNavigationCommittedPromise}catch(t){e=t}else this._firstNonInitialNavigationCommittedPromise.catch((()=>{}));await this._page.initOpener(this._opener),this._initializedPage=e instanceof d.Page?e:null,this._page.reportAsNew(e instanceof d.Page?void 0:e),this._pagePromise.resolve(e)}}_onDispatchMessageFromTarget(e){const{targetId:t,message:n}=e;if(this._provisionalPage&&this._provisionalPage._session.sessionId===t)this._provisionalPage._session.dispatchMessage(JSON.parse(n));else{if(this._session.sessionId!==t)throw new Error("Unknown target: "+t);this._session.dispatchMessage(JSON.parse(n))}}_addSessionListeners(){this._sessionListeners=[l.eventsHelper.addEventListener(this._session,"Page.frameNavigated",(e=>this._onFrameNavigated(e.frame,!1))),l.eventsHelper.addEventListener(this._session,"Page.navigatedWithinDocument",(e=>this._onFrameNavigatedWithinDocument(e.frameId,e.url))),l.eventsHelper.addEventListener(this._session,"Page.frameAttached",(e=>this._onFrameAttached(e.frameId,e.parentFrameId))),l.eventsHelper.addEventListener(this._session,"Page.frameDetached",(e=>this._onFrameDetached(e.frameId))),l.eventsHelper.addEventListener(this._session,"Page.willCheckNavigationPolicy",(e=>this._onWillCheckNavigationPolicy(e.frameId))),l.eventsHelper.addEventListener(this._session,"Page.didCheckNavigationPolicy",(e=>this._onDidCheckNavigationPolicy(e.frameId,e.cancel))),l.eventsHelper.addEventListener(this._session,"Page.frameScheduledNavigation",(e=>this._onFrameScheduledNavigation(e.frameId))),l.eventsHelper.addEventListener(this._session,"Page.frameStoppedLoading",(e=>this._onFrameStoppedLoading(e.frameId))),l.eventsHelper.addEventListener(this._session,"Page.loadEventFired",(e=>this._onLifecycleEvent(e.frameId,"load"))),l.eventsHelper.addEventListener(this._session,"Page.domContentEventFired",(e=>this._onLifecycleEvent(e.frameId,"domcontentloaded"))),l.eventsHelper.addEventListener(this._session,"Runtime.executionContextCreated",(e=>this._onExecutionContextCreated(e.context))),l.eventsHelper.addEventListener(this._session,"Console.messageAdded",(e=>this._onConsoleMessage(e))),l.eventsHelper.addEventListener(this._session,"Console.messageRepeatCountUpdated",(e=>this._onConsoleRepeatCountUpdated(e))),l.eventsHelper.addEventListener(this._pageProxySession,"Dialog.javascriptDialogOpening",(e=>this._onDialog(e))),l.eventsHelper.addEventListener(this._session,"Page.fileChooserOpened",(e=>this._onFileChooserOpened(e))),l.eventsHelper.addEventListener(this._session,"Network.requestWillBeSent",(e=>this._onRequestWillBeSent(this._session,e))),l.eventsHelper.addEventListener(this._session,"Network.requestIntercepted",(e=>this._onRequestIntercepted(this._session,e))),l.eventsHelper.addEventListener(this._session,"Network.responseReceived",(e=>this._onResponseReceived(e))),l.eventsHelper.addEventListener(this._session,"Network.loadingFinished",(e=>this._onLoadingFinished(e))),l.eventsHelper.addEventListener(this._session,"Network.loadingFailed",(e=>this._onLoadingFailed(e))),l.eventsHelper.addEventListener(this._session,"Network.webSocketCreated",(e=>this._page._frameManager.onWebSocketCreated(e.requestId,e.url))),l.eventsHelper.addEventListener(this._session,"Network.webSocketWillSendHandshakeRequest",(e=>this._page._frameManager.onWebSocketRequest(e.requestId))),l.eventsHelper.addEventListener(this._session,"Network.webSocketHandshakeResponseReceived",(e=>this._page._frameManager.onWebSocketResponse(e.requestId,e.response.status,e.response.statusText))),l.eventsHelper.addEventListener(this._session,"Network.webSocketFrameSent",(e=>e.response.payloadData&&this._page._frameManager.onWebSocketFrameSent(e.requestId,e.response.opcode,e.response.payloadData))),l.eventsHelper.addEventListener(this._session,"Network.webSocketFrameReceived",(e=>e.response.payloadData&&this._page._frameManager.webSocketFrameReceived(e.requestId,e.response.opcode,e.response.payloadData))),l.eventsHelper.addEventListener(this._session,"Network.webSocketClosed",(e=>this._page._frameManager.webSocketClosed(e.requestId))),l.eventsHelper.addEventListener(this._session,"Network.webSocketFrameError",(e=>this._page._frameManager.webSocketError(e.requestId,e.errorMessage)))]}async _updateState(e,t){await this._forAllSessions((n=>n.send(e,t).then()))}async _forAllSessions(e){const t=[this._session];this._provisionalPage&&t.push(this._provisionalPage._session),await Promise.all(t.map((t=>e(t).catch((e=>{})))))}_onWillCheckNavigationPolicy(e){this._provisionalPage||this._page._frameManager.frameRequestedNavigation(e)}_onDidCheckNavigationPolicy(e,t){t&&(this._provisionalPage||this._page._frameManager.frameAbortedNavigation(e,"Navigation canceled by policy check"))}_onFrameScheduledNavigation(e){this._page._frameManager.frameRequestedNavigation(e)}_onFrameStoppedLoading(e){this._page._frameManager.frameStoppedLoading(e)}_onLifecycleEvent(e,t){this._page._frameManager.frameLifecycleEvent(e,t)}_handleFrameTree(e){if(this._onFrameAttached(e.frame.id,e.frame.parentId||null),this._onFrameNavigated(e.frame,!0),this._page._frameManager.frameLifecycleEvent(e.frame.id,"domcontentloaded"),this._page._frameManager.frameLifecycleEvent(e.frame.id,"load"),e.childFrames)for(const t of e.childFrames)this._handleFrameTree(t)}_onFrameAttached(e,t){return this._page._frameManager.frameAttached(e,t)}_onFrameNavigated(e,t){const n=this._page._frameManager.frame(e.id);(0,i.assert)(n),this._removeContextsForFrame(n,!0),e.parentId||this._workers.clear(),this._page._frameManager.frameCommittedNewDocumentNavigation(e.id,e.url,e.name||"",e.loaderId,t),t||this._firstNonInitialNavigationCommittedFulfill()}_onFrameNavigatedWithinDocument(e,t){this._page._frameManager.frameCommittedSameDocumentNavigation(e,t)}_onFrameDetached(e){this._page._frameManager.frameDetached(e)}_removeContextsForFrame(e,t){for(const[n,r]of this._contextIdToContext)r.frame===e&&(this._contextIdToContext.delete(n),t&&e._contextDestroyed(r))}_onExecutionContextCreated(e){if(this._contextIdToContext.has(e.id))return;const t=this._page._frameManager.frame(e.frameId);if(!t)return;const n=new f.WKExecutionContext(this._session,e.id);let r=null;"normal"===e.type?r="main":"user"===e.type&&e.name===x&&(r="utility");const i=new a.FrameExecutionContext(n,t,r);i[P]=n,r&&t._contextCreated(r,i),"normal"===e.type&&t===this._page.mainFrame()&&(this._mainFrameContextId=e.id),this._contextIdToContext.set(e.id,i)}async navigateFrame(e,t,n){if(this._pageProxySession.isDisposed())throw new Error("Target closed");const r=this._pageProxySession.sessionId;return{newDocumentId:(await this._pageProxySession.connection.browserSession.send("Playwright.navigate",{url:t,pageProxyId:r,frameId:e._id,referrer:n})).loaderId}}_onConsoleMessage(e){const{type:t,level:n,text:i,parameters:o,url:s,line:a,column:l,source:c}=e.message;if("debug"===n&&o&&o[0].value===k){const e=JSON.parse(o[1].objectId);return void this.pageOrError().then((t=>{const n=this._contextIdToContext.get(e.injectedScriptId);t instanceof Error||!n||this._page._onBindingCalled(o[2].value,n)}))}if("error"===n&&"javascript"===c){const{name:t,message:n}=(0,r.splitErrorMessage)(i);let o;o=e.message.stackTrace?i+"\n"+e.message.stackTrace.map((e=>`    at ${e.functionName||"unknown"} (${e.url}:${e.lineNumber}:${e.columnNumber})`)).join("\n"):"";const s=new Error(n);return s.stack=o,s.name=t,void this._page.firePageError(s)}let u=t||"";"log"===t?u=n:"timing"===t&&(u="timeEnd");const d=[];for(const e of o||[]){let t;if(e.objectId){const n=JSON.parse(e.objectId);t=this._contextIdToContext.get(n.injectedScriptId)}else t=this._contextIdToContext.get(this._mainFrameContextId);if(!t)return;d.push(t.createHandle(e))}this._lastConsoleMessage={derivedType:u,text:i,handles:d,count:0,location:{url:s||"",lineNumber:(a||1)-1,columnNumber:(l||1)-1}},this._onConsoleRepeatCountUpdated({count:1})}_onConsoleRepeatCountUpdated(e){if(this._lastConsoleMessage){const{derivedType:t,text:n,handles:r,count:i,location:o}=this._lastConsoleMessage;for(let s=i;s<e.count;++s)this._page._addConsoleMessage(t,r,o,r.length?void 0:n);this._lastConsoleMessage.count=e.count}}_onDialog(e){this._page.emit(d.Page.Events.Dialog,new s.Dialog(this._page,e.type,e.message,(async(e,t)=>{await this._pageProxySession.send("Dialog.handleJavaScriptDialog",{accept:e,promptText:t})}),e.defaultPrompt))}async _onFileChooserOpened(e){let t;try{t=(await this._page._frameManager.frame(e.frameId)._mainContext()).createHandle(e.element).asElement()}catch(e){return}await this._page._onFileChooserOpened(t)}static async _setEmulateMedia(e,t,n,r){const i=[];let o,s;switch(i.push(e.send("Page.setEmulatedMedia",{media:t||""})),n){case"light":o="Light";break;case"dark":o="Dark"}switch(i.push(e.send("Page.setForcedAppearance",{appearance:o})),r){case"reduce":s="Reduce";break;case"no-preference":s="NoPreference"}i.push(e.send("Page.setForcedReducedMotion",{reducedMotion:s})),await Promise.all(i)}async updateExtraHTTPHeaders(){await this._updateState("Network.setExtraHTTPHeaders",{headers:(0,i.headersArrayToObject)(this._calculateExtraHTTPHeaders(),!1)})}_calculateExtraHTTPHeaders(){const e=this._browserContext._options.locale;return u.mergeHeaders([this._browserContext._options.extraHTTPHeaders,this._page._state.extraHTTPHeaders,e?u.singleHeader("Accept-Language",e):void 0])}async updateEmulateMedia(){const e=this._page._state.colorScheme,t=this._page._state.reducedMotion;await this._forAllSessions((n=>E._setEmulateMedia(n,this._page._state.mediaType,e,t)))}async setEmulatedSize(e){(0,i.assert)(this._page._state.emulatedSize===e),await this._updateViewport()}async bringToFront(){this._pageProxySession.send("Target.activate",{targetId:this._session.sessionId})}async _updateViewport(){const e=this._browserContext._options,t=this._page._state.emulatedSize;if(null===t)return;const n=t.viewport,r=t.screen,i=[this._pageProxySession.send("Emulation.setDeviceMetricsOverride",{width:n.width,height:n.height,fixedLayout:!!e.isMobile,deviceScaleFactor:e.deviceScaleFactor||1}),this._session.send("Page.setScreenSizeOverride",{width:r.width,height:r.height})];if(e.isMobile){const e=n.width>n.height?90:0;i.push(this._session.send("Page.setOrientationOverride",{angle:e}))}await Promise.all(i)}async updateRequestInterception(){const e=this._page._needsRequestInterception();await Promise.all([this._updateState("Network.setInterceptionEnabled",{enabled:e}),this._updateState("Network.addInterception",{url:".*",stage:"request",isRegex:!0})])}async updateOffline(){await this._updateState("Network.setEmulateOfflineState",{offline:!!this._browserContext._options.offline})}async updateHttpCredentials(){const e=this._browserContext._options.httpCredentials||{username:"",password:""};await this._pageProxySession.send("Emulation.setAuthCredentials",{username:e.username,password:e.password})}async setFileChooserIntercepted(e){this._interceptingFileChooser=e,await this._session.send("Page.setInterceptFileChooserDialog",{enabled:e}).catch((e=>{}))}async reload(){await this._session.send("Page.reload")}goBack(){return this._session.send("Page.goBack").then((()=>!0)).catch((e=>{if(e instanceof Error&&e.message.includes("Protocol error (Page.goBack): Failed to go"))return!1;throw e}))}goForward(){return this._session.send("Page.goForward").then((()=>!0)).catch((e=>{if(e instanceof Error&&e.message.includes("Protocol error (Page.goForward): Failed to go"))return!1;throw e}))}async exposeBinding(e){await this._updateBootstrapScript(),await this._evaluateBindingScript(e)}async removeExposedBindings(){await this._updateBootstrapScript()}async _evaluateBindingScript(e){const t=this._bindingToScript(e);await Promise.all(this._page.frames().map((e=>e.evaluateExpression(t,!1,{}).catch((e=>{})))))}async addInitScript(e){await this._updateBootstrapScript()}async removeInitScripts(){await this._updateBootstrapScript()}_bindingToScript(e){return`self.${e.name} = (param) => console.debug('${k}', {}, param); ${e.source}`}_calculateBootstrapScript(){const e=[];this._page.context()._options.isMobile||(e.push("delete window.orientation"),e.push("delete window.ondevicemotion"),e.push("delete window.ondeviceorientation"));for(const t of this._page.allBindings())e.push(this._bindingToScript(t));return e.push(...this._browserContext.initScripts),e.push(...this._page.initScripts),e.join(";\n")}async _updateBootstrapScript(){await this._updateState("Page.setBootstrapScript",{source:this._calculateBootstrapScript()})}async closePage(e){await this._stopVideo(),await this._pageProxySession.sendMayFail("Target.close",{targetId:this._session.sessionId,runBeforeUnload:e})}async setBackgroundColor(e){await this._session.send("Page.setDefaultBackgroundColorOverride",{color:e})}_toolbarHeight(){var e;return null!==(e=this._page._browserContext._browser)&&void 0!==e&&e.options.headful?"mac10.15"===o.hostPlatform?55:59:0}async _startVideo(e){(0,i.assert)(!this._recordingVideoFile);const{screencastId:t}=await this._pageProxySession.send("Screencast.startVideo",{file:e.outputFile,width:e.width,height:e.height,toolbarHeight:this._toolbarHeight()});this._recordingVideoFile=e.outputFile,this._browserContext._browser._videoStarted(this._browserContext,t,e.outputFile,this.pageOrError())}async _stopVideo(){this._recordingVideoFile&&(await this._pageProxySession.sendMayFail("Screencast.stopVideo"),this._recordingVideoFile=null)}async takeScreenshot(t,r,i,o,s,a,l){const c=i||o,u=await this._session.send("Page.snapshotRect",{...c,coordinateSystem:i?"Page":"Viewport",omitDeviceScaleFactor:"css"===l});let d=Buffer.from(u.dataURL.substr("data:image/png;base64,".length),"base64");return"jpeg"===r&&(d=e.encode(n.PNG.sync.read(d),s).data),d}async getContentFrame(e){const t=await this._session.send("DOM.describeNode",{objectId:e._objectId});return t.contentFrameId?this._page._frameManager.frame(t.contentFrameId):null}async getOwnerFrame(e){if(!e._objectId)return null;return(await this._session.send("DOM.describeNode",{objectId:e._objectId})).ownerFrameId||null}isElementHandle(e){return"node"===e.subtype}async getBoundingBox(e){const t=await this.getContentQuads(e);if(!t||!t.length)return null;let n=1/0,r=-1/0,i=1/0,o=-1/0;for(const e of t)for(const t of e)n=Math.min(n,t.x),r=Math.max(r,t.x),i=Math.min(i,t.y),o=Math.max(o,t.y);return{x:n,y:i,width:r-n,height:o-i}}async scrollRectIntoViewIfNeeded(e,t){return await this._session.send("DOM.scrollIntoViewIfNeeded",{objectId:e._objectId,rect:t}).then((()=>"done")).catch((e=>{if(e instanceof Error&&e.message.includes("Node does not have a layout object"))return"error:notvisible";if(e instanceof Error&&e.message.includes("Node is detached from document"))return"error:notconnected";throw e}))}async setScreencastOptions(e){if(e){const t={...e,toolbarHeight:this._toolbarHeight()},{generation:n}=await this._pageProxySession.send("Screencast.startScreencast",t);this._screencastGeneration=n}else await this._pageProxySession.send("Screencast.stopScreencast")}_onScreencastFrame(e){const t=this._screencastGeneration;this._page.throttleScreencastFrameAck((()=>{this._pageProxySession.send("Screencast.screencastFrameAck",{generation:t}).catch((e=>v.debugLogger.log("error",e)))}));const n=Buffer.from(e.data,"base64");this._page.emit(d.Page.Events.ScreencastFrame,{buffer:n,width:e.deviceWidth,height:e.deviceHeight})}rafCountForStablePosition(){return"win32"===process.platform?5:1}async getContentQuads(e){const t=await this._session.sendMayFail("DOM.getContentQuads",{objectId:e._objectId});return t?t.quads.map((e=>[{x:e[0],y:e[1]},{x:e[2],y:e[3]},{x:e[4],y:e[5]},{x:e[6],y:e[7]}])):null}async setInputFiles(e,t){const n=e._objectId,r=t.map((e=>({name:e.name,type:e.mimeType,data:e.buffer})));await this._session.send("DOM.setInputFiles",{objectId:n,files:r})}async setInputFilePaths(e,t){const n=this._pageProxySession.sessionId,r=e._objectId;await Promise.all([this._pageProxySession.connection.browserSession.send("Playwright.grantFileReadAccess",{pageProxyId:n,paths:t}),this._session.send("DOM.setInputFiles",{objectId:r,paths:t})])}async adoptElementHandle(e,t){const n=await this._session.sendMayFail("DOM.resolveNode",{objectId:e._objectId,executionContextId:t[P]._contextId});if(!n||"null"===n.object.subtype)throw new Error(a.kUnableToAdoptErrorMessage);return t.createHandle(n.object)}async getAccessibilityTree(e){return(0,h.getAccessibilityTree)(this._session,e)}async inputActionEpilogue(){}async getFrameElement(e){const t=e.parentFrame();if(!t)throw new Error("Frame has been detached.");const n=this._page.parseSelector("frame,iframe"),r=await this._page.selectors._queryAll(t,n),i=await Promise.all(r.map((async e=>{const t=await e.contentFrame().catch((e=>null));return{handle:e,frame:t}}))),o=i.find((t=>t.frame===e));if(i.map((e=>e===o?Promise.resolve():e.handle.dispose())),!o)throw new Error("Frame has been detached.");return o.handle}_onRequestWillBeSent(e,t){if(t.request.url.startsWith("data:"))return;let n=null;if(t.redirectResponse){const e=this._requestIdToRequest.get(t.requestId);e&&(this._handleRequestRedirect(e,t.redirectResponse,t.timestamp),n=e)}const r=n?n.request.frame():this._page._frameManager.frame(t.frameId);if(!r)return;const i="Document"===t.type?t.loaderId:void 0;let o=null;this._page._needsRequestInterception()&&!n&&(o=new g.WKRouteImpl(e,t.requestId));const s=new g.WKInterceptableRequest(e,o,r,t,n,i);this._requestIdToRequest.set(t.requestId,s),this._page._frameManager.requestStarted(s.request,o||void 0)}_handleRequestRedirect(e,t,n){const r=e.createResponse(t);r._securityDetailsFinished(),r._serverAddrFinished(),r._requestFinished(t.timing?c.helper.secondsToRoundishMillis(n-e._timestamp):-1),this._requestIdToRequest.delete(e._requestId),this._page._frameManager.requestReceivedResponse(r),this._page._frameManager.reportRequestFinished(e.request,r)}_onRequestIntercepted(e,t){const n=this._requestIdToRequest.get(t.requestId);n?n._route?n._route._requestInterceptedPromise.resolve():e.sendMayFail("Network.interceptWithRequest",{requestId:n._requestId}):e.sendMayFail("Network.interceptRequestWithError",{errorType:"Cancellation",requestId:t.requestId})}_onResponseReceived(e){const t=this._requestIdToRequest.get(e.requestId);if(!t)return;this._requestIdToResponseReceivedPayloadEvent.set(t._requestId,e);const n=t.createResponse(e.response);if(e.response.requestHeaders&&Object.keys(e.response.requestHeaders).length){const n={...e.response.requestHeaders};n.host||(n.Host=new URL(t.request.url()).host),t.request.setRawRequestHeaders((0,i.headersObjectToArray)(n))}this._page._frameManager.requestReceivedResponse(n),204===n.status()&&this._onLoadingFailed({requestId:e.requestId,errorText:"Aborted: 204 No Content",timestamp:e.timestamp})}_onLoadingFinished(e){const t=this._requestIdToRequest.get(e.requestId);if(!t)return;const n=t.request._existingResponse();if(n){var r,i,o,s,a,l,u,d,h,p,f,m;const g=this._requestIdToResponseReceivedPayloadEvent.get(t._requestId);n._serverAddrFinished(function(e){if(!e)return;try{const t=e.lastIndexOf(":"),n=e.lastIndexOf(".");if(n<0)return{ipAddress:`[${e.slice(0,t)}]`,port:+e.slice(t+1)};if(t>n){const[t,n]=e.split(":");return{ipAddress:t,port:+n}}{const[t,n]=e.split(".");return{ipAddress:`[${t}]`,port:+n}}}catch(e){}}(null==e||null===(r=e.metrics)||void 0===r?void 0:r.remoteAddress)),n._securityDetailsFinished({protocol:C(n.url(),n.timing())?null===(i=e.metrics)||void 0===i||null===(o=i.securityConnection)||void 0===o?void 0:o.protocol:void 0,subjectName:null==g||null===(s=g.response.security)||void 0===s||null===(a=s.certificate)||void 0===a?void 0:a.subject,validFrom:null==g||null===(l=g.response.security)||void 0===l||null===(u=l.certificate)||void 0===u?void 0:u.validFrom,validTo:null==g||null===(d=g.response.security)||void 0===d||null===(h=d.certificate)||void 0===h?void 0:h.validUntil}),null!==(p=e.metrics)&&void 0!==p&&p.protocol&&n._setHttpVersion(e.metrics.protocol),null!==(f=e.metrics)&&void 0!==f&&f.responseBodyBytesReceived&&(t.request.responseSize.encodedBodySize=e.metrics.responseBodyBytesReceived),null!==(m=e.metrics)&&void 0!==m&&m.responseHeaderBytesReceived&&(t.request.responseSize.responseHeadersSize=e.metrics.responseHeaderBytesReceived),n._requestFinished(c.helper.secondsToRoundishMillis(e.timestamp-t._timestamp))}this._requestIdToResponseReceivedPayloadEvent.delete(t._requestId),this._requestIdToRequest.delete(t._requestId),this._page._frameManager.reportRequestFinished(t.request,n)}_onLoadingFailed(e){const t=this._requestIdToRequest.get(e.requestId);if(!t)return;const n=t.request._existingResponse();n&&(n._serverAddrFinished(),n._securityDetailsFinished(),n._requestFinished(c.helper.secondsToRoundishMillis(e.timestamp-t._timestamp))),this._requestIdToRequest.delete(t._requestId),t.request._setFailureText(e.errorText),this._page._frameManager.requestFailed(t.request,e.errorText.includes("cancelled"))}async _grantPermissions(e,t){const n=new Map([["geolocation","geolocation"]]),r=t.map((e=>{const t=n.get(e);if(!t)throw new Error("Unknown permission: "+e);return t}));await this._pageProxySession.send("Emulation.grantPermissions",{origin:e,permissions:r})}async _clearPermissions(){await this._pageProxySession.send("Emulation.resetPermissions",{})}}function C(e,t){try{const n=new URL(e);return("https:"===n.protocol||"wss:"===n.protocol||"sftp:"===n.protocol)&&(-1!==t.secureConnectionStart||-1===t.connectStart)}catch(e){}}Kb.WKPage=E;const P=Symbol("delegate");return Kb}function rx(){if(QS)return jb;QS=1,Object.defineProperty(jb,"__esModule",{value:!0}),jb.WebKit=void 0;var e=function(){if(XS)return Db;XS=1,Object.defineProperty(Db,"__esModule",{value:!0}),Db.WKBrowserContext=Db.WKBrowser=void 0;var e=Q_(),t=fx(),n=Ci,r=au,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(_u()),o=Lb,s=nx(),a=Al;function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}const c="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Safari/605.1.15";class u extends e.Browser{static async connect(e,t){const n=new u(e,t);t.__testHookOnConnectToBrowser&&await t.__testHookOnConnectToBrowser();const r=[n._browserSession.send("Playwright.enable")];return t.persistent&&(n._defaultContext=new d(n,void 0,t.persistent),r.push(n._defaultContext._initialize())),await Promise.all(r),n}constructor(e,t){super(t),this._connection=void 0,this._browserSession=void 0,this._contexts=new Map,this._wkPages=new Map,this._eventListeners=void 0,this._connection=new o.WKConnection(e,this._onDisconnect.bind(this),t.protocolLogger,t.browserLogsCollector),this._browserSession=this._connection.browserSession,this._eventListeners=[r.eventsHelper.addEventListener(this._browserSession,"Playwright.pageProxyCreated",this._onPageProxyCreated.bind(this)),r.eventsHelper.addEventListener(this._browserSession,"Playwright.pageProxyDestroyed",this._onPageProxyDestroyed.bind(this)),r.eventsHelper.addEventListener(this._browserSession,"Playwright.provisionalLoadFailed",(e=>this._onProvisionalLoadFailed(e))),r.eventsHelper.addEventListener(this._browserSession,"Playwright.windowOpen",(e=>this._onWindowOpen(e))),r.eventsHelper.addEventListener(this._browserSession,"Playwright.downloadCreated",this._onDownloadCreated.bind(this)),r.eventsHelper.addEventListener(this._browserSession,"Playwright.downloadFilenameSuggested",this._onDownloadFilenameSuggested.bind(this)),r.eventsHelper.addEventListener(this._browserSession,"Playwright.downloadFinished",this._onDownloadFinished.bind(this)),r.eventsHelper.addEventListener(this._browserSession,"Playwright.screencastFinished",this._onScreencastFinished.bind(this)),r.eventsHelper.addEventListener(this._browserSession,o.kPageProxyMessageReceived,this._onPageProxyMessageReceived.bind(this))]}_onDisconnect(){for(const e of this._wkPages.values())e.dispose(!0);for(const e of this._idToVideo.values())e.artifact.reportFinished(a.kBrowserClosedError);this._idToVideo.clear(),this._didClose()}async doCreateNewContext(e){const t=e.proxy?{proxyServer:e.proxy.server,proxyBypassList:e.proxy.bypass}:void 0,{browserContextId:n}=await this._browserSession.send("Playwright.createContext",t);e.userAgent=e.userAgent||c;const r=new d(this,n,e);return await r._initialize(),this._contexts.set(n,r),r}contexts(){return Array.from(this._contexts.values())}version(){return"15.4"}userAgent(){return c}_onDownloadCreated(e){const t=this._wkPages.get(e.pageProxyId);if(!t)return;t._page._frameManager.frameAbortedNavigation(e.frameId,"Download is starting");let n=t._initializedPage;n||(t._firstNonInitialNavigationCommittedReject(new Error("Starting new page download")),t._opener&&(n=t._opener._initializedPage)),n&&this._downloadCreated(n,e.uuid,e.url)}_onDownloadFilenameSuggested(e){this._downloadFilenameSuggested(e.uuid,e.suggestedFilename)}_onDownloadFinished(e){this._downloadFinished(e.uuid,e.error)}_onScreencastFinished(e){var t;null===(t=this._takeVideo(e.screencastId))||void 0===t||t.reportFinished()}_onPageProxyCreated(e){const t=e.pageProxyId;let n=null;if(e.browserContextId&&(n=this._contexts.get(e.browserContextId)||null),n||(n=this._defaultContext),!n)return;const r=new o.WKSession(this._connection,t,"Target closed",(e=>{this._connection.rawSend({...e,pageProxyId:t})})),i=e.openerId?this._wkPages.get(e.openerId):void 0,a=new s.WKPage(n,r,i||null);this._wkPages.set(t,a)}_onPageProxyDestroyed(e){const t=e.pageProxyId,n=this._wkPages.get(t);n&&(n.didClose(),n.dispose(!1),this._wkPages.delete(t))}_onPageProxyMessageReceived(e){const t=this._wkPages.get(e.pageProxyId);t&&t.dispatchMessageToSession(e.message)}_onProvisionalLoadFailed(e){const t=this._wkPages.get(e.pageProxyId);t&&t.handleProvisionalLoadFailed(e)}_onWindowOpen(e){const t=this._wkPages.get(e.pageProxyId);t&&t.handleWindowOpen(e)}isConnected(){return!this._connection.isClosed()}}Db.WKBrowser=u;class d extends t.BrowserContext{constructor(e,t,n){super(e,n,t),this._authenticateProxyViaHeader()}async _initialize(){(0,n.assert)(!this._wkPages().length);const e=this._browserContextId,t=[super._initialize()];t.push(this._browser._browserSession.send("Playwright.setDownloadBehavior",{behavior:this._options.acceptDownloads?"allow":"deny",downloadPath:this._browser.options.downloadsPath,browserContextId:e})),this._options.ignoreHTTPSErrors&&t.push(this._browser._browserSession.send("Playwright.setIgnoreCertificateErrors",{browserContextId:e,ignore:!0})),this._options.locale&&t.push(this._browser._browserSession.send("Playwright.setLanguages",{browserContextId:e,languages:[this._options.locale]})),this._options.permissions&&t.push(this.grantPermissions(this._options.permissions)),this._options.geolocation&&t.push(this.setGeolocation(this._options.geolocation)),this._options.offline&&t.push(this.setOffline(this._options.offline)),this._options.httpCredentials&&t.push(this.setHTTPCredentials(this._options.httpCredentials)),await Promise.all(t)}_wkPages(){return Array.from(this._browser._wkPages.values()).filter((e=>e._browserContext===this))}pages(){return this._wkPages().map((e=>e._initializedPage)).filter((e=>!!e))}async newPageDelegate(){(0,t.assertBrowserContextIsNotOwned)(this);const{pageProxyId:e}=await this._browser._browserSession.send("Playwright.createPage",{browserContextId:this._browserContextId});return this._browser._wkPages.get(e)}async doGetCookies(e){const{cookies:t}=await this._browser._browserSession.send("Playwright.getAllCookies",{browserContextId:this._browserContextId});return i.filterCookies(t.map((e=>{const t={...e};return t.expires=-1===e.expires?-1:e.expires/1e3,delete t.session,t})),e)}async addCookies(e){const t=i.rewriteCookies(e).map((e=>({...e,session:-1===e.expires||void 0===e.expires,expires:e.expires&&-1!==e.expires?1e3*e.expires:e.expires})));await this._browser._browserSession.send("Playwright.setCookies",{cookies:t,browserContextId:this._browserContextId})}async clearCookies(){await this._browser._browserSession.send("Playwright.deleteAllCookies",{browserContextId:this._browserContextId})}async doGrantPermissions(e,t){await Promise.all(this.pages().map((n=>n._delegate._grantPermissions(e,t))))}async doClearPermissions(){await Promise.all(this.pages().map((e=>e._delegate._clearPermissions())))}async setGeolocation(e){(0,t.verifyGeolocation)(e),this._options.geolocation=e;const n=e?{...e,timestamp:Date.now()}:void 0;await this._browser._browserSession.send("Playwright.setGeolocationOverride",{browserContextId:this._browserContextId,geolocation:n})}async setExtraHTTPHeaders(e){this._options.extraHTTPHeaders=e;for(const e of this.pages())await e._delegate.updateExtraHTTPHeaders()}async setOffline(e){this._options.offline=e;for(const e of this.pages())await e._delegate.updateOffline()}async doSetHTTPCredentials(e){this._options.httpCredentials=e;for(const e of this.pages())await e._delegate.updateHttpCredentials()}async doAddInitScript(e){for(const e of this.pages())await e._delegate._updateBootstrapScript()}async doRemoveInitScripts(){for(const e of this.pages())await e._delegate._updateBootstrapScript()}async doExposeBinding(e){for(const t of this.pages())await t._delegate.exposeBinding(e)}async doRemoveExposedBindings(){for(const e of this.pages())await e._delegate.removeExposedBindings()}async doUpdateRequestInterception(){for(const e of this.pages())await e._delegate.updateRequestInterception()}onClosePersistent(){}async doClose(){(0,n.assert)(this._browserContextId),await this._browser._browserSession.send("Playwright.deleteContext",{browserContextId:this._browserContextId}),this._browser._contexts.delete(this._browserContextId)}async cancelDownload(e){await this._browser._browserSession.send("Playwright.cancelDownload",{uuid:e})}}return Db.WKBrowserContext=d,Db}(),t=function(e){return e&&e.__esModule?e:{default:e}}(T.default),n=Lb,r=Uv(),i=$l,o=Ci;class s extends r.BrowserType{constructor(e){super("webkit",e)}_connectToTransport(t,n){return e.WKBrowser.connect(t,n)}_amendEnvironment(e,n,r,i){return{...e,CURL_COOKIE_JAR_PATH:t.default.join(n,"cookiejar.db")}}_rewriteStartupError(e){return e.message.includes("cannot open display")?(0,i.rewriteErrorMessage)(e,"\n"+(0,o.wrapInASCIIBox)(r.kNoXServerRunningError,1)):e}_attemptToGracefullyCloseBrowser(e){e.send({method:"Playwright.close",params:{},id:n.kBrowserCloseMessageId})}_defaultArgs(e,t,n){const{args:r=[],proxy:i,headless:o}=e;if(r.find((e=>e.startsWith("--user-data-dir"))))throw new Error("Pass userDataDir parameter to `browserType.launchPersistentContext(userDataDir, ...)` instead of specifying --user-data-dir argument");if(r.find((e=>!e.startsWith("-"))))throw new Error("Arguments can not specify page to be opened");const s=["--inspector-pipe"];return"win32"===process.platform&&s.push("--disable-accelerated-compositing"),o&&s.push("--headless"),t?s.push(`--user-data-dir=${n}`):s.push("--no-startup-window"),i&&("darwin"===process.platform?(s.push(`--proxy=${i.server}`),i.bypass&&s.push(`--proxy-bypass-list=${i.bypass}`)):"linux"===process.platform?(s.push(`--proxy=${i.server}`),i.bypass&&s.push(...i.bypass.split(",").map((e=>`--ignore-host=${e}`)))):"win32"===process.platform&&(s.push(`--curl-proxy=${i.server}`),i.bypass&&s.push(`--curl-noproxy=${i.bypass}`))),s.push(...r),t&&s.push("about:blank"),s}}return jb.WebKit=s,jb}function ix(){if(ZS)return lm;ZS=1,Object.defineProperty(lm,"__esModule",{value:!0}),lm.Playwright=void 0,lm.createPlaywright=function(e,t=!1){return new c(e,t)};var e=yv(),t=Sv,n=Vv(),r=Jv(),i=Mb(),o=Fb,s=rx(),a=Hl,l=Ka;class c extends a.SdkObject{constructor(c,u){super({attribution:{isInternalPlaywright:u},instrumentation:(0,a.createInstrumentation)()},void 0,"Playwright"),this.selectors=void 0,this.chromium=void 0,this.android=void 0,this.electron=void 0,this.firefox=void 0,this.webkit=void 0,this.options=void 0,this._allPages=new Set,this.instrumentation.addListener({onPageOpen:e=>this._allPages.add(e),onPageClose:e=>this._allPages.delete(e),onCallLog:(e,t,n,r)=>{l.debugLogger.log(n,r)}},null),this.options={rootSdkObject:this,selectors:new o.Selectors,sdkLanguage:c},this.chromium=new n.Chromium(this.options),this.firefox=new i.Firefox(this.options),this.webkit=new s.WebKit(this.options),this.electron=new r.Electron(this.options),this.android=new e.Android(new t.AdbBackend,this.options),this.selectors=this.options.selectors}async hideHighlight(){await Promise.all([...this._allPages].map((e=>e.hideHighlight().catch((()=>{})))))}}return lm.Playwright=c,lm}var ox={};Object.defineProperty(ox,"__esModule",{value:!0}),ox.metadataToCallLog=function(e,t){var n,r;let i=e.apiName||e.method;"waitForEventInfo"===e.method&&(i+=`(${e.params.info.event})`);i=i.replace("object.expect","expect"),e.error&&(t="error");const o={url:null===(n=e.params)||void 0===n?void 0:n.url,selector:null===(r=e.params)||void 0===r?void 0:r.selector};let s=e.endTime?e.endTime-e.startTime:void 0;"number"==typeof s&&e.pauseStartTime&&e.pauseEndTime&&(s-=e.pauseEndTime-e.pauseStartTime,s=Math.max(s,0));return{id:e.id,messages:e.log,title:i,status:t,error:e.error,params:o,duration:s}};var sx={};Object.defineProperty(sx,"__esModule",{value:!0}),sx.TimeoutRunnerError=sx.TimeoutRunner=void 0,sx.raceAgainstTimeout=async function(e,t){const n=new hx(t);try{return{result:await n.run(e),timedOut:!1}}catch(e){if(e instanceof dx)return{timedOut:!0};throw e}};var ax,lx,cx=pu,ux=Ci;class dx extends Error{}sx.TimeoutRunnerError=dx;class hx{constructor(e){this._running=void 0,this._timeout=void 0,this._elapsed=void 0,this._timeout=e,this._elapsed=0}async run(e){const t=this._running={lastElapsedSync:(0,ux.monotonicTime)(),timer:void 0,timeoutPromise:new cx.ManualPromise};try{const n=Promise.race([e(),t.timeoutPromise]);return this._updateTimeout(t,this._timeout),await n}finally{this._updateTimeout(t,0),this._running===t&&(this._running=void 0)}}interrupt(){this._running&&this._updateTimeout(this._running,-1)}elapsed(){return this._syncElapsedAndStart(),this._elapsed}updateTimeout(e,t){this._timeout=e,void 0!==t&&(this._syncElapsedAndStart(),this._elapsed=t),this._running&&this._updateTimeout(this._running,e)}_syncElapsedAndStart(){if(this._running){const e=(0,ux.monotonicTime)();this._elapsed+=e-this._running.lastElapsedSync,this._running.lastElapsedSync=e}}_updateTimeout(e,t){e.timer&&(clearTimeout(e.timer),e.timer=void 0),this._syncElapsedAndStart(),0!==t&&((t-=this._elapsed)<=0?e.timeoutPromise.reject(new dx):e.timer=setTimeout((()=>e.timeoutPromise.reject(new dx)),t))}}function px(){if(ax)return Xp;ax=1,Object.defineProperty(Xp,"__esModule",{value:!0}),Xp.Recorder=void 0;var e=v(C.default),t=Qp,n=tf,r=Uh(),i=yd(),o=fx(),s=rf,a=df,l=Mf,c=zf,u=v(rm),d=v(im),h=function(){if(ex)return om;ex=1,Object.defineProperty(om,"__esModule",{value:!0}),om.RecorderApp=void 0;var e=u(C.default),t=u(T.default),n=Uu,r=M.default,i=Hl,o=Ci,s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(Su),a=sm,l=Tl();function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function u(e){return e&&e.__esModule?e:{default:e}}class d extends r.EventEmitter{constructor(e,t){super(),this._page=void 0,this.wsEndpoint=void 0,this.setMaxListeners(0),this._page=e,this.wsEndpoint=t}async close(){await this._page.context().close((0,i.serverSideCallMetadata)())}async _init(){await(0,a.installAppIcon)(this._page),await this._page._setServerRequestInterceptor((async n=>{if(n.request().url().startsWith("https://playwright/")){const r=n.request().url().substring("https://playwright/".length),i=require.resolve("../../webpack/recorder/"+r),o=await e.default.promises.readFile(i);await n.fulfill({status:200,headers:[{name:"Content-Type",value:s.getType(t.default.extname(i))||"application/octet-stream"}],body:o.toString("base64"),isBase64:!0})}else await n.continue()})),await this._page.exposeBinding("dispatch",!1,((e,t)=>this.emit("event",t))),this._page.once("close",(()=>{this.emit("close"),this._page.context().close((0,i.serverSideCallMetadata)()).catch((()=>{}))}));const n=this._page.mainFrame();await n.goto((0,i.serverSideCallMetadata)(),"https://playwright/index.html")}static async open(e,t){if(process.env.PW_CODEGEN_NO_INSPECTOR)return new h;const r=ix().createPlaywright("javascript",!0),s=["--app=data:text/html,","--window-size=600,600","--window-position=1020,10","--test-type="];process.env.PWTEST_RECORDER_PORT&&s.push(`--remote-debugging-port=${process.env.PWTEST_RECORDER_PORT}`);const a=await r.chromium.launchPersistentContext((0,i.serverSideCallMetadata)(),"",{channel:(0,l.findChromiumChannel)(e),args:s,noDefaultViewport:!0,ignoreDefaultArgs:["--enable-automation"],headless:!!process.env.PWTEST_CLI_HEADLESS||(0,o.isUnderTest)()&&!t,useWebSocket:!!process.env.PWTEST_RECORDER_PORT}),c=new n.ProgressController((0,i.serverSideCallMetadata)(),a._browser);await c.run((async e=>{await a._browser._defaultContext._loadDefaultContextAsIs(e)}));const[u]=a.pages(),p=new d(u,a._browser.options.wsEndpoint);return await p._init(),p}async setMode(e){await this._page.mainFrame().evaluateExpression((e=>{window.playwrightSetMode(e)}).toString(),!0,e,"main").catch((()=>{}))}async setFile(e){await this._page.mainFrame().evaluateExpression((e=>{window.playwrightSetFile(e)}).toString(),!0,e,"main").catch((()=>{}))}async setPaused(e){await this._page.mainFrame().evaluateExpression((e=>{window.playwrightSetPaused(e)}).toString(),!0,e,"main").catch((()=>{}))}async setSources(e){await this._page.mainFrame().evaluateExpression((e=>{window.playwrightSetSources(e)}).toString(),!0,e,"main").catch((()=>{})),process.env.PWTEST_CLI_EXIT&&e.length&&(process.stdout.write("\n-------------8<-------------\n"),process.stdout.write(e[0].text),process.stdout.write("\n-------------8<-------------\n"))}async setSelector(e,t){await this._page.mainFrame().evaluateExpression((e=>{window.playwrightSetSelector(e.selector,e.focus)}).toString(),!0,{selector:e,focus:t},"main").catch((()=>{}))}async updateCallLogs(e){await this._page.mainFrame().evaluateExpression((e=>{window.playwrightUpdateLogs(e)}).toString(),!0,e,"main").catch((()=>{}))}async bringToFront(){await this._page.bringToFront()}}om.RecorderApp=d;class h extends r.EventEmitter{async close(){}async setPaused(e){}async setMode(e){}async setFile(e){}async setSelector(e,t){}async updateCallLogs(e){}bringToFront(){}async setSources(e){}}return om}(),p=Ci,f=ox,m=Wh,g=M.default,_=sx;function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(w=function(e){return e?n:t})(e)}function v(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=w(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}const b=Symbol("RecorderSupplement");class y{static showInspector(e){y.show(e,{}).catch((()=>{}))}static show(e,t={}){let n=e[b];if(!n){const r=new y(e,t);n=r.install().then((()=>r)),e[b]=n}return n}constructor(e,t){this._context=void 0,this._mode=void 0,this._highlightedSelector="",this._recorderApp=null,this._currentCallsMetadata=new Map,this._recorderSources=[],this._userSources=new Map,this._allMetadatas=new Map,this._debugger=void 0,this._contextRecorder=void 0,this._mode=t.startRecording?"recording":"none",this._contextRecorder=new S(e,t),this._context=e,this._debugger=m.Debugger.lookup(e),e.instrumentation.addListener(this,e)}async install(){const e=await h.RecorderApp.open(this._context._browser.options.sdkLanguage,!!this._context._browser.options.headful);this._recorderApp=e,e.once("close",(()=>{this._debugger.resume(!1),this._recorderApp=null})),e.on("event",(e=>"setMode"===e.event?(this._setMode(e.params.mode),void this._refreshOverlay()):"selectorUpdated"===e.event?(this._highlightedSelector=e.params.selector,void this._refreshOverlay()):void("step"!==e.event?"resume"!==e.event?"pause"!==e.event?"clear"!==e.event||this._contextRecorder.clearScript():this._debugger.pauseOnNextStatement():this._debugger.resume(!1):this._debugger.resume(!0)))),await Promise.all([e.setMode(this._mode),e.setPaused(this._debugger.isPaused()),this._pushAllSources()]),this._context.once(o.BrowserContext.Events.Close,(()=>{this._contextRecorder.dispose(),e.close().catch((()=>{}))})),this._contextRecorder.on(S.Events.Change,(e=>{var t;this._recorderSources=e.sources,this._pushAllSources(),null===(t=this._recorderApp)||void 0===t||t.setFile(e.primaryFileName)})),await this._context.exposeBinding("_playwrightRecorderState",!1,(e=>{let t,n=this._highlightedSelector;for(const[r,i]of this._currentCallsMetadata)e.page===i.attribution.page&&(t=r.point||t,n=n||r.params.selector);return{mode:this._mode,actionPoint:t,actionSelector:n}})),await this._context.exposeBinding("_playwrightRecorderSetSelector",!1,(async(e,t)=>{var n,r;this._setMode("none"),await(null===(n=this._recorderApp)||void 0===n?void 0:n.setSelector(t,!0)),await(null===(r=this._recorderApp)||void 0===r?void 0:r.bringToFront())})),await this._context.exposeBinding("_playwrightResume",!1,(()=>{this._debugger.resume(!1)})),await this._context.extendInjectedScript(d.source),await this._contextRecorder.install(),this._debugger.isPaused()&&this._pausedStateChanged(),this._debugger.on(m.Debugger.Events.PausedStateChanged,(()=>this._pausedStateChanged())),this._context.recorderAppForTest=e}_pausedStateChanged(){var e;for(const{metadata:e,sdkObject:t}of this._debugger.pausedDetails())this._currentCallsMetadata.has(e)||this.onBeforeCall(t,e);null===(e=this._recorderApp)||void 0===e||e.setPaused(this._debugger.isPaused()),this._updateUserSources(),this.updateCallLog([...this._currentCallsMetadata.keys()])}_setMode(e){var t;this._mode=e,null===(t=this._recorderApp)||void 0===t||t.setMode(this._mode),this._contextRecorder.setEnabled("recording"===this._mode),this._debugger.setMuted("recording"===this._mode),"none"!==this._mode&&this._context.pages()[0].bringToFront().catch((()=>{}))}_refreshOverlay(){for(const e of this._context.pages())e.mainFrame().evaluateExpression("window._playwrightRefreshOverlay()",!1,void 0,"main").catch((()=>{}))}async onBeforeCall(e,t){var n;"recording"!==this._mode&&(this._currentCallsMetadata.set(t,e),this._allMetadatas.set(t.id,t),this._updateUserSources(),this.updateCallLog([t]),t.params&&t.params.selector&&(this._highlightedSelector=t.params.selector,null===(n=this._recorderApp)||void 0===n||n.setSelector(this._highlightedSelector).catch((()=>{}))))}async onAfterCall(e,t){"recording"!==this._mode&&(t.error||this._currentCallsMetadata.delete(t),this._updateUserSources(),this.updateCallLog([t]))}_updateUserSources(){var e;for(const e of this._userSources.values())e.highlight=[],e.revealLine=void 0;let t;for(const e of this._currentCallsMetadata.keys()){if(!e.stack||!e.stack[0])continue;const{file:n,line:r}=e.stack[0];let i=this._userSources.get(n);if(i||(i={file:n,text:this._readSource(n),highlight:[],language:x(n)},this._userSources.set(n,i)),r){const n=this._debugger.isPaused(e);i.highlight.push({line:r,type:e.error?"error":n?"paused":"running"}),i.revealLine=r,t=i.file}}this._pushAllSources(),t&&(null===(e=this._recorderApp)||void 0===e||e.setFile(t))}_pushAllSources(){var e;null===(e=this._recorderApp)||void 0===e||e.setSources([...this._recorderSources,...this._userSources.values()])}async onBeforeInputAction(e,t){}async onCallLog(e,t,n,r){this.updateCallLog([t])}updateCallLog(e){var t;if("recording"===this._mode)return;const n=[];for(const t of e){if(!t.method||t.internal)continue;let e="done";this._currentCallsMetadata.has(t)&&(e="in-progress"),this._debugger.isPaused(t)&&(e="paused"),n.push((0,f.metadataToCallLog)(t,e))}null===(t=this._recorderApp)||void 0===t||t.updateCallLogs(n)}_readSource(t){try{return e.readFileSync(t,"utf-8")}catch(e){return"// No source available"}}}Xp.Recorder=y;class S extends g.EventEmitter{constructor(e,n){super(),this._generator=void 0,this._pageAliases=new Map,this._lastPopupOrdinal=0,this._lastDialogOrdinal=0,this._lastDownloadOrdinal=0,this._timers=new Set,this._context=void 0,this._params=void 0,this._recorderSources=void 0,this._context=e,this._params=n;const r=n.language||e._browser.options.sdkLanguage,i=new Set([new s.JavaLanguageGenerator,new a.JavaScriptLanguageGenerator(!1),new a.JavaScriptLanguageGenerator(!0),new c.PythonLanguageGenerator(!1),new c.PythonLanguageGenerator(!0),new l.CSharpLanguageGenerator]),u=[...i].find((e=>e.id===r));if(!u)throw new Error(`\n===============================\nUnsupported language: '${r}'\n===============================\n`);i.delete(u);const d=[u,...i];this._recorderSources=[];const h=new t.CodeGenerator(e._browser.options.name,!!n.startRecording,n.launchOptions||{},n.contextOptions||{},n.device,n.saveStorage),p=n.outputFile?new k(n.outputFile):null;h.on("change",(()=>{this._recorderSources=[];for(const e of d){const t={file:e.fileName,text:h.generateText(e),language:e.highlighter,highlight:[]};t.revealLine=t.text.split("\n").length-1,this._recorderSources.push(t),e===d[0]&&(null==p||p.setContent(t.text))}this.emit(S.Events.Change,{sources:this._recorderSources,primaryFileName:u.fileName})})),p&&(e.on(o.BrowserContext.Events.BeforeClose,(()=>{p.flush()})),process.on("exit",(()=>{p.flush()}))),this._generator=h}async install(){this._context.on(o.BrowserContext.Events.Page,(e=>this._onPage(e)));for(const e of this._context.pages())this._onPage(e);await this._context.exposeBinding("_playwrightRecorderPerformAction",!1,((e,t)=>this._performAction(e.frame,t))),await this._context.exposeBinding("_playwrightRecorderRecordAction",!1,((e,t)=>this._recordAction(e.frame,t))),await this._context.extendInjectedScript(u.source)}setEnabled(e){this._generator.setEnabled(e)}dispose(){for(const e of this._timers)clearTimeout(e);this._timers.clear()}async _onPage(e){const t=e.mainFrame();e.on("close",(()=>{this._generator.addAction({frame:this._describeMainFrame(e),committed:!0,action:{name:"closePage",signals:[]}}),this._pageAliases.delete(e)})),t.on(i.Frame.Events.Navigation,(()=>this._onFrameNavigated(t,e))),e.on(r.Page.Events.Download,(()=>this._onDownload(e))),e.on(r.Page.Events.Dialog,(()=>this._onDialog(e)));const n="page"+(this._pageAliases.size?String(++this._lastPopupOrdinal):"");this._pageAliases.set(e,n),e.opener()?this._onPopup(e.opener(),e):this._generator.addAction({frame:this._describeMainFrame(e),committed:!0,action:{name:"openPage",url:e.mainFrame().url(),signals:[]}})}clearScript(){if(this._generator.restart(),this._params.startRecording)for(const e of this._context.pages())this._onFrameNavigated(e.mainFrame(),e)}_describeMainFrame(e){return{pageAlias:this._pageAliases.get(e),isMainFrame:!0,url:e.mainFrame().url()}}async _describeFrame(e){const t=e._page,n=this._pageAliases.get(t),r=[];for(let t=e;t;t=t.parentFrame())r.push(t);if(r.reverse(),1===r.length)return this._describeMainFrame(t);const i=1===t.frames().filter((t=>t.name()===e.name())).length,o={pageAlias:n,isMainFrame:!1,url:e.url(),name:e.name()&&i?e.name():void 0};if(r.length>3)return o;const s=[];for(let e=0;e<r.length-1;e++)s.push(this._findFrameSelector(r[e+1],r[e]));const a=await(0,_.raceAgainstTimeout)((()=>Promise.all(s)),2e3);return!a.timedOut&&a.result.every((e=>!!e))?{...o,selectorsChain:a.result}:o}async _findFrameSelector(e,t){try{const n=await e.frameElement();if(!n)return;const r=await t._utilityContext(),i=await r.injectedScript(),o=await i.evaluate(((e,t)=>e.generateSelector(t)),n);return o}catch(e){}}async _performAction(e,t){this._generator.commitLastAction();const r={frame:await this._describeFrame(e),action:t},i=async(t,n,i)=>{const o={id:`call@${(0,p.createGuid)()}`,apiName:"frame."+t,objectId:e.guid,pageId:e._page.guid,frameId:e.guid,wallTime:Date.now(),startTime:(0,p.monotonicTime)(),endTime:0,type:"Frame",method:t,params:n,log:[],snapshots:[]};this._generator.willPerformAction(r);try{await e.instrumentation.onBeforeCall(e,o),await i(o)}catch(t){return o.endTime=(0,p.monotonicTime)(),await e.instrumentation.onAfterCall(e,o),void this._generator.performedActionFailed(r)}o.endTime=(0,p.monotonicTime)(),await e.instrumentation.onAfterCall(e,o);const s=setTimeout((()=>{r.committed=!0,this._timers.delete(s)}),5e3);this._generator.didPerformAction(r),this._timers.add(s)},o=5e3;if("click"===t.name){const{options:r}=(0,n.toClickOptions)(t);await i("click",{selector:t.selector},(n=>e.click(n,t.selector,{...r,timeout:o,strict:!0})))}if("press"===t.name){const r=[...(0,n.toModifiers)(t.modifiers),t.key].join("+");await i("press",{selector:t.selector,key:r},(n=>e.press(n,t.selector,r,{timeout:o,strict:!0})))}if("check"===t.name&&await i("check",{selector:t.selector},(n=>e.check(n,t.selector,{timeout:o,strict:!0}))),"uncheck"===t.name&&await i("uncheck",{selector:t.selector},(n=>e.uncheck(n,t.selector,{timeout:o,strict:!0}))),"select"===t.name){const n=t.options.map((e=>({value:e})));await i("selectOption",{selector:t.selector,values:n},(r=>e.selectOption(r,t.selector,[],n,{timeout:o,strict:!0})))}}async _recordAction(e,t){this._generator.commitLastAction();const n={frame:await this._describeFrame(e),action:t};this._generator.addAction(n)}_onFrameNavigated(e,t){const n=this._pageAliases.get(t);this._generator.signal(n,e,{name:"navigation",url:e.url()})}_onPopup(e,t){const n=this._pageAliases.get(e),r=this._pageAliases.get(t);this._generator.signal(n,e.mainFrame(),{name:"popup",popupAlias:r})}_onDownload(e){const t=this._pageAliases.get(e);this._generator.signal(t,e.mainFrame(),{name:"download",downloadAlias:String(++this._lastDownloadOrdinal)})}_onDialog(e){const t=this._pageAliases.get(e);this._generator.signal(t,e.mainFrame(),{name:"dialog",dialogAlias:String(++this._lastDialogOrdinal)})}}function x(e){return e.endsWith(".py")?"python":e.endsWith(".java")?"java":e.endsWith(".cs")?"csharp":"javascript"}S.Events={Change:"change"};class k{constructor(e){this._file=void 0,this._timer=void 0,this._text=void 0,this._file=e}setContent(e){this._text=e,this._timer||(this._timer=setTimeout((()=>this.flush()),1e3))}flush(){this._timer&&(clearTimeout(this._timer),this._timer=void 0),this._text&&e.writeFileSync(this._file,this._text),this._text=void 0}}return Xp}function fx(){if(lx)return ou;lx=1,Object.defineProperty(ou,"__esModule",{value:!0}),ou.BrowserContext=void 0,ou.assertBrowserContextIsNotOwned=function(e){for(const t of e.pages())if(t._ownedContext)throw new Error("Please use browser.newContext() for multi-page scripts that share the context.")},ou.normalizeProxySettings=y,ou.validateBrowserContextOptions=function(t,r){if(t.noDefaultViewport&&void 0!==t.deviceScaleFactor)throw new Error('"deviceScaleFactor" option is not supported with null "viewport"');if(t.noDefaultViewport&&void 0!==t.isMobile)throw new Error('"isMobile" option is not supported with null "viewport"');void 0===t.acceptDownloads&&(t.acceptDownloads=!0);t.viewport||t.noDefaultViewport||(t.viewport={width:1280,height:720});if(t.recordVideo){if(!t.recordVideo.size)if(t.noDefaultViewport)t.recordVideo.size={width:800,height:600};else{const e=t.viewport,n=Math.min(1,800/Math.max(e.width,e.height));t.recordVideo.size={width:Math.floor(e.width*n),height:Math.floor(e.height*n)}}t.recordVideo.size.width&=-2,t.recordVideo.size.height&=-2}if(t.proxy){if(!r.proxy&&r.isChromium&&"win32"===e.platform())throw new Error("Browser needs to be launched with the global proxy. If all contexts override the proxy, global proxy will be never used and can be any string, for example \"launch({ proxy: { server: 'http://per-context' } })\"");t.proxy=y(t.proxy)}"inspector"===(0,n.debugMode)()&&(t.bypassCSP=!0);b(t.geolocation)},ou.verifyGeolocation=b;var e=w(E.default),t=ru,n=Ci,r=Ri,i=su,o=w(_u()),s=Uh(),a=g(T.default),l=g(C.default),c=Hl,u=Wh,d=Kp(),h=function(){if(Jp)return Yp;Jp=1,Object.defineProperty(Yp,"__esModule",{value:!0}),Yp.HarRecorder=void 0;var e=function(e){return e&&e.__esModule?e:{default:e}}(C.default),t=Np,n=Up();return Yp.HarRecorder=class{constructor(e,r){this._artifact=void 0,this._isFlushed=!1,this._options=void 0,this._tracer=void 0,this._entries=[],this._artifact=new t.Artifact(e,r.path),this._options=r,this._tracer=new n.HarTracer(e,this,{content:r.omitContent?"omit":"embedded",waitForContentOnStop:!0,skipScripts:!1}),this._tracer.start()}onEntryStarted(e){this._entries.push(e)}onEntryFinished(e){}onContentBlob(e,t){}async flush(){if(this._isFlushed)return;this._isFlushed=!0,await this._tracer.flush();const t=this._tracer.stop();t.entries=this._entries,await e.default.promises.writeFile(this._options.path,JSON.stringify({log:t},void 0,2))}async export(){return await this.flush(),this._artifact.reportFinished(),this._artifact}},Yp}(),p=px(),f=w(im),m=xx();function g(e){return e&&e.__esModule?e:{default:e}}function _(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_=function(e){return e?n:t})(e)}function w(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}class v extends c.SdkObject{constructor(e,r,i){super(e,"browser-context"),this._timeoutSettings=new t.TimeoutSettings,this._pageBindings=new Map,this._options=void 0,this._requestInterceptor=void 0,this._isPersistentContext=void 0,this._closedStatus="open",this._closePromise=void 0,this._closePromiseFulfill=void 0,this._permissions=new Map,this._downloads=new Set,this._browser=void 0,this._browserContextId=void 0,this._selectors=void 0,this._origins=new Set,this._harRecorder=void 0,this.tracing=void 0,this.fetchRequest=void 0,this._customCloseHandler=void 0,this._tempDirs=[],this._settingStorageState=!1,this.initScripts=[],this.attribution.context=this,this._browser=e,this._options=r,this._browserContextId=i,this._isPersistentContext=!i,this._closePromise=new Promise((e=>this._closePromiseFulfill=e)),this.fetchRequest=new m.BrowserContextAPIRequestContext(this),this._options.recordHar&&(this._harRecorder=new h.HarRecorder(this,{...this._options.recordHar,path:a.default.join(this._browser.options.artifactsDir,`${(0,n.createGuid)()}.har`)})),this.tracing=new d.Tracing(this,e.options.tracesDir)}isPersistentContext(){return this._isPersistentContext}setSelectors(e){this._selectors=e}selectors(){return this._selectors||this._browser.options.selectors}async _initialize(){if(this.attribution.isInternalPlaywright)return;const e=new u.Debugger(this);this.instrumentation.addListener(e,this),"inspector"===(0,n.debugMode)()&&await p.Recorder.show(this,{pauseOnNextStatement:!0}),e.isPaused()&&p.Recorder.showInspector(this),e.on(u.Debugger.Events.PausedStateChanged,(()=>{p.Recorder.showInspector(this)})),"console"===(0,n.debugMode)()&&await this.extendInjectedScript(f.source)}async _ensureVideosPath(){this._options.recordVideo&&await(0,r.mkdirIfNeeded)(a.default.join(this._options.recordVideo.dir,"dummy"))}_browserClosed(){for(const e of this.pages())e._didClose();this._didCloseInternal()}_didCloseInternal(){"closed"!==this._closedStatus&&(this._closedStatus="closed",this._deleteAllDownloads(),this._downloads.clear(),this.tracing.dispose(),this._isPersistentContext&&this.onClosePersistent(),this._closePromiseFulfill(new Error("Context closed")),this.emit(v.Events.Close))}async cookies(e=[]){return e&&!Array.isArray(e)&&(e=[e]),await this.doGetCookies(e)}setHTTPCredentials(e){return this.doSetHTTPCredentials(e)}async exposeBinding(e,t,n){if(this._pageBindings.has(e))throw new Error(`Function "${e}" has been already registered`);for(const t of this.pages())if(t.getBinding(e))throw new Error(`Function "${e}" has been already registered in one of the pages`);const r=new s.PageBinding(e,n,t);this._pageBindings.set(e,r),await this.doExposeBinding(r)}async removeExposedBindings(){this._pageBindings.clear(),await this.doRemoveExposedBindings()}async grantPermissions(e,t){let n="*";if(t){n=new URL(t).origin}const r=new Set(this._permissions.get(n)||[]);e.forEach((e=>r.add(e)));const i=[...r.values()];this._permissions.set(n,i),await this.doGrantPermissions(n,i)}async clearPermissions(){this._permissions.clear(),await this.doClearPermissions()}setDefaultNavigationTimeout(e){this._timeoutSettings.setDefaultNavigationTimeout(e)}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e)}async _loadDefaultContextAsIs(e){if(!this.pages().length){const t=i.helper.waitForEvent(e,this,v.Events.Page);e.cleanupWhenAborted((()=>t.dispose));const n=await t.promise;if(n._pageIsError)throw n._pageIsError}const t=this.pages();if(t[0]._pageIsError)throw t[0]._pageIsError;return await t[0].mainFrame()._waitForLoadState(e,"load"),t}async _loadDefaultContext(e){const t=await this._loadDefaultContextAsIs(e);if(this._options.isMobile||this._options.locale){const n=t[0];await this.newPage(e.metadata),await n.close(e.metadata)}}_authenticateProxyViaHeader(){const e=this._options.proxy||this._browser.options.proxy||{username:void 0,password:void 0},{username:t,password:n}=e;if(t){this._options.httpCredentials={username:t,password:n};const e=Buffer.from(`${t}:${n}`).toString("base64");this._options.extraHTTPHeaders=o.mergeHeaders([this._options.extraHTTPHeaders,o.singleHeader("Proxy-Authorization",`Basic ${e}`)])}}_authenticateProxyViaCredentials(){const e=this._options.proxy||this._browser.options.proxy;if(!e)return;const{username:t,password:n}=e;t&&(this._options.httpCredentials={username:t,password:n||""})}async addInitScript(e){this.initScripts.push(e),await this.doAddInitScript(e)}async removeInitScripts(){this.initScripts.splice(0,this.initScripts.length),await this.doRemoveInitScripts()}async setRequestInterceptor(e){this._requestInterceptor=e,await this.doUpdateRequestInterception()}isClosingOrClosed(){return"open"!==this._closedStatus}async _deleteAllDownloads(){await Promise.all(Array.from(this._downloads).map((e=>e.artifact.deleteOnContextClose())))}async _deleteAllTempDirs(){await Promise.all(this._tempDirs.map((async e=>await l.default.promises.unlink(e).catch((e=>{})))))}setCustomCloseHandler(e){this._customCloseHandler=e}async close(e){if("open"===this._closedStatus){var t;this.emit(v.Events.BeforeClose),this._closedStatus="closing",await(null===(t=this._harRecorder)||void 0===t?void 0:t.flush()),await this.tracing.flush();const n=[];for(const{context:e,artifact:t}of this._browser._idToVideo.values())e===this&&n.push(t.finishedPromise());if(this._customCloseHandler?await this._customCloseHandler():this._isPersistentContext?await Promise.all(this.pages().map((t=>t.close(e)))):await this.doClose(),n.push(this._deleteAllDownloads()),n.push(this._deleteAllTempDirs()),await Promise.all(n),this._customCloseHandler)return;this._isPersistentContext&&await this._browser.close(),this._didCloseInternal()}await this._closePromise}async newPage(e){const t=await this.newPageDelegate();e.isServerSide&&t.potentiallyUninitializedPage().markAsServerSideOnly();const n=await t.pageOrError();if(n instanceof s.Page){if(n.isClosed())throw new Error("Page has been closed.");return n}throw n}addVisitedOrigin(e){this._origins.add(e)}async storageState(){const e={cookies:await this.cookies(),origins:[]};if(this._origins.size){const t=(0,c.serverSideCallMetadata)(),n=await this.newPage(t);await n._setServerRequestInterceptor((e=>{e.fulfill({body:"<html></html>"}).catch((()=>{}))}));for(const r of this._origins){const i={origin:r,localStorage:[]},o=n.mainFrame();await o.goto(t,r);const s=await o.evaluateExpression("({\n\t          localStorage: Object.keys(localStorage).map(name => ({ name, value: localStorage.getItem(name) })),\n\t        })",!1,void 0,"utility");i.localStorage=s.localStorage,s.localStorage.length&&e.origins.push(i)}await n.close(t)}return e}isSettingStorageState(){return this._settingStorageState}async setStorageState(e,t){this._settingStorageState=!0;try{if(t.cookies&&await this.addCookies(t.cookies),t.origins&&t.origins.length){const n=(0,c.serverSideCallMetadata)(),r=await this.newPage(n);await r._setServerRequestInterceptor((e=>{e.fulfill({body:"<html></html>"}).catch((()=>{}))}));for(const n of t.origins){const t=r.mainFrame();await t.goto(e,n.origin),await t.evaluateExpression("\n\t            originState => {\n\t              for (const { name, value } of (originState.localStorage || []))\n\t                localStorage.setItem(name, value);\n\t            }",!0,n,"utility")}await r.close(n)}}finally{this._settingStorageState=!1}}async extendInjectedScript(e,t){const n=n=>n.extendInjectedScript(e,t).catch((()=>{})),r=e=>(e.on(s.Page.Events.InternalFrameNavigatedToNewDocument,n),Promise.all(e.frames().map(n)));return this.on(v.Events.Page,r),Promise.all(this.pages().map(r))}}function b(e){if(!e)return;e.accuracy=e.accuracy||0;const{longitude:t,latitude:n,accuracy:r}=e;if(t<-180||t>180)throw new Error("geolocation.longitude: precondition -180 <= LONGITUDE <= 180 failed.");if(n<-90||n>90)throw new Error("geolocation.latitude: precondition -90 <= LATITUDE <= 90 failed.");if(r<0)throw new Error("geolocation.accuracy: precondition 0 <= ACCURACY failed.")}function y(e){let t,{server:n,bypass:r}=e;try{t=new URL(n),t.host&&t.protocol||(t=new URL("http://"+n))}catch(e){t=new URL("http://"+n)}if("socks4:"===t.protocol&&(e.username||e.password))throw new Error("Socks4 proxy protocol does not support authentication");if("socks5:"===t.protocol&&(e.username||e.password))throw new Error("Browser does not support socks5 proxy authentication");return n=t.protocol+"//"+t.host,r&&(r=r.split(",").map((e=>e.trim())).join(",")),{...e,server:n,bypass:r}}return ou.BrowserContext=v,v.Events={Close:"close",Page:"page",Request:"request",Response:"response",RequestFailed:"requestfailed",RequestFinished:"requestfinished",BeforeClose:"beforeclose",VideoStarted:"videostarted"},ou}sx.TimeoutRunner=hx;var mx={};Object.defineProperty(mx,"__esModule",{value:!0}),mx.CookieStore=void 0,mx.domainMatches=wx;class gx{constructor(e){this._raw=void 0,this._raw=e}name(){return this._raw.name}matches(e){return(!this._raw.secure||"https:"===e.protocol||"localhost"===e.hostname)&&(!!wx(e.hostname,this._raw.domain)&&!!function(e,t){if(e===t)return!0;e.endsWith("/")||(e+="/");t.endsWith("/")||(t+="/");return e.startsWith(t)}(e.pathname,this._raw.path))}equals(e){return this._raw.name===e._raw.name&&this._raw.domain===e._raw.domain&&this._raw.path===e._raw.path}networkCookie(){return this._raw}updateExpiresFrom(e){this._raw.expires=e._raw.expires}expired(){return-1!==this._raw.expires&&1e3*this._raw.expires<Date.now()}}class _x{constructor(){this._nameToCookies=new Map}addCookies(e){for(const t of e)this._addCookie(new gx(t))}cookies(e){const t=[];for(const n of this._cookiesIterator())n.matches(e)&&t.push(n.networkCookie());return t}allCookies(){const e=[];for(const t of this._cookiesIterator())e.push(t.networkCookie());return e}_addCookie(e){if(e.expired())return;let t=this._nameToCookies.get(e.name());t||(t=new Set,this._nameToCookies.set(e.name(),t)),_x.pruneExpired(t);for(const n of t)n.equals(e)&&(e.updateExpiresFrom(n),t.delete(n));t.add(e)}*_cookiesIterator(){for(const[e,t]of this._nameToCookies){_x.pruneExpired(t);for(const e of t)yield e;0===t.size&&this._nameToCookies.delete(e)}}static pruneExpired(e){for(const t of e)t.expired()&&e.delete(t)}}function wx(e,t){return e===t||!!t.startsWith(".")&&(e="."+e).endsWith(t)}mx.CookieStore=_x;var vx={};Object.defineProperty(vx,"__esModule",{value:!0}),vx.MultipartFormData=void 0;var bx=function(e){return e&&e.__esModule?e:{default:e}}(Su);vx.MultipartFormData=class{constructor(){this._boundary=void 0,this._chunks=[],this._boundary=function(){const e=[];for(let t=0;t<16;t++)e.push(yx[Math.floor(Math.random()*yx.length)]);return"----WebKitFormBoundary"+String.fromCharCode(...e)}()}contentTypeHeader(){return`multipart/form-data; boundary=${this._boundary}`}addField(e,t){this._beginMultiPartHeader(e),this._finishMultiPartHeader(),this._chunks.push(Buffer.from(t)),this._finishMultiPartField()}addFileField(e,t){this._beginMultiPartHeader(e),this._chunks.push(Buffer.from(`; filename="${t.name}"`)),this._chunks.push(Buffer.from(`\r\ncontent-type: ${t.mimeType||bx.default.getType(t.name)||"application/octet-stream"}`)),this._finishMultiPartHeader(),this._chunks.push(Buffer.from(t.buffer,"base64")),this._finishMultiPartField()}finish(){return this._addBoundary(!0),Buffer.concat(this._chunks)}_beginMultiPartHeader(e){this._addBoundary(),this._chunks.push(Buffer.from(`content-disposition: form-data; name="${e}"`))}_finishMultiPartHeader(){this._chunks.push(Buffer.from("\r\n\r\n"))}_finishMultiPartField(){this._chunks.push(Buffer.from("\r\n"))}_addBoundary(e){this._chunks.push(Buffer.from("--"+this._boundary)),e&&this._chunks.push(Buffer.from("--")),this._chunks.push(Buffer.from("\r\n"))}};const yx=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,65,66];var Sx;function xx(){if(Sx)return Oc;Sx=1,Object.defineProperty(Oc,"__esModule",{value:!0}),Oc.GlobalAPIRequestContext=Oc.BrowserContextAPIRequestContext=Oc.APIRequestContext=void 0;var e=w(P.default),t=w(O.default),n=si,r=function(){if(Zc)return Qc;Zc=1;const e=(Y&&Y.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(nu());function t(t){return new e.default(t)}return function(t){t.SocksProxyAgent=e.default,t.prototype=e.default.prototype}(t||(t={})),Qc=t}(),i=B.default,o=g(H.default),s=g($.default),a=ru,l=gi,c=Ci,u=fx(),d=mx,h=vx,p=Hl,f=Uu,m=Kp();function g(e){return e&&e.__esModule?e:{default:e}}function _(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_=function(e){return e?n:t})(e)}function w(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}class v extends p.SdkObject{static findResponseBody(e){for(const t of v.allInstances){const n=t.fetchResponses.get(e);if(n)return n}}constructor(e){super(e,"fetchRequest"),this.fetchResponses=new Map,this.fetchLog=new Map,v.allInstances.add(this)}_disposeImpl(){v.allInstances.delete(this),this.fetchResponses.clear(),this.fetchLog.clear(),this.emit(v.Events.Dispose)}disposeResponse(e){this.fetchResponses.delete(e),this.fetchLog.delete(e)}_storeResponseBody(e){const t=(0,c.createGuid)();return this.fetchResponses.set(t,e),t}async fetch(e,t){var i;const s={},a=this._defaultOptions();if(s["user-agent"]=a.userAgent,s.accept="*/*",s["accept-encoding"]="gzip,deflate,br",a.extraHTTPHeaders)for(const{name:e,value:t}of a.extraHTTPHeaders)s[e.toLowerCase()]=t;if(e.headers)for(const{name:t,value:n}of e.headers)s[t.toLowerCase()]=n;const l=(null===(i=e.method)||void 0===i?void 0:i.toUpperCase())||"GET",u=a.proxy;let d;if(u){var p;const e=o.default.parse(u.server);null!==(p=e.protocol)&&void 0!==p&&p.startsWith("socks")?d=new r.SocksProxyAgent({host:e.hostname,port:e.port||void 0}):(u.username&&(e.auth=`${u.username}:${u.password||""}`),d=new n.HttpsProxyAgent(e))}const m=a.timeoutSettings.timeout(e),g={method:l,headers:s,agent:d,maxRedirects:20,timeout:m,deadline:m&&(0,c.monotonicTime)()+m};(e.ignoreHTTPSErrors||a.ignoreHTTPSErrors)&&(g.rejectUnauthorized=!1);const _=new URL(e.url,a.baseURL);if(e.params)for(const{name:t,value:n}of e.params)_.searchParams.set(t,n);let w;if(["POST","PUT","PATCH","DELETE"].includes(l))w=function(e,t){if((0,c.assert)((e.postData?1:0)+(e.jsonData?1:0)+(e.formData?1:0)+(e.multipartData?1:0)<=1,"Only one of 'data', 'form' or 'multipart' can be specified"),void 0!==e.jsonData){var n,r;const i=function(e){if("string"!=typeof e)return!1;try{return JSON.parse(e),!0}catch(e){if(e instanceof SyntaxError)return!1;throw e}}(e.jsonData)?e.jsonData:JSON.stringify(e.jsonData);return null!==(r=t[n="content-type"])&&void 0!==r||(t[n]="application/json"),Buffer.from(i,"utf8")}if(e.formData){var i,o;const n=new URLSearchParams;for(const{name:t,value:r}of e.formData)n.append(t,r);return null!==(o=t[i="content-type"])&&void 0!==o||(t[i]="application/x-www-form-urlencoded"),Buffer.from(n.toString(),"utf8")}if(e.multipartData){var s,a;const n=new h.MultipartFormData;for(const t of e.multipartData)t.file?n.addFileField(t.name,t.file):t.value&&n.addField(t.name,t.value);return null!==(a=t[s="content-type"])&&void 0!==a||(t[s]=n.contentTypeHeader()),n.finish()}var l,u;if(void 0!==e.postData)return null!==(u=t[l="content-type"])&&void 0!==u||(t[l]="application/octet-stream"),Buffer.from(e.postData,"base64");return}(e,s);else if(e.postData||e.jsonData||e.formData||e.multipartData)throw new Error(`Method ${l} does not accept post data`);w&&(s["content-length"]=String(w.byteLength));const v=new f.ProgressController(t,this),b=await v.run((e=>this._sendRequest(e,_,g,w))),y=this._storeResponseBody(b.body);if(this.fetchLog.set(y,v.metadata.log),e.failOnStatusCode&&(b.status<200||b.status>=400))throw new Error(`${b.status} ${b.statusText}`);return{...b,fetchUid:y}}_parseSetCookieHeader(e,t){if(!t)return[];const n=new URL(e),r="/"+n.pathname.substr(1).split("/").slice(0,-1).join("/"),i=[];for(const e of t){const t=x(e);t&&(t.domain?(0,c.assert)(t.domain.startsWith(".")):t.domain=n.hostname,(0,d.domainMatches)(n.hostname,t.domain)&&(t.path&&t.path.startsWith("/")||(t.path=r),i.push(t)))}return i}async _updateRequestCookieHeader(e,t){if(void 0!==t.headers.cookie)return;const n=await this._cookies(e);if(n.length){const e=n.map((e=>`${e.name}=${e.value}`));t.headers.cookie=e.join("; ")}}async _sendRequest(n,r,o,a){var l;await this._updateRequestCookieHeader(r,o);const u=(null===(l=o.headers.cookie)||void 0===l?void 0:l.split(";").map((e=>{const[t,n]=e.split("=").map((e=>e.trim()));return{name:t,value:n}})))||[],d={url:r,method:o.method,headers:o.headers,cookies:u,postData:a};return this.emit(v.Events.Request,d),new Promise(((l,u)=>{const h=(0,("https:"===r.protocol?t:e).request)(r,o,(async e=>{const t=t=>{const n={requestEvent:d,httpVersion:e.httpVersion,statusCode:e.statusCode||0,statusMessage:e.statusMessage||"",headers:e.headers,rawHeaders:e.rawHeaders,cookies:c,body:t};this.emit(v.Events.RequestFinished,n)};n.log(` ${e.statusCode} ${e.statusMessage}`);for(const[t,r]of Object.entries(e.headers))n.log(`  ${t}: ${r}`);const c=this._parseSetCookieHeader(e.url||r.toString(),e.headers["set-cookie"]);if(c.length&&await this._addCookies(c),S.includes(e.statusCode)){if(!o.maxRedirects)return u(new Error("Max redirect count exceeded")),void h.destroy();const i={...o.headers};delete i.cookie;const s=e.statusCode;let c=o.method;((301===s||302===s)&&"POST"===c||303===s&&!["GET","HEAD"].includes(c))&&(c="GET",a=void 0,delete i["content-encoding"],delete i["content-language"],delete i["content-length"],delete i["content-location"],delete i["content-type"]);const d={method:c,headers:i,agent:o.agent,maxRedirects:o.maxRedirects-1,timeout:o.timeout,deadline:o.deadline};if(!1===o.rejectUnauthorized&&(d.rejectUnauthorized=!1),e.headers.location){const i=new URL(e.headers.location,r);return t(),l(this._sendRequest(n,i,d,a)),void h.destroy()}}if(401===e.statusCode&&!o.headers.authorization){const i=e.headers["www-authenticate"],s=this._defaultOptions().httpCredentials;if(null!=i&&i.trim().startsWith("Basic")&&s){const{username:e,password:i}=s,c=Buffer.from(`${e||""}:${i||""}`).toString("base64");return o.headers.authorization=`Basic ${c}`,t(),l(this._sendRequest(n,r,o,a)),void h.destroy()}}e.on("aborted",(()=>u(new Error("aborted"))));const p=[],f=()=>{const n=Buffer.concat(p);t(n),l({url:e.url||r.toString(),status:e.statusCode||0,statusText:e.statusMessage||"",headers:y(e.rawHeaders),body:n})};let m,g=e;const _=e.headers["content-encoding"];if("gzip"===_||"x-gzip"===_?m=s.default.createGunzip({flush:s.default.constants.Z_SYNC_FLUSH,finishFlush:s.default.constants.Z_SYNC_FLUSH}):"br"===_?m=s.default.createBrotliDecompress():"deflate"===_&&(m=s.default.createInflate()),m){const t=new b(f);g=(0,i.pipeline)(e,t,m,(e=>{e&&u(new Error(`failed to decompress '${_}' encoding: ${e}`))}))}g.on("data",(e=>p.push(e))),g.on("end",f),g.on("error",u)}));h.on("error",u);const p=()=>{u(new Error("Request context disposed.")),h.destroy()};if(this.on(v.Events.Dispose,p),h.on("close",(()=>this.off(v.Events.Dispose,p))),n.log(` ${o.method} ${r.toString()}`),o.headers)for(const[e,t]of Object.entries(o.headers))n.log(`  ${e}: ${t}`);if(o.deadline){const e=()=>{u(new Error(`Request timed out after ${o.timeout}ms`)),h.destroy()},t=o.deadline-(0,c.monotonicTime)();if(t<=0)return void e();h.setTimeout(t,e)}a&&h.write(a),h.end()}))}}Oc.APIRequestContext=v,v.Events={Dispose:"dispose",Request:"request",RequestFinished:"requestfinished"},v.allInstances=new Set;class b extends i.Transform{constructor(e){super(),this._receivedSomeData=!1,this._onEmptyStreamCallback=void 0,this._onEmptyStreamCallback=e}_transform(e,t,n){this._receivedSomeData=!0,n(null,e)}_flush(e){this._receivedSomeData?e(null):this._onEmptyStreamCallback()}}Oc.BrowserContextAPIRequestContext=class extends v{constructor(e){super(e),this._context=void 0,this._context=e,e.once(u.BrowserContext.Events.Close,(()=>this._disposeImpl()))}tracing(){return this._context.tracing}async dispose(){this.fetchResponses.clear()}_defaultOptions(){return{userAgent:this._context._options.userAgent||this._context._browser.userAgent(),extraHTTPHeaders:this._context._options.extraHTTPHeaders,httpCredentials:this._context._options.httpCredentials,proxy:this._context._options.proxy||this._context._browser.options.proxy,timeoutSettings:this._context._timeoutSettings,ignoreHTTPSErrors:this._context._options.ignoreHTTPSErrors,baseURL:this._context._options.baseURL}}async _addCookies(e){await this._context.addCookies(e)}async _cookies(e){return await this._context.cookies(e.toString())}async storageState(){return this._context.storageState()}};function y(e){const t=[];for(let n=0;n<e.length;n+=2)t.push({name:e[n],value:e[n+1]});return t}Oc.GlobalAPIRequestContext=class extends v{constructor(e,t){super(e),this._cookieStore=new d.CookieStore,this._options=void 0,this._origins=void 0,this._tracing=void 0,this.attribution.context=this;const n=new a.TimeoutSettings;void 0!==t.timeout&&n.setDefaultTimeout(t.timeout);const r=t.proxy;if(null!=r&&r.server){let e=null==r?void 0:r.server.trim();/^\w+:\/\//.test(e)||(e="http://"+e),r.server=e}t.storageState&&(this._origins=t.storageState.origins,this._cookieStore.addCookies(t.storageState.cookies)),this._options={baseURL:t.baseURL,userAgent:t.userAgent||(0,l.getUserAgent)(),extraHTTPHeaders:t.extraHTTPHeaders,ignoreHTTPSErrors:!!t.ignoreHTTPSErrors,httpCredentials:t.httpCredentials,proxy:r,timeoutSettings:n},this._tracing=new m.Tracing(this,t.tracesDir)}tracing(){return this._tracing}async dispose(){await this._tracing.flush(),await this._tracing.deleteTmpTracesDir(),this._tracing.dispose(),this._disposeImpl()}_defaultOptions(){return this._options}async _addCookies(e){this._cookieStore.addCookies(e)}async _cookies(e){return this._cookieStore.cookies(e)}async storageState(){return{cookies:this._cookieStore.allCookies(),origins:this._origins||[]}}};const S=[301,302,303,307,308];function x(e){const t=e.split(";").filter((e=>e.trim().length>0)).map((e=>{let t="",n="";const r=e.indexOf("=");return-1===r?t=e.trim():(t=e.slice(0,r).trim(),n=e.slice(r+1).trim()),[t,n]}));if(!t.length)return null;const[n,r]=t[0],i={name:n,value:r,domain:"",path:"",expires:-1,httpOnly:!1,secure:!1,sameSite:"Lax"};for(let e=1;e<t.length;e++){const[n,r]=t[e];switch(n.toLowerCase()){case"expires":const e=+new Date(r);isFinite(e)&&(i.expires=e/1e3);break;case"max-age":const t=parseInt(r,10);isFinite(t)&&(i.expires=Date.now()/1e3+t);break;case"domain":i.domain=r.toLocaleLowerCase()||"",i.domain&&!i.domain.startsWith(".")&&(i.domain="."+i.domain);break;case"path":i.path=r||"";break;case"secure":i.secure=!0;break;case"httponly":i.httpOnly=!0}}return i}return Oc}var kx={};Object.defineProperty(kx,"__esModule",{value:!0}),kx.SocksProxyHandler=kx.SocksProxy=void 0;var Ex=Mx(V.default),Cx=Mx(M.default),Tx=Mx(A.default),Px=Mx(N.default),Ox=Ka,Ax=nr,Ix=Ci;function Mx(e){return e&&e.__esModule?e:{default:e}}const Fx=Px.default.promisify(Ex.default.lookup);var Nx,Rx,jx,Dx;!function(e){e[e.NO_AUTHENTICATION_REQUIRED=0]="NO_AUTHENTICATION_REQUIRED",e[e.GSSAPI=1]="GSSAPI",e[e.USERNAME_PASSWORD=2]="USERNAME_PASSWORD",e[e.NO_ACCEPTABLE_METHODS=255]="NO_ACCEPTABLE_METHODS"}(Nx||(Nx={})),function(e){e[e.IPv4=1]="IPv4",e[e.FqName=3]="FqName",e[e.IPv6=4]="IPv6"}(Rx||(Rx={})),function(e){e[e.CONNECT=1]="CONNECT",e[e.BIND=2]="BIND",e[e.UDP_ASSOCIATE=3]="UDP_ASSOCIATE"}(jx||(jx={})),function(e){e[e.Succeeded=0]="Succeeded",e[e.GeneralServerFailure=1]="GeneralServerFailure",e[e.NotAllowedByRuleSet=2]="NotAllowedByRuleSet",e[e.NetworkUnreachable=3]="NetworkUnreachable",e[e.HostUnreachable=4]="HostUnreachable",e[e.ConnectionRefused=5]="ConnectionRefused",e[e.TtlExpired=6]="TtlExpired",e[e.CommandNotSupported=7]="CommandNotSupported",e[e.AddressTypeNotSupported=8]="AddressTypeNotSupported"}(Dx||(Dx={}));class Lx{constructor(e,t,n){this._buffer=Buffer.from([]),this._offset=0,this._fence=0,this._fenceCallback=void 0,this._socket=void 0,this._boundOnData=void 0,this._uid=void 0,this._client=void 0,this._uid=e,this._socket=t,this._client=n,this._boundOnData=this._onData.bind(this),t.on("data",this._boundOnData),t.on("close",(()=>this._onClose())),t.on("end",(()=>this._onClose())),t.on("error",(()=>this._onClose())),this._run().catch((()=>this._socket.end()))}async _run(){(0,Ix.assert)(await this._authenticate());const{command:e,host:t,port:n}=await this._parseRequest();e===jx.CONNECT?(this._socket.off("data",this._boundOnData),this._client.onSocketRequested({uid:this._uid,host:t,port:n})):this._writeBytes(Buffer.from([5,Dx.CommandNotSupported,0,1,0,0,0,0,0,0]))}async _authenticate(){const e=await this._readByte();(0,Ix.assert)(5===e,"The VER field must be set to x05 for this version of the protocol, was "+e);const t=await this._readByte();(0,Ix.assert)(t,"No authentication methods specified");const n=await this._readBytes(t);for(const t of n)if(0===t)return this._writeBytes(Buffer.from([e,t])),!0;return this._writeBytes(Buffer.from([e,Nx.NO_ACCEPTABLE_METHODS])),!1}async _parseRequest(){const e=await this._readByte();(0,Ix.assert)(5===e,"The VER field must be set to x05 for this version of the protocol, was "+e);const t=await this._readByte();await this._readByte();let n="";switch(await this._readByte()){case Rx.IPv4:n=(await this._readBytes(4)).join(".");break;case Rx.FqName:const e=await this._readByte();n=(await this._readBytes(e)).toString();break;case Rx.IPv6:const t=await this._readBytes(16),r=[];for(let e=0;e<8;++e)r.push(t.readUInt16BE(2*e));n=r.join(":")}const r=(await this._readBytes(2)).readUInt16BE(0);return this._buffer=Buffer.from([]),this._offset=0,this._fence=0,{command:t,host:n,port:r}}async _readByte(){return(await this._readBytes(1))[0]}async _readBytes(e){return this._fence=this._offset+e,(!this._buffer||this._buffer.length<this._fence)&&await new Promise((e=>this._fenceCallback=e)),this._offset+=e,this._buffer.slice(this._offset-e,this._offset)}_writeBytes(e){this._socket.writable&&this._socket.write(e)}_onClose(){this._client.onSocketClosed({uid:this._uid})}_onData(e){if(this._buffer=Buffer.concat([this._buffer,e]),this._fenceCallback&&this._buffer.length>=this._fence){const e=this._fenceCallback;this._fenceCallback=void 0,e()}}socketConnected(e,t){this._writeBytes(Buffer.from([5,Dx.Succeeded,0,1,...Bx(e),t<<8,255&t])),this._socket.on("data",(e=>this._client.onSocketData({uid:this._uid,data:e})))}socketFailed(e){const t=Buffer.from([5,0,0,1,...Bx("0.0.0.0"),0,0]);switch(e){case"ENOENT":case"ENOTFOUND":case"ETIMEDOUT":case"EHOSTUNREACH":t[1]=Dx.HostUnreachable;break;case"ENETUNREACH":t[1]=Dx.NetworkUnreachable;break;case"ECONNREFUSED":t[1]=Dx.ConnectionRefused}this._writeBytes(t),this._socket.end()}sendData(e){this._socket.write(e)}end(){this._socket.end()}error(e){this._socket.destroy(new Error(e))}}function Bx(e){if(!Tx.default.isIPv4(e))throw new Error("IPv6 is not supported");return e.split(".",4).map((e=>+e))}class Hx extends Cx.default{constructor(){super(),this._server=void 0,this._connections=new Map,this._server=new Tx.default.Server((e=>{const t=(0,Ix.createGuid)(),n=new Lx(t,e,this);this._connections.set(t,n)}))}async listen(e){return new Promise((t=>{this._server.listen(e,(()=>{const e=this._server.address().port;Ox.debugLogger.log("proxy",`Starting socks proxy server on port ${e}`),t(e)}))}))}async close(){await new Promise((e=>this._server.close(e)))}onSocketRequested(e){this.emit(Hx.Events.SocksRequested,e)}onSocketData(e){this.emit(Hx.Events.SocksData,e)}onSocketClosed(e){this.emit(Hx.Events.SocksClosed,e)}socketConnected({uid:e,host:t,port:n}){var r;null===(r=this._connections.get(e))||void 0===r||r.socketConnected(t,n)}socketFailed({uid:e,errorCode:t}){var n;null===(n=this._connections.get(e))||void 0===n||n.socketFailed(t)}sendSocketData({uid:e,data:t}){var n;null===(n=this._connections.get(e))||void 0===n||n.sendData(t)}sendSocketEnd({uid:e}){var t;null===(t=this._connections.get(e))||void 0===t||t.end()}sendSocketError({uid:e,error:t}){var n;null===(n=this._connections.get(e))||void 0===n||n.error(t)}}kx.SocksProxy=Hx,Hx.Events={SocksRequested:"socksRequested",SocksData:"socksData",SocksClosed:"socksClosed"};class qx extends Cx.default{constructor(e){super(),this._sockets=new Map,this._redirectPortForTest=void 0,this._redirectPortForTest=e}cleanup(){for(const e of this._sockets.keys())this.socketClosed({uid:e})}async socketRequested({uid:e,host:t,port:n}){"local.playwright"===t&&(t="localhost");try{this._redirectPortForTest&&(n=this._redirectPortForTest);const{address:r}=await Fx(t),i=await(0,Ax.createSocket)(r,n);i.on("data",(t=>{const n={uid:e,data:t};this.emit(qx.Events.SocksData,n)})),i.on("error",(t=>{const n={uid:e,error:t.message};this.emit(qx.Events.SocksError,n),this._sockets.delete(e)})),i.on("end",(()=>{const t={uid:e};this.emit(qx.Events.SocksEnd,t),this._sockets.delete(e)}));const o=i.localAddress,s=i.localPort;this._sockets.set(e,i);const a={uid:e,host:o,port:s};this.emit(qx.Events.SocksConnected,a)}catch(t){const n={uid:e,errorCode:t.code};this.emit(qx.Events.SocksFailed,n)}}sendSocketData({uid:e,data:t}){var n;null===(n=this._sockets.get(e))||void 0===n||n.write(t)}socketClosed({uid:e}){var t;null===(t=this._sockets.get(e))||void 0===t||t.destroy(),this._sockets.delete(e)}}kx.SocksProxyHandler=qx,qx.Events={SocksConnected:"socksConnected",SocksData:"socksData",SocksError:"socksError",SocksFailed:"socksFailed",SocksEnd:"socksEnd"};var Ux,Wx,$x={},zx={},Vx={},Gx={},Kx={},Jx={};function Yx(){if(Ux)return Jx;Ux=1,Object.defineProperty(Jx,"__esModule",{value:!0}),Jx.JSHandleDispatcher=void 0,Jx.parseArgument=i,Jx.parseValue=function(e){return(0,n.parseSerializedValue)(e,[])},Jx.serializeResult=o;var e=Pl,t=Xx(),n=Ol;class r extends e.Dispatcher{constructor(e,t){super(e,t,t.asElement()?"ElementHandle":"JSHandle",{preview:t.toString()}),this._type_JSHandle=!0,t._setPreviewCallback((e=>this._dispatchEvent("previewUpdated",{preview:e})))}async evaluateExpression(e){return{value:o(await this._object.evaluateExpressionAndWaitForSignals(e.expression,e.isFunction,!0,i(e.arg)))}}async evaluateExpressionHandle(e){const n=await this._object.evaluateExpressionAndWaitForSignals(e.expression,e.isFunction,!1,i(e.arg));return{handle:t.ElementHandleDispatcher.fromJSHandle(this._scope,n)}}async getProperty(e){const n=await this._object.getProperty(e.name);return{handle:t.ElementHandleDispatcher.fromJSHandle(this._scope,n)}}async getPropertyList(){const e=await this._object.getProperties(),n=[];for(const[r,i]of e)n.push({name:r,value:t.ElementHandleDispatcher.fromJSHandle(this._scope,i)});return{properties:n}}async jsonValue(){return{value:o(await this._object.jsonValue())}}async dispose(){await this._object.dispose()}}function i(e){return(0,n.parseSerializedValue)(e.value,e.handles.map((e=>e._object)))}function o(e){return(0,n.serializeValue)(e,(e=>({fallThrough:e})),new Set)}return Jx.JSHandleDispatcher=r,Jx}function Xx(){if(Wx)return Kx;Wx=1,Object.defineProperty(Kx,"__esModule",{value:!0}),Kx.ElementHandleDispatcher=void 0;var e=Pl,t=Yx();class n extends t.JSHandleDispatcher{static from(t,r){return(0,e.existingDispatcher)(r)||new n(t,r)}static fromNullable(t,r){if(r)return(0,e.existingDispatcher)(r)||new n(t,r)}static fromJSHandle(r,i){const o=(0,e.existingDispatcher)(i);return o||(i.asElement()?new n(r,i.asElement()):new t.JSHandleDispatcher(r,i))}constructor(e,t){super(e,t),this._type_ElementHandle=!0,this._elementHandle=void 0,this._elementHandle=t}async ownerFrame(t,n){return{frame:(0,e.lookupNullableDispatcher)(await this._elementHandle.ownerFrame())}}async contentFrame(t,n){return{frame:(0,e.lookupNullableDispatcher)(await this._elementHandle.contentFrame())}}async getAttribute(e,t){const n=await this._elementHandle.getAttribute(e.name);return{value:null===n?void 0:n}}async inputValue(e,t){return{value:await this._elementHandle.inputValue()}}async textContent(e,t){const n=await this._elementHandle.textContent();return{value:null===n?void 0:n}}async innerText(e,t){return{value:await this._elementHandle.innerText()}}async innerHTML(e,t){return{value:await this._elementHandle.innerHTML()}}async isChecked(e,t){return{value:await this._elementHandle.isChecked()}}async isDisabled(e,t){return{value:await this._elementHandle.isDisabled()}}async isEditable(e,t){return{value:await this._elementHandle.isEditable()}}async isEnabled(e,t){return{value:await this._elementHandle.isEnabled()}}async isHidden(e,t){return{value:await this._elementHandle.isHidden()}}async isVisible(e,t){return{value:await this._elementHandle.isVisible()}}async dispatchEvent(e,n){await this._elementHandle.dispatchEvent(e.type,(0,t.parseArgument)(e.eventInit))}async scrollIntoViewIfNeeded(e,t){await this._elementHandle.scrollIntoViewIfNeeded(t,e)}async hover(e,t){return await this._elementHandle.hover(t,e)}async click(e,t){return await this._elementHandle.click(t,e)}async dblclick(e,t){return await this._elementHandle.dblclick(t,e)}async tap(e,t){return await this._elementHandle.tap(t,e)}async selectOption(e,t){const n=(e.elements||[]).map((e=>e._elementHandle));return{values:await this._elementHandle.selectOption(t,n,e.options||[],e)}}async fill(e,t){return await this._elementHandle.fill(t,e.value,e)}async selectText(e,t){await this._elementHandle.selectText(t,e)}async setInputFiles(e,t){return await this._elementHandle.setInputFiles(t,{files:e.files},e)}async setInputFilePaths(e,t){let{localPaths:n}=e;if(!n){if(!e.streams)throw new Error("Neither localPaths nor streams is specified");n=e.streams.map((e=>e.path()))}return await this._elementHandle.setInputFiles(t,{localPaths:n},e)}async focus(e,t){await this._elementHandle.focus(t)}async type(e,t){return await this._elementHandle.type(t,e.text,e)}async press(e,t){return await this._elementHandle.press(t,e.key,e)}async check(e,t){return await this._elementHandle.check(t,e)}async uncheck(e,t){return await this._elementHandle.uncheck(t,e)}async boundingBox(e,t){return{value:await this._elementHandle.boundingBox()||void 0}}async screenshot(e,t){const n=(e.mask||[]).map((({frame:e,selector:t})=>({frame:e._object,selector:t})));return{binary:(await this._elementHandle.screenshot(t,{...e,mask:n})).toString("base64")}}async querySelector(e,t){const r=await this._elementHandle.querySelector(e.selector,e);return{element:n.fromNullable(this._scope,r)}}async querySelectorAll(e,t){return{elements:(await this._elementHandle.querySelectorAll(e.selector)).map((e=>n.from(this._scope,e)))}}async evalOnSelector(e,n){return{value:(0,t.serializeResult)(await this._elementHandle.evalOnSelectorAndWaitForSignals(e.selector,!!e.strict,e.expression,e.isFunction,(0,t.parseArgument)(e.arg)))}}async evalOnSelectorAll(e,n){return{value:(0,t.serializeResult)(await this._elementHandle.evalOnSelectorAllAndWaitForSignals(e.selector,e.expression,e.isFunction,(0,t.parseArgument)(e.arg)))}}async waitForElementState(e,t){await this._elementHandle.waitForElementState(t,e.state,e)}async waitForSelector(e,t){return{element:n.fromNullable(this._scope,await this._elementHandle.waitForSelector(t,e.selector,e))}}}return Kx.ElementHandleDispatcher=n,Kx}Object.defineProperty(Gx,"__esModule",{value:!0}),Gx.ConsoleMessageDispatcher=void 0;var Qx=Pl,Zx=Xx();class ek extends Qx.Dispatcher{constructor(e,t){super(e,t,"ConsoleMessage",{type:t.type(),text:t.text(),args:t.args().map((t=>Zx.ElementHandleDispatcher.fromJSHandle(e,t))),location:t.location()}),this._type_ConsoleMessage=!0}}Gx.ConsoleMessageDispatcher=ek;var tk={};Object.defineProperty(tk,"__esModule",{value:!0}),tk.DialogDispatcher=void 0;var nk=Pl;class rk extends nk.Dispatcher{constructor(e,t){super(e,t,"Dialog",{type:t.type(),message:t.message(),defaultValue:t.defaultValue()}),this._type_Dialog=!0}async accept(e){await this._object.accept(e.promptText)}async dismiss(){await this._object.dismiss()}}tk.DialogDispatcher=rk;var ik={},ok={},sk={},ak={},lk={};Object.defineProperty(lk,"__esModule",{value:!0}),lk.StreamDispatcher=void 0;var ck=Pl,uk=Ci;class dk extends ck.Dispatcher{constructor(e,t){super(e,{guid:"stream@"+(0,uk.createGuid)(),stream:t},"Stream",{}),this._type_Stream=!0,this._ended=!1,t.once("end",(()=>this._ended=!0)),t.once("error",(()=>this._ended=!0))}async read(e){const t=this._object.stream;if(this._ended)return{binary:""};t.readableLength||await new Promise(((e,n)=>{t.once("readable",e),t.once("end",e),t.once("error",n)}));const n=t.read(Math.min(t.readableLength,e.size||t.readableLength));return{binary:n?n.toString("base64"):""}}async close(){this._object.stream.destroy()}}lk.StreamDispatcher=dk,Object.defineProperty(ak,"__esModule",{value:!0}),ak.ArtifactDispatcher=void 0;var hk=Pl,pk=lk,fk=function(e){return e&&e.__esModule?e:{default:e}}(C.default),mk=Ri;class gk extends hk.Dispatcher{constructor(e,t){super(e,t,"Artifact",{absolutePath:t.localPath()}),this._type_Artifact=!0}async pathAfterFinished(){return{value:await this._object.localPathAfterFinished()||void 0}}async saveAs(e){return await new Promise(((t,n)=>{this._object.saveAs((async(r,i)=>{if(void 0===i)try{await(0,mk.mkdirIfNeeded)(e.path),await fk.default.promises.copyFile(r,e.path),t()}catch(e){n(e)}else n(new Error(i))}))}))}async saveAsStream(){return await new Promise(((e,t)=>{this._object.saveAs((async(n,r)=>{if(void 0===r)try{const t=fk.default.createReadStream(n),r=new pk.StreamDispatcher(this._scope,t);e({stream:r}),await new Promise((e=>{t.on("close",e),t.on("end",e),t.on("error",e)}))}catch(e){t(e)}else t(new Error(r))}))}))}async stream(){const e=await this._object.localPathAfterFinished();if(!e)return{};const t=fk.default.createReadStream(e);return{stream:new pk.StreamDispatcher(this._scope,t)}}async failure(){return{error:await this._object.failureError()||void 0}}async cancel(){await this._object.cancel()}async delete(){await this._object.delete(),this._dispose()}}ak.ArtifactDispatcher=gk,Object.defineProperty(sk,"__esModule",{value:!0}),sk.TracingDispatcher=void 0;var _k,wk,vk=Kp(),bk=ak,yk=Pl;class Sk extends yk.Dispatcher{static from(e,t){return(0,yk.existingDispatcher)(t)||new Sk(e,t)}constructor(e,t){super(e,t,"Tracing",{},!0),this._type_Tracing=!0,t.on(vk.Tracing.Events.Dispose,(()=>this._dispose()))}async tracingStart(e){await this._object.start(e)}async tracingStartChunk(e){await this._object.startChunk(e)}async tracingStopChunk(e){const{artifact:t,sourceEntries:n}=await this._object.stopChunk(e);return{artifact:t?new bk.ArtifactDispatcher(this._scope,t):void 0,sourceEntries:n}}async tracingStop(e){await this._object.stop()}}function xk(){if(_k)return ok;_k=1,Object.defineProperty(ok,"__esModule",{value:!0}),ok.WebSocketDispatcher=ok.RouteDispatcher=ok.ResponseDispatcher=ok.RequestDispatcher=ok.APIRequestContextDispatcher=void 0;var e=xx(),t=_u(),n=Pl,r=kk(),i=sk;class o extends n.Dispatcher{static from(e,t){return(0,n.existingDispatcher)(t)||new o(e,t)}static fromNullable(e,t){return t?o.from(e,t):void 0}constructor(e,t){const n=t.postDataBuffer();super(e,t,"Request",{frame:r.FrameDispatcher.from(e,t.frame()),url:t.url(),resourceType:t.resourceType(),method:t.method(),postData:null===n?void 0:n.toString("base64"),headers:t.headers(),isNavigationRequest:t.isNavigationRequest(),redirectedFrom:o.fromNullable(e,t.redirectedFrom())}),this._type_Request=void 0,this._type_Request=!0}async rawRequestHeaders(e){return{headers:await this._object.rawRequestHeaders()}}async response(){return{response:(0,n.lookupNullableDispatcher)(await this._object.response())}}}ok.RequestDispatcher=o;class s extends n.Dispatcher{static from(e,t){return(0,n.existingDispatcher)(t)||new s(e,t)}static fromNullable(e,t){return t?s.from(e,t):void 0}constructor(e,t){super(e,t,"Response",{request:o.from(e,t.request()),url:t.url(),status:t.status(),statusText:t.statusText(),headers:t.headers(),timing:t.timing()}),this._type_Response=!0}async body(){return{binary:(await this._object.body()).toString("base64")}}async securityDetails(){return{value:await this._object.securityDetails()||void 0}}async serverAddr(){return{value:await this._object.serverAddr()||void 0}}async rawResponseHeaders(e){return{headers:await this._object.rawResponseHeaders()}}async sizes(e){return{sizes:await this._object.sizes()}}}ok.ResponseDispatcher=s;class a extends n.Dispatcher{static from(e,t){return(0,n.existingDispatcher)(t)||new a(e,t)}constructor(e,t){super(e,t,"Route",{request:o.from(e,t.request())}),this._type_Route=!0}async continue(e,t){await this._object.continue({url:e.url,method:e.method,headers:e.headers,postData:void 0!==e.postData?Buffer.from(e.postData,"base64"):void 0})}async fulfill(e){await this._object.fulfill(e)}async abort(e){await this._object.abort(e.errorCode||"failed")}}ok.RouteDispatcher=a;class l extends n.Dispatcher{constructor(e,n){super(e,n,"WebSocket",{url:n.url()}),this._type_EventTarget=!0,this._type_WebSocket=!0,n.on(t.WebSocket.Events.FrameSent,(e=>this._dispatchEvent("frameSent",e))),n.on(t.WebSocket.Events.FrameReceived,(e=>this._dispatchEvent("frameReceived",e))),n.on(t.WebSocket.Events.SocketError,(e=>this._dispatchEvent("socketError",{error:e}))),n.on(t.WebSocket.Events.Close,(()=>this._dispatchEvent("close",{})))}}ok.WebSocketDispatcher=l;class c extends n.Dispatcher{static from(e,t){return(0,n.existingDispatcher)(t)||new c(e,t)}static fromNullable(e,t){return t?c.from(e,t):void 0}constructor(t,n){super(t,n,"APIRequestContext",{tracing:i.TracingDispatcher.from(t,n.tracing())},!0),this._type_APIRequestContext=!0,n.once(e.APIRequestContext.Events.Dispose,(()=>{this._disposed||super._dispose()}))}async storageState(e){return this._object.storageState()}async dispose(e){await this._object.dispose()}async fetch(e,t){const n=await this._object.fetch(e,t);return{response:{url:n.url,status:n.status,statusText:n.statusText,headers:n.headers,fetchUid:n.fetchUid}}}async fetchResponseBody(e,t){const n=this._object.fetchResponses.get(e.fetchUid);return{binary:n?n.toString("base64"):void 0}}async fetchLog(e,t){return{log:this._object.fetchLog.get(e.fetchUid)||[]}}async disposeAPIResponse(e,t){this._object.disposeResponse(e.fetchUid)}}return ok.APIRequestContextDispatcher=c,ok}function kk(){if(wk)return ik;wk=1,Object.defineProperty(ik,"__esModule",{value:!0}),ik.FrameDispatcher=void 0;var e=yd(),t=Pl,n=Xx(),r=Yx(),i=xk();class o extends t.Dispatcher{static from(e,n){return(0,t.existingDispatcher)(n)||new o(e,n)}static fromNullable(e,t){if(t)return o.from(e,t)}constructor(t,n){super(t,n,"Frame",{url:n.url(),name:n.name(),parentFrame:o.fromNullable(t,n.parentFrame()),loadStates:Array.from(n._subtreeLifecycleEvents)}),this._type_Frame=!0,this._frame=void 0,this._frame=n,n.on(e.Frame.Events.AddLifecycle,(e=>{this._dispatchEvent("loadstate",{add:e})})),n.on(e.Frame.Events.RemoveLifecycle,(e=>{this._dispatchEvent("loadstate",{remove:e})})),n.on(e.Frame.Events.Navigation,(e=>{const t={url:e.url,name:e.name,error:e.error?e.error.message:void 0};e.newDocument&&(t.newDocument={request:i.RequestDispatcher.fromNullable(this._scope,e.newDocument.request||null)}),this._dispatchEvent("navigated",t)}))}async goto(e,n){return{response:(0,t.lookupNullableDispatcher)(await this._frame.goto(n,e.url,e))}}async frameElement(){return{element:n.ElementHandleDispatcher.from(this._scope,await this._frame.frameElement())}}async evaluateExpression(e,t){return{value:(0,r.serializeResult)(await this._frame.evaluateExpressionAndWaitForSignals(e.expression,e.isFunction,(0,r.parseArgument)(e.arg),"main"))}}async evaluateExpressionHandle(e,t){return{handle:n.ElementHandleDispatcher.fromJSHandle(this._scope,await this._frame.evaluateExpressionHandleAndWaitForSignals(e.expression,e.isFunction,(0,r.parseArgument)(e.arg),"main"))}}async waitForSelector(e,t){return{element:n.ElementHandleDispatcher.fromNullable(this._scope,await this._frame.waitForSelector(t,e.selector,e))}}async dispatchEvent(e,t){return this._frame.dispatchEvent(t,e.selector,e.type,(0,r.parseArgument)(e.eventInit),e)}async evalOnSelector(e,t){return{value:(0,r.serializeResult)(await this._frame.evalOnSelectorAndWaitForSignals(e.selector,!!e.strict,e.expression,e.isFunction,(0,r.parseArgument)(e.arg)))}}async evalOnSelectorAll(e,t){return{value:(0,r.serializeResult)(await this._frame.evalOnSelectorAllAndWaitForSignals(e.selector,e.expression,e.isFunction,(0,r.parseArgument)(e.arg)))}}async querySelector(e,t){return{element:n.ElementHandleDispatcher.fromNullable(this._scope,await this._frame.querySelector(e.selector,e))}}async querySelectorAll(e,t){return{elements:(await this._frame.querySelectorAll(e.selector)).map((e=>n.ElementHandleDispatcher.from(this._scope,e)))}}async queryCount(e){return{value:await this._frame.queryCount(e.selector)}}async content(){return{value:await this._frame.content()}}async setContent(e,t){return await this._frame.setContent(t,e.html,e)}async addScriptTag(e,t){return{element:n.ElementHandleDispatcher.from(this._scope,await this._frame.addScriptTag(e))}}async addStyleTag(e,t){return{element:n.ElementHandleDispatcher.from(this._scope,await this._frame.addStyleTag(e))}}async click(e,t){return await this._frame.click(t,e.selector,e)}async dblclick(e,t){return await this._frame.dblclick(t,e.selector,e)}async dragAndDrop(e,t){return await this._frame.dragAndDrop(t,e.source,e.target,e)}async tap(e,t){return await this._frame.tap(t,e.selector,e)}async fill(e,t){return await this._frame.fill(t,e.selector,e.value,e)}async focus(e,t){await this._frame.focus(t,e.selector,e)}async textContent(e,t){const n=await this._frame.textContent(t,e.selector,e);return{value:null===n?void 0:n}}async innerText(e,t){return{value:await this._frame.innerText(t,e.selector,e)}}async innerHTML(e,t){return{value:await this._frame.innerHTML(t,e.selector,e)}}async getAttribute(e,t){const n=await this._frame.getAttribute(t,e.selector,e.name,e);return{value:null===n?void 0:n}}async inputValue(e,t){return{value:await this._frame.inputValue(t,e.selector,e)}}async isChecked(e,t){return{value:await this._frame.isChecked(t,e.selector,e)}}async isDisabled(e,t){return{value:await this._frame.isDisabled(t,e.selector,e)}}async isEditable(e,t){return{value:await this._frame.isEditable(t,e.selector,e)}}async isEnabled(e,t){return{value:await this._frame.isEnabled(t,e.selector,e)}}async isHidden(e,t){return{value:await this._frame.isHidden(t,e.selector,e)}}async isVisible(e,t){return{value:await this._frame.isVisible(t,e.selector,e)}}async hover(e,t){return await this._frame.hover(t,e.selector,e)}async selectOption(e,t){const n=(e.elements||[]).map((e=>e._elementHandle));return{values:await this._frame.selectOption(t,e.selector,n,e.options||[],e)}}async setInputFiles(e,t){return await this._frame.setInputFiles(t,e.selector,{files:e.files},e)}async setInputFilePaths(e,t){let{localPaths:n}=e;if(!n){if(!e.streams)throw new Error("Neither localPaths nor streams is specified");n=e.streams.map((e=>e.path()))}return await this._frame.setInputFiles(t,e.selector,{localPaths:n},e)}async type(e,t){return await this._frame.type(t,e.selector,e.text,e)}async press(e,t){return await this._frame.press(t,e.selector,e.key,e)}async check(e,t){return await this._frame.check(t,e.selector,e)}async uncheck(e,t){return await this._frame.uncheck(t,e.selector,e)}async waitForTimeout(e,t){return await this._frame.waitForTimeout(t,e.timeout)}async waitForFunction(e,t){return{handle:n.ElementHandleDispatcher.fromJSHandle(this._scope,await this._frame._waitForFunctionExpression(t,e.expression,e.isFunction,(0,r.parseArgument)(e.arg),e))}}async title(e,t){return{value:await this._frame.title()}}async highlight(e,t){return await this._frame.highlight(e.selector)}async expect(e,t){const n=e.expectedValue?(0,r.parseArgument)(e.expectedValue):void 0,i=await this._frame.expect(t,e.selector,{...e,expectedValue:n});return void 0!==i.received&&(i.received=(0,r.serializeResult)(i.received)),i.matches===e.isNot&&(t.error={error:{name:"Expect",message:"Expect failed"}}),i}}return ik.FrameDispatcher=o,ik}sk.TracingDispatcher=Sk,Object.defineProperty(Vx,"__esModule",{value:!0}),Vx.WorkerDispatcher=Vx.PageDispatcher=Vx.BindingCallDispatcher=void 0;var Ek=Uh(),Ck=Pl,Tk=Ol,Pk=Gx,Ok=tk,Ak=kk(),Ik=xk(),Mk=Yx(),Fk=Xx(),Nk=ak,Rk=Ci;class jk extends Ck.Dispatcher{static fromNullable(e,t){if(!t)return;return(0,Ck.existingDispatcher)(t)||new jk(e,t)}constructor(e,t){super(e,t,"Page",{mainFrame:Ak.FrameDispatcher.from(e,t.mainFrame()),viewportSize:t.viewportSize()||void 0,isClosed:t.isClosed(),opener:jk.fromNullable(e,t.opener())},!0),this._type_EventTarget=!0,this._type_Page=!0,this._page=void 0,this._page=t,t.on(Ek.Page.Events.Close,(()=>{this._dispatchEvent("close"),this._dispose()})),t.on(Ek.Page.Events.Console,(e=>this._dispatchEvent("console",{message:new Pk.ConsoleMessageDispatcher(this._scope,e)}))),t.on(Ek.Page.Events.Crash,(()=>this._dispatchEvent("crash"))),t.on(Ek.Page.Events.DOMContentLoaded,(()=>this._dispatchEvent("domcontentloaded"))),t.on(Ek.Page.Events.Dialog,(e=>this._dispatchEvent("dialog",{dialog:new Ok.DialogDispatcher(this._scope,e)}))),t.on(Ek.Page.Events.Download,(t=>{this._dispatchEvent("download",{url:t.url,suggestedFilename:t.suggestedFilename(),artifact:new Nk.ArtifactDispatcher(e,t.artifact)})})),this._page.on(Ek.Page.Events.FileChooser,(e=>this._dispatchEvent("fileChooser",{element:Fk.ElementHandleDispatcher.from(this._scope,e.element()),isMultiple:e.isMultiple()}))),t.on(Ek.Page.Events.FrameAttached,(e=>this._onFrameAttached(e))),t.on(Ek.Page.Events.FrameDetached,(e=>this._onFrameDetached(e))),t.on(Ek.Page.Events.Load,(()=>this._dispatchEvent("load"))),t.on(Ek.Page.Events.PageError,(e=>this._dispatchEvent("pageError",{error:(0,Tk.serializeError)(e)}))),t.on(Ek.Page.Events.WebSocket,(e=>this._dispatchEvent("webSocket",{webSocket:new Ik.WebSocketDispatcher(this._scope,e)}))),t.on(Ek.Page.Events.Worker,(e=>this._dispatchEvent("worker",{worker:new Dk(this._scope,e)}))),t.on(Ek.Page.Events.Video,(e=>this._dispatchEvent("video",{artifact:(0,Ck.existingDispatcher)(e)}))),t._video&&this._dispatchEvent("video",{artifact:(0,Ck.existingDispatcher)(t._video)});const n=t._frameManager.frames();for(let e=1;e<n.length;e++)this._onFrameAttached(n[e])}page(){return this._page}async setDefaultNavigationTimeoutNoReply(e,t){this._page.setDefaultNavigationTimeout(e.timeout)}async setDefaultTimeoutNoReply(e,t){this._page.setDefaultTimeout(e.timeout)}async exposeBinding(e,t){await this._page.exposeBinding(e.name,!!e.needsHandle,((t,...n)=>{const r=new Lk(this._scope,e.name,!!e.needsHandle,t,n);return this._dispatchEvent("bindingCall",{binding:r}),r.promise()}))}async removeExposedBindings(){await this._page.removeExposedBindings()}async setExtraHTTPHeaders(e,t){await this._page.setExtraHTTPHeaders(e.headers)}async reload(e,t){return{response:(0,Ck.lookupNullableDispatcher)(await this._page.reload(t,e))}}async goBack(e,t){return{response:(0,Ck.lookupNullableDispatcher)(await this._page.goBack(t,e))}}async goForward(e,t){return{response:(0,Ck.lookupNullableDispatcher)(await this._page.goForward(t,e))}}async emulateMedia(e,t){await this._page.emulateMedia({media:"null"===e.media?null:e.media,colorScheme:"null"===e.colorScheme?null:e.colorScheme,reducedMotion:"null"===e.reducedMotion?null:e.reducedMotion,forcedColors:"null"===e.forcedColors?null:e.forcedColors})}async setViewportSize(e,t){await this._page.setViewportSize(e.viewportSize)}async addInitScript(e,t){await this._page.addInitScript(e.source)}async removeInitScripts(){await this._page.removeInitScripts()}async setNetworkInterceptionEnabled(e,t){e.enabled?await this._page.setClientRequestInterceptor(((e,t)=>{this._dispatchEvent("route",{route:Ik.RouteDispatcher.from(this._scope,e),request:Ik.RequestDispatcher.from(this._scope,t)})})):await this._page.setClientRequestInterceptor(void 0)}async expectScreenshot(e,t){var n,r,i,o;const s=((null===(n=e.screenshotOptions)||void 0===n?void 0:n.mask)||[]).map((({frame:e,selector:t})=>({frame:e._object,selector:t}))),a=e.locator?{frame:e.locator.frame._object,selector:e.locator.selector}:void 0,l=e.expected?Buffer.from(e.expected,"base64"):void 0,c=await this._page.expectScreenshot(t,{...e,expected:l,locator:a,screenshotOptions:{...e.screenshotOptions,mask:s}});return{diff:null===(r=c.diff)||void 0===r?void 0:r.toString("base64"),errorMessage:c.errorMessage,actual:null===(i=c.actual)||void 0===i?void 0:i.toString("base64"),previous:null===(o=c.previous)||void 0===o?void 0:o.toString("base64"),log:c.log}}async screenshot(e,t){const n=(e.mask||[]).map((({frame:e,selector:t})=>({frame:e._object,selector:t})));return{binary:(await this._page.screenshot(t,{...e,mask:n})).toString("base64")}}async close(e,t){await this._page.close(t,e)}async setFileChooserInterceptedNoReply(e,t){await this._page.setFileChooserIntercepted(e.intercepted)}async keyboardDown(e,t){await this._page.keyboard.down(e.key)}async keyboardUp(e,t){await this._page.keyboard.up(e.key)}async keyboardInsertText(e,t){await this._page.keyboard.insertText(e.text)}async keyboardType(e,t){await this._page.keyboard.type(e.text,e)}async keyboardPress(e,t){await this._page.keyboard.press(e.key,e)}async mouseMove(e,t){await this._page.mouse.move(e.x,e.y,e)}async mouseDown(e,t){await this._page.mouse.down(e)}async mouseUp(e,t){await this._page.mouse.up(e)}async mouseClick(e,t){await this._page.mouse.click(e.x,e.y,e)}async mouseWheel(e,t){await this._page.mouse.wheel(e.deltaX,e.deltaY)}async touchscreenTap(e,t){await this._page.touchscreen.tap(e.x,e.y)}async accessibilitySnapshot(e,t){return{rootAXNode:await this._page.accessibility.snapshot({interestingOnly:e.interestingOnly,root:e.root?e.root._elementHandle:void 0})||void 0}}async pdf(e,t){if(!this._page.pdf)throw new Error("PDF generation is only supported for Headless Chromium");return{pdf:(await this._page.pdf(e)).toString("base64")}}async bringToFront(e,t){await this._page.bringToFront()}async startJSCoverage(e,t){const n=this._page.coverage;await n.startJSCoverage(e)}async stopJSCoverage(e,t){const n=this._page.coverage;return{entries:await n.stopJSCoverage()}}async startCSSCoverage(e,t){const n=this._page.coverage;await n.startCSSCoverage(e)}async stopCSSCoverage(e,t){const n=this._page.coverage;return{entries:await n.stopCSSCoverage()}}_onFrameAttached(e){this._dispatchEvent("frameAttached",{frame:Ak.FrameDispatcher.from(this._scope,e)})}_onFrameDetached(e){this._dispatchEvent("frameDetached",{frame:(0,Ck.lookupDispatcher)(e)})}}Vx.PageDispatcher=jk;class Dk extends Ck.Dispatcher{constructor(e,t){super(e,t,"Worker",{url:t.url()}),this._type_Worker=!0,t.on(Ek.Worker.Events.Close,(()=>this._dispatchEvent("close")))}async evaluateExpression(e,t){return{value:(0,Mk.serializeResult)(await this._object.evaluateExpression(e.expression,e.isFunction,(0,Mk.parseArgument)(e.arg)))}}async evaluateExpressionHandle(e,t){return{handle:Fk.ElementHandleDispatcher.fromJSHandle(this._scope,await this._object.evaluateExpressionHandle(e.expression,e.isFunction,(0,Mk.parseArgument)(e.arg)))}}}Vx.WorkerDispatcher=Dk;class Lk extends Ck.Dispatcher{constructor(e,t,n,r,i){super(e,{guid:"bindingCall@"+(0,Rk.createGuid)()},"BindingCall",{frame:(0,Ck.lookupDispatcher)(r.frame),name:t,args:n?void 0:i.map(Mk.serializeResult),handle:n?Fk.ElementHandleDispatcher.fromJSHandle(e,i[0]):void 0}),this._type_BindingCall=!0,this._resolve=void 0,this._reject=void 0,this._promise=void 0,this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}promise(){return this._promise}async resolve(e,t){this._resolve((0,Mk.parseArgument)(e.result))}async reject(e,t){this._reject((0,Tk.parseError)(e.error))}}Vx.BindingCallDispatcher=Lk;var Bk={};Object.defineProperty(Bk,"__esModule",{value:!0}),Bk.CDPSessionDispatcher=void 0;var Hk=Z_,qk=Pl;class Uk extends qk.Dispatcher{constructor(e,t){super(e,t,"CDPSession",{},!0),this._type_CDPSession=!0,t._eventListener=(e,t)=>{this._dispatchEvent("event",{method:e,params:t})},t.on(Hk.CRSessionEvents.Disconnected,(()=>this._dispose()))}async send(e){return{result:await this._object.send(e.method,e.params)}}async detach(){return this._object.detach()}}Bk.CDPSessionDispatcher=Uk;var Wk={};Object.defineProperty(Wk,"__esModule",{value:!0}),Wk.WritableStreamDispatcher=void 0;var $k=Pl,zk=Ci;class Vk extends $k.Dispatcher{constructor(e,t){super(e,{guid:"writableStream@"+(0,zk.createGuid)(),stream:t},"WritableStream",{}),this._type_WritableStream=!0}async write(e){const t=this._object.stream;await new Promise(((n,r)=>{t.write(Buffer.from(e.binary,"base64"),(e=>{e?r(e):n()}))}))}async close(){const e=this._object.stream;await new Promise((t=>e.end(t)))}path(){return this._object.stream.path}}Wk.WritableStreamDispatcher=Vk,Object.defineProperty(zx,"__esModule",{value:!0}),zx.BrowserContextDispatcher=void 0;var Gk=fx(),Kk=Pl,Jk=Vx,Yk=xk(),Xk=_v(),Qk=Bk,Zk=px(),eE=ak,tE=sk,nE=aE(C.default),rE=aE(T.default),iE=Ci,oE=Wk;function sE(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(sE=function(e){return e?n:t})(e)}function aE(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=sE(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}class lE extends Kk.Dispatcher{constructor(e,t){super(e,t,"BrowserContext",{isChromium:t._browser.options.isChromium,APIRequestContext:Yk.APIRequestContextDispatcher.from(e,t.fetchRequest),tracing:tE.TracingDispatcher.from(e,t.tracing)},!0),this._type_EventTarget=!0,this._type_BrowserContext=!0,this._context=void 0,this._context=t;const n=t=>{const n=new eE.ArtifactDispatcher(e,t);this._dispatchEvent("video",{artifact:n})};t.on(Gk.BrowserContext.Events.VideoStarted,n);for(const e of t._browser._idToVideo.values())e.context===t&&n(e.artifact);for(const e of t.pages())this._dispatchEvent("page",{page:new Jk.PageDispatcher(this._scope,e)});if(t.on(Gk.BrowserContext.Events.Page,(e=>this._dispatchEvent("page",{page:new Jk.PageDispatcher(this._scope,e)}))),t.on(Gk.BrowserContext.Events.Close,(()=>{this._dispatchEvent("close"),this._dispose()})),"chromium"===t._browser.options.name){for(const e of t.backgroundPages())this._dispatchEvent("backgroundPage",{page:new Jk.PageDispatcher(this._scope,e)});t.on(Xk.CRBrowserContext.CREvents.BackgroundPage,(e=>this._dispatchEvent("backgroundPage",{page:new Jk.PageDispatcher(this._scope,e)})));for(const e of t.serviceWorkers())this._dispatchEvent("serviceWorker",{worker:new Jk.WorkerDispatcher(this._scope,e)});t.on(Xk.CRBrowserContext.CREvents.ServiceWorker,(e=>this._dispatchEvent("serviceWorker",{worker:new Jk.WorkerDispatcher(this._scope,e)})))}t.on(Gk.BrowserContext.Events.Request,(e=>this._dispatchEvent("request",{request:Yk.RequestDispatcher.from(this._scope,e),page:Jk.PageDispatcher.fromNullable(this._scope,e.frame()._page.initializedOrUndefined())}))),t.on(Gk.BrowserContext.Events.Response,(e=>this._dispatchEvent("response",{response:Yk.ResponseDispatcher.from(this._scope,e),page:Jk.PageDispatcher.fromNullable(this._scope,e.frame()._page.initializedOrUndefined())}))),t.on(Gk.BrowserContext.Events.RequestFailed,(e=>this._dispatchEvent("requestFailed",{request:Yk.RequestDispatcher.from(this._scope,e),failureText:e._failureText||void 0,responseEndTiming:e._responseEndTiming,page:Jk.PageDispatcher.fromNullable(this._scope,e.frame()._page.initializedOrUndefined())}))),t.on(Gk.BrowserContext.Events.RequestFinished,(({request:t,response:n})=>this._dispatchEvent("requestFinished",{request:Yk.RequestDispatcher.from(e,t),response:Yk.ResponseDispatcher.fromNullable(e,n),responseEndTiming:t._responseEndTiming,page:Jk.PageDispatcher.fromNullable(this._scope,t.frame()._page.initializedOrUndefined())})))}async createTempFile(e,t){const n=this._context._browser.options.artifactsDir,r=rE.join(n,"upload-"+(0,iE.createGuid)());await nE.promises.mkdir(r),this._context._tempDirs.push(r);const i=nE.createWriteStream(rE.join(r,e.name));return{writableStream:new oE.WritableStreamDispatcher(this._scope,i)}}async setDefaultNavigationTimeoutNoReply(e){this._context.setDefaultNavigationTimeout(e.timeout)}async setDefaultTimeoutNoReply(e){this._context.setDefaultTimeout(e.timeout)}async exposeBinding(e){await this._context.exposeBinding(e.name,!!e.needsHandle,((t,...n)=>{const r=new Jk.BindingCallDispatcher(this._scope,e.name,!!e.needsHandle,t,n);return this._dispatchEvent("bindingCall",{binding:r}),r.promise()}))}async removeExposedBindings(){await this._context.removeExposedBindings()}async newPage(e,t){return{page:(0,Kk.lookupDispatcher)(await this._context.newPage(t))}}async cookies(e){return{cookies:await this._context.cookies(e.urls)}}async addCookies(e){await this._context.addCookies(e.cookies)}async clearCookies(){await this._context.clearCookies()}async grantPermissions(e){await this._context.grantPermissions(e.permissions,e.origin)}async clearPermissions(){await this._context.clearPermissions()}async setGeolocation(e){await this._context.setGeolocation(e.geolocation)}async setExtraHTTPHeaders(e){await this._context.setExtraHTTPHeaders(e.headers)}async setOffline(e){await this._context.setOffline(e.offline)}async setHTTPCredentials(e){await this._context.setHTTPCredentials(e.httpCredentials)}async addInitScript(e){await this._context.addInitScript(e.source)}async removeInitScripts(){await this._context.removeInitScripts()}async setNetworkInterceptionEnabled(e){e.enabled?await this._context.setRequestInterceptor(((e,t)=>{this._dispatchEvent("route",{route:Yk.RouteDispatcher.from(this._scope,e),request:Yk.RequestDispatcher.from(this._scope,t)})})):await this._context.setRequestInterceptor(void 0)}async storageState(e,t){return await this._context.storageState()}async close(e,t){await this._context.close(t)}async recorderSupplementEnable(e){await Zk.Recorder.show(this._context,e)}async pause(e,t){}async newCDPSession(e){if(!this._object._browser.options.isChromium)throw new Error("CDP session is only available in Chromium");if(!e.page&&!e.frame||e.page&&e.frame)throw new Error("CDP session must be initiated with either Page or Frame, not none or both");const t=this._object;return{session:new Qk.CDPSessionDispatcher(this._scope,await t.newCDPSession((e.page?e.page:e.frame)._object))}}async harExport(e){var t;const n=await(null===(t=this._context._harRecorder)||void 0===t?void 0:t.export());if(!n)throw new Error("No HAR artifact. Ensure record.harPath is set.");return{artifact:new eE.ArtifactDispatcher(this._scope,n)}}}zx.BrowserContextDispatcher=lE,Object.defineProperty($x,"__esModule",{value:!0}),$x.AndroidSocketDispatcher=$x.AndroidDispatcher=$x.AndroidDeviceDispatcher=void 0;var cE=Pl,uE=yv(),dE=zx;class hE extends cE.Dispatcher{constructor(e,t){super(e,t,"Android",{},!0),this._type_Android=!0}async devices(e){return{devices:(await this._object.devices(e)).map((e=>pE.from(this._scope,e)))}}async setDefaultTimeoutNoReply(e){this._object.setDefaultTimeout(e.timeout)}}$x.AndroidDispatcher=hE;class pE extends cE.Dispatcher{static from(e,t){return(0,cE.existingDispatcher)(t)||new pE(e,t)}constructor(e,t){super(e,t,"AndroidDevice",{model:t.model,serial:t.serial},!0),this._type_EventTarget=!0,this._type_AndroidDevice=!0;for(const e of t.webViews())this._dispatchEvent("webViewAdded",{webView:e});t.on(uE.AndroidDevice.Events.WebViewAdded,(e=>this._dispatchEvent("webViewAdded",{webView:e}))),t.on(uE.AndroidDevice.Events.WebViewRemoved,(e=>this._dispatchEvent("webViewRemoved",{pid:e})))}async wait(e){await this._object.send("wait",e)}async fill(e){await this._object.send("click",{selector:e.selector}),await this._object.send("fill",e)}async tap(e){await this._object.send("click",e)}async drag(e){await this._object.send("drag",e)}async fling(e){await this._object.send("fling",e)}async longTap(e){await this._object.send("longClick",e)}async pinchClose(e){await this._object.send("pinchClose",e)}async pinchOpen(e){await this._object.send("pinchOpen",e)}async scroll(e){await this._object.send("scroll",e)}async swipe(e){await this._object.send("swipe",e)}async info(e){return{info:await this._object.send("info",e)}}async inputType(e){const t=e.text,n=[];for(let e=0;e<t.length;++e){const r=mE.get(t[e].toUpperCase());if(void 0===r)throw new Error("No mapping for "+t[e]+" found");n.push(r)}await Promise.all(n.map((e=>this._object.send("inputPress",{keyCode:e}))))}async inputPress(e){if(!mE.has(e.key))throw new Error("Unknown key: "+e.key);await this._object.send("inputPress",{keyCode:mE.get(e.key)})}async inputTap(e){await this._object.send("inputClick",e)}async inputSwipe(e){await this._object.send("inputSwipe",e)}async inputDrag(e){await this._object.send("inputDrag",e)}async screenshot(e){return{binary:(await this._object.screenshot()).toString("base64")}}async shell(e){return{result:(await this._object.shell(e.command)).toString("base64")}}async open(e,t){const n=await this._object.open(e.command);return{socket:new fE(this._scope,n)}}async installApk(e){await this._object.installApk(Buffer.from(e.file,"base64"),{args:e.args})}async push(e){await this._object.push(Buffer.from(e.file,"base64"),e.path,e.mode)}async launchBrowser(e){const t=await this._object.launchBrowser(e.pkg,e);return{context:new dE.BrowserContextDispatcher(this._scope,t)}}async close(e){await this._object.close()}async setDefaultTimeoutNoReply(e){this._object.setDefaultTimeout(e.timeout)}async connectToWebView(e){return{context:new dE.BrowserContextDispatcher(this._scope,await this._object.connectToWebView(e.pid))}}}$x.AndroidDeviceDispatcher=pE;class fE extends cE.Dispatcher{constructor(e,t){super(e,t,"AndroidSocket",{},!0),this._type_AndroidSocket=!0,t.on("data",(e=>this._dispatchEvent("data",{data:e.toString("base64")}))),t.on("close",(()=>{this._dispatchEvent("close"),this._dispose()}))}async write(e,t){await this._object.write(Buffer.from(e.data,"base64"))}async close(e,t){this._object.close()}}$x.AndroidSocketDispatcher=fE;const mE=new Map([["Unknown",0],["SoftLeft",1],["SoftRight",2],["Home",3],["Back",4],["Call",5],["EndCall",6],["0",7],["1",8],["2",9],["3",10],["4",11],["5",12],["6",13],["7",14],["8",15],["9",16],["Star",17],["*",17],["Pound",18],["#",18],["DialUp",19],["DialDown",20],["DialLeft",21],["DialRight",22],["DialCenter",23],["VolumeUp",24],["VolumeDown",25],["Power",26],["Camera",27],["Clear",28],["A",29],["B",30],["C",31],["D",32],["E",33],["F",34],["G",35],["H",36],["I",37],["J",38],["K",39],["L",40],["M",41],["N",42],["O",43],["P",44],["Q",45],["R",46],["S",47],["T",48],["U",49],["V",50],["W",51],["X",52],["Y",53],["Z",54],["Comma",55],[",",55],["Period",56],[".",56],["AltLeft",57],["AltRight",58],["ShiftLeft",59],["ShiftRight",60],["Tab",61],["\t",61],["Space",62],[" ",62],["Sym",63],["Explorer",64],["Envelop",65],["Enter",66],["Del",67],["Grave",68],["Minus",69],["-",69],["Equals",70],["=",70],["LeftBracket",71],["(",71],["RightBracket",72],[")",72],["Backslash",73],["\\",73],["Semicolon",74],[";",74],["Apostrophe",75],["`",75],["Slash",76],["/",76],["At",77],["@",77],["Num",78],["HeadsetHook",79],["Focus",80],["Plus",81],["Menu",82],["Notification",83],["Search",84],["AppSwitch",187],["Assist",219],["Cut",277],["Copy",278],["Paste",279]]);var gE={},_E={};Object.defineProperty(_E,"__esModule",{value:!0}),_E.ConnectedBrowserDispatcher=_E.BrowserDispatcher=void 0;var wE=Q_(),vE=zx,bE=Bk,yE=Pl,SE=Hl,xE=fx(),kE=Fb;class EE extends yE.Dispatcher{constructor(e,t){super(e,t,"Browser",{version:t.version(),name:t.options.name},!0),this._type_Browser=!0,t.on(wE.Browser.Events.Disconnected,(()=>this._didClose()))}_didClose(){this._dispatchEvent("close"),this._dispose()}async newContext(e,t){const n=await this._object.newContext(t,e);return{context:new vE.BrowserContextDispatcher(this._scope,n)}}async close(){await this._object.close()}async killForTests(){await this._object.killForTests()}async newBrowserCDPSession(){if(!this._object.options.isChromium)throw new Error("CDP session is only available in Chromium");const e=this._object;return{session:new bE.CDPSessionDispatcher(this._scope,await e.newBrowserCDPSession())}}async startTracing(e){if(!this._object.options.isChromium)throw new Error("Tracing is only available in Chromium");const t=this._object;await t.startTracing(e.page?e.page._object:void 0,e)}async stopTracing(){if(!this._object.options.isChromium)throw new Error("Tracing is only available in Chromium");const e=this._object;return{binary:(await e.stopTracing()).toString("base64")}}}_E.BrowserDispatcher=EE;class CE extends yE.Dispatcher{constructor(e,t){super(e,t,"Browser",{version:t.version(),name:t.options.name},!0),this._type_Browser=!0,this._contexts=new Set,this.selectors=void 0,this.selectors=new kE.Selectors}async newContext(e,t){e.recordVideo&&(e.recordVideo.dir=this._object.options.artifactsDir);const n=await this._object.newContext(t,e);return this._contexts.add(n),n.setSelectors(this.selectors),n.on(xE.BrowserContext.Events.Close,(()=>this._contexts.delete(n))),{context:new vE.BrowserContextDispatcher(this._scope,n)}}async close(){}async killForTests(){}async newBrowserCDPSession(){if(!this._object.options.isChromium)throw new Error("CDP session is only available in Chromium");const e=this._object;return{session:new bE.CDPSessionDispatcher(this._scope,await e.newBrowserCDPSession())}}async startTracing(e){if(!this._object.options.isChromium)throw new Error("Tracing is only available in Chromium");const t=this._object;await t.startTracing(e.page?e.page._object:void 0,e)}async stopTracing(){if(!this._object.options.isChromium)throw new Error("Tracing is only available in Chromium");const e=this._object;return{binary:(await e.stopTracing()).toString("base64")}}async cleanupContexts(){await Promise.all(Array.from(this._contexts).map((e=>e.close((0,SE.serverSideCallMetadata)()))))}}_E.ConnectedBrowserDispatcher=CE;var TE={};Object.defineProperty(TE,"__esModule",{value:!0}),TE.JsonPipeDispatcher=void 0;var PE=Pl,OE=Ci,AE=Ol;class IE extends PE.Dispatcher{constructor(e){super(e,{guid:"jsonPipe@"+(0,OE.createGuid)()},"JsonPipe",{}),this._type_JsonPipe=!0}async send(e){this.emit("message",e.message)}async close(){this.emit("close"),this._disposed||(this._dispatchEvent("closed",{}),this._dispose())}dispatch(e){this._disposed||this._dispatchEvent("message",{message:e})}wasClosed(e){if(!this._disposed){const t=e?{error:(0,AE.serializeError)(e)}:{};this._dispatchEvent("closed",t),this._dispose()}}dispose(){this._dispose()}}TE.JsonPipeDispatcher=IE,Object.defineProperty(gE,"__esModule",{value:!0}),gE.BrowserTypeDispatcher=void 0;var ME=_E,FE=Pl,NE=zx,RE=TE,jE=gi,DE=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=qE(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(kx),LE=function(e){return e&&e.__esModule?e:{default:e}}(M.default),BE=Uu,HE=Nv;function qE(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(qE=function(e){return e?n:t})(e)}class UE extends FE.Dispatcher{constructor(e,t){super(e,t,"BrowserType",{executablePath:t.executablePath(),name:t.name()},!0),this._type_BrowserType=!0}async launch(e,t){const n=await this._object.launch(t,e);return{browser:new ME.BrowserDispatcher(this._scope,n)}}async launchPersistentContext(e,t){const n=await this._object.launchPersistentContext(t,e.userDataDir,e);return{context:new NE.BrowserContextDispatcher(this._scope,n)}}async connectOverCDP(e,t){const n=await this._object.connectOverCDP(t,e.endpointURL,e,e.timeout),r=new ME.BrowserDispatcher(this._scope,n);return{browser:r,defaultContext:n._defaultContext?new NE.BrowserContextDispatcher(r._scope,n._defaultContext):void 0}}async connect(e,t){const n=new BE.ProgressController(t,this._object);return n.setLogName("browser"),await n.run((async t=>{const n=Object.assign({"User-Agent":(0,jE.getUserAgent)()},e.headers||{}),r=await HE.WebSocketTransport.connect(t,e.wsEndpoint,n,!0);let i;const o=new RE.JsonPipeDispatcher(this._scope);return r.onmessage=t=>{var n;if("__create__"===t.method&&"SocksSupport"===t.params.type&&(i=new WE(r,e.socksProxyRedirectPortForTest,t.params.guid)),null!==(n=i)&&void 0!==n&&n.interceptMessage(t))return;const s=()=>{try{o.dispatch(t)}catch(e){r.close()}};e.slowMo?setTimeout(s,e.slowMo):s()},o.on("message",(e=>{r.send(e)})),r.onclose=()=>{var e;null===(e=i)||void 0===e||e.cleanup(),o.wasClosed()},o.on("close",(()=>r.close())),{pipe:o}}),e.timeout||0)}}gE.BrowserTypeDispatcher=UE;class WE{constructor(e,t,n){this._handler=void 0,this._channel=void 0,this._socksSupportObjectGuid=void 0,this._ids=new Set,this._handler=new DE.SocksProxyHandler(t),this._socksSupportObjectGuid=n;let r=-1;this._channel=new Proxy(new LE.default,{get:(t,i)=>i in t||void 0!==t[i]||"string"!=typeof i?t[i]:t=>{try{const o=--r;this._ids.add(o),e.send({id:o,guid:n,method:i,params:t,metadata:{stack:[],apiName:"",internal:!0}})}catch(e){}}}),this._handler.on(DE.SocksProxyHandler.Events.SocksConnected,(e=>this._channel.socksConnected(e))),this._handler.on(DE.SocksProxyHandler.Events.SocksData,(e=>this._channel.socksData({uid:e.uid,data:e.data.toString("base64")}))),this._handler.on(DE.SocksProxyHandler.Events.SocksError,(e=>this._channel.socksError(e))),this._handler.on(DE.SocksProxyHandler.Events.SocksFailed,(e=>this._channel.socksFailed(e))),this._handler.on(DE.SocksProxyHandler.Events.SocksEnd,(e=>this._channel.socksEnd(e))),this._channel.on("socksRequested",(e=>this._handler.socketRequested(e))),this._channel.on("socksClosed",(e=>this._handler.socketClosed(e))),this._channel.on("socksData",(e=>this._handler.sendSocketData({uid:e.uid,data:Buffer.from(e.data,"base64")})))}cleanup(){this._handler.cleanup()}interceptMessage(e){return this._ids.has(e.id)?(this._ids.delete(e.id),!0):e.guid===this._socksSupportObjectGuid&&(this._channel.emit(e.method,e.params),!0)}}var $E={};Object.defineProperty($E,"__esModule",{value:!0}),$E.ElectronDispatcher=$E.ElectronApplicationDispatcher=void 0;var zE=Pl,VE=Jv(),GE=zx,KE=Yx(),JE=Xx();class YE extends zE.Dispatcher{constructor(e,t){super(e,t,"Electron",{},!0),this._type_Electron=!0}async launch(e){const t=await this._object.launch(e);return{electronApplication:new XE(this._scope,t)}}}$E.ElectronDispatcher=YE;class XE extends zE.Dispatcher{constructor(e,t){super(e,t,"ElectronApplication",{context:new GE.BrowserContextDispatcher(e,t.context())},!0),this._type_EventTarget=!0,this._type_ElectronApplication=!0,t.on(VE.ElectronApplication.Events.Close,(()=>{this._dispatchEvent("close"),this._dispose()}))}async browserWindow(e){const t=await this._object.browserWindow(e.page.page());return{handle:JE.ElementHandleDispatcher.fromJSHandle(this._scope,t)}}async evaluateExpression(e){const t=await this._object._nodeElectronHandlePromise;return{value:(0,KE.serializeResult)(await t.evaluateExpressionAndWaitForSignals(e.expression,e.isFunction,!0,(0,KE.parseArgument)(e.arg)))}}async evaluateExpressionHandle(e){const t=await this._object._nodeElectronHandlePromise,n=await t.evaluateExpressionAndWaitForSignals(e.expression,e.isFunction,!1,(0,KE.parseArgument)(e.arg));return{handle:JE.ElementHandleDispatcher.fromJSHandle(this._scope,n)}}async close(){await this._object.close()}}$E.ElectronApplicationDispatcher=XE;var QE={};Object.defineProperty(QE,"__esModule",{value:!0}),QE.LocalUtilsDispatcher=void 0;var ZE=sC(C.default),eC=sC(T.default),tC=sC(Bs),nC=sC(Zh),rC=pu,iC=Ci,oC=Pl;function sC(e){return e&&e.__esModule?e:{default:e}}class aC extends oC.Dispatcher{constructor(e){super(e,{guid:"localUtils@"+(0,iC.createGuid)()},"LocalUtils",{}),this._type_LocalUtils=void 0,this._type_LocalUtils=!0}async zip(e,t){const n=new rC.ManualPromise,r=new nC.default.ZipFile;r.on("error",(e=>n.reject(e)));for(const t of e.entries)try{ZE.default.statSync(t.value).isFile()&&r.addFile(t.value,t.name)}catch(e){}if(!ZE.default.existsSync(e.zipFile))return await ZE.default.promises.mkdir(eC.default.dirname(e.zipFile),{recursive:!0}),r.end(void 0,(()=>{r.outputStream.pipe(ZE.default.createWriteStream(e.zipFile)).on("close",(()=>n.resolve()))})),n;const i=e.zipFile+".tmp";return await ZE.default.promises.rename(e.zipFile,i),tC.default.open(i,((t,o)=>{if(t)return void n.reject(t);(0,iC.assert)(o);let s=o.entryCount;o.on("entry",(t=>{o.openReadStream(t,((o,a)=>{o?n.reject(o):(r.addReadStream(a,t.fileName),0==--s&&r.end(void 0,(()=>{r.outputStream.pipe(ZE.default.createWriteStream(e.zipFile)).on("close",(()=>{ZE.default.promises.unlink(i).then((()=>{n.resolve()}))}))})))}))}))})),n}}QE.LocalUtilsDispatcher=aC;var lC={};Object.defineProperty(lC,"__esModule",{value:!0}),lC.SelectorsDispatcher=void 0;var cC=Pl;class uC extends cC.Dispatcher{constructor(e,t){super(e,t,"Selectors",{}),this._type_Selectors=!0}async register(e){await this._object.register(e.name,e.source,e.contentScript)}}lC.SelectorsDispatcher=uC,Object.defineProperty(Pc,"__esModule",{value:!0}),Pc.PlaywrightDispatcher=void 0;var dC=xx(),hC=kx,pC=$x,fC=gE,mC=Pl,gC=$E,_C=QE,wC=xk(),vC=lC,bC=_E,yC=Ci;class SC extends mC.Dispatcher{constructor(e,t,n,r){const i=uf(),o=Object.entries(i).map((([e,t])=>({name:e,descriptor:t}))),s=r?new bC.ConnectedBrowserDispatcher(e,r):void 0;super(e,t,"Playwright",{chromium:new fC.BrowserTypeDispatcher(e,t.chromium),firefox:new fC.BrowserTypeDispatcher(e,t.firefox),webkit:new fC.BrowserTypeDispatcher(e,t.webkit),android:new pC.AndroidDispatcher(e,t.android),electron:new gC.ElectronDispatcher(e,t.electron),utils:new _C.LocalUtilsDispatcher(e),deviceDescriptors:o,selectors:new vC.SelectorsDispatcher(e,(null==s?void 0:s.selectors)||t.selectors),preLaunchedBrowser:s,socksSupport:n?new xC(e,n):void 0},!1),this._type_Playwright=void 0,this._browserDispatcher=void 0,this._type_Playwright=!0,this._browserDispatcher=s}async newRequest(e,t){const n=new dC.GlobalAPIRequestContext(this._object,e);return{request:wC.APIRequestContextDispatcher.from(this._scope,n)}}async hideHighlight(e,t){await this._object.hideHighlight()}async cleanup(){var e;await(null===(e=this._browserDispatcher)||void 0===e?void 0:e.cleanupContexts())}}Pc.PlaywrightDispatcher=SC;class xC extends mC.Dispatcher{constructor(e,t){super(e,{guid:"socksSupport@"+(0,yC.createGuid)()},"SocksSupport",{}),this._type_SocksSupport=void 0,this._socksProxy=void 0,this._type_SocksSupport=!0,this._socksProxy=t,t.on(hC.SocksProxy.Events.SocksRequested,(e=>this._dispatchEvent("socksRequested",e))),t.on(hC.SocksProxy.Events.SocksData,(e=>this._dispatchEvent("socksData",{uid:e.uid,data:e.data.toString("base64")}))),t.on(hC.SocksProxy.Events.SocksClosed,(e=>this._dispatchEvent("socksClosed",e)))}async socksConnected(e){var t;null===(t=this._socksProxy)||void 0===t||t.socketConnected(e)}async socksFailed(e){var t;null===(t=this._socksProxy)||void 0===t||t.socketFailed(e)}async socksData(e){var t;null===(t=this._socksProxy)||void 0===t||t.sendSocketData({uid:e.uid,data:Buffer.from(e.data,"base64")})}async socksError(e){var t;null===(t=this._socksProxy)||void 0===t||t.sendSocketError(e)}async socksEnd(e){var t;null===(t=this._socksProxy)||void 0===t||t.sendSocketEnd(e)}}!function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"DispatcherConnection",{enumerable:!0,get:function(){return n.DispatcherConnection}}),Object.defineProperty(e,"PlaywrightDispatcher",{enumerable:!0,get:function(){return r.PlaywrightDispatcher}}),Object.defineProperty(e,"Registry",{enumerable:!0,get:function(){return t.Registry}}),Object.defineProperty(e,"Root",{enumerable:!0,get:function(){return n.Root}}),Object.defineProperty(e,"createPlaywright",{enumerable:!0,get:function(){return i.createPlaywright}}),Object.defineProperty(e,"installBrowsersForNpmInstall",{enumerable:!0,get:function(){return t.installBrowsersForNpmInstall}}),Object.defineProperty(e,"installDefaultBrowsersForNpmInstall",{enumerable:!0,get:function(){return t.installDefaultBrowsersForNpmInstall}}),Object.defineProperty(e,"registry",{enumerable:!0,get:function(){return t.registry}}),Object.defineProperty(e,"registryDirectory",{enumerable:!0,get:function(){return t.registryDirectory}}),Object.defineProperty(e,"writeDockerVersion",{enumerable:!0,get:function(){return t.writeDockerVersion}});var t=Tl(),n=Pl,r=Pc,i=ix()}(xt);var kC={},EC={},CC={},TC={},PC={};Object.defineProperty(PC,"__esModule",{value:!0}),PC.Events=void 0;PC.Events={AndroidDevice:{WebView:"webview",Close:"close"},AndroidSocket:{Data:"data",Close:"close"},AndroidWebView:{Close:"close"},Browser:{Disconnected:"disconnected"},BrowserContext:{Close:"close",Page:"page",BackgroundPage:"backgroundpage",ServiceWorker:"serviceworker",Request:"request",Response:"response",RequestFailed:"requestfailed",RequestFinished:"requestfinished"},BrowserServer:{Close:"close"},Page:{Close:"close",Crash:"crash",Console:"console",Dialog:"dialog",Download:"download",FileChooser:"filechooser",DOMContentLoaded:"domcontentloaded",PageError:"pageerror",Request:"request",Response:"response",RequestFailed:"requestfailed",RequestFinished:"requestfinished",FrameAttached:"frameattached",FrameDetached:"framedetached",FrameNavigated:"framenavigated",Load:"load",Popup:"popup",WebSocket:"websocket",Worker:"worker"},WebSocket:{Close:"close",Error:"socketerror",FrameReceived:"framereceived",FrameSent:"framesent"},Worker:{Close:"close"},ElectronApplication:{Close:"close",Window:"window"}};var OC={};function AC(e){const t={...e,value:void 0!==e.valueNumber?e.valueNumber:e.valueString,checked:"checked"===e.checked||"unchecked"!==e.checked&&e.checked,pressed:"pressed"===e.pressed||"released"!==e.pressed&&e.pressed,children:e.children?e.children.map(AC):void 0};return delete t.valueNumber,delete t.valueString,t}Object.defineProperty(OC,"__esModule",{value:!0}),OC.Accessibility=void 0;OC.Accessibility=class{constructor(e){this._channel=void 0,this._channel=e}async snapshot(e={}){const t=e.root?e.root._elementChannel:void 0,n=await this._channel.accessibilitySnapshot({interestingOnly:e.interestingOnly,root:t});return n.rootAXNode?AC(n.rootAXNode):null}};var IC={},MC={};Object.defineProperty(MC,"__esModule",{value:!0}),MC.zones=void 0;var FC=$l;class NC{constructor(e,t,n,r){this._manager=void 0,this.id=void 0,this.type=void 0,this.data={},this._manager=e,this.id=t,this.type=n,this.data=r}async run(e){Object.defineProperty(e,"name",{value:`__PWZONE__[${this.id}]`});try{return await e()}finally{this._manager._zones.delete(this.id)}}}const RC=new class{constructor(){this.lastZoneId=0,this._zones=new Map}async run(e,t,n){const r=new NC(this,++this.lastZoneId,e,t);return this._zones.set(r.id,r),r.run(n)}zoneData(e,t){const n=t||(0,FC.captureRawStack)();for(const t of n.split("\n")){const n=t.indexOf("__PWZONE__[");if(-1!==n){const r=+t.substring(n+"__PWZONE__[".length,t.indexOf("]",n)),i=this._zones.get(r);if(i&&i.type===e)return i.data}}return null}};MC.zones=RC,Object.defineProperty(IC,"__esModule",{value:!0}),IC.ChannelOwner=void 0,IC.renderCallWithParams=zC;var jC=M.default,DC=jl,LC=Ka,BC=$l,HC=Ci,qC=MC;class UC extends jC.EventEmitter{constructor(e,t,n,r,i){var o;super(),this._connection=void 0,this._parent=void 0,this._objects=new Map,this._type=void 0,this._guid=void 0,this._channel=void 0,this._initializer=void 0,this._logger=void 0,this._instrumentation=void 0,this.setMaxListeners(0),this._connection=e instanceof UC?e._connection:e,this._type=t,this._guid=n,this._parent=e instanceof UC?e:void 0,this._instrumentation=i||(null===(o=this._parent)||void 0===o?void 0:o._instrumentation),this._connection._objects.set(n,this),this._parent&&(this._parent._objects.set(n,this),this._logger=this._parent._logger),this._channel=this._createChannel(new jC.EventEmitter),this._initializer=r}_dispose(){this._parent&&this._parent._objects.delete(this._guid),this._connection._objects.delete(this._guid);for(const e of[...this._objects.values()])e._dispose();this._objects.clear()}_debugScopeState(){return{_guid:this._guid,objects:Array.from(this._objects.values()).map((e=>e._debugScopeState()))}}_createChannel(e){const t=new Proxy(e,{get:(e,t)=>{if("debugScopeState"===t)return e=>this._connection.sendMessageToServer(this,t,e,null);if("string"==typeof t){const e=VC[(n=this._type,r=t,n+r[0].toUpperCase()+r.substring(1)+"Params")];if(e)return n=>this._wrapApiCall((r=>{const{stackTrace:i,csi:o,callCookie:s}=r.reported?{csi:void 0,callCookie:void 0,stackTrace:null}:r;return r.reported=!0,o&&i&&i.apiName&&o.onApiCallBegin(zC(i.apiName,n),i,s),this._connection.sendMessageToServer(this,t,e(n,""),i)}))}var n,r;return e[t]}});return t._object=this,t}async _wrapApiCall(e,t=!1,n){const r=this._logger,i=(0,BC.captureRawStack)(),o=qC.zones.zoneData("apiZone",i);if(o)return e(o);const s=n||(0,BC.captureStackTrace)(i);t&&delete s.apiName;const a=t?void 0:this._instrumentation,l={},{apiName:c,frameTexts:u}=s;try{WC(r,`=> ${c} started`,t);const n={stackTrace:s,isInternal:t,reported:!1,csi:a,callCookie:l},i=await qC.zones.run("apiZone",n,(async()=>await e(n)));return null==a||a.onApiCallEnd(l),WC(r,`<= ${c} succeeded`,t),i}catch(e){const n=(process.env.PWDEBUGIMPL||(0,HC.isUnderTest)())&&e.stack?"\n<inner error>\n"+e.stack:"";throw e.message=c+": "+e.message,e.stack=e.message+"\n"+u.join("\n")+n,null==a||a.onApiCallEnd(l,e),WC(r,`<= ${c} failed`,t),e}}_toImpl(){var e,t;return null===(e=(t=this._connection).toImpl)||void 0===e?void 0:e.call(t,this)}toJSON(){return{_type:this._type,_guid:this._guid}}}function WC(e,t,n){n||(e&&e.isEnabled("api","info")&&e.log("api","info",t,[],{color:"cyan"}),LC.debugLogger.log("api",t))}IC.ChannelOwner=UC;const $C=["url","selector","text","key"];function zC(e,t){const n=[];if(t)for(const e of $C)t[e]&&n.push(t[e]);return e+(n.length?"("+n.join(", ")+")":"")}const VC=(0,DC.createScheme)((e=>(t,n)=>{if(t._object instanceof UC&&("*"===e||t._object._type===e))return{guid:t._object._guid};throw new DC.ValidationError(`${n}: expected ${e}`)}));var GC={},KC={};Object.defineProperty(KC,"__esModule",{value:!0}),KC.JSHandle=void 0,KC.assertMaxArguments=function(e,t){if(e>t)throw new Error("Too many arguments. If you need to pass more than 1 argument to the function wrap them in an object.")},KC.parseResult=ZC,KC.serializeArgument=QC;var JC=IC,YC=Ol;class XC extends JC.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r),this._preview=void 0,this._preview=this._initializer.preview,this._channel.on("previewUpdated",(({preview:e})=>this._preview=e))}async evaluate(e,t){return ZC((await this._channel.evaluateExpression({expression:String(e),isFunction:"function"==typeof e,arg:QC(t)})).value)}async evaluateHandle(e,t){const n=await this._channel.evaluateExpressionHandle({expression:String(e),isFunction:"function"==typeof e,arg:QC(t)});return XC.from(n.handle)}async getProperty(e){const t=await this._channel.getProperty({name:e});return XC.from(t.handle)}async getProperties(){const e=new Map;for(const{name:t,value:n}of(await this._channel.getPropertyList()).properties)e.set(t,XC.from(n));return e}async jsonValue(){return ZC((await this._channel.jsonValue()).value)}asElement(){return null}async dispose(){return await this._channel.dispose()}toString(){return this._preview}}function QC(e){const t=[];return{value:(0,YC.serializeValue)(e,(e=>{return e instanceof XC?{h:(n=e._channel,t.push(n),t.length-1)}:{fallThrough:e};var n}),new Set),handles:t}}function ZC(e){return(0,YC.parseSerializedValue)(e,void 0)}KC.JSHandle=XC,Object.defineProperty(GC,"__esModule",{value:!0}),GC.ConsoleMessage=void 0;var eT=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=rT(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(N.default),tT=KC,nT=IC;function rT(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(rT=function(e){return e?n:t})(e)}class iT extends nT.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r)}type(){return this._initializer.type}text(){return this._initializer.text}args(){return this._initializer.args.map(tT.JSHandle.from)}location(){return this._initializer.location}[eT.inspect.custom](){return this.text()}}GC.ConsoleMessage=iT;var oT={};Object.defineProperty(oT,"__esModule",{value:!0}),oT.Dialog=void 0;var sT=IC;class aT extends sT.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r)}type(){return this._initializer.type}message(){return this._initializer.message}defaultValue(){return this._initializer.defaultValue}async accept(e){await this._channel.accept({promptText:e})}async dismiss(){await this._channel.dismiss()}}oT.Dialog=aT;var lT={};Object.defineProperty(lT,"__esModule",{value:!0}),lT.Download=void 0;lT.Download=class{constructor(e,t,n,r){this._page=void 0,this._url=void 0,this._suggestedFilename=void 0,this._artifact=void 0,this._page=e,this._url=t,this._suggestedFilename=n,this._artifact=r}page(){return this._page}url(){return this._url}suggestedFilename(){return this._suggestedFilename}async path(){return this._artifact.pathAfterFinished()}async saveAs(e){return this._artifact.saveAs(e)}async failure(){return this._artifact.failure()}async createReadStream(){return this._artifact.createReadStream()}async cancel(){return this._artifact.cancel()}async delete(){return this._artifact.delete()}};var cT,uT={},dT={},hT={};var pT={},fT={};Object.defineProperty(fT,"__esModule",{value:!0}),fT.Waiter=void 0;var mT=$l,gT=Al,_T=Ci;class wT{constructor(e,t){this._dispose=void 0,this._failures=[],this._immediateError=void 0,this._logs=[],this._channelOwner=void 0,this._waitId=void 0,this._error=void 0,this._waitId=(0,_T.createGuid)(),this._channelOwner=e,this._channelOwner._channel.waitForEventInfo({info:{waitId:this._waitId,phase:"before",event:t}}).catch((()=>{})),this._dispose=[()=>this._channelOwner._wrapApiCall((async()=>{await this._channelOwner._channel.waitForEventInfo({info:{waitId:this._waitId,phase:"after",error:this._error}})}),!0).catch((()=>{}))]}static createForEvent(e,t){return new wT(e,t)}async waitForEvent(e,t,n){const{promise:r,dispose:i}=vT(e,t,n);return this.waitForPromise(r,i)}rejectOnEvent(e,t,n,r){const{promise:i,dispose:o}=vT(e,t,r);this._rejectOn(i.then((()=>{throw n})),o)}rejectOnTimeout(e,t){if(!e)return;const{promise:n,dispose:r}=function(e){let t;const n=new Promise((n=>t=setTimeout(n,e)));return{promise:n,dispose:()=>clearTimeout(t)}}(e);this._rejectOn(n.then((()=>{throw new gT.TimeoutError(t)})),r)}rejectImmediately(e){this._immediateError=e}dispose(){for(const e of this._dispose)e()}async waitForPromise(e,t){try{if(this._immediateError)throw this._immediateError;const n=await Promise.race([e,...this._failures]);return t&&t(),n}catch(e){throw t&&t(),this._error=e.message,this.dispose(),(0,mT.rewriteErrorMessage)(e,e.message+function(e){if(!e.length)return"";const t=" logs ",n=60,r=(n-t.length)/2,i=n-t.length-r;return`\n${"=".repeat(r)}${t}${"=".repeat(i)}\n${e.join("\n")}\n${"=".repeat(n)}`}(this._logs)),e}}log(e){this._logs.push(e),this._channelOwner._wrapApiCall((async()=>{await this._channelOwner._channel.waitForEventInfo({info:{waitId:this._waitId,phase:"log",message:e}}).catch((()=>{}))}),!0)}_rejectOn(e,t){this._failures.push(e),t&&this._dispose.push(t)}}function vT(e,t,n){let r;return{promise:new Promise(((i,o)=>{r=async s=>{try{if(n&&!await n(s))return;e.removeListener(t,r),i(s)}catch(n){e.removeListener(t,r),o(n)}},e.addListener(t,r)})),dispose:()=>e.removeListener(t,r)}}fT.Waiter=wT;var bT={};Object.defineProperty(bT,"__esModule",{value:!0}),bT.envObjectToArray=function(e){const t=[];for(const n in e)Object.is(e[n],void 0)||t.push({name:n,value:String(e[n])});return t},bT.evaluationScript=async function(e,t,n=!0){if("function"==typeof e){const n=e.toString(),r=Object.is(t,void 0)?"undefined":JSON.stringify(t);return`(${n})(${r})`}if(void 0!==t)throw new Error("Cannot evaluate a string with arguments");if((0,ST.isString)(e))return e;if(void 0!==e.content)return e.content;if(void 0!==e.path){let t=await yT.default.promises.readFile(e.path,"utf8");return n&&(t+="\n//# sourceURL="+e.path.replace(/\n/g,"")),t}throw new Error("Either path or content property must be present")},bT.globToRegex=ET,bT.parsedURL=xT,bT.urlMatches=function(e,t,n){if(void 0===n||""===n)return!0;(0,ST.isString)(n)&&!n.startsWith("*")&&(n=(0,ST.constructURLBasedOnBaseURL)(e,n));(0,ST.isString)(n)&&(n=ET(n));if((0,ST.isRegExp)(n))return n.test(t);if("string"==typeof n&&n===t)return!0;const r=xT(t);if(!r)return!1;if("string"==typeof n)return r.pathname===n;if("function"!=typeof n)throw new Error("url parameter should be string, RegExp or function");return n(r)};var yT=function(e){return e&&e.__esModule?e:{default:e}}(C.default),ST=Ci;function xT(e){try{return new URL(e)}catch(e){return null}}const kT=new Set(["/","$","^","+",".","(",")","=","!","|"]);function ET(e){const t=["^"];let n;for(let r=0;r<e.length;++r){const i=e[r];if(kT.has(i))t.push("\\"+i);else if("*"!==i)switch(i){case"?":t.push(".");break;case"{":n=!0,t.push("(");break;case"}":n=!1,t.push(")");break;case",":if(n){t.push("|");break}t.push("\\"+i);break;default:t.push(i)}else{const n=e[r-1];let i=1;for(;"*"===e[r+1];)i++,r++;const o=e[r+1];i>1&&("/"===n||void 0===n)&&("/"===o||void 0===o)?(t.push("((?:[^/]*(?:/|$))*)"),r++):t.push("([^/]*)")}}return t.push("$"),new RegExp(t.join(""))}var CT={},TT={};Object.defineProperty(TT,"__esModule",{value:!0}),TT.createInstrumentation=function(){const e=[];return new Proxy({},{get:(t,n)=>"addListener"===n?t=>e.push(t):"removeListener"===n?t=>e.splice(e.indexOf(t),1):"removeAllListeners"===n?()=>e.splice(0,e.length):n.startsWith("on")?async(...t)=>{for(const o of e){var r,i;await(null===(r=(i=o)[n])||void 0===r?void 0:r.call(i,...t))}}:t[n]})};var PT={},OT={},AT={};Object.defineProperty(AT,"__esModule",{value:!0}),AT.Stream=void 0;var IT=B.default,MT=IC;class FT extends MT.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r)}stream(){return new NT(this._channel)}}AT.Stream=FT;class NT extends IT.Readable{constructor(e){super(),this._channel=void 0,this._channel=e}async _read(e){const t=await this._channel.read({size:e});t.binary?this.push(Buffer.from(t.binary,"base64")):this.push(null)}_destroy(e,t){this._channel.close().catch((e=>null)),super._destroy(e,t)}}Object.defineProperty(OT,"__esModule",{value:!0}),OT.Artifact=void 0;var RT=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=BT(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(C.default),jT=AT,DT=Ri,LT=IC;function BT(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(BT=function(e){return e?n:t})(e)}class HT extends LT.ChannelOwner{static from(e){return e._object}async pathAfterFinished(){if(this._connection.isRemote())throw new Error("Path is not available when connecting remotely. Use saveAs() to save a local copy.");return(await this._channel.pathAfterFinished()).value||null}async saveAs(e){if(!this._connection.isRemote())return void await this._channel.saveAs({path:e});const t=await this._channel.saveAsStream(),n=jT.Stream.from(t.stream);await(0,DT.mkdirIfNeeded)(e),await new Promise(((t,r)=>{n.stream().pipe(RT.createWriteStream(e)).on("finish",t).on("error",r)}))}async failure(){return(await this._channel.failure()).error||null}async createReadStream(){const e=await this._channel.stream();if(!e.stream)return null;return jT.Stream.from(e.stream).stream()}async cancel(){return this._channel.cancel()}async delete(){return this._channel.delete()}}OT.Artifact=HT,Object.defineProperty(PT,"__esModule",{value:!0}),PT.Tracing=void 0;var qT,UT,WT=OT,$T=IC;class zT extends $T.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r),this._localUtils=void 0}async start(e={}){await this._wrapApiCall((async()=>{await this._channel.tracingStart(e),await this._channel.tracingStartChunk({title:e.title})}))}async startChunk(e={}){await this._channel.tracingStartChunk(e)}async stopChunk(e={}){await this._doStopChunk(e.path)}async stop(e={}){await this._wrapApiCall((async()=>{await this._doStopChunk(e.path),await this._channel.tracingStop()}))}async _doStopChunk(e){var t;const n=!this._connection.isRemote();let r="doNotSave";e&&(r=n?"compressTraceAndSources":"compressTrace");const i=await this._channel.tracingStopChunk({mode:r});if(!e)return;if(!i.artifact)return;const o=WT.Artifact.from(i.artifact);await o.saveAs(e),await o.delete(),null!==(t=i.sourceEntries)&&void 0!==t&&t.length&&await this._localUtils.zip(e,i.sourceEntries)}}function VT(){if(qT)return CT;qT=1,Object.defineProperty(CT,"__esModule",{value:!0}),CT.APIResponse=CT.APIRequestContext=CT.APIRequest=void 0;var e=p(C.default),t=p(T.default),n=h(N.default),r=Al,i=Ci,o=Ri,s=IC,a=h(GT()),l=TT,c=PT;let u;function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function h(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}function p(e){return e&&e.__esModule?e:{default:e}}CT.APIRequest=class{constructor(e){this._playwright=void 0,this._contexts=new Set,this._onDidCreateContext=void 0,this._onWillCloseContext=void 0,this._playwright=e}async newContext(t={}){var n;const r="string"==typeof t.storageState?JSON.parse(await e.default.promises.readFile(t.storageState,"utf8")):t.storageState,o=f.from((await this._playwright._channel.newRequest({...t,extraHTTPHeaders:t.extraHTTPHeaders?(0,i.headersObjectToArray)(t.extraHTTPHeaders):void 0,storageState:r})).request);return o._tracing._localUtils=this._playwright._utils,this._contexts.add(o),o._request=this,await(null===(n=this._onDidCreateContext)||void 0===n?void 0:n.call(this,o)),o}};class f extends s.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r,(0,l.createInstrumentation)()),this._request=void 0,this._tracing=void 0,this._tracing=c.Tracing.from(r.tracing)}async dispose(){var e,t,n;await(null===(e=this._request)||void 0===e||null===(t=e._onWillCloseContext)||void 0===t?void 0:t.call(e,this)),await this._channel.dispose(),null===(n=this._request)||void 0===n||n._contexts.delete(this)}async delete(e,t){return this.fetch(e,{...t,method:"DELETE"})}async head(e,t){return this.fetch(e,{...t,method:"HEAD"})}async get(e,t){return this.fetch(e,{...t,method:"GET"})}async patch(e,t){return this.fetch(e,{...t,method:"PATCH"})}async post(e,t){return this.fetch(e,{...t,method:"POST"})}async put(e,t){return this.fetch(e,{...t,method:"PUT"})}async fetch(t,n={}){return this._wrapApiCall((async()=>{const r=t instanceof a.Request?t:void 0;(0,i.assert)(r||"string"==typeof t,"First argument must be either URL string or Request"),(0,i.assert)((void 0===n.data?0:1)+(void 0===n.form?0:1)+(void 0===n.multipart?0:1)<=1,"Only one of 'data', 'form' or 'multipart' can be specified");const o=r?r.url():t,s=(0,i.objectToArray)(n.params),l=n.method||(null==r?void 0:r.method()),c=n.headers||(null==r?void 0:r.headers()),u=c?(0,i.headersObjectToArray)(c):void 0;let d,h,p,f;if(void 0!==n.data)if((0,i.isString)(n.data))!function(e){if(!e)return!1;for(const{name:t,value:n}of e)if("content-type"===t.toLocaleLowerCase())return"application/json"===n;return!1}(u)?f=Buffer.from(n.data,"utf8"):d=n.data;else if(Buffer.isBuffer(n.data))f=n.data;else{if("object"!=typeof n.data&&"number"!=typeof n.data&&"boolean"!=typeof n.data)throw new Error("Unexpected 'data' type");d=n.data}else if(n.form)h=(0,i.objectToArray)(n.form);else if(n.multipart){p=[];for(const[t,r]of Object.entries(n.multipart))if((0,i.isFilePayload)(r)){const e=r;if(!Buffer.isBuffer(e.buffer))throw new Error(`Unexpected buffer type of 'data.${t}'`);p.push({name:t,file:g(e)})}else r instanceof e.default.ReadStream?p.push({name:t,file:await _(r)}):p.push({name:t,value:String(r)})}void 0===f&&void 0===d&&void 0===h&&void 0===p&&(f=(null==r?void 0:r.postDataBuffer())||void 0);const w=f?f.toString("base64"):void 0,v=await this._channel.fetch({url:o,params:s,method:l,headers:u,postData:w,jsonData:d,formData:h,multipartData:p,timeout:n.timeout,failOnStatusCode:n.failOnStatusCode,ignoreHTTPSErrors:n.ignoreHTTPSErrors});return new m(this,v.response)}))}async storageState(t={}){const n=await this._channel.storageState();return t.path&&(await(0,o.mkdirIfNeeded)(t.path),await e.default.promises.writeFile(t.path,JSON.stringify(n,void 0,2),"utf8")),n}}CT.APIRequestContext=f,u=n.inspect.custom;class m{constructor(e,t){this._initializer=void 0,this._headers=void 0,this._request=void 0,this._request=e,this._initializer=t,this._headers=new a.RawHeaders(this._initializer.headers)}ok(){return this._initializer.status>=200&&this._initializer.status<=299}url(){return this._initializer.url}status(){return this._initializer.status}statusText(){return this._initializer.statusText}headers(){return this._headers.headers()}headersArray(){return this._headers.headersArray()}async body(){try{const e=await this._request._channel.fetchResponseBody({fetchUid:this._fetchUid()});if(void 0===e.binary)throw new Error("Response has been disposed");return Buffer.from(e.binary,"base64")}catch(e){if(e.message.includes(r.kBrowserOrContextClosedError))throw new Error("Response has been disposed");throw e}}async text(){return(await this.body()).toString("utf8")}async json(){const e=await this.text();return JSON.parse(e)}async dispose(){await this._request._channel.disposeAPIResponse({fetchUid:this._fetchUid()})}[u](){const e=this.headersArray().map((({name:e,value:t})=>`  ${e}: ${t}`));return`APIResponse: ${this.status()} ${this.statusText()}\n${e.join("\n")}`}_fetchUid(){return this._initializer.fetchUid}async _fetchLog(){const{log:e}=await this._request._channel.fetchLog({fetchUid:this._fetchUid()});return e}}function g(e){return{name:e.name,mimeType:e.mimeType,buffer:e.buffer.toString("base64")}}async function _(e){const n=await new Promise(((t,n)=>{const r=[];e.on("data",(e=>r.push(e))),e.on("end",(()=>t(Buffer.concat(r)))),e.on("error",(e=>n(e)))})),r=Buffer.isBuffer(e.path)?e.path.toString("utf8"):e.path;return{name:t.default.basename(r),buffer:n.toString("base64")}}return CT.APIResponse=m,CT}function GT(){if(UT)return pT;UT=1,Object.defineProperty(pT,"__esModule",{value:!0}),pT.WebSocket=pT.RouteHandler=pT.Route=pT.Response=pT.Request=pT.RawHeaders=void 0,pT.validateHeaders=function(e){for(const t of Object.keys(e)){const n=e[t];if(!Object.is(n,void 0)&&!(0,o.isString)(n))throw new Error(`Expected value of header "${t}" to be String, but "${typeof n}" is found.`)}};var e=H.default,t=IC,n=XT(),r=function(e){return e&&e.__esModule?e:{default:e}}(C.default),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(Su),o=Ci,s=pu,a=PC,l=fT,c=bT,u=Md,d=VT();function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}class p extends t.ChannelOwner{static from(e){return e._object}static fromNullable(e){return e?p.from(e):null}constructor(e,t,n,r){super(e,t,n,r),this._redirectedFrom=null,this._redirectedTo=null,this._failureText=null,this._provisionalHeaders=void 0,this._actualHeadersPromise=void 0,this._postData=void 0,this._timing=void 0,this._redirectedFrom=p.fromNullable(r.redirectedFrom),this._redirectedFrom&&(this._redirectedFrom._redirectedTo=this),this._provisionalHeaders=new _(r.headers),this._postData=void 0!==r.postData?Buffer.from(r.postData,"base64"):null,this._timing={startTime:0,domainLookupStart:-1,domainLookupEnd:-1,connectStart:-1,secureConnectionStart:-1,connectEnd:-1,requestStart:-1,responseStart:-1,responseEnd:-1}}url(){return this._initializer.url}resourceType(){return this._initializer.resourceType}method(){return this._initializer.method}postData(){return this._postData?this._postData.toString("utf8"):null}postDataBuffer(){return this._postData}postDataJSON(){const t=this.postData();if(!t)return null;if("application/x-www-form-urlencoded"===this.headers()["content-type"]){const n={},r=new e.URLSearchParams(t);for(const[e,t]of r.entries())n[e]=t;return n}try{return JSON.parse(t)}catch(e){throw new Error("POST data is not a valid JSON object: "+t)}}headers(){return this._provisionalHeaders.headers()}_actualHeaders(){return this._actualHeadersPromise||(this._actualHeadersPromise=this._wrapApiCall((async()=>new _((await this._channel.rawRequestHeaders()).headers)))),this._actualHeadersPromise}async allHeaders(){return(await this._actualHeaders()).headers()}async headersArray(){return(await this._actualHeaders()).headersArray()}async headerValue(e){return(await this._actualHeaders()).get(e)}async response(){return m.fromNullable((await this._channel.response()).response)}async _internalResponse(){return this._wrapApiCall((async()=>m.fromNullable((await this._channel.response()).response)),!0)}frame(){return n.Frame.from(this._initializer.frame)}isNavigationRequest(){return this._initializer.isNavigationRequest}redirectedFrom(){return this._redirectedFrom}redirectedTo(){return this._redirectedTo}failure(){return null===this._failureText?null:{errorText:this._failureText}}timing(){return this._timing}async sizes(){const e=await this.response();if(!e)throw new Error("Unable to fetch sizes for failed request");return(await e._channel.sizes()).sizes}_finalRequest(){return this._redirectedTo?this._redirectedTo._finalRequest():this}}pT.Request=p;class f extends t.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r)}request(){return p.from(this._initializer.request)}_raceWithPageClose(e){const t=this.request().frame()._page;return Promise.race([e,t?t._closedOrCrashedPromise:Promise.resolve()])}async abort(e){await this._raceWithPageClose(this._channel.abort({errorCode:e}))}async fulfill(e={}){let t,{status:n,headers:s,body:a}=e;e.response&&(n||(n=e.response.status()),s||(s=e.response.headers()),void 0===e.body&&void 0===e.path&&e.response instanceof d.APIResponse&&(e.response._request._connection===this._connection?t=e.response._fetchUid():a=await e.response.body()));let l=!1,c=0;if(e.path){const t=await r.default.promises.readFile(e.path);a=t.toString("base64"),l=!0,c=t.length}else(0,o.isString)(a)?(l=!1,c=Buffer.byteLength(a)):a&&(c=a.length,a=a.toString("base64"),l=!0);const u={};for(const e of Object.keys(s||{}))u[e.toLowerCase()]=String(s[e]);e.contentType?u["content-type"]=String(e.contentType):e.path&&(u["content-type"]=i.getType(e.path)||"application/octet-stream"),c&&!("content-length"in u)&&(u["content-length"]=String(c)),await this._raceWithPageClose(this._channel.fulfill({status:n||200,headers:(0,o.headersObjectToArray)(u),body:a,isBase64:l,fetchResponseUid:t}))}async continue(e={}){await this._continue(e)}async _internalContinue(e={}){await this._continue(e,!0).catch((()=>{}))}async _continue(e,t){return await this._wrapApiCall((async()=>{const t=(0,o.isString)(e.postData)?Buffer.from(e.postData,"utf8"):e.postData;await this._raceWithPageClose(this._channel.continue({url:e.url,method:e.method,headers:e.headers?(0,o.headersObjectToArray)(e.headers):void 0,postData:t?t.toString("base64"):void 0}))}),t)}}pT.Route=f;class m extends t.ChannelOwner{static from(e){return e._object}static fromNullable(e){return e?m.from(e):null}constructor(e,t,n,r){super(e,t,n,r),this._provisionalHeaders=void 0,this._actualHeadersPromise=void 0,this._request=void 0,this._finishedPromise=new s.ManualPromise,this._provisionalHeaders=new _(r.headers),this._request=p.from(this._initializer.request),Object.assign(this._request._timing,this._initializer.timing)}url(){return this._initializer.url}ok(){return 0===this._initializer.status||this._initializer.status>=200&&this._initializer.status<=299}status(){return this._initializer.status}statusText(){return this._initializer.statusText}headers(){return this._provisionalHeaders.headers()}async _actualHeaders(){return this._actualHeadersPromise||(this._actualHeadersPromise=(async()=>new _((await this._channel.rawResponseHeaders()).headers))()),this._actualHeadersPromise}async allHeaders(){return(await this._actualHeaders()).headers()}async headersArray(){return(await this._actualHeaders()).headersArray().slice()}async headerValue(e){return(await this._actualHeaders()).get(e)}async headerValues(e){return(await this._actualHeaders()).getAll(e)}async finished(){return this._finishedPromise.then((()=>null))}async body(){return Buffer.from((await this._channel.body()).binary,"base64")}async text(){return(await this.body()).toString("utf8")}async json(){const e=await this.text();return JSON.parse(e)}request(){return this._request}frame(){return this._request.frame()}async serverAddr(){return(await this._channel.serverAddr()).value||null}async securityDetails(){return(await this._channel.securityDetails()).value||null}}pT.Response=m;class g extends t.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r),this._page=void 0,this._isClosed=void 0,this._isClosed=!1,this._page=e,this._channel.on("frameSent",(e=>{1===e.opcode?this.emit(a.Events.WebSocket.FrameSent,{payload:e.data}):2===e.opcode&&this.emit(a.Events.WebSocket.FrameSent,{payload:Buffer.from(e.data,"base64")})})),this._channel.on("frameReceived",(e=>{1===e.opcode?this.emit(a.Events.WebSocket.FrameReceived,{payload:e.data}):2===e.opcode&&this.emit(a.Events.WebSocket.FrameReceived,{payload:Buffer.from(e.data,"base64")})})),this._channel.on("socketError",(({error:e})=>this.emit(a.Events.WebSocket.Error,e))),this._channel.on("close",(()=>{this._isClosed=!0,this.emit(a.Events.WebSocket.Close,this)}))}url(){return this._initializer.url}isClosed(){return this._isClosed}async waitForEvent(e,t={}){return this._wrapApiCall((async()=>{const n=this._page._timeoutSettings.timeout("function"==typeof t?{}:t),r="function"==typeof t?t:t.predicate,i=l.Waiter.createForEvent(this,e);i.rejectOnTimeout(n,`Timeout ${n}ms exceeded while waiting for event "${e}"`),e!==a.Events.WebSocket.Error&&i.rejectOnEvent(this,a.Events.WebSocket.Error,new Error("Socket error")),e!==a.Events.WebSocket.Close&&i.rejectOnEvent(this,a.Events.WebSocket.Close,new Error("Socket closed")),i.rejectOnEvent(this._page,a.Events.Page.Close,new Error("Page closed"));const o=await i.waitForEvent(this,e,r);return i.dispose(),o}))}}pT.WebSocket=g;pT.RouteHandler=class{constructor(e,t,n,r=Number.MAX_SAFE_INTEGER){this.handledCount=0,this._baseURL=void 0,this._times=void 0,this.url=void 0,this.handler=void 0,this._baseURL=e,this._times=r,this.url=t,this.handler=n}matches(e){return(0,c.urlMatches)(this._baseURL,e,this.url)}handle(e,t){++this.handledCount,this.handler(e,t)}isActive(){return this.handledCount<this._times}};class _{constructor(e){this._headersArray=void 0,this._headersMap=new u.MultiMap,this._headersArray=e;for(const t of e)this._headersMap.set(t.name.toLowerCase(),t.value)}get(e){const t=this.getAll(e);return t&&t.length?t.join("set-cookie"===e.toLowerCase()?"\n":", "):null}getAll(e){return[...this._headersMap.get(e.toLowerCase())]}headers(){const e={};for(const t of this._headersMap.keys())e[t]=this.get(t);return e}headersArray(){return this._headersArray}}return pT.RawHeaders=_,pT}PT.Tracing=zT;var KT={};Object.defineProperty(KT,"__esModule",{value:!0}),KT.kLifecycleEvents=void 0;const JT=new Set(["load","domcontentloaded","networkidle","commit"]);var YT;function XT(){if(YT)return dT;YT=1,Object.defineProperty(dT,"__esModule",{value:!0}),dT.Frame=void 0,dT.verifyLoadState=m;var e=Ci,t=IC,n=function(){if(cT)return hT;cT=1,Object.defineProperty(hT,"__esModule",{value:!0}),hT.Locator=hT.FrameLocator=void 0;var e=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(N.default),t=Ci,n=iP(),r=KC,i=hf;let o;function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}o=e.inspect.custom;class a{constructor(e,n,r){if(this._frame=void 0,this._selector=void 0,this._frame=e,this._selector=n,null!=r&&r.hasText){const e=r.hasText;(0,t.isRegExp)(e)?this._selector+=` >> :scope:text-matches(${(0,i.escapeWithQuotes)(e.source,'"')}, "${e.flags}")`:this._selector+=` >> :scope:has-text(${(0,i.escapeWithQuotes)(e,'"')})`}if(null!=r&&r.has){if(r.has._frame!==e)throw new Error('Inner "has" locator must belong to the same frame.');this._selector+=" >> has="+JSON.stringify(r.has._selector)}}async _withElement(e,r){const i=(r=this._frame.page()._timeoutSettings.timeout({timeout:r}))?(0,t.monotonicTime)()+r:0;return this._frame._wrapApiCall((async()=>{const o=await this._frame._channel.waitForSelector({selector:this._selector,strict:!0,state:"attached",timeout:r}),s=n.ElementHandle.fromNullable(o.element);if(!s)throw new Error(`Could not resolve ${this._selector} to DOM Element`);try{return await e(s,i?i-(0,t.monotonicTime)():0)}finally{await s.dispose()}}))}page(){return this._frame.page()}async boundingBox(e){return this._withElement((e=>e.boundingBox()),null==e?void 0:e.timeout)}async check(e={}){return this._frame.check(this._selector,{strict:!0,...e})}async click(e={}){return this._frame.click(this._selector,{strict:!0,...e})}async dblclick(e={}){return this._frame.dblclick(this._selector,{strict:!0,...e})}async dispatchEvent(e,t={},n){return this._frame.dispatchEvent(this._selector,e,t,{strict:!0,...n})}async dragTo(e,t={}){return this._frame.dragAndDrop(this._selector,e._selector,{strict:!0,...t})}async evaluate(e,t,n){return this._withElement((n=>n.evaluate(e,t)),null==n?void 0:n.timeout)}async evaluateAll(e,t){return this._frame.$$eval(this._selector,e,t)}async evaluateHandle(e,t,n){return this._withElement((n=>n.evaluateHandle(e,t)),null==n?void 0:n.timeout)}async fill(e,t={}){return this._frame.fill(this._selector,e,{strict:!0,...t})}async _highlight(){return this._frame._highlight(this._selector)}async highlight(){return this._frame._highlight(this._selector)}locator(e,t){return new a(this._frame,this._selector+" >> "+e,t)}frameLocator(e){return new l(this._frame,this._selector+" >> "+e)}async elementHandle(e){return await this._frame.waitForSelector(this._selector,{strict:!0,state:"attached",...e})}async elementHandles(){return this._frame.$$(this._selector)}first(){return new a(this._frame,this._selector+" >> nth=0")}last(){return new a(this._frame,this._selector+" >> nth=-1")}nth(e){return new a(this._frame,this._selector+` >> nth=${e}`)}async focus(e){return this._frame.focus(this._selector,{strict:!0,...e})}async count(){return this._frame._queryCount(this._selector)}async getAttribute(e,t){return this._frame.getAttribute(this._selector,e,{strict:!0,...t})}async hover(e={}){return this._frame.hover(this._selector,{strict:!0,...e})}async innerHTML(e){return this._frame.innerHTML(this._selector,{strict:!0,...e})}async innerText(e){return this._frame.innerText(this._selector,{strict:!0,...e})}async inputValue(e){return this._frame.inputValue(this._selector,{strict:!0,...e})}async isChecked(e){return this._frame.isChecked(this._selector,{strict:!0,...e})}async isDisabled(e){return this._frame.isDisabled(this._selector,{strict:!0,...e})}async isEditable(e){return this._frame.isEditable(this._selector,{strict:!0,...e})}async isEnabled(e){return this._frame.isEnabled(this._selector,{strict:!0,...e})}async isHidden(e){return this._frame.isHidden(this._selector,{strict:!0,...e})}async isVisible(e){return this._frame.isVisible(this._selector,{strict:!0,...e})}async press(e,t={}){return this._frame.press(this._selector,e,{strict:!0,...t})}async screenshot(e={}){return this._withElement(((t,n)=>t.screenshot({...e,timeout:n})),e.timeout)}async scrollIntoViewIfNeeded(e={}){return this._withElement(((t,n)=>t.scrollIntoViewIfNeeded({...e,timeout:n})),e.timeout)}async selectOption(e,t={}){return this._frame.selectOption(this._selector,e,{strict:!0,...t})}async selectText(e={}){return this._withElement(((t,n)=>t.selectText({...e,timeout:n})),e.timeout)}async setChecked(e,t){e?await this.check(t):await this.uncheck(t)}async setInputFiles(e,t={}){return this._frame.setInputFiles(this._selector,e,{strict:!0,...t})}async tap(e={}){return this._frame.tap(this._selector,{strict:!0,...e})}async textContent(e){return this._frame.textContent(this._selector,{strict:!0,...e})}async type(e,t={}){return this._frame.type(this._selector,e,{strict:!0,...t})}async uncheck(e={}){return this._frame.uncheck(this._selector,{strict:!0,...e})}async allInnerTexts(){return this._frame.$$eval(this._selector,(e=>e.map((e=>e.innerText))))}async allTextContents(){return this._frame.$$eval(this._selector,(e=>e.map((e=>e.textContent||""))))}async waitFor(e){await this._frame._channel.waitForSelector({selector:this._selector,strict:!0,omitReturnValue:!0,...e})}async _expect(e,t,n){return this._frame._wrapApiCall((async()=>{const e={selector:this._selector,expression:t,...n,isNot:!!n.isNot};n.expectedValue&&(e.expectedValue=(0,r.serializeArgument)(n.expectedValue));const i=await this._frame._channel.expect(e);return void 0!==i.received&&(i.received=(0,r.parseResult)(i.received)),i}),!1,e)}[o](){return this.toString()}toString(){return`Locator@${this._selector}`}}hT.Locator=a;class l{constructor(e,t){this._frame=void 0,this._frameSelector=void 0,this._frame=e,this._frameSelector=t}locator(e,t){return new a(this._frame,this._frameSelector+" >> control=enter-frame >> "+e,t)}frameLocator(e){return new l(this._frame,this._frameSelector+" >> control=enter-frame >> "+e)}first(){return new l(this._frame,this._frameSelector+" >> nth=0")}last(){return new l(this._frame,this._frameSelector+" >> nth=-1")}nth(e){return new l(this._frame,this._frameSelector+` >> nth=${e}`)}}return hT.FrameLocator=l,hT}(),r=iP(),i=KC,o=function(e){return e&&e.__esModule?e:{default:e}}(C.default),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(GT()),a=M.default,l=fT,c=PC,u=KT,d=bT,h=Ka;function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}class f extends t.ChannelOwner{static from(e){return e._object}static fromNullable(e){return e?f.from(e):null}constructor(e,t,n,r){super(e,t,n,r),this._eventEmitter=void 0,this._loadStates=void 0,this._parentFrame=null,this._url="",this._name="",this._detached=!1,this._childFrames=new Set,this._page=void 0,this._eventEmitter=new a.EventEmitter,this._eventEmitter.setMaxListeners(0),this._parentFrame=f.fromNullable(r.parentFrame),this._parentFrame&&this._parentFrame._childFrames.add(this),this._name=r.name,this._url=r.url,this._loadStates=new Set(r.loadStates),this._channel.on("loadstate",(e=>{e.add&&(this._loadStates.add(e.add),this._eventEmitter.emit("loadstate",e.add)),e.remove&&this._loadStates.delete(e.remove)})),this._channel.on("navigated",(e=>{this._url=e.url,this._name=e.name,this._eventEmitter.emit("navigated",e),!e.error&&this._page&&this._page.emit(c.Events.Page.FrameNavigated,this)}))}page(){return this._page}async goto(e,t={}){const n=m("waitUntil",void 0===t.waitUntil?"load":t.waitUntil);return s.Response.fromNullable((await this._channel.goto({url:e,...t,waitUntil:n})).response)}_setupNavigationWaiter(e){const t=new l.Waiter(this._page,"");this._page.isClosed()&&t.rejectImmediately(new Error("Navigation failed because page was closed!")),t.rejectOnEvent(this._page,c.Events.Page.Close,new Error("Navigation failed because page was closed!")),t.rejectOnEvent(this._page,c.Events.Page.Crash,new Error("Navigation failed because page crashed!")),t.rejectOnEvent(this._page,c.Events.Page.FrameDetached,new Error("Navigating frame was detached!"),(e=>e===this));const n=this._page._timeoutSettings.navigationTimeout(e);return t.rejectOnTimeout(n,`Timeout ${n}ms exceeded.`),t}async waitForNavigation(e={}){return this._page._wrapApiCall((async()=>{const t=m("waitUntil",void 0===e.waitUntil?"load":e.waitUntil),n=this._setupNavigationWaiter(e),r="string"==typeof e.url?` to "${e.url}"`:"";n.log(`waiting for navigation${r} until "${t}"`);const i=await n.waitForEvent(this._eventEmitter,"navigated",(t=>{var r;return!!t.error||(n.log(`  navigated to "${t.url}"`),(0,d.urlMatches)(null===(r=this._page)||void 0===r?void 0:r.context()._options.baseURL,t.url,e.url))}));if(i.error){const e=new Error(i.error);e.stack="",await n.waitForPromise(Promise.reject(e))}this._loadStates.has(t)||await n.waitForEvent(this._eventEmitter,"loadstate",(e=>(n.log(`  "${e}" event fired`),e===t)));const o=i.newDocument?s.Request.fromNullable(i.newDocument.request):null,a=o?await n.waitForPromise(o._finalRequest()._internalResponse()):null;return n.dispose(),a}))}async waitForLoadState(e="load",t={}){if(e=m("state",e),!this._loadStates.has(e))return this._page._wrapApiCall((async()=>{const n=this._setupNavigationWaiter(t);await n.waitForEvent(this._eventEmitter,"loadstate",(t=>(n.log(`  "${t}" event fired`),t===e))),n.dispose()}))}async waitForURL(e,t={}){var n;if((0,d.urlMatches)(null===(n=this._page)||void 0===n?void 0:n.context()._options.baseURL,this.url(),e))return await this.waitForLoadState(t.waitUntil,t);await this.waitForNavigation({url:e,...t})}async frameElement(){return r.ElementHandle.from((await this._channel.frameElement()).element)}async evaluateHandle(e,t){(0,i.assertMaxArguments)(arguments.length,2);const n=await this._channel.evaluateExpressionHandle({expression:String(e),isFunction:"function"==typeof e,arg:(0,i.serializeArgument)(t)});return i.JSHandle.from(n.handle)}async evaluate(e,t){(0,i.assertMaxArguments)(arguments.length,2);const n=await this._channel.evaluateExpression({expression:String(e),isFunction:"function"==typeof e,arg:(0,i.serializeArgument)(t)});return(0,i.parseResult)(n.value)}async $(e,t){const n=await this._channel.querySelector({selector:e,...t});return r.ElementHandle.fromNullable(n.element)}async waitForSelector(e,t={}){if(t.visibility)throw new Error("options.visibility is not supported, did you mean options.state?");if(t.waitFor&&"visible"!==t.waitFor)throw new Error("options.waitFor is not supported, did you mean options.state?");const n=await this._channel.waitForSelector({selector:e,...t});return r.ElementHandle.fromNullable(n.element)}async dispatchEvent(e,t,n,r={}){await this._channel.dispatchEvent({selector:e,type:t,eventInit:(0,i.serializeArgument)(n),...r})}async $eval(e,t,n){(0,i.assertMaxArguments)(arguments.length,3);const r=await this._channel.evalOnSelector({selector:e,expression:String(t),isFunction:"function"==typeof t,arg:(0,i.serializeArgument)(n)});return(0,i.parseResult)(r.value)}async $$eval(e,t,n){(0,i.assertMaxArguments)(arguments.length,3);const r=await this._channel.evalOnSelectorAll({selector:e,expression:String(t),isFunction:"function"==typeof t,arg:(0,i.serializeArgument)(n)});return(0,i.parseResult)(r.value)}async $$(e){return(await this._channel.querySelectorAll({selector:e})).elements.map((e=>r.ElementHandle.from(e)))}async _queryCount(e){return(await this._channel.queryCount({selector:e})).value}async content(){return(await this._channel.content()).value}async setContent(e,t={}){const n=m("waitUntil",void 0===t.waitUntil?"load":t.waitUntil);await this._channel.setContent({html:e,...t,waitUntil:n})}name(){return this._name||""}url(){return this._url}parentFrame(){return this._parentFrame}childFrames(){return Array.from(this._childFrames)}isDetached(){return this._detached}async addScriptTag(e={}){const t={...e};return t.path&&(t.content=(await o.default.promises.readFile(t.path)).toString(),t.content+="//# sourceURL="+t.path.replace(/\n/g,"")),r.ElementHandle.from((await this._channel.addScriptTag({...t})).element)}async addStyleTag(e={}){const t={...e};return t.path&&(t.content=(await o.default.promises.readFile(t.path)).toString(),t.content+="/*# sourceURL="+t.path.replace(/\n/g,"")+"*/"),r.ElementHandle.from((await this._channel.addStyleTag({...t})).element)}async click(e,t={}){return await this._channel.click({selector:e,...t})}async dblclick(e,t={}){return await this._channel.dblclick({selector:e,...t})}async dragAndDrop(e,t,n={}){return await this._channel.dragAndDrop({source:e,target:t,...n})}async tap(e,t={}){return await this._channel.tap({selector:e,...t})}async fill(e,t,n={}){return await this._channel.fill({selector:e,value:t,...n})}async _highlight(e){return await this._channel.highlight({selector:e})}locator(e,t){return new n.Locator(this,e,t)}frameLocator(e){return new n.FrameLocator(this,e)}async focus(e,t={}){await this._channel.focus({selector:e,...t})}async textContent(e,t={}){const n=(await this._channel.textContent({selector:e,...t})).value;return void 0===n?null:n}async innerText(e,t={}){return(await this._channel.innerText({selector:e,...t})).value}async innerHTML(e,t={}){return(await this._channel.innerHTML({selector:e,...t})).value}async getAttribute(e,t,n={}){const r=(await this._channel.getAttribute({selector:e,name:t,...n})).value;return void 0===r?null:r}async inputValue(e,t={}){return(await this._channel.inputValue({selector:e,...t})).value}async isChecked(e,t={}){return(await this._channel.isChecked({selector:e,...t})).value}async isDisabled(e,t={}){return(await this._channel.isDisabled({selector:e,...t})).value}async isEditable(e,t={}){return(await this._channel.isEditable({selector:e,...t})).value}async isEnabled(e,t={}){return(await this._channel.isEnabled({selector:e,...t})).value}async isHidden(e,t={}){return(await this._channel.isHidden({selector:e,...t})).value}async isVisible(e,t={}){return(await this._channel.isVisible({selector:e,...t})).value}async hover(e,t={}){await this._channel.hover({selector:e,...t})}async selectOption(e,t,n={}){return(await this._channel.selectOption({selector:e,...(0,r.convertSelectOptionValues)(t),...n})).values}async setInputFiles(e,t,n={}){const i=await(0,r.convertInputFiles)(t,this.page().context());i.files?await this._channel.setInputFiles({selector:e,files:i.files,...n}):(h.debugLogger.log("api","switching to large files mode"),await this._channel.setInputFilePaths({selector:e,...i,...n}))}async type(e,t,n={}){await this._channel.type({selector:e,text:t,...n})}async press(e,t,n={}){await this._channel.press({selector:e,key:t,...n})}async check(e,t={}){await this._channel.check({selector:e,...t})}async uncheck(e,t={}){await this._channel.uncheck({selector:e,...t})}async setChecked(e,t,n){t?await this.check(e,n):await this.uncheck(e,n)}async waitForTimeout(e){await this._channel.waitForTimeout({timeout:e})}async waitForFunction(t,n,r={}){"string"==typeof r.polling&&(0,e.assert)("raf"===r.polling,"Unknown polling option: "+r.polling);const o=await this._channel.waitForFunction({...r,pollingInterval:"raf"===r.polling?void 0:r.polling,expression:String(t),isFunction:"function"==typeof t,arg:(0,i.serializeArgument)(n)});return i.JSHandle.from(o.handle)}async title(){return(await this._channel.title()).value}}function m(e,t){if("networkidle0"===t&&(t="networkidle"),!u.kLifecycleEvents.has(t))throw new Error(`${e}: expected one of (load|domcontentloaded|networkidle|commit)`);return t}return dT.Frame=f,dT}KT.kLifecycleEvents=JT;var QT={};Object.defineProperty(QT,"__esModule",{value:!0}),QT.WritableStream=void 0;var ZT,eP=B.default,tP=IC;class nP extends tP.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r)}stream(){return new rP(this._channel)}}QT.WritableStream=nP;class rP extends eP.Writable{constructor(e){super(),this._channel=void 0,this._channel=e}async _write(e,t,n){n(await this._channel.write({binary:e.toString("base64")}).catch((e=>e))||null)}async _final(e){e(await this._channel.close().catch((e=>e))||null)}}function iP(){if(ZT)return uT;ZT=1,Object.defineProperty(uT,"__esModule",{value:!0}),uT.ElementHandle=void 0,uT.convertInputFiles=g,uT.convertSelectOptionValues=m,uT.determineScreenshotType=_;var e=XT(),t=KC,n=h(C.default),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(Su),i=h(T.default),o=Ci,s=Ri,a=QT,l=B.default,c=N.default,u=Ka;function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function h(e){return e&&e.__esModule?e:{default:e}}const p=(0,c.promisify)(l.pipeline);class f extends t.JSHandle{static from(e){return e._object}static fromNullable(e){return e?f.from(e):null}constructor(e,t,n,r){super(e,t,n,r),this._elementChannel=void 0,this._elementChannel=this._channel}asElement(){return this}async ownerFrame(){return e.Frame.fromNullable((await this._elementChannel.ownerFrame()).frame)}async contentFrame(){return e.Frame.fromNullable((await this._elementChannel.contentFrame()).frame)}async getAttribute(e){const t=(await this._elementChannel.getAttribute({name:e})).value;return void 0===t?null:t}async inputValue(){return(await this._elementChannel.inputValue()).value}async textContent(){const e=(await this._elementChannel.textContent()).value;return void 0===e?null:e}async innerText(){return(await this._elementChannel.innerText()).value}async innerHTML(){return(await this._elementChannel.innerHTML()).value}async isChecked(){return(await this._elementChannel.isChecked()).value}async isDisabled(){return(await this._elementChannel.isDisabled()).value}async isEditable(){return(await this._elementChannel.isEditable()).value}async isEnabled(){return(await this._elementChannel.isEnabled()).value}async isHidden(){return(await this._elementChannel.isHidden()).value}async isVisible(){return(await this._elementChannel.isVisible()).value}async dispatchEvent(e,n={}){await this._elementChannel.dispatchEvent({type:e,eventInit:(0,t.serializeArgument)(n)})}async scrollIntoViewIfNeeded(e={}){await this._elementChannel.scrollIntoViewIfNeeded(e)}async hover(e={}){await this._elementChannel.hover(e)}async click(e={}){return await this._elementChannel.click(e)}async dblclick(e={}){return await this._elementChannel.dblclick(e)}async tap(e={}){return await this._elementChannel.tap(e)}async selectOption(e,t={}){return(await this._elementChannel.selectOption({...m(e),...t})).values}async fill(e,t={}){return await this._elementChannel.fill({value:e,...t})}async selectText(e={}){await this._elementChannel.selectText(e)}async setInputFiles(e,t={}){const n=await this.ownerFrame();if(!n)throw new Error("Cannot set input files to detached element");const r=await g(e,n.page().context());r.files?await this._elementChannel.setInputFiles({files:r.files,...t}):(u.debugLogger.log("api","switching to large files mode"),await this._elementChannel.setInputFilePaths({...r,...t}))}async focus(){await this._elementChannel.focus()}async type(e,t={}){await this._elementChannel.type({text:e,...t})}async press(e,t={}){await this._elementChannel.press({key:e,...t})}async check(e={}){return await this._elementChannel.check(e)}async uncheck(e={}){return await this._elementChannel.uncheck(e)}async setChecked(e,t){e?await this.check(t):await this.uncheck(t)}async boundingBox(){const e=(await this._elementChannel.boundingBox()).value;return void 0===e?null:e}async screenshot(e={}){const t={...e,mask:void 0};t.type||(t.type=_(e)),e.mask&&(t.mask=e.mask.map((e=>({frame:e._frame._channel,selector:e._selector})))),t.fonts=e._fonts;const r=await this._elementChannel.screenshot(t),i=Buffer.from(r.binary,"base64");return e.path&&(await(0,s.mkdirIfNeeded)(e.path),await n.default.promises.writeFile(e.path,i)),i}async $(e){return f.fromNullable((await this._elementChannel.querySelector({selector:e})).element)}async $$(e){return(await this._elementChannel.querySelectorAll({selector:e})).elements.map((e=>f.from(e)))}async $eval(e,n,r){const i=await this._elementChannel.evalOnSelector({selector:e,expression:String(n),isFunction:"function"==typeof n,arg:(0,t.serializeArgument)(r)});return(0,t.parseResult)(i.value)}async $$eval(e,n,r){const i=await this._elementChannel.evalOnSelectorAll({selector:e,expression:String(n),isFunction:"function"==typeof n,arg:(0,t.serializeArgument)(r)});return(0,t.parseResult)(i.value)}async waitForElementState(e,t={}){return await this._elementChannel.waitForElementState({state:e,...t})}async waitForSelector(e,t={}){const n=await this._elementChannel.waitForSelector({selector:e,...t});return f.fromNullable(n.element)}}function m(e){if(null===e)return{};if(Array.isArray(e)||(e=[e]),!e.length)return{};for(let t=0;t<e.length;t++)(0,o.assert)(null!==e[t],`options[${t}]: expected object, got null`);return e[0]instanceof f?{elements:e.map((e=>e._elementChannel))}:(0,o.isString)(e[0])?{options:e.map((e=>({value:e})))}:{options:e}}async function g(e,t){const r=Array.isArray(e)?e.slice():[e],s=52428800;if(r.find((e=>"object"==typeof e&&e.buffer&&e.buffer.byteLength>s)))throw new Error("Cannot set buffer larger than 50Mb, please write it to a file and pass its path instead.");if(!!(await Promise.all(r.filter(o.isString).map((e=>n.default.promises.stat(e))))).find((e=>e.size>s))){if(t._connection.isRemote()){const e=await Promise.all(r.map((async e=>{(0,o.assert)((0,o.isString)(e));const{writableStream:r}=await t._channel.createTempFile({name:i.default.basename(e)}),s=a.WritableStream.from(r);return await p(n.default.createReadStream(e),s.stream()),r})));return{streams:e}}return{localPaths:r}}return{files:await Promise.all(r.map((async e=>"string"==typeof e?{name:i.default.basename(e),buffer:(await n.default.promises.readFile(e)).toString("base64")}:{name:e.name,mimeType:e.mimeType,buffer:e.buffer.toString("base64")})))}}function _(e){if(e.path){const t=r.getType(e.path);if("image/png"===t)return"png";if("image/jpeg"===t)return"jpeg";throw new Error(`path: unsupported mime type "${t}"`)}return e.type}return uT.ElementHandle=f,uT}var oP={};Object.defineProperty(oP,"__esModule",{value:!0}),oP.Worker=void 0;var sP=PC,aP=IC,lP=KC;class cP extends aP.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r),this._page=void 0,this._context=void 0,this._channel.on("close",(()=>{this._page&&this._page._workers.delete(this),this._context&&this._context._serviceWorkers.delete(this),this.emit(sP.Events.Worker.Close,this)}))}url(){return this._initializer.url}async evaluate(e,t){(0,lP.assertMaxArguments)(arguments.length,2);const n=await this._channel.evaluateExpression({expression:String(e),isFunction:"function"==typeof e,arg:(0,lP.serializeArgument)(t)});return(0,lP.parseResult)(n.value)}async evaluateHandle(e,t){(0,lP.assertMaxArguments)(arguments.length,2);const n=await this._channel.evaluateExpressionHandle({expression:String(e),isFunction:"function"==typeof e,arg:(0,lP.serializeArgument)(t)});return lP.JSHandle.from(n.handle)}}oP.Worker=cP;var uP={};Object.defineProperty(uP,"__esModule",{value:!0}),uP.Touchscreen=uP.Mouse=uP.Keyboard=void 0;uP.Keyboard=class{constructor(e){this._page=void 0,this._page=e}async down(e){await this._page._channel.keyboardDown({key:e})}async up(e){await this._page._channel.keyboardUp({key:e})}async insertText(e){await this._page._channel.keyboardInsertText({text:e})}async type(e,t={}){await this._page._channel.keyboardType({text:e,...t})}async press(e,t={}){await this._page._channel.keyboardPress({key:e,...t})}};uP.Mouse=class{constructor(e){this._page=void 0,this._page=e}async move(e,t,n={}){await this._page._channel.mouseMove({x:e,y:t,...n})}async down(e={}){await this._page._channel.mouseDown({...e})}async up(e={}){await this._page._channel.mouseUp(e)}async click(e,t,n={}){await this._page._channel.mouseClick({x:e,y:t,...n})}async dblclick(e,t,n={}){await this.click(e,t,{...n,clickCount:2})}async wheel(e,t){await this._page._channel.mouseWheel({deltaX:e,deltaY:t})}};uP.Touchscreen=class{constructor(e){this._page=void 0,this._page=e}async tap(e,t){await this._page._channel.touchscreenTap({x:e,y:t})}};var dP={};Object.defineProperty(dP,"__esModule",{value:!0}),dP.FileChooser=void 0;dP.FileChooser=class{constructor(e,t,n){this._page=void 0,this._elementHandle=void 0,this._isMultiple=void 0,this._page=e,this._elementHandle=t,this._isMultiple=n}element(){return this._elementHandle}isMultiple(){return this._isMultiple}page(){return this._page}async setFiles(e,t){return this._elementHandle.setInputFiles(e,t)}};var hP={};Object.defineProperty(hP,"__esModule",{value:!0}),hP.Coverage=void 0;hP.Coverage=class{constructor(e){this._channel=void 0,this._channel=e}async startJSCoverage(e={}){await this._channel.startJSCoverage(e)}async stopJSCoverage(){return(await this._channel.stopJSCoverage()).entries}async startCSSCoverage(e={}){await this._channel.startCSSCoverage(e)}async stopCSSCoverage(){return(await this._channel.stopCSSCoverage()).entries}};var pP={};Object.defineProperty(pP,"__esModule",{value:!0}),pP.Video=void 0;pP.Video=class{constructor(e,t){this._artifact=null,this._artifactCallback=e=>{},this._isRemote=!1,this._isRemote=t.isRemote(),this._artifact=Promise.race([new Promise((e=>this._artifactCallback=e)),e._closedOrCrashedPromise.then((()=>null))])}_artifactReady(e){this._artifactCallback(e)}async path(){if(this._isRemote)throw new Error("Path is not available when connecting remotely. Use saveAs() to save a local copy.");const e=await this._artifact;if(!e)throw new Error("Page did not produce any video frames");return e._initializer.absolutePath}async saveAs(e){const t=await this._artifact;if(!t)throw new Error("Page did not produce any video frames");return t.saveAs(e)}async delete(){const e=await this._artifact;e&&await e.delete()}},Object.defineProperty(TC,"__esModule",{value:!0}),TC.Page=TC.BindingCall=void 0;var fP=PC,mP=Ci,gP=ru,_P=Ol,wP=OC,vP=IC,bP=GC,yP=oT,SP=lT,xP=iP(),kP=oP,EP=XT(),CP=uP,TP=KC,PP=GT(),OP=dP,AP=W.default,IP=hP,MP=fT,FP=HP(C.default),NP=HP(T.default),RP=bT,jP=Ri,DP=Al,LP=pP,BP=OT;function HP(e){return e&&e.__esModule?e:{default:e}}class qP extends vP.ChannelOwner{static from(e){return e._object}static fromNullable(e){return e?qP.from(e):null}constructor(e,t,n,r){super(e,t,n,r),this._browserContext=void 0,this._ownedContext=void 0,this._mainFrame=void 0,this._frames=new Set,this._workers=new Set,this._closed=!1,this._closedOrCrashedPromise=void 0,this._viewportSize=void 0,this._routes=[],this.accessibility=void 0,this.coverage=void 0,this.keyboard=void 0,this.mouse=void 0,this.request=void 0,this.touchscreen=void 0,this._bindings=new Map,this._timeoutSettings=void 0,this._video=null,this._opener=void 0,this._browserContext=e,this._timeoutSettings=new gP.TimeoutSettings(this._browserContext._timeoutSettings),this.accessibility=new wP.Accessibility(this._channel),this.keyboard=new CP.Keyboard(this),this.mouse=new CP.Mouse(this),this.request=this._browserContext.request,this.touchscreen=new CP.Touchscreen(this),this._mainFrame=EP.Frame.from(r.mainFrame),this._mainFrame._page=this,this._frames.add(this._mainFrame),this._viewportSize=r.viewportSize||null,this._closed=r.isClosed,this._opener=qP.fromNullable(r.opener),this._channel.on("bindingCall",(({binding:e})=>this._onBinding(UP.from(e)))),this._channel.on("close",(()=>this._onClose())),this._channel.on("console",(({message:e})=>this.emit(fP.Events.Page.Console,bP.ConsoleMessage.from(e)))),this._channel.on("crash",(()=>this._onCrash())),this._channel.on("dialog",(({dialog:e})=>{const t=yP.Dialog.from(e);this.emit(fP.Events.Page.Dialog,t)||("beforeunload"===t.type()?e.accept({}).catch((()=>{})):e.dismiss().catch((()=>{})))})),this._channel.on("domcontentloaded",(()=>this.emit(fP.Events.Page.DOMContentLoaded,this))),this._channel.on("download",(({url:e,suggestedFilename:t,artifact:n})=>{const r=BP.Artifact.from(n);this.emit(fP.Events.Page.Download,new SP.Download(this,e,t,r))})),this._channel.on("fileChooser",(({element:e,isMultiple:t})=>this.emit(fP.Events.Page.FileChooser,new OP.FileChooser(this,xP.ElementHandle.from(e),t)))),this._channel.on("frameAttached",(({frame:e})=>this._onFrameAttached(EP.Frame.from(e)))),this._channel.on("frameDetached",(({frame:e})=>this._onFrameDetached(EP.Frame.from(e)))),this._channel.on("load",(()=>this.emit(fP.Events.Page.Load,this))),this._channel.on("pageError",(({error:e})=>this.emit(fP.Events.Page.PageError,(0,_P.parseError)(e)))),this._channel.on("route",(({route:e,request:t})=>this._onRoute(PP.Route.from(e),PP.Request.from(t)))),this._channel.on("video",(({artifact:e})=>{const t=BP.Artifact.from(e);this._forceVideo()._artifactReady(t)})),this._channel.on("webSocket",(({webSocket:e})=>this.emit(fP.Events.Page.WebSocket,PP.WebSocket.from(e)))),this._channel.on("worker",(({worker:e})=>this._onWorker(kP.Worker.from(e)))),this.coverage=new IP.Coverage(this._channel),this._closedOrCrashedPromise=Promise.race([new Promise((e=>this.once(fP.Events.Page.Close,e))),new Promise((e=>this.once(fP.Events.Page.Crash,e)))])}_onFrameAttached(e){e._page=this,this._frames.add(e),e._parentFrame&&e._parentFrame._childFrames.add(e),this.emit(fP.Events.Page.FrameAttached,e)}_onFrameDetached(e){this._frames.delete(e),e._detached=!0,e._parentFrame&&e._parentFrame._childFrames.delete(e),this.emit(fP.Events.Page.FrameDetached,e)}_onRoute(e,t){for(const n of this._routes)if(n.matches(t.url())){try{n.handle(e,t)}finally{n.isActive()||(this._routes.splice(this._routes.indexOf(n),1),this._routes.length||this._wrapApiCall((()=>this._disableInterception()),!0).catch((()=>{})))}return}this._browserContext._onRoute(e,t)}async _onBinding(e){const t=this._bindings.get(e._initializer.name);t?await e.call(t):await this._browserContext._onBinding(e)}_onWorker(e){this._workers.add(e),e._page=this,this.emit(fP.Events.Page.Worker,e)}_onClose(){this._closed=!0,this._browserContext._pages.delete(this),this._browserContext._backgroundPages.delete(this),this.emit(fP.Events.Page.Close,this)}_onCrash(){this.emit(fP.Events.Page.Crash,this)}context(){return this._browserContext}async opener(){return!this._opener||this._opener.isClosed()?null:this._opener}mainFrame(){return this._mainFrame}frame(e){const t=(0,mP.isString)(e)?e:e.name,n=(0,mP.isObject)(e)?e.url:void 0;return(0,mP.assert)(t||n,"Either name or url matcher should be specified"),this.frames().find((e=>t?e.name()===t:(0,RP.urlMatches)(this._browserContext._options.baseURL,e.url(),n)))||null}frames(){return[...this._frames]}setDefaultNavigationTimeout(e){this._timeoutSettings.setDefaultNavigationTimeout(e),this._wrapApiCall((async()=>{this._channel.setDefaultNavigationTimeoutNoReply({timeout:e})}),!0)}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e),this._wrapApiCall((async()=>{this._channel.setDefaultTimeoutNoReply({timeout:e})}),!0)}_forceVideo(){return this._video||(this._video=new LP.Video(this,this._connection)),this._video}video(){return this._browserContext._options.recordVideo?this._forceVideo():null}async $(e,t){return this._mainFrame.$(e,t)}async waitForSelector(e,t){return this._mainFrame.waitForSelector(e,t)}async dispatchEvent(e,t,n,r){return this._mainFrame.dispatchEvent(e,t,n,r)}async evaluateHandle(e,t){return(0,TP.assertMaxArguments)(arguments.length,2),this._mainFrame.evaluateHandle(e,t)}async $eval(e,t,n){return(0,TP.assertMaxArguments)(arguments.length,3),this._mainFrame.$eval(e,t,n)}async $$eval(e,t,n){return(0,TP.assertMaxArguments)(arguments.length,3),this._mainFrame.$$eval(e,t,n)}async $$(e){return this._mainFrame.$$(e)}async addScriptTag(e={}){return this._mainFrame.addScriptTag(e)}async addStyleTag(e={}){return this._mainFrame.addStyleTag(e)}async exposeFunction(e,t){await this._channel.exposeBinding({name:e});this._bindings.set(e,((e,...n)=>t(...n)))}async exposeBinding(e,t,n={}){await this._channel.exposeBinding({name:e,needsHandle:n.handle}),this._bindings.set(e,t)}async _removeExposedBindings(){this._bindings.clear(),await this._channel.removeExposedBindings()}async setExtraHTTPHeaders(e){(0,PP.validateHeaders)(e),await this._channel.setExtraHTTPHeaders({headers:(0,mP.headersObjectToArray)(e)})}url(){return this._mainFrame.url()}async content(){return this._mainFrame.content()}async setContent(e,t){return this._mainFrame.setContent(e,t)}async goto(e,t){return this._mainFrame.goto(e,t)}async reload(e={}){const t=(0,EP.verifyLoadState)("waitUntil",void 0===e.waitUntil?"load":e.waitUntil);return PP.Response.fromNullable((await this._channel.reload({...e,waitUntil:t})).response)}async waitForLoadState(e,t){return this._mainFrame.waitForLoadState(e,t)}async waitForNavigation(e){return this._mainFrame.waitForNavigation(e)}async waitForURL(e,t){return this._mainFrame.waitForURL(e,t)}async waitForRequest(e,t={}){const n=$P(e),r=n?`waiting for request ${n}`:void 0;return this._waitForEvent(fP.Events.Page.Request,{predicate:t=>(0,mP.isString)(e)||(0,mP.isRegExp)(e)?(0,RP.urlMatches)(this._browserContext._options.baseURL,t.url(),e):e(t),timeout:t.timeout},r)}async waitForResponse(e,t={}){const n=$P(e),r=n?`waiting for response ${n}`:void 0;return this._waitForEvent(fP.Events.Page.Response,{predicate:t=>(0,mP.isString)(e)||(0,mP.isRegExp)(e)?(0,RP.urlMatches)(this._browserContext._options.baseURL,t.url(),e):e(t),timeout:t.timeout},r)}async waitForEvent(e,t={}){return this._waitForEvent(e,t,`waiting for event "${e}"`)}async _waitForEvent(e,t,n){return this._wrapApiCall((async()=>{const r=this._timeoutSettings.timeout("function"==typeof t?{}:t),i="function"==typeof t?t:t.predicate,o=MP.Waiter.createForEvent(this,e);n&&o.log(n),o.rejectOnTimeout(r,`Timeout ${r}ms exceeded while waiting for event "${e}"`),e!==fP.Events.Page.Crash&&o.rejectOnEvent(this,fP.Events.Page.Crash,new Error("Page crashed")),e!==fP.Events.Page.Close&&o.rejectOnEvent(this,fP.Events.Page.Close,new Error("Page closed"));const s=await o.waitForEvent(this,e,i);return o.dispose(),s}))}async goBack(e={}){const t=(0,EP.verifyLoadState)("waitUntil",void 0===e.waitUntil?"load":e.waitUntil);return PP.Response.fromNullable((await this._channel.goBack({...e,waitUntil:t})).response)}async goForward(e={}){const t=(0,EP.verifyLoadState)("waitUntil",void 0===e.waitUntil?"load":e.waitUntil);return PP.Response.fromNullable((await this._channel.goForward({...e,waitUntil:t})).response)}async emulateMedia(e={}){await this._channel.emulateMedia({media:null===e.media?"null":e.media,colorScheme:null===e.colorScheme?"null":e.colorScheme,reducedMotion:null===e.reducedMotion?"null":e.reducedMotion,forcedColors:null===e.forcedColors?"null":e.forcedColors})}async setViewportSize(e){this._viewportSize=e,await this._channel.setViewportSize({viewportSize:e})}viewportSize(){return this._viewportSize}async evaluate(e,t){return(0,TP.assertMaxArguments)(arguments.length,2),this._mainFrame.evaluate(e,t)}async addInitScript(e,t){const n=await(0,RP.evaluationScript)(e,t);await this._channel.addInitScript({source:n})}async _removeInitScripts(){await this._channel.removeInitScripts()}async route(e,t,n={}){this._routes.unshift(new PP.RouteHandler(this._browserContext._options.baseURL,e,t,n.times)),1===this._routes.length&&await this._channel.setNetworkInterceptionEnabled({enabled:!0})}async unroute(e,t){this._routes=this._routes.filter((n=>n.url!==e||t&&n.handler!==t)),this._routes.length||await this._disableInterception()}async _unrouteAll(){this._routes=[],await this._disableInterception()}async _disableInterception(){await this._channel.setNetworkInterceptionEnabled({enabled:!1})}async screenshot(e={}){const t={...e,mask:void 0};t.type||(t.type=(0,xP.determineScreenshotType)(e)),e.mask&&(t.mask=e.mask.map((e=>({frame:e._frame._channel,selector:e._selector})))),t.fonts=e._fonts;const n=await this._channel.screenshot(t),r=AP.Buffer.from(n.binary,"base64");return e.path&&(await(0,jP.mkdirIfNeeded)(e.path),await FP.default.promises.writeFile(e.path,r)),r}async _expectScreenshot(e,t){return this._wrapApiCall((async()=>{var e,n;const r=null!==(e=t.screenshotOptions)&&void 0!==e&&e.mask?null===(n=t.screenshotOptions)||void 0===n?void 0:n.mask.map((e=>({frame:e._frame._channel,selector:e._selector}))):void 0,i=t.locator?{frame:t.locator._frame._channel,selector:t.locator._selector}:void 0,o=t.expected?t.expected.toString("base64"):void 0,s=await this._channel.expectScreenshot({...t,isNot:!!t.isNot,expected:o,locator:i,screenshotOptions:{...t.screenshotOptions,mask:r}});return{log:s.log,actual:s.actual?AP.Buffer.from(s.actual,"base64"):void 0,previous:s.previous?AP.Buffer.from(s.previous,"base64"):void 0,diff:s.diff?AP.Buffer.from(s.diff,"base64"):void 0,errorMessage:s.errorMessage}}),!1,e)}async title(){return this._mainFrame.title()}async bringToFront(){await this._channel.bringToFront()}async close(e={runBeforeUnload:void 0}){try{this._ownedContext?await this._ownedContext.close():await this._channel.close(e)}catch(e){if((0,DP.isSafeCloseError)(e))return;throw e}}isClosed(){return this._closed}async click(e,t){return this._mainFrame.click(e,t)}async dragAndDrop(e,t,n){return this._mainFrame.dragAndDrop(e,t,n)}async dblclick(e,t){return this._mainFrame.dblclick(e,t)}async tap(e,t){return this._mainFrame.tap(e,t)}async fill(e,t,n){return this._mainFrame.fill(e,t,n)}locator(e,t){return this.mainFrame().locator(e,t)}frameLocator(e){return this.mainFrame().frameLocator(e)}async focus(e,t){return this._mainFrame.focus(e,t)}async textContent(e,t){return this._mainFrame.textContent(e,t)}async innerText(e,t){return this._mainFrame.innerText(e,t)}async innerHTML(e,t){return this._mainFrame.innerHTML(e,t)}async getAttribute(e,t,n){return this._mainFrame.getAttribute(e,t,n)}async inputValue(e,t){return this._mainFrame.inputValue(e,t)}async isChecked(e,t){return this._mainFrame.isChecked(e,t)}async isDisabled(e,t){return this._mainFrame.isDisabled(e,t)}async isEditable(e,t){return this._mainFrame.isEditable(e,t)}async isEnabled(e,t){return this._mainFrame.isEnabled(e,t)}async isHidden(e,t){return this._mainFrame.isHidden(e,t)}async isVisible(e,t){return this._mainFrame.isVisible(e,t)}async hover(e,t){return this._mainFrame.hover(e,t)}async selectOption(e,t,n){return this._mainFrame.selectOption(e,t,n)}async setInputFiles(e,t,n){return this._mainFrame.setInputFiles(e,t,n)}async type(e,t,n){return this._mainFrame.type(e,t,n)}async press(e,t,n){return this._mainFrame.press(e,t,n)}async check(e,t){return this._mainFrame.check(e,t)}async uncheck(e,t){return this._mainFrame.uncheck(e,t)}async setChecked(e,t,n){return this._mainFrame.setChecked(e,t,n)}async waitForTimeout(e){return this._mainFrame.waitForTimeout(e)}async waitForFunction(e,t,n){return this._mainFrame.waitForFunction(e,t,n)}workers(){return[...this._workers]}on(e,t){return e!==fP.Events.Page.FileChooser||this.listenerCount(e)||this._channel.setFileChooserInterceptedNoReply({intercepted:!0}),super.on(e,t),this}addListener(e,t){return e!==fP.Events.Page.FileChooser||this.listenerCount(e)||this._channel.setFileChooserInterceptedNoReply({intercepted:!0}),super.addListener(e,t),this}off(e,t){return super.off(e,t),e!==fP.Events.Page.FileChooser||this.listenerCount(e)||this._channel.setFileChooserInterceptedNoReply({intercepted:!1}),this}removeListener(e,t){return super.removeListener(e,t),e!==fP.Events.Page.FileChooser||this.listenerCount(e)||this._channel.setFileChooserInterceptedNoReply({intercepted:!1}),this}async pause(){K.default.url()||await this.context()._channel.pause()}async pdf(e={}){const t={...e};t.margin&&(t.margin={...t.margin}),"number"==typeof e.width&&(t.width=e.width+"px"),"number"==typeof e.height&&(t.height=e.height+"px");for(const n of["top","right","bottom","left"]){const r=n;e.margin&&"number"==typeof e.margin[r]&&(t.margin[r]=t.margin[r]+"px")}const n=await this._channel.pdf(t),r=AP.Buffer.from(n.pdf,"base64");return e.path&&(await FP.default.promises.mkdir(NP.default.dirname(e.path),{recursive:!0}),await FP.default.promises.writeFile(e.path,r)),r}async _resetForReuse(){await this._unrouteAll(),await this._removeInitScripts(),await this._removeExposedBindings()}}TC.Page=qP;class UP extends vP.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r)}async call(e){try{const t=EP.Frame.from(this._initializer.frame),n={context:t._page.context(),page:t._page,frame:t};let r;r=this._initializer.handle?await e(n,TP.JSHandle.from(this._initializer.handle)):await e(n,...this._initializer.args.map(TP.parseResult)),this._channel.resolve({result:(0,TP.serializeArgument)(r)}).catch((()=>{}))}catch(e){this._channel.reject({error:(0,_P.serializeError)(e)}).catch((()=>{}))}}}function WP(e){return e.length>50&&(e=e.substring(0,50)+""),e}function $P(e){return(0,mP.isRegExp)(e)?`/${WP(e.source)}/${e.flags}`:(0,mP.isString)(e)?`"${WP(e)}"`:void 0}TC.BindingCall=UP;var zP={};Object.defineProperty(zP,"__esModule",{value:!0}),zP.CDPSession=void 0;var VP,GP,KP=IC;class JP extends KP.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r),this._channel.on("event",(({method:e,params:t})=>{this.emit(e,t)})),this.on=super.on,this.addListener=super.addListener,this.off=super.removeListener,this.removeListener=super.removeListener,this.once=super.once}async send(e,t){return(await this._channel.send({method:e,params:t})).result}async detach(){return this._channel.detach()}}function YP(){if(VP)return CC;VP=1,Object.defineProperty(CC,"__esModule",{value:!0}),CC.BrowserContext=void 0,CC.prepareBrowserContextParams=async function(e){if(e.videoSize&&!e.videosPath)throw new Error('"videoSize" option requires "videosPath" to be specified');e.extraHTTPHeaders&&n.validateHeaders(e.extraHTTPHeaders);const t={...e,viewport:null===e.viewport?void 0:e.viewport,noDefaultViewport:null===e.viewport,extraHTTPHeaders:e.extraHTTPHeaders?(0,d.headersObjectToArray)(e.extraHTTPHeaders):void 0,storageState:await S(e)};!t.recordVideo&&e.videosPath&&(t.recordVideo={dir:e.videosPath,size:e.videoSize});return t};var e=TC,t=XT(),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=b(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(GT()),r=function(e){return e&&e.__esModule?e:{default:e}}(C.default),i=IC,o=bT,s=XP(),a=oP,l=PC,c=ru,u=fT,d=Ci,h=Ri,p=Al,f=zP,m=PT,g=OT,_=VT(),w=TT,v=$l;function b(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(b=function(e){return e?n:t})(e)}class y extends i.ChannelOwner{static from(e){return e._object}static fromNullable(e){return e?y.from(e):null}constructor(t,r,i,o){var u;super(t,r,i,o,(0,w.createInstrumentation)()),this._pages=new Set,this._routes=[],this._browser=null,this._browserType=void 0,this._bindings=new Map,this._timeoutSettings=new c.TimeoutSettings,this._ownerPage=void 0,this._closedPromise=void 0,this._options={},this.request=void 0,this.tracing=void 0,this._backgroundPages=new Set,this._serviceWorkers=new Set,this._isChromium=void 0,t instanceof s.Browser&&(this._browser=t),this._isChromium="chromium"===(null===(u=this._browser)||void 0===u?void 0:u._name),this.tracing=m.Tracing.from(o.tracing),this.request=_.APIRequestContext.from(o.APIRequestContext),this._channel.on("bindingCall",(({binding:t})=>this._onBinding(e.BindingCall.from(t)))),this._channel.on("close",(()=>this._onClose())),this._channel.on("page",(({page:t})=>this._onPage(e.Page.from(t)))),this._channel.on("route",(({route:e,request:t})=>this._onRoute(n.Route.from(e),n.Request.from(t)))),this._channel.on("backgroundPage",(({page:t})=>{const n=e.Page.from(t);this._backgroundPages.add(n),this.emit(l.Events.BrowserContext.BackgroundPage,n)})),this._channel.on("serviceWorker",(({worker:e})=>{const t=a.Worker.from(e);t._context=this,this._serviceWorkers.add(t),this.emit(l.Events.BrowserContext.ServiceWorker,t)})),this._channel.on("request",(({request:t,page:r})=>this._onRequest(n.Request.from(t),e.Page.fromNullable(r)))),this._channel.on("requestFailed",(({request:t,failureText:r,responseEndTiming:i,page:o})=>this._onRequestFailed(n.Request.from(t),i,r,e.Page.fromNullable(o)))),this._channel.on("requestFinished",(e=>this._onRequestFinished(e))),this._channel.on("response",(({response:t,page:r})=>this._onResponse(n.Response.from(t),e.Page.fromNullable(r)))),this._closedPromise=new Promise((e=>this.once(l.Events.BrowserContext.Close,e)))}_setBrowserType(e){this._browserType=e,e._contexts.add(this)}_onPage(e){this._pages.add(e),this.emit(l.Events.BrowserContext.Page,e),e._opener&&!e._opener.isClosed()&&e._opener.emit(l.Events.Page.Popup,e)}_onRequest(e,t){this.emit(l.Events.BrowserContext.Request,e),t&&t.emit(l.Events.Page.Request,e)}_onResponse(e,t){this.emit(l.Events.BrowserContext.Response,e),t&&t.emit(l.Events.Page.Response,e)}_onRequestFailed(e,t,n,r){e._failureText=n||null,e._timing&&(e._timing.responseEnd=t),this.emit(l.Events.BrowserContext.RequestFailed,e),r&&r.emit(l.Events.Page.RequestFailed,e)}_onRequestFinished(t){const{responseEndTiming:r}=t,i=n.Request.from(t.request),o=n.Response.fromNullable(t.response),s=e.Page.fromNullable(t.page);i._timing&&(i._timing.responseEnd=r),this.emit(l.Events.BrowserContext.RequestFinished,i),s&&s.emit(l.Events.Page.RequestFinished,i),o&&o._finishedPromise.resolve()}_onRoute(e,t){for(const n of this._routes)if(n.matches(t.url())){try{n.handle(e,t)}finally{n.isActive()||(this._routes.splice(this._routes.indexOf(n),1),this._routes.length||this._wrapApiCall((()=>this._disableInterception()),!0).catch((()=>{})))}return}e._internalContinue()}async _onBinding(e){const t=this._bindings.get(e._initializer.name);t&&await e.call(t)}setDefaultNavigationTimeout(e){this._timeoutSettings.setDefaultNavigationTimeout(e),this._wrapApiCall((async()=>{this._channel.setDefaultNavigationTimeoutNoReply({timeout:e})}),!0)}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e),this._wrapApiCall((async()=>{this._channel.setDefaultTimeoutNoReply({timeout:e})}),!0)}browser(){return this._browser}pages(){return[...this._pages]}async newPage(){if(this._ownerPage)throw new Error("Please use browser.newContext()");return e.Page.from((await this._channel.newPage()).page)}async cookies(e){return e||(e=[]),e&&"string"==typeof e&&(e=[e]),(await this._channel.cookies({urls:e})).cookies}async addCookies(e){await this._channel.addCookies({cookies:e})}async clearCookies(){await this._channel.clearCookies()}async grantPermissions(e,t){await this._channel.grantPermissions({permissions:e,...t})}async clearPermissions(){await this._channel.clearPermissions()}async setGeolocation(e){await this._channel.setGeolocation({geolocation:e||void 0})}async setExtraHTTPHeaders(e){n.validateHeaders(e),await this._channel.setExtraHTTPHeaders({headers:(0,d.headersObjectToArray)(e)})}async setOffline(e){await this._channel.setOffline({offline:e})}async setHTTPCredentials(e){await this._channel.setHTTPCredentials({httpCredentials:e||void 0})}async addInitScript(e,t){const n=await(0,o.evaluationScript)(e,t);await this._channel.addInitScript({source:n})}async _removeInitScripts(){await this._channel.removeInitScripts()}async exposeBinding(e,t,n={}){await this._channel.exposeBinding({name:e,needsHandle:n.handle}),this._bindings.set(e,t)}async _removeExposedBindings(){this._bindings.clear(),await this._channel.removeExposedBindings()}async exposeFunction(e,t){await this._channel.exposeBinding({name:e});this._bindings.set(e,((e,...n)=>t(...n)))}async route(e,t,r={}){this._routes.unshift(new n.RouteHandler(this._options.baseURL,e,t,r.times)),1===this._routes.length&&await this._channel.setNetworkInterceptionEnabled({enabled:!0})}async unroute(e,t){this._routes=this._routes.filter((n=>n.url!==e||t&&n.handler!==t)),this._routes.length||await this._disableInterception()}async _unrouteAll(){this._routes=[],await this._disableInterception()}async _disableInterception(){await this._channel.setNetworkInterceptionEnabled({enabled:!1})}async waitForEvent(e,t={}){return this._wrapApiCall((async()=>{const n=this._timeoutSettings.timeout("function"==typeof t?{}:t),r="function"==typeof t?t:t.predicate,i=u.Waiter.createForEvent(this,e);i.rejectOnTimeout(n,`Timeout ${n}ms exceeded while waiting for event "${e}"`),e!==l.Events.BrowserContext.Close&&i.rejectOnEvent(this,l.Events.BrowserContext.Close,new Error("Context closed"));const o=await i.waitForEvent(this,e,r);return i.dispose(),o}))}async storageState(e={}){const t=await this._channel.storageState();return e.path&&(await(0,h.mkdirIfNeeded)(e.path),await r.default.promises.writeFile(e.path,JSON.stringify(t,void 0,2),"utf8")),t}backgroundPages(){return[...this._backgroundPages]}serviceWorkers(){return[...this._serviceWorkers]}async newCDPSession(n){if(!(n instanceof e.Page||n instanceof t.Frame))throw new Error("page: expected Page or Frame");const r=await this._channel.newCDPSession(n instanceof e.Page?{page:n._channel}:{frame:n._channel});return f.CDPSession.from(r.session)}_onClose(){var e,t;this._browser&&this._browser._contexts.delete(this),null===(e=this._browserType)||void 0===e||null===(t=e._contexts)||void 0===t||t.delete(this),this.emit(l.Events.BrowserContext.Close,this)}async close(){try{await this._wrapApiCall((async()=>{var e,t;if(await(null===(e=this._browserType)||void 0===e||null===(t=e._onWillCloseContext)||void 0===t?void 0:t.call(e,this)),this._options.recordHar){const e=await this._channel.harExport(),t=g.Artifact.from(e.artifact);await t.saveAs(this._options.recordHar.path),await t.delete()}}),!0),await this._channel.close(),await this._closedPromise}catch(e){if((0,p.isSafeCloseError)(e))return;throw e}}async _enableRecorder(e){await this._channel.recorderSupplementEnable(e)}async _resetForReuse(){await this._unrouteAll(),await this._removeInitScripts(),await this._removeExposedBindings()}}async function S(e){if("string"!=typeof e.storageState)return e.storageState;try{return JSON.parse(await r.default.promises.readFile(e.storageState,"utf8"))}catch(t){throw(0,v.rewriteErrorMessage)(t,`Error reading storage state from ${e.storageState}:\n`+t.message),t}}return CC.BrowserContext=y,CC}function XP(){if(GP)return EC;GP=1,Object.defineProperty(EC,"__esModule",{value:!0}),EC.Browser=void 0;var e=YP(),t=IC,n=PC,r=Al,i=zP;class o extends t.ChannelOwner{static from(e){return e._object}static fromNullable(e){return e?o.from(e):null}constructor(e,t,r,i){super(e,t,r,i),this._contexts=new Set,this._isConnected=!0,this._closedPromise=void 0,this._shouldCloseConnectionOnClose=!1,this._browserType=void 0,this._name=void 0,this._localUtils=void 0,this._name=i.name,this._channel.on("close",(()=>this._didClose())),this._closedPromise=new Promise((e=>this.once(n.Events.Browser.Disconnected,e)))}_setBrowserType(e){this._browserType=e;for(const t of this._contexts)t._setBrowserType(e)}async newContext(t={}){var n,r;t={...this._browserType._defaultContextOptions,...t};const i=await(0,e.prepareBrowserContextParams)(t),o=e.BrowserContext.from((await this._channel.newContext(i)).context);return o._options=i,this._contexts.add(o),o._logger=t.logger||this._logger,o._setBrowserType(this._browserType),o.tracing._localUtils=this._localUtils,await(null===(n=(r=this._browserType)._onDidCreateContext)||void 0===n?void 0:n.call(r,o)),o}contexts(){return[...this._contexts]}version(){return this._initializer.version}async newPage(e={}){const t=await this.newContext(e),n=await t.newPage();return n._ownedContext=t,t._ownerPage=n,n}isConnected(){return this._isConnected}async newBrowserCDPSession(){return i.CDPSession.from((await this._channel.newBrowserCDPSession()).session)}async startTracing(e,t={}){await this._channel.startTracing({...t,page:e?e._channel:void 0})}async stopTracing(){return Buffer.from((await this._channel.stopTracing()).binary,"base64")}async close(){try{this._shouldCloseConnectionOnClose?this._connection.close(r.kBrowserClosedError):await this._channel.close(),await this._closedPromise}catch(e){if((0,r.isSafeCloseError)(e))return;throw e}}_didClose(){this._isConnected=!1,this.emit(n.Events.Browser.Disconnected,this)}}return EC.Browser=o,EC}zP.CDPSession=JP;var QP,ZP={};function eO(){if(QP)return ZP;QP=1,Object.defineProperty(ZP,"__esModule",{value:!0}),ZP.BrowserType=void 0;var e=XP(),t=YP(),n=IC,r=qO(),i=PC,o=bT,s=Ci,a=Al,l=sx;class c extends n.ChannelOwner{constructor(...e){super(...e),this._serverLauncher=void 0,this._contexts=new Set,this._playwright=void 0,this._defaultContextOptions=void 0,this._defaultLaunchOptions=void 0,this._onDidCreateContext=void 0,this._onWillCloseContext=void 0}static from(e){return e._object}executablePath(){if(!this._initializer.executablePath)throw new Error("Browser is not supported on current platform");return this._initializer.executablePath}name(){return this._initializer.name}async launch(t={}){var n;const r=t.logger||(null===(n=this._defaultLaunchOptions)||void 0===n?void 0:n.logger);(0,s.assert)(!t.userDataDir,"userDataDir option is not supported in `browserType.launch`. Use `browserType.launchPersistentContext` instead"),(0,s.assert)(!t.port,"Cannot specify a port without launching as a server."),t={...this._defaultLaunchOptions,...t};const i={...t,ignoreDefaultArgs:Array.isArray(t.ignoreDefaultArgs)?t.ignoreDefaultArgs:void 0,ignoreAllDefaultArgs:!!t.ignoreDefaultArgs&&!Array.isArray(t.ignoreDefaultArgs),env:t.env?(0,o.envObjectToArray)(t.env):void 0},a=e.Browser.from((await this._channel.launch(i)).browser);return a._logger=r,a._setBrowserType(this),a._localUtils=this._playwright._utils,a}async launchServer(e={}){if(!this._serverLauncher)throw new Error("Launching server is not supported");return e={...this._defaultLaunchOptions,...e},this._serverLauncher.launchServer(e)}async launchPersistentContext(e,n={}){var r,i;const a=n.logger||(null===(r=this._defaultLaunchOptions)||void 0===r?void 0:r.logger);(0,s.assert)(!n.port,"Cannot specify a port without launching as a server."),n={...this._defaultLaunchOptions,...this._defaultContextOptions,...n};const l=await(0,t.prepareBrowserContextParams)(n),c={...l,ignoreDefaultArgs:Array.isArray(n.ignoreDefaultArgs)?n.ignoreDefaultArgs:void 0,ignoreAllDefaultArgs:!!n.ignoreDefaultArgs&&!Array.isArray(n.ignoreDefaultArgs),env:n.env?(0,o.envObjectToArray)(n.env):void 0,channel:n.channel,userDataDir:e},u=await this._channel.launchPersistentContext(c),d=t.BrowserContext.from(u.context);return d._options=l,d._logger=a,d._setBrowserType(this),d.tracing._localUtils=this._playwright._utils,await(null===(i=this._onDidCreateContext)||void 0===i?void 0:i.call(this,d)),d}async connect(e,t){return"string"==typeof e?this._connect(e,t):((0,s.assert)(e.wsEndpoint,"options.wsEndpoint is required"),this._connect(e.wsEndpoint,e))}async _connect(t,n={}){const o=n.logger;return await this._wrapApiCall((async()=>{const c=n.timeout?(0,s.monotonicTime)()+n.timeout:0;let u;const d={"x-playwright-browser":this.name(),...n.headers},h={wsEndpoint:t,headers:d,slowMo:n.slowMo,timeout:n.timeout};n.__testHookRedirectPortForwarding&&(h.socksProxyRedirectPortForTest=n.__testHookRedirectPortForwarding);const{pipe:p}=await this._channel.connect(h),f=()=>p.close().catch((()=>{})),m=new r.Connection;let g;m.markAsRemote(),m.on("close",f);const _=()=>{var e;for(const e of(null===(t=u)||void 0===t?void 0:t.contexts())||[]){var t;for(const t of e.pages())t._onClose();e._onClose()}null===(e=u)||void 0===e||e._didClose(),m.close(g||a.kBrowserClosedError)};p.on("closed",_),m.onmessage=e=>p.send({message:e}).catch(_),p.on("message",(({message:e})=>{try{m.dispatch(e)}catch(e){g=e.toString(),f()}}));const w=await(0,l.raceAgainstTimeout)((async()=>{n.__testHookBeforeCreateBrowser&&await n.__testHookBeforeCreateBrowser();const t=await m.initializePlaywright();if(!t._initializer.preLaunchedBrowser)throw f(),new Error("Malformed endpoint. Did you use launchServer method?");return t._setSelectors(this._playwright.selectors),u=e.Browser.from(t._initializer.preLaunchedBrowser),u._logger=o,u._shouldCloseConnectionOnClose=!0,u._setBrowserType(this),u._localUtils=this._playwright._utils,u.on(i.Events.Browser.Disconnected,f),u}),c?c-(0,s.monotonicTime)():0);if(w.timedOut)throw f(),new Error(`Timeout ${n.timeout}ms exceeded`);return w.result}))}connectOverCDP(e,t){if("string"==typeof e)return this._connectOverCDP(e,t);const n="endpointURL"in e?e.endpointURL:e.wsEndpoint;return(0,s.assert)(n,"Cannot connect over CDP without wsEndpoint."),this.connectOverCDP(n,e)}async _connectOverCDP(n,r={}){if("chromium"!==this.name())throw new Error("Connecting over CDP is only supported in Chromium.");const i=r.headers?(0,s.headersObjectToArray)(r.headers):void 0,o=await this._channel.connectOverCDP({endpointURL:n,headers:i,slowMo:r.slowMo,timeout:r.timeout}),a=e.Browser.from(o.browser);return o.defaultContext&&a._contexts.add(t.BrowserContext.from(o.defaultContext)),a._logger=r.logger,a._setBrowserType(this),a._localUtils=this._playwright._utils,a}}return ZP.BrowserType=c,ZP}var tO={},nO={};Object.defineProperty(nO,"__esModule",{value:!0}),nO.AndroidWebView=nO.AndroidSocket=nO.AndroidInput=nO.AndroidDevice=nO.Android=void 0;var rO=function(e){return e&&e.__esModule?e:{default:e}}(C.default),iO=Ci,oO=PC,sO=YP(),aO=IC,lO=ru,cO=fT,uO=M.default;class dO extends aO.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r),this._timeoutSettings=void 0,this._timeoutSettings=new lO.TimeoutSettings}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e),this._channel.setDefaultTimeoutNoReply({timeout:e})}async devices(e={}){const{devices:t}=await this._channel.devices(e);return t.map((e=>hO.from(e)))}}nO.Android=dO;class hO extends aO.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r),this._timeoutSettings=void 0,this._webViews=new Map,this.input=void 0,this.input=new mO(this),this._timeoutSettings=new lO.TimeoutSettings(e._timeoutSettings),this._channel.on("webViewAdded",(({webView:e})=>this._onWebViewAdded(e))),this._channel.on("webViewRemoved",(({pid:e})=>this._onWebViewRemoved(e)))}_onWebViewAdded(e){const t=new _O(this,e);this._webViews.set(e.pid,t),this.emit(oO.Events.AndroidDevice.WebView,t)}_onWebViewRemoved(e){const t=this._webViews.get(e);this._webViews.delete(e),t&&t.emit(oO.Events.AndroidWebView.Close)}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e),this._channel.setDefaultTimeoutNoReply({timeout:e})}serial(){return this._initializer.serial}model(){return this._initializer.model}webViews(){return[...this._webViews.values()]}async webView(e,t){const n=[...this._webViews.values()].find((t=>t.pkg()===e.pkg));return n||this.waitForEvent("webview",{...t,predicate:t=>t.pkg()===e.pkg})}async wait(e,t){await this._channel.wait({selector:gO(e),...t})}async fill(e,t,n){await this._channel.fill({selector:gO(e),text:t,...n})}async press(e,t,n){await this.tap(e,n),await this.input.press(t)}async tap(e,t){await this._channel.tap({selector:gO(e),...t})}async drag(e,t,n){await this._channel.drag({selector:gO(e),dest:t,...n})}async fling(e,t,n){await this._channel.fling({selector:gO(e),direction:t,...n})}async longTap(e,t){await this._channel.longTap({selector:gO(e),...t})}async pinchClose(e,t,n){await this._channel.pinchClose({selector:gO(e),percent:t,...n})}async pinchOpen(e,t,n){await this._channel.pinchOpen({selector:gO(e),percent:t,...n})}async scroll(e,t,n,r){await this._channel.scroll({selector:gO(e),direction:t,percent:n,...r})}async swipe(e,t,n,r){await this._channel.swipe({selector:gO(e),direction:t,percent:n,...r})}async info(e){return(await this._channel.info({selector:gO(e)})).info}async screenshot(e={}){const{binary:t}=await this._channel.screenshot(),n=Buffer.from(t,"base64");return e.path&&await rO.default.promises.writeFile(e.path,n),n}async close(){await this._channel.close(),this.emit(oO.Events.AndroidDevice.Close)}async shell(e){const{result:t}=await this._channel.shell({command:e});return Buffer.from(t,"base64")}async open(e){return pO.from((await this._channel.open({command:e})).socket)}async installApk(e,t){await this._channel.installApk({file:await fO(e),args:t&&t.args})}async push(e,t,n){await this._channel.push({file:await fO(e),path:t,mode:n?n.mode:void 0})}async launchBrowser(e={}){const t=await(0,sO.prepareBrowserContextParams)(e),{context:n}=await this._channel.launchBrowser(t);return sO.BrowserContext.from(n)}async waitForEvent(e,t={}){return this._wrapApiCall((async()=>{const n=this._timeoutSettings.timeout("function"==typeof t?{}:t),r="function"==typeof t?t:t.predicate,i=cO.Waiter.createForEvent(this,e);i.rejectOnTimeout(n,`Timeout ${n}ms exceeded while waiting for event "${e}"`),e!==oO.Events.AndroidDevice.Close&&i.rejectOnEvent(this,oO.Events.AndroidDevice.Close,new Error("Device closed"));const o=await i.waitForEvent(this,e,r);return i.dispose(),o}))}}nO.AndroidDevice=hO;class pO extends aO.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r),this._channel.on("data",(({data:e})=>this.emit(oO.Events.AndroidSocket.Data,Buffer.from(e,"base64")))),this._channel.on("close",(()=>this.emit(oO.Events.AndroidSocket.Close)))}async write(e){await this._channel.write({data:e.toString("base64")})}async close(){await this._channel.close()}}async function fO(e){return(0,iO.isString)(e)?rO.default.promises.readFile(e,{encoding:"base64"}).toString():e.toString("base64")}nO.AndroidSocket=pO;class mO{constructor(e){this._device=void 0,this._device=e}async type(e){await this._device._channel.inputType({text:e})}async press(e){await this._device._channel.inputPress({key:e})}async tap(e){await this._device._channel.inputTap({point:e})}async swipe(e,t,n){await this._device._channel.inputSwipe({segments:t,steps:n})}async drag(e,t,n){await this._device._channel.inputDrag({from:e,to:t,steps:n})}}function gO(e){const{checkable:t,checked:n,clazz:r,clickable:i,depth:o,desc:s,enabled:a,focusable:l,focused:c,hasChild:u,hasDescendant:d,longClickable:h,pkg:p,res:f,scrollable:m,selected:g,text:_}=e,w=e=>{if(void 0!==e)return(0,iO.isRegExp)(e)?e.source:"^"+e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")+"$"};return{checkable:t,checked:n,clazz:w(r),pkg:w(p),desc:w(s),res:w(f),text:w(_),clickable:i,depth:o,enabled:a,focusable:l,focused:c,hasChild:u?{selector:gO(u.selector)}:void 0,hasDescendant:d?{selector:gO(d.selector),maxDepth:d.maxDepth}:void 0,longClickable:h,scrollable:m,selected:g}}nO.AndroidInput=mO;class _O extends uO.EventEmitter{constructor(e,t){super(),this._device=void 0,this._data=void 0,this._pagePromise=void 0,this._device=e,this._data=t}pid(){return this._data.pid}pkg(){return this._data.pkg}async page(){return this._pagePromise||(this._pagePromise=this._fetchPage()),this._pagePromise}async _fetchPage(){const{context:e}=await this._device._channel.connectToWebView({pid:this._data.pid});return sO.BrowserContext.from(e).pages()[0]}}nO.AndroidWebView=_O;var wO={};Object.defineProperty(wO,"__esModule",{value:!0}),wO.ElectronApplication=wO.Electron=void 0;var vO=ru,bO=Ci,yO=YP(),SO=IC,xO=bT,kO=PC,EO=KC,CO=fT;class TO extends SO.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r)}async launch(e={}){const t={...e,extraHTTPHeaders:e.extraHTTPHeaders&&(0,bO.headersObjectToArray)(e.extraHTTPHeaders),env:(0,xO.envObjectToArray)(e.env?e.env:process.env)},n=PO.from((await this._channel.launch(t)).electronApplication);return n._context._options=t,n}}wO.Electron=TO;class PO extends SO.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r),this._context=void 0,this._windows=new Set,this._timeoutSettings=new vO.TimeoutSettings,this._context=yO.BrowserContext.from(r.context);for(const e of this._context._pages)this._onPage(e);this._context.on(kO.Events.BrowserContext.Page,(e=>this._onPage(e))),this._channel.on("close",(()=>this.emit(kO.Events.ElectronApplication.Close)))}process(){return this._toImpl().process()}_onPage(e){this._windows.add(e),this.emit(kO.Events.ElectronApplication.Window,e),e.once(kO.Events.Page.Close,(()=>this._windows.delete(e)))}windows(){return[...this._windows]}async firstWindow(){return this._windows.size?this._windows.values().next().value:this.waitForEvent("window")}context(){return this._context}async close(){await this._channel.close()}async waitForEvent(e,t={}){return this._wrapApiCall((async()=>{const n=this._timeoutSettings.timeout("function"==typeof t?{}:t),r="function"==typeof t?t:t.predicate,i=CO.Waiter.createForEvent(this,e);i.rejectOnTimeout(n,`Timeout ${n}ms exceeded while waiting for event "${e}"`),e!==kO.Events.ElectronApplication.Close&&i.rejectOnEvent(this,kO.Events.ElectronApplication.Close,new Error("Electron application closed"));const o=await i.waitForEvent(this,e,r);return i.dispose(),o}))}async browserWindow(e){const t=await this._channel.browserWindow({page:e._channel});return EO.JSHandle.from(t.handle)}async evaluate(e,t){const n=await this._channel.evaluateExpression({expression:String(e),isFunction:"function"==typeof e,arg:(0,EO.serializeArgument)(t)});return(0,EO.parseResult)(n.value)}async evaluateHandle(e,t){const n=await this._channel.evaluateExpressionHandle({expression:String(e),isFunction:"function"==typeof e,arg:(0,EO.serializeArgument)(t)});return EO.JSHandle.from(n.handle)}}wO.ElectronApplication=PO;var OO={};Object.defineProperty(OO,"__esModule",{value:!0}),OO.LocalUtils=void 0;var AO=IC;class IO extends AO.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r)}async zip(e,t){await this._channel.zip({zipFile:e,entries:t})}}OO.LocalUtils=IO;var MO={};Object.defineProperty(MO,"__esModule",{value:!0}),MO.SelectorsOwner=MO.Selectors=void 0;var FO,NO=bT,RO=IC;MO.Selectors=class{constructor(){this._channels=new Set,this._registrations=[]}async register(e,t,n={}){const r={...n,name:e,source:await(0,NO.evaluationScript)(t,void 0,!1)};for(const e of this._channels)await e._channel.register(r);this._registrations.push(r)}_addChannel(e){this._channels.add(e);for(const t of this._registrations)e._channel.register(t).catch((e=>{}))}_removeChannel(e){this._channels.delete(e)}};class jO extends RO.ChannelOwner{static from(e){return e._object}}MO.SelectorsOwner=jO;var DO={};Object.defineProperty(DO,"__esModule",{value:!0}),DO.JsonPipe=void 0;var LO,BO=IC;class HO extends BO.ChannelOwner{static from(e){return e._object}constructor(e,t,n,r){super(e,t,n,r)}channel(){return this._channel}}function qO(){if(LO)return kC;LO=1,Object.defineProperty(kC,"__esModule",{value:!0}),kC.Connection=void 0;var e=XP(),t=YP(),n=eO(),r=IC,i=iP(),o=XT(),s=KC,a=GT(),l=TC,c=oP,u=GC,d=oT,h=Ol,p=zP,f=function(){if(FO)return tO;FO=1,Object.defineProperty(tO,"__esModule",{value:!0}),tO.Playwright=void 0;var e=Al,t=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(kx),n=nO,r=eO(),i=IC,o=wO,s=VT(),a=OO,l=MO;function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}class u extends i.ChannelOwner{constructor(t,i,c,u){super(t,i,c,u),this._android=void 0,this._electron=void 0,this.chromium=void 0,this.firefox=void 0,this.webkit=void 0,this.devices=void 0,this.selectors=void 0,this.request=void 0,this.errors=void 0,this._utils=void 0,this._socksProxyHandler=void 0,this.request=new s.APIRequest(this),this.chromium=r.BrowserType.from(u.chromium),this.chromium._playwright=this,this.firefox=r.BrowserType.from(u.firefox),this.firefox._playwright=this,this.webkit=r.BrowserType.from(u.webkit),this.webkit._playwright=this,this._android=n.Android.from(u.android),this._electron=o.Electron.from(u.electron),this.devices={};for(const{name:e,descriptor:t}of u.deviceDescriptors)this.devices[e]=t;this.selectors=new l.Selectors,this.errors={TimeoutError:e.TimeoutError},this._utils=a.LocalUtils.from(u.utils);const d=l.SelectorsOwner.from(u.selectors);this.selectors._addChannel(d),this._connection.on("close",(()=>{var e;this.selectors._removeChannel(d),null===(e=this._socksProxyHandler)||void 0===e||e.cleanup()})),Y._playwrightInstance=this}async _hideHighlight(){await this._channel.hideHighlight()}_setSelectors(e){const t=l.SelectorsOwner.from(this._initializer.selectors);this.selectors._removeChannel(t),this.selectors=e,this.selectors._addChannel(t)}_enablePortForwarding(e){const n=this._initializer.socksSupport;if(!n)return;const r=new t.SocksProxyHandler(e);this._socksProxyHandler=r,r.on(t.SocksProxyHandler.Events.SocksConnected,(e=>n.socksConnected(e).catch((()=>{})))),r.on(t.SocksProxyHandler.Events.SocksData,(e=>n.socksData({uid:e.uid,data:e.data.toString("base64")}).catch((()=>{})))),r.on(t.SocksProxyHandler.Events.SocksError,(e=>n.socksError(e).catch((()=>{})))),r.on(t.SocksProxyHandler.Events.SocksFailed,(e=>n.socksFailed(e).catch((()=>{})))),r.on(t.SocksProxyHandler.Events.SocksEnd,(e=>n.socksEnd(e).catch((()=>{})))),n.on("socksRequested",(e=>r.socketRequested(e))),n.on("socksClosed",(e=>r.socketClosed(e))),n.on("socksData",(e=>r.sendSocketData({uid:e.uid,data:Buffer.from(e.data,"base64")})))}static from(e){return e._object}}return tO.Playwright=u,tO}(),m=wO,g=AT,_=QT,w=Ka,v=MO,b=nO,y=OT,S=M.default,x=DO,k=VT(),E=OO,C=PT;class T extends r.ChannelOwner{constructor(e){super(e,"Root","",{})}async initialize(){return f.Playwright.from((await this._channel.initialize({sdkLanguage:"javascript"})).playwright)}}class P extends r.ChannelOwner{}class O extends S.EventEmitter{constructor(){super(),this._objects=new Map,this.onmessage=e=>{},this._lastId=0,this._callbacks=new Map,this._rootObject=void 0,this._closedErrorMessage=void 0,this._isRemote=!1,this.toImpl=void 0,this._rootObject=new T(this)}markAsRemote(){this._isRemote=!0}isRemote(){return this._isRemote}async initializePlaywright(){return await this._rootObject.initialize()}pendingProtocolCalls(){return Array.from(this._callbacks.values()).map((e=>e.stackTrace)).filter(Boolean)}getObjectWithKnownName(e){return this._objects.get(e)}async sendMessageToServer(e,t,n,r){if(this._closedErrorMessage)throw new Error(this._closedErrorMessage);const{apiName:i,frames:o}=r||{apiName:"",frames:[]},s=e._guid,a=++this._lastId,l={id:a,guid:s,method:t,params:n};w.debugLogger.log("channel:command",l);const c={stack:o,apiName:i,internal:!i};return this.onmessage({...l,metadata:c}),await new Promise(((e,t)=>this._callbacks.set(a,{resolve:e,reject:t,stackTrace:r})))}_debugScopeState(){return this._rootObject._debugScopeState()}dispatch(e){if(this._closedErrorMessage)return;const{id:t,guid:n,method:r,params:i,result:o,error:s}=e;if(t){w.debugLogger.log("channel:response",e);const n=this._callbacks.get(t);if(!n)throw new Error(`Cannot find command to respond: ${t}`);return this._callbacks.delete(t),void(s&&!o?n.reject((0,h.parseError)(s)):n.resolve(this._replaceGuidsWithChannels(o)))}if(w.debugLogger.log("channel:event",e),"__create__"===r)return void this._createRemoteObject(n,i.type,i.guid,i.initializer);if("__dispose__"===r){const e=this._objects.get(n);if(!e)throw new Error(`Cannot find object to dispose: ${n}`);return void e._dispose()}const a=this._objects.get(n);if(!a)throw new Error(`Cannot find object to emit "${r}": ${n}`);a._channel.emit(r,"JsonPipe"===a._type?i:this._replaceGuidsWithChannels(i))}close(e="Connection closed"){this._closedErrorMessage=e;for(const t of this._callbacks.values())t.reject(new Error(e));this._callbacks.clear(),this.emit("close")}_replaceGuidsWithChannels(e){if(!e)return e;if(Array.isArray(e))return e.map((e=>this._replaceGuidsWithChannels(e)));if(e.guid&&this._objects.has(e.guid))return this._objects.get(e.guid)._channel;if("object"==typeof e){const t={};for(const n of Object.keys(e))t[n]=this._replaceGuidsWithChannels(e[n]);return t}return e}_createRemoteObject(r,h,w,S){const T=this._objects.get(r);if(!T)throw new Error(`Cannot find parent object ${r} to create ${w}`);let O;switch(S=this._replaceGuidsWithChannels(S),h){case"Android":O=new b.Android(T,h,w,S);break;case"AndroidSocket":O=new b.AndroidSocket(T,h,w,S);break;case"AndroidDevice":O=new b.AndroidDevice(T,h,w,S);break;case"APIRequestContext":O=new k.APIRequestContext(T,h,w,S);break;case"Artifact":O=new y.Artifact(T,h,w,S);break;case"BindingCall":O=new l.BindingCall(T,h,w,S);break;case"Browser":O=new e.Browser(T,h,w,S);break;case"BrowserContext":O=new t.BrowserContext(T,h,w,S);break;case"BrowserType":O=new n.BrowserType(T,h,w,S);break;case"CDPSession":O=new p.CDPSession(T,h,w,S);break;case"ConsoleMessage":O=new u.ConsoleMessage(T,h,w,S);break;case"Dialog":O=new d.Dialog(T,h,w,S);break;case"Electron":O=new m.Electron(T,h,w,S);break;case"ElectronApplication":O=new m.ElectronApplication(T,h,w,S);break;case"ElementHandle":O=new i.ElementHandle(T,h,w,S);break;case"Frame":O=new o.Frame(T,h,w,S);break;case"JSHandle":O=new s.JSHandle(T,h,w,S);break;case"JsonPipe":O=new x.JsonPipe(T,h,w,S);break;case"LocalUtils":O=new E.LocalUtils(T,h,w,S);break;case"Page":O=new l.Page(T,h,w,S);break;case"Playwright":O=new f.Playwright(T,h,w,S);break;case"Request":O=new a.Request(T,h,w,S);break;case"Response":O=new a.Response(T,h,w,S);break;case"Route":O=new a.Route(T,h,w,S);break;case"Stream":O=new g.Stream(T,h,w,S);break;case"Selectors":O=new v.SelectorsOwner(T,h,w,S);break;case"SocksSupport":O=new P(T,h,w,S);break;case"Tracing":O=new C.Tracing(T,h,w,S);break;case"WebSocket":O=new a.WebSocket(T,h,w,S);break;case"Worker":O=new c.Worker(T,h,w,S);break;case"WritableStream":O=new _.WritableStream(T,h,w,S);break;default:throw new Error("Missing type "+h)}return O}}return kC.Connection=O,kC}DO.JsonPipe=HO;var UO={},WO={},$O={};Object.defineProperty($O,"__esModule",{value:!0}),$O.PlaywrightConnection=void 0;var zO=xt,VO=Q_(),GO=Hl,KO=nv,JO=kx;$O.PlaywrightConnection=class{constructor(e,t,n,r,i,o,s){this._ws=void 0,this._onClose=void 0,this._dispatcherConnection=void 0,this._cleanups=[],this._debugLog=void 0,this._disconnected=!1,this._ws=e,this._onClose=s,this._debugLog=o,this._dispatcherConnection=new zO.DispatcherConnection,this._dispatcherConnection.onmessage=t=>{e.readyState!==e.CLOSING&&e.send(JSON.stringify(t))},e.on("message",(e=>{this._dispatcherConnection.dispatch(JSON.parse(Buffer.from(e).toString()))})),e.on("close",(()=>this._onDisconnect())),e.on("error",(e=>this._onDisconnect(e))),new zO.Root(this._dispatcherConnection,(async e=>i?await this._initPreLaunchedBrowserMode(e,i):n?await this._initLaunchBrowserMode(e,t,n,r):await this._initPlaywrightConnectMode(e,t)))}async _initPlaywrightConnectMode(e,t){this._debugLog("engaged playwright.connect mode");const n=(0,zO.createPlaywright)("javascript");this._cleanups.push((()=>(0,KO.gracefullyCloseAll)()));const r=t?await this._enableSocksProxy(n):void 0;return new zO.PlaywrightDispatcher(e,n,r)}async _initLaunchBrowserMode(e,t,n,r){this._debugLog(`engaged launch mode for "${n}"`);const i=zO.registry.findExecutable(n);if(!i||!i.browserName)throw new Error(`Unsupported browser "${n}`);const o=(0,zO.createPlaywright)("javascript"),s=t?await this._enableSocksProxy(o):void 0,a=await o[i.browserName].launch((0,GO.serverSideCallMetadata)(),{channel:"browser"===i.type?void 0:i.name,headless:r});return this._cleanups.push((()=>a.close())),a.on(VO.Browser.Events.Disconnected,(()=>{this.close({code:1001,reason:"Browser closed"})})),new zO.PlaywrightDispatcher(e,o,s,a)}async _initPreLaunchedBrowserMode(e,t){this._debugLog("engaged pre-launched mode"),t.on(VO.Browser.Events.Disconnected,(()=>{this.close({code:1001,reason:"Browser closed"})}));const n=t.options.rootSdkObject,r=new zO.PlaywrightDispatcher(e,n,void 0,t);return this._cleanups.push((()=>r.cleanup())),r}async _enableSocksProxy(e){const t=new JO.SocksProxy;return e.options.socksProxyPort=await t.listen(0),this._debugLog(`started socks proxy on port ${e.options.socksProxyPort}`),this._cleanups.push((()=>t.close())),t}async _onDisconnect(e){this._disconnected=!0,this._debugLog(`disconnected. error: ${e}`),this._dispatcherConnection.onmessage=()=>{},this._debugLog("starting cleanup");for(const e of this._cleanups)await e().catch((()=>{}));this._onClose(),this._debugLog("finished cleanup")}async close(e){if(!this._disconnected){this._debugLog(`force closing connection: ${(null==e?void 0:e.reason)||""} (${(null==e?void 0:e.code)||0})`);try{this._ws.close(null==e?void 0:e.code,null==e?void 0:e.reason)}catch(e){}}}},Object.defineProperty(WO,"__esModule",{value:!0}),WO.PlaywrightServer=void 0;var YO=tA(Ja.exports),XO=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=eA(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,n&&n.set(e,r);return r}(P.default),QO=tA(W_),ZO=$O;function eA(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(eA=function(e){return e?n:t})(e)}function tA(e){return e&&e.__esModule?e:{default:e}}const nA=(0,YO.default)("pw:server");let rA=0;const iA=Symbol("kConnection");class oA{static async startDefault(e={}){const{path:t="/ws",maxClients:n=1,enableSocksProxy:r=!0}=e;return new oA(t,n,r)}constructor(e,t,n,r){this._path=void 0,this._maxClients=void 0,this._enableSocksProxy=void 0,this._browser=void 0,this._wsServer=void 0,this._clientsCount=0,this._path=e,this._maxClients=t,this._enableSocksProxy=n,this._browser=r}async listen(e=0){const t=XO.createServer(((e,t)=>{t.end("Running")}));t.on("error",(e=>nA(e)));const n=await new Promise(((n,r)=>{t.listen(e,(()=>{const e=t.address();if(!e)return void r(new Error("Could not bind server socket"));const i="string"==typeof e?`${e}${this._path}`:`ws://127.0.0.1:${e.port}${this._path}`;n(i)})).on("error",r)}));nA("Listening at "+n),this._wsServer=new QO.default.Server({server:t,path:this._path});const r=this._wsServer.shouldHandle.bind(this._wsServer);return this._wsServer.shouldHandle=e=>r(e)&&this._clientsCount<this._maxClients,this._wsServer.on("connection",(async(e,t)=>{if(this._clientsCount>=this._maxClients)return void e.close(1013,"Playwright Server is busy");const n=new URL("http://localhost"+(t.url||"")),r=t.headers["x-playwright-browser"],i=n.searchParams.get("browser")||(Array.isArray(r)?r[0]:r),o=t.headers["x-playwright-headless"],s=n.searchParams.get("headless")||(Array.isArray(o)?o[0]:o),a=t.headers["x-playwright-proxy"],l=n.searchParams.get("proxy")||(Array.isArray(a)?a[0]:a),c=this._enableSocksProxy&&"*"===l;this._clientsCount++;const u=function(){const e=++rA;return t=>nA(`[id=${e}] ${t}`)}();u(`serving connection: ${t.url}`);const d=new ZO.PlaywrightConnection(e,c,i,"0"!==s,this._browser,u,(()=>this._clientsCount--));e[iA]=d})),n}async close(){const e=this._wsServer;if(!e)return;nA("closing websocket server");const t=new Promise((t=>e.close(t)));await Promise.all(Array.from(e.clients).map((async e=>{const t=e[iA];t&&await t.close();try{e.terminate()}catch(e){}}))),await t,nA("closing http server"),await new Promise((t=>e.options.server.close(t))),this._wsServer=void 0,nA("closed server")}}WO.PlaywrightServer=oA,Object.defineProperty(UO,"__esModule",{value:!0}),UO.BrowserServerLauncherImpl=void 0;var sA=W_,aA=bT,lA=Ci,cA=Hl,uA=ix(),dA=WO,hA=su,pA=$l;UO.BrowserServerLauncherImpl=class{constructor(e){this._browserName=void 0,this._browserName=e}async launchServer(e={}){const t=(0,uA.createPlaywright)("javascript"),n=(0,cA.serverSideCallMetadata)(),r=await t[this._browserName].launch(n,{...e,ignoreDefaultArgs:Array.isArray(e.ignoreDefaultArgs)?e.ignoreDefaultArgs:void 0,ignoreAllDefaultArgs:!!e.ignoreDefaultArgs&&!Array.isArray(e.ignoreDefaultArgs),env:e.env?(0,aA.envObjectToArray)(e.env):void 0},(i=e.logger,i?(e,t)=>{i.isEnabled("protocol","verbose")&&i.log("protocol","verbose",("send"===e?"SEND  ":" RECV ")+JSON.stringify(t),[],{})}:void 0)).catch((e=>{const t=hA.helper.formatBrowserLogs(n.log);throw(0,pA.rewriteErrorMessage)(e,`${e.message} Failed to launch browser.${t}`),e}));var i;let o=`/${(0,lA.createGuid)()}`;e.wsPath&&(o=e.wsPath.startsWith("/")?e.wsPath:`/${e.wsPath}`);const s=new dA.PlaywrightServer(o,1/0,!1,r),a=await s.listen(e.port),l=new sA.EventEmitter;return l.process=()=>r.options.browserProcess.process,l.wsEndpoint=()=>a,l.close=()=>r.options.browserProcess.close(),l.kill=()=>r.options.browserProcess.kill(),l._disconnectForTest=()=>s.close(),r.options.browserProcess.onclose=async(e,t)=>{s.close(),l.emit("close",e,t)},l}},Object.defineProperty(St,"__esModule",{value:!0}),St.createInProcessPlaywright=function(){const e=(0,fA.createPlaywright)("javascript"),t=new mA.Connection,n=new fA.DispatcherConnection;n.onmessage=e=>t.dispatch(e),t.onmessage=e=>n.dispatch(e);const r=new fA.Root(n);new fA.PlaywrightDispatcher(r,e);const i=t.getObjectWithKnownName("Playwright");return i.chromium._serverLauncher=new gA.BrowserServerLauncherImpl("chromium"),i.firefox._serverLauncher=new gA.BrowserServerLauncherImpl("firefox"),i.webkit._serverLauncher=new gA.BrowserServerLauncherImpl("webkit"),n.onmessage=e=>setImmediate((()=>t.dispatch(e))),t.onmessage=e=>setImmediate((()=>n.dispatch(e))),t.toImpl=e=>n._dispatchers.get(e._guid)._object,i._toImpl=t.toImpl,i};var fA=xt,mA=qO(),gA=UO;var _A=(0,St.createInProcessPlaywright)();!function(e){const t=process.versions.node,n=t.split("."),[r]=[+n[0]];r<12&&(console.error("You are running Node.js "+t+".\nPlaywright requires Node.js 12 or higher. \nPlease update your version of Node.js."),process.exit(1)),e.exports=_A}(yt);var wA=X(yt.exports);wA.chromium,wA.firefox;const vA=wA.webkit;wA.selectors,wA.devices,wA.errors,wA.request,wA._electron,wA._android;const bA=()=>{const e=yA("path_input",!0),t=function(e){const t=Me.getInput(e,{required:!1});return t?xA(t):void 0}("path_output"),n=yA("diagram_type"),r=yA("diagram_exclude_types"),i=yA("diagram_stacks"),o=SA("viewport_height",!1),s=SA("viewport_width",!1);let a;return s&&o&&(a={width:s,height:o}),{viewport:a,diagramType:n,diagramExcludeTypes:r,diagramStacks:i,pathOutput:t,pathInput:e}};function yA(e,t){const n=Me.getInput(e,{required:t});if(t&&!n)throw new Error(`Input '${e}' empty.`);return""!==n?n:void 0}function SA(e,t){const n=Me.getInput(e,{required:t});if(isFinite(parseFloat(n)))return parseFloat(n);if(t||""!==n)throw new Error(`Input '${e}' is an invalid number.`)}function xA(e){const t=process.env.GITHUB_WORKSPACE;if(void 0===t)throw new Error("'GITHUB_WORKSPACE' variable is not set. Was checkout action done?");return n.join(t,e)}const kA=(e="html")=>"html"===e||"h"===e;var EA="object"==typeof process&&process&&"win32"===process.platform?{sep:"\\"}:{sep:"/"},CA=ao,TA=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return HA(function(e){return e.split("\\\\").join(PA).split("\\{").join(OA).split("\\}").join(AA).split("\\,").join(IA).split("\\.").join(MA)}(e),!0).map(NA)},PA="\0SLASH"+Math.random()+"\0",OA="\0OPEN"+Math.random()+"\0",AA="\0CLOSE"+Math.random()+"\0",IA="\0COMMA"+Math.random()+"\0",MA="\0PERIOD"+Math.random()+"\0";function FA(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function NA(e){return e.split(PA).join("\\").split(OA).join("{").split(AA).join("}").split(IA).join(",").split(MA).join(".")}function RA(e){if(!e)return[""];var t=[],n=CA("{","}",e);if(!n)return e.split(",");var r=n.pre,i=n.body,o=n.post,s=r.split(",");s[s.length-1]+="{"+i+"}";var a=RA(o);return o.length&&(s[s.length-1]+=a.shift(),s.push.apply(s,a)),t.push.apply(t,s),t}function jA(e){return"{"+e+"}"}function DA(e){return/^-?0\d/.test(e)}function LA(e,t){return e<=t}function BA(e,t){return e>=t}function HA(e,t){var n=[],r=CA("{","}",e);if(!r)return[e];var i=r.pre,o=r.post.length?HA(r.post,!1):[""];if(/\$$/.test(r.pre))for(var s=0;s<o.length;s++){var a=i+"{"+r.body+"}"+o[s];n.push(a)}else{var l,c,u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),d=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),h=u||d,p=r.body.indexOf(",")>=0;if(!h&&!p)return r.post.match(/,.*\}/)?HA(e=r.pre+"{"+r.body+AA+r.post):[e];if(h)l=r.body.split(/\.\./);else if(1===(l=RA(r.body)).length&&1===(l=HA(l[0],!1).map(jA)).length)return o.map((function(e){return r.pre+l[0]+e}));if(h){var f=FA(l[0]),m=FA(l[1]),g=Math.max(l[0].length,l[1].length),_=3==l.length?Math.abs(FA(l[2])):1,w=LA;m<f&&(_*=-1,w=BA);var v=l.some(DA);c=[];for(var b=f;w(b,m);b+=_){var y;if(d)"\\"===(y=String.fromCharCode(b))&&(y="");else if(y=String(b),v){var S=g-y.length;if(S>0){var x=new Array(S+1).join("0");y=b<0?"-"+x+y.slice(1):x+y}}c.push(y)}}else{c=[];for(var k=0;k<l.length;k++)c.push.apply(c,HA(l[k],!1))}for(k=0;k<c.length;k++)for(s=0;s<o.length;s++){a=i+c[k]+o[s];(!t||h||a)&&n.push(a)}}return n}const qA=(e,t,n={})=>(ZA(t),!(!n.nocomment&&"#"===t.charAt(0))&&new tI(t,n).match(e));var UA=qA;const WA=EA;qA.sep=WA.sep;const $A=Symbol("globstar **");qA.GLOBSTAR=$A;const zA=TA,VA={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},GA=e=>e.split("").reduce(((e,t)=>(e[t]=!0,e)),{}),KA=GA("().*{}+?[]^$\\!"),JA=GA("[.("),YA=/\/+/;qA.filter=(e,t={})=>(n,r,i)=>qA(n,e,t);const XA=(e,t={})=>{const n={};return Object.keys(e).forEach((t=>n[t]=e[t])),Object.keys(t).forEach((e=>n[e]=t[e])),n};qA.defaults=e=>{if(!e||"object"!=typeof e||!Object.keys(e).length)return qA;const t=qA,n=(n,r,i)=>t(n,r,XA(e,i));return(n.Minimatch=class extends t.Minimatch{constructor(t,n){super(t,XA(e,n))}}).defaults=n=>t.defaults(XA(e,n)).Minimatch,n.filter=(n,r)=>t.filter(n,XA(e,r)),n.defaults=n=>t.defaults(XA(e,n)),n.makeRe=(n,r)=>t.makeRe(n,XA(e,r)),n.braceExpand=(n,r)=>t.braceExpand(n,XA(e,r)),n.match=(n,r,i)=>t.match(n,r,XA(e,i)),n},qA.braceExpand=(e,t)=>QA(e,t);const QA=(e,t={})=>(ZA(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:zA(e)),ZA=e=>{if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")},eI=Symbol("subparse");qA.makeRe=(e,t)=>new tI(e,t||{}).makeRe(),qA.match=(e,t,n={})=>{const r=new tI(t,n);return e=e.filter((e=>r.match(e))),r.options.nonull&&!e.length&&e.push(t),e};class tI{constructor(e,t){ZA(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){const e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();let n=this.globSet=this.braceExpand();t.debug&&(this.debug=(...e)=>console.error(...e)),this.debug(this.pattern,n),n=this.globParts=n.map((e=>e.split(YA))),this.debug(this.pattern,n),n=n.map(((e,t,n)=>e.map(this.parse,this))),this.debug(this.pattern,n),n=n.filter((e=>-1===e.indexOf(!1))),this.debug(this.pattern,n),this.set=n}parseNegate(){if(this.options.nonegate)return;const e=this.pattern;let t=!1,n=0;for(let r=0;r<e.length&&"!"===e.charAt(r);r++)t=!t,n++;n&&(this.pattern=e.substr(n)),this.negate=t}matchOne(e,t,n){var r=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var i=0,o=0,s=e.length,a=t.length;i<s&&o<a;i++,o++){this.debug("matchOne loop");var l,c=t[o],u=e[i];if(this.debug(t,c,u),!1===c)return!1;if(c===$A){this.debug("GLOBSTAR",[t,c,u]);var d=i,h=o+1;if(h===a){for(this.debug("** at the end");i<s;i++)if("."===e[i]||".."===e[i]||!r.dot&&"."===e[i].charAt(0))return!1;return!0}for(;d<s;){var p=e[d];if(this.debug("\nglobstar while",e,d,t,h,p),this.matchOne(e.slice(d),t.slice(h),n))return this.debug("globstar found match!",d,s,p),!0;if("."===p||".."===p||!r.dot&&"."===p.charAt(0)){this.debug("dot detected!",e,d,t,h);break}this.debug("globstar swallow a segment, and continue"),d++}return!(!n||(this.debug("\n>>> no match, partial?",e,d,t,h),d!==s))}if("string"==typeof c?(l=u===c,this.debug("string match",c,u,l)):(l=u.match(c),this.debug("pattern match",c,u,l)),!l)return!1}if(i===s&&o===a)return!0;if(i===s)return n;if(o===a)return i===s-1&&""===e[i];throw new Error("wtf?")}braceExpand(){return QA(this.pattern,this.options)}parse(e,t){ZA(e);const n=this.options;if("**"===e){if(!n.noglobstar)return $A;e="*"}if(""===e)return"";let r="",i=!!n.nocase,o=!1;const s=[],a=[];let l,c,u,d,h=!1,p=-1,f=-1;const m="."===e.charAt(0)?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",g=()=>{if(l){switch(l){case"*":r+="[^/]*?",i=!0;break;case"?":r+="[^/]",i=!0;break;default:r+="\\"+l}this.debug("clearStateChar %j %j",l,r),l=!1}};for(let t,m=0;m<e.length&&(t=e.charAt(m));m++)if(this.debug("%s\t%s %s %j",e,m,r,t),o){if("/"===t)return!1;KA[t]&&(r+="\\"),r+=t,o=!1}else switch(t){case"/":return!1;case"\\":g(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,m,r,t),h){this.debug("  in class"),"!"===t&&m===f+1&&(t="^"),r+=t;continue}this.debug("call clearStateChar %j",l),g(),l=t,n.noext&&g();continue;case"(":if(h){r+="(";continue}if(!l){r+="\\(";continue}s.push({type:l,start:m-1,reStart:r.length,open:VA[l].open,close:VA[l].close}),r+="!"===l?"(?:(?!(?:":"(?:",this.debug("plType %j %j",l,r),l=!1;continue;case")":if(h||!s.length){r+="\\)";continue}g(),i=!0,u=s.pop(),r+=u.close,"!"===u.type&&a.push(u),u.reEnd=r.length;continue;case"|":if(h||!s.length){r+="\\|";continue}g(),r+="|";continue;case"[":if(g(),h){r+="\\"+t;continue}h=!0,f=m,p=r.length,r+=t;continue;case"]":if(m===f+1||!h){r+="\\"+t;continue}c=e.substring(f+1,m);try{RegExp("["+c+"]")}catch(e){d=this.parse(c,eI),r=r.substr(0,p)+"\\["+d[0]+"\\]",i=i||d[1],h=!1;continue}i=!0,h=!1,r+=t;continue;default:g(),!KA[t]||"^"===t&&h||(r+="\\"),r+=t}for(h&&(c=e.substr(f+1),d=this.parse(c,eI),r=r.substr(0,p)+"\\["+d[0],i=i||d[1]),u=s.pop();u;u=s.pop()){let e;e=r.slice(u.reStart+u.open.length),this.debug("setting tail",r,u),e=e.replace(/((?:\\{2}){0,64})(\\?)\|/g,((e,t,n)=>(n||(n="\\"),t+t+n+"|"))),this.debug("tail=%j\n   %s",e,e,u,r);const t="*"===u.type?"[^/]*?":"?"===u.type?"[^/]":"\\"+u.type;i=!0,r=r.slice(0,u.reStart)+t+"\\("+e}g(),o&&(r+="\\\\");const _=JA[r.charAt(0)];for(let e=a.length-1;e>-1;e--){const n=a[e],i=r.slice(0,n.reStart),o=r.slice(n.reStart,n.reEnd-8);let s=r.slice(n.reEnd);const l=r.slice(n.reEnd-8,n.reEnd)+s,c=i.split("(").length-1;let u=s;for(let e=0;e<c;e++)u=u.replace(/\)[+*?]?/,"");s=u;r=i+o+s+(""===s&&t!==eI?"$":"")+l}if(""!==r&&i&&(r="(?=.)"+r),_&&(r=m+r),t===eI)return[r,i];if(!i)return e.replace(/\\(.)/g,"$1");const w=n.nocase?"i":"";try{return Object.assign(new RegExp("^"+r+"$",w),{_glob:e,_src:r})}catch(e){return new RegExp("$.")}}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;const e=this.set;if(!e.length)return this.regexp=!1,this.regexp;const t=this.options,n=t.noglobstar?"[^/]*?":t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",r=t.nocase?"i":"";let i=e.map((e=>(e=e.map((e=>"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e===$A?$A:e._src)).reduce(((e,t)=>(e[e.length-1]===$A&&t===$A||e.push(t),e)),[]),e.forEach(((t,r)=>{t===$A&&e[r-1]!==$A&&(0===r?e.length>1?e[r+1]="(?:\\/|"+n+"\\/)?"+e[r+1]:e[r]=n:r===e.length-1?e[r-1]+="(?:\\/|"+n+")?":(e[r-1]+="(?:\\/|\\/"+n+"\\/)"+e[r+1],e[r+1]=$A))})),e.filter((e=>e!==$A)).join("/")))).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,r)}catch(e){this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;const n=this.options;"/"!==WA.sep&&(e=e.split(WA.sep).join("/")),e=e.split(YA),this.debug(this.pattern,"split",e);const r=this.set;let i;this.debug(this.pattern,"set",r);for(let t=e.length-1;t>=0&&(i=e[t],!i);t--);for(let o=0;o<r.length;o++){const s=r[o];let a=e;n.matchBase&&1===s.length&&(a=[i]);if(this.matchOne(a,s,t))return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate}static defaults(e){return qA.defaults(e).Minimatch}}qA.Minimatch=tI;var nI={};function rI(e,t){return Object.prototype.hasOwnProperty.call(e,t)}nI.setopts=function(e,t,n){n||(n={});if(n.matchBase&&-1===t.indexOf("/")){if(n.noglobstar)throw new Error("base matching requires globstar");t="**/"+t}e.silent=!!n.silent,e.pattern=t,e.strict=!1!==n.strict,e.realpath=!!n.realpath,e.realpathCache=n.realpathCache||Object.create(null),e.follow=!!n.follow,e.dot=!!n.dot,e.mark=!!n.mark,e.nodir=!!n.nodir,e.nodir&&(e.mark=!0);e.sync=!!n.sync,e.nounique=!!n.nounique,e.nonull=!!n.nonull,e.nosort=!!n.nosort,e.nocase=!!n.nocase,e.stat=!!n.stat,e.noprocess=!!n.noprocess,e.absolute=!!n.absolute,e.fs=n.fs||lI,e.maxLength=n.maxLength||1/0,e.cache=n.cache||Object.create(null),e.statCache=n.statCache||Object.create(null),e.symlinks=n.symlinks||Object.create(null),function(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]);e.ignore.length&&(e.ignore=e.ignore.map(fI))}(e,n),e.changedCwd=!1;var r=process.cwd();rI(n,"cwd")?(e.cwd=cI.resolve(n.cwd),e.changedCwd=e.cwd!==r):e.cwd=r;e.root=n.root||cI.resolve(e.cwd,"/"),e.root=cI.resolve(e.root),"win32"===process.platform&&(e.root=e.root.replace(/\\/g,"/"));e.cwdAbs=dI(e.cwd)?e.cwd:mI(e,e.cwd),"win32"===process.platform&&(e.cwdAbs=e.cwdAbs.replace(/\\/g,"/"));e.nomount=!!n.nomount,n.nonegate=!0,n.nocomment=!0,n.allowWindowsEscape=!0,e.minimatch=new hI(t,n),e.options=e.minimatch.options},nI.ownProp=rI,nI.makeAbs=mI,nI.finish=function(e){for(var t=e.nounique,n=t?[]:Object.create(null),r=0,i=e.matches.length;r<i;r++){var o=e.matches[r];if(o&&0!==Object.keys(o).length){var s=Object.keys(o);t?n.push.apply(n,s):s.forEach((function(e){n[e]=!0}))}else if(e.nonull){var a=e.minimatch.globSet[r];t?n.push(a):n[a]=!0}}t||(n=Object.keys(n));e.nosort||(n=n.sort(pI));if(e.mark){for(r=0;r<n.length;r++)n[r]=e._mark(n[r]);e.nodir&&(n=n.filter((function(t){var n=!/\/$/.test(t),r=e.cache[t]||e.cache[mI(e,t)];return n&&r&&(n="DIR"!==r&&!Array.isArray(r)),n})))}e.ignore.length&&(n=n.filter((function(t){return!gI(e,t)})));e.found=n},nI.mark=function(e,t){var n=mI(e,t),r=e.cache[n],i=t;if(r){var o="DIR"===r||Array.isArray(r),s="/"===t.slice(-1);if(o&&!s?i+="/":!o&&s&&(i=i.slice(0,-1)),i!==t){var a=mI(e,i);e.statCache[a]=e.statCache[n],e.cache[a]=e.cache[n]}}return i},nI.isIgnored=gI,nI.childrenIgnored=function(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return!(!e.gmatcher||!e.gmatcher.match(t))}))};var iI,oI,sI,aI,lI=C.default,cI=T.default,uI=UA,dI=_o.exports,hI=uI.Minimatch;function pI(e,t){return e.localeCompare(t,"en")}function fI(e){var t=null;if("/**"===e.slice(-3)){var n=e.replace(/(\/\*\*)+$/,"");t=new hI(n,{dot:!0})}return{matcher:new hI(e,{dot:!0}),gmatcher:t}}function mI(e,t){var n=t;return n="/"===t.charAt(0)?cI.join(e.root,t):dI(t)||""===t?t:e.changedCwd?cI.resolve(e.cwd,t):cI.resolve(t),"win32"===process.platform&&(n=n.replace(/\\/g,"/")),n}function gI(e,t){return!!e.ignore.length&&e.ignore.some((function(e){return e.matcher.match(t)||!(!e.gmatcher||!e.gmatcher.match(t))}))}function _I(){if(aI)return sI;aI=1,sI=m;var e=$i,t=UA;t.Minimatch;var n=mo.exports,r=M.default.EventEmitter,i=T.default,o=F.default,s=_o.exports,a=function(){if(oI)return iI;oI=1,iI=u,u.GlobSync=d;var e=$i,t=UA;t.Minimatch,_I().Glob;var n=T.default,r=F.default,i=_o.exports,o=nI,s=o.setopts,a=o.ownProp,l=o.childrenIgnored,c=o.isIgnored;function u(e,t){if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new d(e,t).found}function d(e,t){if(!e)throw new Error("must provide pattern");if("function"==typeof t||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof d))return new d(e,t);if(s(this,e,t),this.noprocess)return this;var n=this.minimatch.set.length;this.matches=new Array(n);for(var r=0;r<n;r++)this._process(this.minimatch.set[r],r,!1);this._finish()}return d.prototype._finish=function(){if(r(this instanceof d),this.realpath){var t=this;this.matches.forEach((function(n,r){var i=t.matches[r]=Object.create(null);for(var o in n)try{o=t._makeAbs(o),i[e.realpathSync(o,t.realpathCache)]=!0}catch(e){if("stat"!==e.syscall)throw e;i[t._makeAbs(o)]=!0}}))}o.finish(this)},d.prototype._process=function(e,n,o){r(this instanceof d);for(var s,a=0;"string"==typeof e[a];)a++;switch(a){case e.length:return void this._processSimple(e.join("/"),n);case 0:s=null;break;default:s=e.slice(0,a).join("/")}var c,u=e.slice(a);null===s?c=".":i(s)||i(e.map((function(e){return"string"==typeof e?e:"[*]"})).join("/"))?(s&&i(s)||(s="/"+s),c=s):c=s;var h=this._makeAbs(c);l(this,c)||(u[0]===t.GLOBSTAR?this._processGlobStar(s,c,h,u,n,o):this._processReaddir(s,c,h,u,n,o))},d.prototype._processReaddir=function(e,t,r,i,o,s){var a=this._readdir(r,s);if(a){for(var l=i[0],c=!!this.minimatch.negate,u=l._glob,d=this.dot||"."===u.charAt(0),h=[],p=0;p<a.length;p++)("."!==(g=a[p]).charAt(0)||d)&&(c&&!e?!g.match(l):g.match(l))&&h.push(g);var f=h.length;if(0!==f)if(1!==i.length||this.mark||this.stat)for(i.shift(),p=0;p<f;p++){var m;g=h[p],m=e?[e,g]:[g],this._process(m.concat(i),o,s)}else{this.matches[o]||(this.matches[o]=Object.create(null));for(p=0;p<f;p++){var g=h[p];e&&(g="/"!==e.slice(-1)?e+"/"+g:e+g),"/"!==g.charAt(0)||this.nomount||(g=n.join(this.root,g)),this._emitMatch(o,g)}}}},d.prototype._emitMatch=function(e,t){if(!c(this,t)){var n=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=n),!this.matches[e][t]){if(this.nodir){var r=this.cache[n];if("DIR"===r||Array.isArray(r))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}},d.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,n;try{n=this.fs.lstatSync(e)}catch(e){if("ENOENT"===e.code)return null}var r=n&&n.isSymbolicLink();return this.symlinks[e]=r,r||!n||n.isDirectory()?t=this._readdir(e,!1):this.cache[e]="FILE",t},d.prototype._readdir=function(e,t){if(t&&!a(this.symlinks,e))return this._readdirInGlobStar(e);if(a(this.cache,e)){var n=this.cache[e];if(!n||"FILE"===n)return null;if(Array.isArray(n))return n}try{return this._readdirEntries(e,this.fs.readdirSync(e))}catch(t){return this._readdirError(e,t),null}},d.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var n=0;n<t.length;n++){var r=t[n];r="/"===e?e+r:e+"/"+r,this.cache[r]=!0}return this.cache[e]=t,t},d.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(e);if(this.cache[n]="FILE",n===this.cwdAbs){var r=new Error(t.code+" invalid cwd "+this.cwd);throw r.path=this.cwd,r.code=t.code,r}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t)}},d.prototype._processGlobStar=function(e,t,n,r,i,o){var s=this._readdir(n,o);if(s){var a=r.slice(1),l=e?[e]:[],c=l.concat(a);this._process(c,i,!1);var u=s.length;if(!this.symlinks[n]||!o)for(var d=0;d<u;d++)if("."!==s[d].charAt(0)||this.dot){var h=l.concat(s[d],a);this._process(h,i,!0);var p=l.concat(s[d],r);this._process(p,i,!0)}}},d.prototype._processSimple=function(e,t){var r=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),r){if(e&&i(e)&&!this.nomount){var o=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=n.join(this.root,e):(e=n.resolve(this.root,e),o&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}},d.prototype._stat=function(e){var t=this._makeAbs(e),n="/"===e.slice(-1);if(e.length>this.maxLength)return!1;if(!this.stat&&a(this.cache,t)){var r=this.cache[t];if(Array.isArray(r)&&(r="DIR"),!n||"DIR"===r)return r;if(n&&"FILE"===r)return!1}var i=this.statCache[t];if(!i){var o;try{o=this.fs.lstatSync(t)}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return this.statCache[t]=!1,!1}if(o&&o.isSymbolicLink())try{i=this.fs.statSync(t)}catch(e){i=o}else i=o}return this.statCache[t]=i,r=!0,i&&(r=i.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||r,(!n||"FILE"!==r)&&r},d.prototype._mark=function(e){return o.mark(this,e)},d.prototype._makeAbs=function(e){return o.makeAbs(this,e)},iI}(),l=nI,c=l.setopts,u=l.ownProp,d=Ro,h=l.childrenIgnored,p=l.isIgnored,f=Co.exports;function m(e,t,n){if("function"==typeof t&&(n=t,t={}),t||(t={}),t.sync){if(n)throw new TypeError("callback provided to sync glob");return a(e,t)}return new _(e,t,n)}m.sync=a;var g=m.GlobSync=a.GlobSync;function _(e,t,n){if("function"==typeof t&&(n=t,t=null),t&&t.sync){if(n)throw new TypeError("callback provided to sync glob");return new g(e,t)}if(!(this instanceof _))return new _(e,t,n);c(this,e,t),this._didRealPath=!1;var r=this.minimatch.set.length;this.matches=new Array(r),"function"==typeof n&&(n=f(n),this.on("error",n),this.on("end",(function(e){n(null,e)})));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===r)return s();for(var o=0;o<r;o++)this._process(this.minimatch.set[o],o,!1,s);function s(){--i._processing,i._processing<=0&&i._finish()}}return m.glob=m,m.hasMagic=function(e,t){var n=function(e,t){if(null===t||"object"!=typeof t)return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}({},t);n.noprocess=!0;var r=new _(e,n).minimatch.set;if(!e)return!1;if(r.length>1)return!0;for(var i=0;i<r[0].length;i++)if("string"!=typeof r[0][i])return!0;return!1},m.Glob=_,n(_,r),_.prototype._finish=function(){if(o(this instanceof _),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();l.finish(this),this.emit("end",this.found)}},_.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var e=this.matches.length;if(0===e)return this._finish();for(var t=this,n=0;n<this.matches.length;n++)this._realpathSet(n,r)}function r(){0==--e&&t._finish()}},_.prototype._realpathSet=function(t,n){var r=this.matches[t];if(!r)return n();var i=Object.keys(r),o=this,s=i.length;if(0===s)return n();var a=this.matches[t]=Object.create(null);i.forEach((function(r,i){r=o._makeAbs(r),e.realpath(r,o.realpathCache,(function(e,i){e?"stat"===e.syscall?a[r]=!0:o.emit("error",e):a[i]=!0,0==--s&&(o.matches[t]=a,n())}))}))},_.prototype._mark=function(e){return l.mark(this,e)},_.prototype._makeAbs=function(e){return l.makeAbs(this,e)},_.prototype.abort=function(){this.aborted=!0,this.emit("abort")},_.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},_.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var n=e[t];this._emitMatch(n[0],n[1])}}if(this._processQueue.length){var r=this._processQueue.slice(0);this._processQueue.length=0;for(t=0;t<r.length;t++){var i=r[t];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},_.prototype._process=function(e,n,r,i){if(o(this instanceof _),o("function"==typeof i),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([e,n,r,i]);else{for(var a,l=0;"string"==typeof e[l];)l++;switch(l){case e.length:return void this._processSimple(e.join("/"),n,i);case 0:a=null;break;default:a=e.slice(0,l).join("/")}var c,u=e.slice(l);null===a?c=".":s(a)||s(e.map((function(e){return"string"==typeof e?e:"[*]"})).join("/"))?(a&&s(a)||(a="/"+a),c=a):c=a;var d=this._makeAbs(c);if(h(this,c))return i();u[0]===t.GLOBSTAR?this._processGlobStar(a,c,d,u,n,r,i):this._processReaddir(a,c,d,u,n,r,i)}},_.prototype._processReaddir=function(e,t,n,r,i,o,s){var a=this;this._readdir(n,o,(function(l,c){return a._processReaddir2(e,t,n,r,i,o,c,s)}))},_.prototype._processReaddir2=function(e,t,n,r,o,s,a,l){if(!a)return l();for(var c=r[0],u=!!this.minimatch.negate,d=c._glob,h=this.dot||"."===d.charAt(0),p=[],f=0;f<a.length;f++){if("."!==(g=a[f]).charAt(0)||h)(u&&!e?!g.match(c):g.match(c))&&p.push(g)}var m=p.length;if(0===m)return l();if(1===r.length&&!this.mark&&!this.stat){this.matches[o]||(this.matches[o]=Object.create(null));for(f=0;f<m;f++){var g=p[f];e&&(g="/"!==e?e+"/"+g:e+g),"/"!==g.charAt(0)||this.nomount||(g=i.join(this.root,g)),this._emitMatch(o,g)}return l()}r.shift();for(f=0;f<m;f++){g=p[f];e&&(g="/"!==e?e+"/"+g:e+g),this._process([g].concat(r),o,s,l)}l()},_.prototype._emitMatch=function(e,t){if(!this.aborted&&!p(this,t))if(this.paused)this._emitQueue.push([e,t]);else{var n=s(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=n),!this.matches[e][t]){if(this.nodir){var r=this.cache[n];if("DIR"===r||Array.isArray(r))return}this.matches[e][t]=!0;var i=this.statCache[n];i&&this.emit("stat",t,i),this.emit("match",t)}}},_.prototype._readdirInGlobStar=function(e,t){if(!this.aborted){if(this.follow)return this._readdir(e,!1,t);var n=this,r=d("lstat\0"+e,(function(r,i){if(r&&"ENOENT"===r.code)return t();var o=i&&i.isSymbolicLink();n.symlinks[e]=o,o||!i||i.isDirectory()?n._readdir(e,!1,t):(n.cache[e]="FILE",t())}));r&&n.fs.lstat(e,r)}},_.prototype._readdir=function(e,t,n){if(!this.aborted&&(n=d("readdir\0"+e+"\0"+t,n))){if(t&&!u(this.symlinks,e))return this._readdirInGlobStar(e,n);if(u(this.cache,e)){var r=this.cache[e];if(!r||"FILE"===r)return n();if(Array.isArray(r))return n(null,r)}this.fs.readdir(e,function(e,t,n){return function(r,i){r?e._readdirError(t,r,n):e._readdirEntries(t,i,n)}}(this,e,n))}},_.prototype._readdirEntries=function(e,t,n){if(!this.aborted){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var i=t[r];i="/"===e?e+i:e+"/"+i,this.cache[i]=!0}return this.cache[e]=t,n(null,t)}},_.prototype._readdirError=function(e,t,n){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var i=new Error(t.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=t.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t)}return n()}},_.prototype._processGlobStar=function(e,t,n,r,i,o,s){var a=this;this._readdir(n,o,(function(l,c){a._processGlobStar2(e,t,n,r,i,o,c,s)}))},_.prototype._processGlobStar2=function(e,t,n,r,i,o,s,a){if(!s)return a();var l=r.slice(1),c=e?[e]:[],u=c.concat(l);this._process(u,i,!1,a);var d=this.symlinks[n],h=s.length;if(d&&o)return a();for(var p=0;p<h;p++){if("."!==s[p].charAt(0)||this.dot){var f=c.concat(s[p],l);this._process(f,i,!0,a);var m=c.concat(s[p],r);this._process(m,i,!0,a)}}a()},_.prototype._processSimple=function(e,t,n){var r=this;this._stat(e,(function(i,o){r._processSimple2(e,t,i,o,n)}))},_.prototype._processSimple2=function(e,t,n,r,o){if(this.matches[t]||(this.matches[t]=Object.create(null)),!r)return o();if(e&&s(e)&&!this.nomount){var a=/[\/\\]$/.test(e);"/"===e.charAt(0)?e=i.join(this.root,e):(e=i.resolve(this.root,e),a&&(e+="/"))}"win32"===process.platform&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),o()},_.prototype._stat=function(e,t){var n=this._makeAbs(e),r="/"===e.slice(-1);if(e.length>this.maxLength)return t();if(!this.stat&&u(this.cache,n)){var i=this.cache[n];if(Array.isArray(i)&&(i="DIR"),!r||"DIR"===i)return t(null,i);if(r&&"FILE"===i)return t()}var o=this.statCache[n];if(void 0!==o){if(!1===o)return t(null,o);var s=o.isDirectory()?"DIR":"FILE";return r&&"FILE"===s?t():t(null,s,o)}var a=this,l=d("stat\0"+n,(function(r,i){if(i&&i.isSymbolicLink())return a.fs.stat(n,(function(r,o){r?a._stat2(e,n,null,i,t):a._stat2(e,n,r,o,t)}));a._stat2(e,n,r,i,t)}));l&&a.fs.lstat(n,l)},_.prototype._stat2=function(e,t,n,r,i){if(n&&("ENOENT"===n.code||"ENOTDIR"===n.code))return this.statCache[t]=!1,i();var o="/"===e.slice(-1);if(this.statCache[t]=r,"/"===t.slice(-1)&&r&&!r.isDirectory())return i(null,!1,r);var s=!0;return r&&(s=r.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||s,o&&"FILE"===s?i():i(null,s,r)},sI}var wI=_I();const vI=(e,t)=>t.map((t=>{const r=n.basename(t);return{path:t,subPath:t.replace(e,"").replace(`/${r}`,""),fileNameShort:n.parse(r).name}}));const bI=()=>J(void 0,void 0,void 0,(function*(){return bt("npx",["playwright-chromium","install","--with-deps"])}));!function(){J(this,void 0,void 0,(function*(){try{const{diagramType:e,diagramExcludeTypes:r,diagramStacks:i,pathInput:o,pathOutput:s,viewport:a}=bA();e&&kA(e)&&(yield bI());const l=(e=>{if(wI.glob.hasMagic(e)){const t=new wI.Glob(e,{noprocess:!0}).minimatch.set[0].filter((e=>"string"==typeof e&&""!==e)),r=xA(n.join(...t)),i=wI.glob.sync(e).map((e=>xA(e)));return vI(r,i)}if(t.statSync(e).isFile()){const t=n.basename(e);return[{path:e,fileNameShort:n.parse(t).name,subPath:""}]}return console.warn(`[cfn-diagram-action]: No files found for path ${e}`),[]})(o),c=yield(({files:e,diagramType:t="html",diagramExcludeTypes:r,diagramStacks:i,pathOutput:o=xA("diagrams")})=>J(void 0,void 0,void 0,(function*(){return Promise.all(e.map((({path:e,subPath:s,fileNameShort:a})=>()=>J(void 0,void 0,void 0,(function*(){let l,c;kA(t)?(c=n.join(o,s,`${a.toLowerCase()}`),l=c):(c=n.join(o,s),l=n.join(c,`${a}.drawio`)),yield bt(`mkdir -p ${c}`);const u=[{key:"",value:t},{key:"t",value:e},{key:"o",value:l}];r&&u.push({key:"e",value:r}),i&&u.push({key:"-stacks",value:i});const d=u.reduce(((e,t)=>e+`${t.key?`-${t.key}`:t.key} ${t.value} `),"");return yield bt(`cfn-dia ${d}-c`),{path:l,subPath:s,fileName:a}})))).map((e=>e())))})))({files:l,diagramType:e,diagramExcludeTypes:r,diagramStacks:i,pathOutput:s});kA(e)&&(yield(({inputFiles:e,pathOutput:t="diagrams",viewport:n={width:1280,height:720}})=>J(void 0,void 0,void 0,(function*(){const r=yield vA.launch(),i=yield r.newContext({viewport:n}),o=yield i.newPage();for(let n=0;n<e.length;n++){const{path:r,subPath:i,fileName:s}=e[n],a=`${r}/index.html`,l=`${t}${i?`/${i}`:""}/${s}.png`;yield o.goto(`file:${a}`),yield o.screenshot({path:l,fullPage:!0})}yield r.close()})))({inputFiles:c,pathOutput:s,viewport:a}))}catch(e){e instanceof Error?Me.setFailed(e.message):Me.setFailed("Unknown error caused failure.")}}))}();
